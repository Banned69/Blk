function g(a){throw a;}var j=void 0,m=!0,p=null,r=!1;function aa(){return function(){}}function ba(a){return function(b){this[a]=b}}function s(a){return function(){return this[a]}}function ca(a){return function(){return a}}var t,da=da||{},v=this;function ea(a,b){var c=a.split("."),d=v;!(c[0]in d)&&d.execScript&&d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)!c.length&&fa(b)?d[e]=b:d=d[e]?d[e]:d[e]={}}
function ha(a){a=a.split(".");for(var b=v,c;c=a.shift();)if(b[c]!=p)b=b[c];else return p;return b}function x(){}function ia(a){return a}
function ja(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function fa(a){return a!==j}function ka(a){return"array"==ja(a)}function la(a){var b=ja(a);return"array"==b||"object"==b&&"number"==typeof a.length}function ma(a){return"string"==typeof a}function na(a){return"function"==ja(a)}function oa(a){var b=typeof a;return"object"==b&&a!=p||"function"==b}function qa(a){return a[ra]||(a[ra]=++sa)}var ra="closure_uid_"+Math.floor(2147483648*Math.random()).toString(36),sa=0;
function ta(a,b,c){return a.call.apply(a.bind,arguments)}function ua(a,b,c){a||g(Error());if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}function y(a,b,c){y=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ta:ua;return y.apply(p,arguments)}var z=Date.now||function(){return+new Date};
function A(a,b){function c(){}c.prototype=b.prototype;a.d=b.prototype;a.prototype=new c};var va=!!v.wtf&&2==v.wtf.trace.API_VERSION,wa=va?v.wtf.trace.appendScopeData:x,xa=va?v.wtf.trace.beginTimeRange:x,ya=va?v.wtf.trace.endTimeRange:x,za=va?v.wtf.trace.instrument:ia,Aa=va?v.wtf.trace.instrumentType:ia;function Ba(a,b){this.attributes=[new Ca(3,0),new Ca(2,24)];this.Nm=a;this.Ym=b}function Ca(a,b){this.size=a;this.type=5126;this.jn=r;this.qn=32;this.offset=b};function Da(){};function Ea(a){this.length=a.length||a;for(var b=0;b<this.length;b++)this[b]=a[b]||0}Ea.prototype.BYTES_PER_ELEMENT=4;Ea.prototype.set=function(a,b){b=b||0;for(var c=0;c<a.length&&b+c<this.length;c++)this[b+c]=a[c]};Ea.prototype.toString=Array.prototype.join;"undefined"==typeof Float32Array&&(Ea.BYTES_PER_ELEMENT=4,Ea.prototype.BYTES_PER_ELEMENT=Ea.prototype.BYTES_PER_ELEMENT,Ea.prototype.set=Ea.prototype.set,Ea.prototype.toString=Ea.prototype.toString,ea("Float32Array",Ea));function Fa(a){this.length=a.length||a;for(var b=0;b<this.length;b++)this[b]=a[b]||0}Fa.prototype.BYTES_PER_ELEMENT=8;Fa.prototype.set=function(a,b){b=b||0;for(var c=0;c<a.length&&b+c<this.length;c++)this[b+c]=a[c]};Fa.prototype.toString=Array.prototype.join;if("undefined"==typeof Float64Array){try{Fa.BYTES_PER_ELEMENT=8}catch(Ga){}Fa.prototype.BYTES_PER_ELEMENT=Fa.prototype.BYTES_PER_ELEMENT;Fa.prototype.set=Fa.prototype.set;Fa.prototype.toString=Fa.prototype.toString;ea("Float64Array",Fa)};function B(){return new Float32Array(3)}function Ha(a,b,c){var d=B();C(d,a,b,c);return d}function C(a,b,c,d){a[0]=b;a[1]=c;a[2]=d}function Ia(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2]}function Ja(a,b,c){c[0]=a[0]+b[0];c[1]=a[1]+b[1];c[2]=a[2]+b[2]}function Ka(a,b,c){c[0]=a[0]*b;c[1]=a[1]*b;c[2]=a[2]*b}function La(a){var b=a[0],c=a[1];a=a[2];return Math.sqrt(b*b+c*c+a*a)}function Ua(a,b){var c=a[0]-b[0],d=a[1]-b[1],e=a[2]-b[2];return c*c+d*d+e*e}
function Va(a,b,c){var d=b[0]-a[0],e=b[1]-a[1];a=b[2]-a[2];(b=Math.sqrt(d*d+e*e+a*a))?(b=1/b,c[0]=d*b,c[1]=e*b,c[2]=a*b):c[0]=c[1]=c[2]=0}function Wa(a,b){return a.length==b.length&&a[0]==b[0]&&a[1]==b[1]&&a[2]==b[2]};function Xa(){var a=B(),b=B();this.min=a;this.max=b}function Ya(a,b,c,d,e,f){var h=new Xa;h.min[0]=a<d?a:d;h.min[1]=b<e?b:e;h.min[2]=c<f?c:f;h.max[0]=a<d?d:a;h.max[1]=b<e?e:b;h.max[2]=c<f?f:c;return h}
function Za(a,b,c){var d=a.min;a=a.max;var e=$a[0];e[0]=Math.abs(b[3]);e[1]=Math.abs(b[4]);e[2]=Math.abs(b[5]);var f=0,h=1,k=2;e[0]<e[2]&&(f=2,k=0);e[1]<e[k]?(h=k,k=1):e[1]>e[f]&&(h=f,f=1);var i=0,l=Number.MAX_VALUE,n=b[3+f],q=(d[f]-b[f])/n,f=(a[f]-b[f])/n;q>f&&(n=q,q=f,f=n);if(!(q>l||f<i)){q>i&&(i=q);f<l&&(l=f);if(1E-6>e[h]){if(b[h]<d[h]||b[h]>a[h]||b[k]<d[k]||b[k]>a[k])return}else{n=b[3+h];q=(d[h]-b[h])/n;f=(a[h]-b[h])/n;q>f&&(n=q,q=f,f=n);if(q>l||f<i)return;q>i&&(i=q);f<l&&(l=f);if(1E-6>e[k]){if(b[k]<
d[k]||b[k]>a[k])return}else{n=b[3+k];q=(d[k]-b[k])/n;f=(a[k]-b[k])/n;q>f&&(n=q,q=f,f=n);if(q>l||f<i)return;q>i&&(i=q)}}c&&(c[0]=b[0]+b[3]*i,c[1]=b[1]+b[4]*i,c[2]=b[2]+b[5]*i)}}var $a=[B(),B(),B()];function D(){return new Float32Array(4)}function ab(a,b,c,d){var e=D();bb(e,a,b,c,d);return e}function bb(a,b,c,d,e){a[0]=b;a[1]=c;a[2]=d;a[3]=e}function cb(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3]}function db(a,b){var c=1/256;b[0]=a[0]*c;b[1]=a[1]*c;b[2]=a[2]*c;b[3]=a[3]*c};function eb(){var a=new Float32Array(16);a[0]=a[5]=a[10]=a[15]=1;return a}function fb(a,b,c,d,e,f,h,k,i){a[0]=b;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=c;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=d;a[11]=e;a[12]=f;a[13]=h;a[14]=k;a[15]=i}
function gb(a,b,c){var d=a[0],e=a[1],f=a[2],h=a[3],k=a[4],i=a[5],l=a[6],n=a[7],q=a[8],u=a[9],w=a[10],F=a[11],H=a[12],G=a[13],I=a[14];a=a[15];var N=b[0],ga=b[1],Z=b[2],pa=b[3],Ma=b[4],Na=b[5],Oa=b[6],Pa=b[7],Qa=b[8],Ra=b[9],Sa=b[10],Ta=b[11],L=b[12],Nd=b[13],Od=b[14];b=b[15];c[0]=d*N+k*ga+q*Z+H*pa;c[1]=e*N+i*ga+u*Z+G*pa;c[2]=f*N+l*ga+w*Z+I*pa;c[3]=h*N+n*ga+F*Z+a*pa;c[4]=d*Ma+k*Na+q*Oa+H*Pa;c[5]=e*Ma+i*Na+u*Oa+G*Pa;c[6]=f*Ma+l*Na+w*Oa+I*Pa;c[7]=h*Ma+n*Na+F*Oa+a*Pa;c[8]=d*Qa+k*Ra+q*Sa+H*Ta;c[9]=e*Qa+
i*Ra+u*Sa+G*Ta;c[10]=f*Qa+l*Ra+w*Sa+I*Ta;c[11]=h*Qa+n*Ra+F*Sa+a*Ta;c[12]=d*L+k*Nd+q*Od+H*b;c[13]=e*L+i*Nd+u*Od+G*b;c[14]=f*L+l*Nd+w*Od+I*b;c[15]=h*L+n*Nd+F*Od+a*b}
function hb(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],h=a[4],k=a[5],i=a[6],l=a[7],n=a[8],q=a[9],u=a[10],w=a[11],F=a[12],H=a[13],G=a[14],I=a[15],N=c*k-d*h,ga=c*i-e*h,Z=c*l-f*h,pa=d*i-e*k,Ma=d*l-f*k,Na=e*l-f*i,Oa=n*H-q*F,Pa=n*G-u*F,Qa=n*I-w*F,Ra=q*G-u*H,Sa=q*I-w*H,Ta=u*I-w*G,L=N*Ta-ga*Sa+Z*Ra+pa*Qa-Ma*Pa+Na*Oa;0!=L&&(L=1/L,b[0]=(k*Ta-i*Sa+l*Ra)*L,b[1]=(-d*Ta+e*Sa-f*Ra)*L,b[2]=(H*Na-G*Ma+I*pa)*L,b[3]=(-q*Na+u*Ma-w*pa)*L,b[4]=(-h*Ta+i*Qa-l*Pa)*L,b[5]=(c*Ta-e*Qa+f*Pa)*L,b[6]=(-F*Na+G*Z-I*ga)*L,b[7]=(n*Na-u*
Z+w*ga)*L,b[8]=(h*Sa-k*Qa+l*Oa)*L,b[9]=(-c*Sa+d*Qa-f*Oa)*L,b[10]=(F*Ma-H*Z+I*N)*L,b[11]=(-n*Ma+q*Z-w*N)*L,b[12]=(-h*Ra+k*Pa-i*Oa)*L,b[13]=(c*Ra-d*Pa+e*Oa)*L,b[14]=(-F*pa+H*ga-G*N)*L,b[15]=(n*pa-q*ga+u*N)*L)}function ib(a,b,c){var d=b[0],e=b[1];b=b[2];var f=1/(d*a[3]+e*a[7]+b*a[11]+a[15]);c[0]=(d*a[0]+e*a[4]+b*a[8]+a[12])*f;c[1]=(d*a[1]+e*a[5]+b*a[9]+a[13])*f;c[2]=(d*a[2]+e*a[6]+b*a[10]+a[14])*f}new Float64Array(3);new Float64Array(3);new Float64Array(4);new Float64Array(4);new Float64Array(4);new Float64Array(16);function jb(){this.name=p;this.index=0;this.parent=p;this.children=[];this.transform=eb();this.ab=new Xa;this.Rd=D()};function kb(a){this.Ki=a;a=a.Pd;this.lk=new Float32Array(16*a.length);this.Jm=new Float32Array(16*a.length);this.tm=m;this.reset()}kb.prototype.reset=function(){this.tm=m;for(var a=this.Ki.Pd,b=0,c=0;b<a.length;b++,c+=16)for(var d=a[b],e=0;16>e;e++)this.lk[c+e]=d.transform[e]};function E(){0!=lb&&(this.Vm=Error().stack,mb[qa(this)]=this)}var lb=0,mb={};E.prototype.Xf=r;E.prototype.Uc=function(){if(!this.Xf&&(this.Xf=m,this.b(),0!=lb)){var a=qa(this);delete mb[a]}};function J(a,b){a.ge||(a.ge=[]);a.ge.push(b)}E.prototype.b=function(){this.ge&&nb.apply(p,this.ge);if(this.Si)for(;this.Si.length;)this.Si.shift()()};function K(a){a&&"function"==typeof a.Uc&&a.Uc()}function nb(a){for(var b=0,c=arguments.length;b<c;++b){var d=arguments[b];la(d)?nb.apply(p,d):K(d)}};function ob(a){Error.captureStackTrace?Error.captureStackTrace(this,ob):this.stack=Error().stack||"";a&&(this.message=String(a))}A(ob,Error);ob.prototype.name="CustomError";function pb(a,b){for(var c=1;c<arguments.length;c++){var d=String(arguments[c]).replace(/\$/g,"$$$$");a=a.replace(/\%s/,d)}return a}function qb(a){return a.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")}function rb(a){if(!sb.test(a))return a;-1!=a.indexOf("&")&&(a=a.replace(tb,"&amp;"));-1!=a.indexOf("<")&&(a=a.replace(ub,"&lt;"));-1!=a.indexOf(">")&&(a=a.replace(vb,"&gt;"));-1!=a.indexOf('"')&&(a=a.replace(wb,"&quot;"));return a}var tb=/&/g,ub=/</g,vb=/>/g,wb=/\"/g,sb=/[&<>\"]/;Math.random();function xb(a){E.call(this);this.id=a;this.ab=new Xa;this.Rd=D();this.Lk=p;this.Ol=[];this.Pd=[];this.Qm={}}A(xb,E);xb.prototype.ee=function(){return new kb(this)};function yb(){this.Bl=new Da;this.primitiveType=4;this.Zm=this.Ak=0};function zb(){var a=new xb("pumpkin"),b=a.ab,c=[-0.5,-1,0,0.5,1,0.5],d=b.min,b=b.max;if(c.length){var e=0;C(d,c[e],c[e+1],c[e+2]);C(b,c[e],c[e+1],c[e+2]);e++;for(var f=1;f<c.length/3;f++,e++)c[e]<d[0]?d[0]=c[e]:c[e]>b[0]&&(b[0]=c[e]),c[e+1]<d[1]?d[1]=c[e+1]:c[e+1]>b[1]&&(b[1]=c[e+1]),c[e+2]<d[2]?d[2]=c[e+2]:c[e+2]>b[2]&&(b[2]=c[e+2])}else C(d,0,0,0),C(b,0,0,0);bb(a.Rd,0,0,0,1);c=ab(96,112,112,128);d=ab(112,112,128,128);b=ab(96,96,112,112);db(c,c);db(d,d);db(b,b);c=new Float32Array([-0.5,-1,0.5,0,
0,1,c[2],c[3],0.5,-1,0.5,0,0,1,c[0],c[3],0.5,1,0.5,0,0,1,c[0],c[1],-0.5,1,0.5,0,0,1,c[2],c[1],-0.5,-1,-0.5,0,0,-1,d[0],d[3],-0.5,1,-0.5,0,0,-1,d[0],d[1],0.5,1,-0.5,0,0,-1,d[2],d[1],0.5,-1,-0.5,0,0,-1,d[2],d[3],-0.5,1,-0.5,0,1,0,b[2],b[1],-0.5,1,0.5,0,1,0,b[2],b[3],0.5,1,0.5,0,1,0,b[0],b[3],0.5,1,-0.5,0,1,0,b[0],b[1],-0.5,-1,-0.5,0,-1,0,c[0],c[1],0.5,-1,-0.5,0,-1,0,c[2],c[1],0.5,-1,0.5,0,-1,0,c[2],c[3],-0.5,-1,0.5,0,-1,0,c[0],c[3],0.5,-1,-0.5,1,0,0,c[0],c[3],0.5,1,-0.5,1,0,0,c[0],c[1],0.5,1,0.5,1,
0,0,c[2],c[1],0.5,-1,0.5,1,0,0,c[2],c[3],-0.5,-1,-0.5,-1,0,0,c[2],c[3],-0.5,-1,0.5,-1,0,0,c[0],c[3],-0.5,1,0.5,-1,0,0,c[0],c[1],-0.5,1,-0.5,-1,0,0,c[2],c[1]]);d=new Uint16Array(36);for(f=e=b=0;6>b;b++,e+=6,f+=4)d[e+0]=0+f,d[e+1]=1+f,d[e+2]=2+f,d[e+3]=0+f,d[e+4]=2+f,d[e+5]=3+f;a.Lk=new Ba(c.buffer,d);c=new yb;a.Ol.push(c);c.primitiveType=4;c.Ak=36;c=new jb;c.index=a.Pd.length;c.name=p;c.parent=p;a.Pd.push(c);d=c.ab;b=a.ab;Ia(d.min,b.min);Ia(d.max,b.max);cb(c.Rd,a.Rd);return a};var Ab=Array.prototype,Bb=Ab.indexOf?function(a,b,c){return Ab.indexOf.call(a,b,c)}:function(a,b,c){c=c==p?0:0>c?Math.max(0,a.length+c):c;if(ma(a))return!ma(b)||1!=b.length?-1:a.indexOf(b,c);for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},Cb=Ab.forEach?function(a,b,c){Ab.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=ma(a)?a.split(""):a,f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)},Db=Ab.filter?function(a,b,c){return Ab.filter.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=[],f=
0,h=ma(a)?a.split(""):a,k=0;k<d;k++)if(k in h){var i=h[k];b.call(c,i,k,a)&&(e[f++]=i)}return e},Eb=Ab.map?function(a,b,c){return Ab.map.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=Array(d),f=ma(a)?a.split(""):a,h=0;h<d;h++)h in f&&(e[h]=b.call(c,f[h],h,a));return e},Fb=Ab.some?function(a,b,c){return Ab.some.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=ma(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return m;return r};
function Gb(a){if(!ka(a))for(var b=a.length-1;0<=b;b--)delete a[b];a.length=0}function Hb(a,b){var c=Bb(a,b),d;(d=0<=c)&&Ab.splice.call(a,c,1);return d}function Ib(a){return Ab.concat.apply(Ab,arguments)}function Jb(a){var b=a.length;if(0<b){for(var c=Array(b),d=0;d<b;d++)c[d]=a[d];return c}return[]}function Kb(a,b){Ab.sort.call(a,b||Lb)}function Lb(a,b){return a>b?1:a<b?-1:0};var Mb=v.postMessage?[v]:[];function M(a){for(var b=0;b<Mb.length;b++){for(var c=Array(arguments.length),d=0;d<c.length;d++)c[d]=arguments[d];try{Mb[b].postMessage({type:"gf_log",args:c},p)}catch(e){}}}if(v.console)var Nb=v.console,M=y(Nb.log,Nb);function Ob(){E.call(this);this.pd={}}A(Ob,E);Ob.prototype.b=function(){for(var a in this.pd)K(this.pd[a]);this.pd={};Ob.d.b.call(this)};Ob.prototype.update=aa();function Pb(a){Ob.call(this);this.Jc=a;this.Mi={}}A(Pb,Ob);function Qb(a){Pb.call(this,a);this.Mi.pumpkin={id:"pumpkin",xk:zb}}A(Qb,Pb);function Rb(){this.ni="improved";this.Qe=0};function Sb(){this.q=Array(256)}function Tb(a,b){a.q[b.id]=b};function Ub(a,b,c,d,e,f,h){this.Nc=a;this.Eh=b;this.Fh=c;this.Gh=d;this.$=e;this.Yf=f;this.Xi=h};function Vb(a,b,c,d){this.map=a;this.x=b;this.y=c;this.l=d;this.ab=Ya(b,c,d,b+16,c+128,d+16);this.state=Wb;this.bc=m;this.version=this.Na=0;this.$=new Uint16Array(32768);this.ln=this.ub=p}var Wb=0;Vb.prototype.fill=function(a){for(var b=0;32768>b;b++)this.$[b]=a[b];this.bc=m;this.state=2;this.map.Be(this);this.map.uf(this)};Vb.prototype.ra=function(a,b,c,d){b=(a&15)+16*(c&15)+256*(b&127);a=this.$[b];this.$[b]=d;a!=d&&!this.bc&&(d=this.bc,this.bc=m,this.ub=p,d||this.map.uf(this));return a};
Vb.prototype.rg=function(a){var b=Xb[0];Za(this.ab,a,b);var c=Math.floor(b[0]),d=Math.floor(b[1]),e=Math.floor(b[2]),f=0==a[3]?0:0>a[3]?-1:1,h=0==a[4]?0:0>a[4]?-1:1,k=0==a[5]?0:0>a[5]?-1:1,i=(c+(0<f?1:0)-b[0])/a[3],l=(d+(0<h?1:0)-b[1])/a[4],n=(e+(0<k?1:0)-b[2])/a[5];isNaN(i)&&(i=Number.POSITIVE_INFINITY);isNaN(l)&&(l=Number.POSITIVE_INFINITY);isNaN(n)&&(n=Number.POSITIVE_INFINITY);var q=f/a[3],u=h/a[4],w=k/a[5];isNaN(q)&&(q=Number.POSITIVE_INFINITY);isNaN(u)&&(u=Number.POSITIVE_INFINITY);isNaN(w)&&
(w=Number.POSITIVE_INFINITY);for(var F=this.$,H=b=0;256>H;H++){var G=c-this.x,I=d-this.y,N=e-this.l;if(0<=G&&(16>G&&0<=I&&128>I&&0<=N&&16>N)&&(b=F[G+16*N+256*I],b>>8))break;i<l&&i<n?(i+=q,c+=f):l<n?(l+=u,d+=h):(n+=w,e+=k)}return b?(f=Yb,h=c+1,k=d+1,i=e+1,C(f.min,c,d,e),C(f.max,h,k,i),f=B(),Za(Yb,a,f),new Ub(this,c,d,e,b,Math.sqrt(Ua(a,f)),f)):p};var Xb=[B(),B()],Yb=new Xa;function Zb(){E.call(this);this.ua={};this.Wb=[];this.af=this.Lj=0}A(Zb,E);t=Zb.prototype;t.b=function(){this.Wb.length=0;Zb.d.b.call(this)};t.update=function(){for(;this.Wb.length;){var a=this.Wb.shift();$b(this,a)}};t.get=function(a,b,c){return 0!=b>>7?p:this.ua[(a>>4&65535)<<16|c>>4&65535]||p};t.add=function(a){this.ua[(a.x>>4&65535)<<16|a.l>>4&65535]=a;0<a.Na||this.Wb.push(a);this.Lj++;this.af+=65792};t.remove=function(a){$b(this,a);0<a.Na||Hb(this.Wb,a)};
function $b(a,b){delete a.ua[(b.x>>4&65535)<<16|b.l>>4&65535];a.af-=65792;a.Lj--}t.ze=function(a){this.Wb.push(a)};t.Ae=function(a){Hb(this.Wb,a)};function ac(){E.call(this);this.jm=Ha(0,191/255,1);this.Lm=Ha(110/255,110/255,110/255);this.sn=Ha(1,1,-0.5);this.rn=Ha(130/255,130/255,130/255);this.Hk=Ha(1,1,1);Ia(this.Hk,this.jm)}A(ac,E);ac.prototype.update=aa();function bc(a,b,c,d,e){this.id=a;this.name=b;this.Bl=c;this.z=d;this.pn=0;this.cn=1;this.tn=0;this.Mm=e};function cc(a,b,c,d,e){bc.call(this,a,b,c,d,e)}A(cc,bc);function dc(a,b){var c=ab(0,0,0,0);this.z=a;this.Km=b||p;this.mn=p;this.color=c||D()};var ec=new dc(17,"block_gravel"),fc=new dc(17,"block_stone"),gc=new dc(17,"block_wood"),hc=new dc(97,"block_stone"),ic=new dc(17,"block_cloth");function jc(){bc.call(this,6,"Red Cloth",ic,17,129)}A(jc,cc);function kc(){bc.call(this,7,"Green Cloth",ic,17,145)}A(kc,cc);function lc(){bc.call(this,8,"Yellow Cloth",ic,17,162)}A(lc,cc);function mc(){bc.call(this,9,"Blue Cloth",ic,17,177)}A(mc,cc);function nc(){bc.call(this,3,"Brick",fc,17,7)}A(nc,cc);function oc(){bc.call(this,1,"Dirt",ec,17,2)}A(oc,cc);function pc(){bc.call(this,5,"Glass",hc,17,49)}A(pc,cc);function qc(){bc.call(this,2,"Stone",fc,17,1)}A(qc,cc);function rc(){bc.call(this,4,"Wood",gc,17,4)}A(rc,cc);function sc(){E.call(this);this.A=new Sb;Tb(this.A,new oc);Tb(this.A,new qc);Tb(this.A,new nc);Tb(this.A,new rc);Tb(this.A,new pc);Tb(this.A,new jc);Tb(this.A,new kc);Tb(this.A,new lc);Tb(this.A,new mc);this.ci=new ac;J(this,this.ci);this.Ya=[];this.Ab=new Zb;J(this,this.Ab)}A(sc,E);t=sc.prototype;t.b=function(){sc.d.b.call(this)};t.update=function(a){this.ci.update(a);this.Ab.update(a)};
t.fc=function(a,b,c){var d=this.Ab.get(a,b,c);if(d)return d;d=new Vb(this,a&-16,b&-128,c&-16);this.Ab.add(d);this.Ne(d);return d};t.Be=function(a){for(var b=0;b<this.Ya.length;b++){var c=this.Ya[b],d=c.bb,e=a.ab,f=d.min,d=d.max,h=e.min,e=e.max;-1!=(d[0]<h[0]||f[0]>e[0]||d[1]<h[1]||f[1]>e[1]||d[2]<h[2]||f[2]>e[2]?-1:f[0]>h[0]||e[0]>d[0]||f[1]>h[1]||e[1]>d[1]||f[2]>h[2]||e[2]>d[2]?0:1)&&c.Be(a)}};t.uf=x;t.ze=function(a){this.Ab.ze(a)};t.Ae=function(a){this.Ab.Ae(a)};t.Ne=x;
t.ra=function(a,b,c,d){var e=this.Ab.get(a,b,c);if(e){if(2!=e.state)return M("setBlock before chunk fully loaded - inconsistent state!"),0}else return 0;e=e.ra(a,b,c,d);if(e!=d)for(d=0;d<this.Ya.length;d++)for(var f=this.Ya[d],h=a,k=b,i=c,l=0;l<f.n.length;l++)f.n[l].zi(h,k,i,0);return e};function tc(a,b){this.Gi=a;this.A=b}tc.prototype.me=x;function uc(a,b){tc.call(this,a,b)}A(uc,tc);uc.prototype.me=function(a,b,c,d,e){if(0>=c&&0<=c){a=b+16;for(c=d+16;b<a;b++)for(var f=d;f<c;f++)e.ra(b,0,f,256)}};function vc(a){this.Qb=wc(32);this.Rb=wc(32);this.Sb=wc(32);this.Nh=1;a=fa(a)?a:z();this.Qb-=wc(a);0>this.Qb&&(this.Qb+=1);this.Rb-=wc(a);0>this.Rb&&(this.Rb+=1);this.Sb-=wc(a);0>this.Sb&&(this.Sb+=1);for(a=0;100>a;a++)this.random()}function wc(a){a=a.toString();for(var b=4022871197,c=0;c<a.length;c++)var b=b+a.charCodeAt(c),d=0.02519603282416938*b,b=d>>>0,d=d-b,d=d*b,b=d>>>0,d=d-b,b=b+4294967296*d;return 2.3283064365386963E-10*(b>>>0)}
vc.prototype.random=function(){var a=2091639*this.Qb+2.3283064365386963E-10*this.Nh;this.Qb=this.Rb;this.Rb=this.Sb;return this.Sb=a-(this.Nh=a|0)};function xc(a){this.jc=new Float32Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1]);this.sc=new Uint8Array(512);for(var b=0;256>b;b++)this.sc[b]=this.sc[256+b]=~~(255*a.random())}function yc(a,b,c,d){a=a.jc;return a[3*b]*c+a[3*b+1]*d}
xc.prototype.sb=function(a,b){var c,d,e;e=(a+b)*0.5*(Math.sqrt(3)-1);var f=Math.floor(a+e),h=Math.floor(b+e),k=(3-Math.sqrt(3))/6;e=(f+h)*k;c=a-(f-e);var i=b-(h-e),l,n;c>i?(l=1,n=0):(l=0,n=1);d=c-l+k;var q=i-n+k;e=c-1+2*k;var k=i-1+2*k,u=f&255,h=h&255,w=this.sc,f=w[u+w[h]]%12;l=w[u+l+w[h+n]]%12;n=w[u+1+w[h+1]]%12;u=0.5-c*c-i*i;0>u?c=0:(u*=u,c=u*u*yc(this,f,c,i));i=0.5-d*d-q*q;0>i?d=0:(i*=i,d=i*i*yc(this,l,d,q));q=0.5-e*e-k*k;0>q?e=0:(q*=q,e=q*q*yc(this,n,e,k));return 70*(c+d+e)};function zc(a,b){tc.call(this,a,b);var c=new vc(a.Qe);this.Bg=new xc(c)}A(zc,tc);zc.prototype.me=function(a,b,c,d,e){a=this.Bg;for(c=0;16>c;c++)for(var f=b+c,h=0;16>h;h++){var k=d+h,i=0.5*a.sb(0.001*f,0.001*k),i=i+0.25*a.sb(0.002*(f+100),0.002*k),i=i+0.25*a.sb(0.01*(f+100),0.01*k),l=25.6*i+64|0;1>l&&(l=1);e.ra(c,l,h,257);var k=e,n=c&15,i=0,l=l-1&127,q=h&15;if(i>l)var u=i,i=l,l=u;for(n=n+16*q+256*i;i<=l;i++,n+=256)k.$[n]=256}};function Ac(a,b){this.qi=b||15;this.jc=new Float32Array(512);this.sc=new Uint8Array(256);for(var c=0;256>c;c++){var d=2*Math.PI*a.random();this.jc[c]=Math.cos(d);this.jc[256+c]=Math.sin(d);this.sc[c]=~~(255*a.random())}}
Ac.prototype.sb=function(a,b){for(var c=a/this.qi,d=b/this.qi,e=~~c,f=~~d,h=0;4>h;h++){var k=e+h%2,i=f+~~(h/2),l=i+this.sc[k]&255;Bc[h]=this.jc[l]*(c-k)+this.jc[256+l]*(d-i)}c-=~~c;d-=~~d;c=3*Math.pow(c,2)-2*Math.pow(c,3);e=Bc[0]+c*(Bc[1]-Bc[0]);return e+(3*Math.pow(d,2)-2*Math.pow(d,3))*(Bc[2]+c*(Bc[3]-Bc[2])-e)};var Bc=new Float32Array(4);function Cc(a,b){tc.call(this,a,b);var c=new vc(a.Qe);this.Bg=new Ac(c,15)}A(Cc,tc);Cc.prototype.me=function(a,b,c,d,e){a=this.Bg;c=b+16;for(var f=d+16;b<c;b++)for(var h=d;h<f;h++){var k;k=a;var i=b+1E3,l=h+1E3;k=(k.sb(i+16,l+16)*(16-i)*(16-l)+k.sb(i,l+16)*i*(16-l)+k.sb(i,l)*i*l+k.sb(i+16,l)*(16-i)*l)/256;k=Math.max(0,Math.min(15,k/1E3|0));for(i=0;i<=64+k;i++)l=256,i>=64+k&&(l|=1),e.ra(b,i,h,l)}};var Dc={flat:uc,noise:Cc,improved:zc};function Ec(){this.$=new Uint16Array(32768);this.Gm=new Uint16Array(32768)}Ec.prototype.ka=function(){this.$.set(this.Gm)};Ec.prototype.end=s("$");Ec.prototype.ra=function(a,b,c,d){this.$[(a&15)+16*(c&15)+256*(b&127)]=d};var Fc;var Gc=v.performance;Fc=Gc&&Gc.now?function(){return Gc.now()}:Gc&&Gc.webkitNow?function(){return Gc.webkitNow()}:j;var Hc=Fc?Fc:Date.now;function Ic(a,b){for(var c in a)b.call(j,a[c],c,a)}function Jc(a){var b=[],c=0,d;for(d in a)b[c++]=a[d];return b}function Kc(a){var b=[],c=0,d;for(d in a)b[c++]=d;return b}function Lc(a){var b={},c;for(c in a)b[c]=a[c];return b}var Mc="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");
function Nc(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var f=0;f<Mc.length;f++)c=Mc[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}};function Oc(a){if("function"==typeof a.za)return a.za();if(ma(a))return a.split("");if(la(a)){for(var b=[],c=a.length,d=0;d<c;d++)b.push(a[d]);return b}return Jc(a)}function Pc(a,b,c){if("function"==typeof a.forEach)a.forEach(b,c);else if(la(a)||ma(a))Cb(a,b,c);else{var d;if("function"==typeof a.Ka)d=a.Ka();else if("function"!=typeof a.za)if(la(a)||ma(a)){d=[];for(var e=a.length,f=0;f<e;f++)d.push(f)}else d=Kc(a);else d=j;for(var e=Oc(a),f=e.length,h=0;h<f;h++)b.call(c,e[h],d&&d[h],a)}};function Qc(a,b){this.Ci=a;this.xh=b}Qc.prototype.getKey=s("Ci");Qc.prototype.w=function(){return new Qc(this.Ci,this.xh)};function Rc(a){this.La=[];if(a)a:{var b,c;if(a instanceof Rc){if(b=a.Ka(),c=a.za(),0>=a.fa()){a=this.La;for(var d=0;d<b.length;d++)a.push(new Qc(b[d],c[d]));break a}}else b=Kc(a),c=Jc(a);for(d=0;d<b.length;d++)Sc(this,b[d],c[d])}}function Sc(a,b,c){var d=a.La;d.push(new Qc(b,c));b=d.length-1;a=a.La;for(c=a[b];0<b;)if(d=b-1>>1,a[d].getKey()>c.getKey())a[b]=a[d],b=d;else break;a[b]=c}t=Rc.prototype;
t.remove=function(){var a=this.La,b=a.length,c=a[0];if(!(0>=b)){if(1==b)Gb(a);else{a[0]=a.pop();for(var a=0,b=this.La,d=b.length,e=b[a];a<d>>1;){var f=2*a+1,h=2*a+2,f=h<d&&b[h].getKey()<b[f].getKey()?h:f;if(b[f].getKey()>e.getKey())break;b[a]=b[f];a=f}b[a]=e}return c.xh}};t.za=function(){for(var a=this.La,b=[],c=a.length,d=0;d<c;d++)b.push(a[d].xh);return b};t.Ka=function(){for(var a=this.La,b=[],c=a.length,d=0;d<c;d++)b.push(a[d].getKey());return b};
t.Cb=function(a){return Fb(this.La,function(b){return b.getKey()==a})};t.w=function(){return new Rc(this)};t.fa=function(){return this.La.length};t.clear=function(){Gb(this.La)};function Tc(){Rc.call(this)}A(Tc,Rc);Tc.prototype.ie=function(a,b){Sc(this,a,b)};function Uc(a,b,c){E.call(this);this.oi=b;this.od=c;this.oe=new Tc;this.vc=r;this.td=p;this.Hf=new Ec}A(Uc,E);Uc.prototype.b=function(){this.vc&&(this.vc=r,v.clearTimeout(this.td),this.td=p);Uc.d.b.call(this)};Uc.prototype.update=aa();Uc.prototype.Ne=function(a,b){var c=fa(b)?b:Number.MAX_VALUE;a.state=1;var d=this.od,e=new O,f=new Vc(e,Wc,a.x,a.y,a.l);f.Nc=a;f.uc=c;d.pa.push(f);d.rc||d.ob();d.yg=m;P(e,aa(),function(){this.oe.ie(c,a);this.vc||(this.vc=m,this.td=v.setTimeout(y(this.cj,this),5))},this)};
Uc.prototype.cj=function(){for(var a=Hc();this.oe.fa();){var b=this.oe.remove(),c=new vc(this.oi.Gi.Qe);this.Hf.ka();this.oi.me(c,b.x,b.y,b.l,this.Hf);b.fill(this.Hf.end());if(16<Hc()-a)break}this.oe.fa()?(this.vc=m,this.td=v.setTimeout(y(this.cj,this),5)):(this.vc=r,this.td=p)};function Xc(){E.call(this)}A(Xc,E);Xc.prototype.update=aa();/*
 Portions of this code are from MochiKit, received by
 The Closure Authors under the MIT license. All other code is Copyright
 2005-2009 The Closure Authors. All Rights Reserved.
*/
function O(a,b){this.Re=[];this.Ri=a;this.Zh=b||p}t=O.prototype;t.Gb=r;t.cd=r;t.Cf=r;t.kk=r;t.fh=r;t.Df=0;t.cancel=function(a){if(this.Gb)this.xd instanceof O&&this.xd.cancel();else{if(this.P){var b=this.P;delete this.P;a?b.cancel(a):(b.Df--,0>=b.Df&&b.cancel())}this.Ri?this.Ri.call(this.Zh,this):this.fh=m;this.Gb||this.a(new Yc(this))}};t.Uh=function(a,b){this.Cf=r;Zc(this,a,b)};function Zc(a,b,c){a.Gb=m;a.xd=c;a.cd=!b;$c(a)}function ad(a){a.Gb&&(a.fh||g(new bd(a)),a.fh=r)}
t.e=function(a){ad(this);Zc(this,m,a)};t.a=function(a){ad(this);Zc(this,r,a)};function P(a,b,c,d){a.Re.push([b,c,d]);a.Gb&&$c(a);return a}function cd(a){return Fb(a.Re,function(a){return na(a[1])})}
function $c(a){a.ph&&(a.Gb&&cd(a))&&(v.clearTimeout(a.ph),delete a.ph);a.P&&(a.P.Df--,delete a.P);for(var b=a.xd,c=r,d=r;a.Re.length&&!a.Cf;){var e=a.Re.shift(),f=e[0],h=e[1],e=e[2];if(f=a.cd?h:f)try{var k=f.call(e||a.Zh,b);fa(k)&&(a.cd=a.cd&&(k==b||k instanceof Error),a.xd=b=k);b instanceof O&&(d=m,a.Cf=m)}catch(i){b=i,a.cd=m,cd(a)||(c=m)}}a.xd=b;d&&(P(b,y(a.Uh,a,m),y(a.Uh,a,r)),b.kk=m);c&&(a.ph=v.setTimeout(function(){g(b)},0))}function dd(a){var b=new O;b.e(a);return b}
function ed(a){var b=new O;b.a(a);return b}function bd(a){ob.call(this);this.la=a}A(bd,ob);bd.prototype.message="Deferred has already fired";bd.prototype.name="AlreadyCalledError";function Yc(a){ob.call(this);this.la=a}A(Yc,ob);Yc.prototype.message="Deferred was cancelled";Yc.prototype.name="CancelledError";function fd(a,b,c,d,e,f){O.call(this,e,f);this.q=a;this.Qf=[];this.ii=!!b;this.Dk=!!c;this.vk=!!d;for(b=0;b<a.length;b++)P(a[b],y(this.ri,this,b,m),y(this.ri,this,b,r));0==a.length&&!this.ii&&this.e(this.Qf)}A(fd,O);fd.prototype.Qi=0;fd.prototype.ri=function(a,b,c){this.Qi++;this.Qf[a]=[b,c];this.Gb||(this.ii&&b?this.e([a,c]):this.Dk&&!b?this.a(c):this.Qi==this.q.length&&this.e(this.Qf));this.vk&&!b&&(c=p);return c};fd.prototype.a=function(a){fd.d.a.call(this,a);Cb(this.q,function(a){a.cancel()})};function gd(a,b){sc.call(this);var c;(c=Dc[a.ni])||(c=Dc.flat);c=new c(a,this.A);this.Gi=a;this.od=b;J(this,this.od);this.tb=new Xc;J(this,this.tb);this.Jf=new Uc(0,c,b);J(this,this.Jf);this.he=[]}A(gd,sc);gd.prototype.update=function(a){gd.d.update.call(this,a);this.tb.update(a);this.Jf.update(a);this.flush();this.od.update(a)};gd.prototype.uf=function(a){this.he.push(a);a.Na||a.map.Ae(a);a.Na++};
gd.prototype.flush=function(){for(var a=[],b=0;b<this.he.length;b++){var c=this.he[b];a.push(hd(this.od,c));c.bc=r;c.Na--;c.Na||c.map.ze(c)}this.he.length=0;return new fd(a)};gd.prototype.Ne=function(a){for(var b=Number.MAX_VALUE,c=0;c<this.Ya.length;c++){var d=this.Ya[c],e=a.x-d.Ha[0],d=a.l-d.Ha[2],e=e*e+d*d;e<b&&(b=e)}b==Number.MAX_VALUE&&(b=j);this.Jf.Ne(a,b)};function id(a){this.factory=a;this.ta=this.$e=0}id.prototype.getTime=s("$e");id.prototype.read=function(a){var b=this.factory.z;b&2&&(this.$e=a.s()/1E3);b&4||(this.ta=a.s())};id.prototype.write=function(a){var b=this.factory.z;b&2&&a.t(1E3*this.$e|0);b&4||a.t(this.ta)};id.prototype.Ob=function(){this.factory.Ob(this)};function jd(a){id.call(this,a);this.jh=0;this.qe=r}A(jd,id);jd.prototype.read=function(a){jd.d.read.call(this,a);this.jh=a.s()/1E3;this.qe=r};
jd.prototype.write=function(a){jd.d.write.call(this,a);a.t(1E3*this.jh|0)};function kd(a){id.call(this,a);this.Hg=0}A(kd,id);kd.prototype.read=function(a){kd.d.read.call(this,a);this.Hg=a.s()};kd.prototype.write=function(a){kd.d.write.call(this,a);a.t(this.Hg)};function ld(a,b,c,d){E.call(this);this.Y=a;this.factory=b;this.ha=p;this.D=c;this.Ja=d;this.P=p;this.J=[];this.T=0;this.g=md(b,this);this.zd=[]}A(ld,E);t=ld.prototype;t.b=function(){var a=this.getParent();a&&(Hb(a.J,this),a.$b(this));this.factory.Xe.push(this.g);for(a=0;a<this.zd.length;a++)this.factory.Xe.push(this.zd[a]);ld.d.b.call(this)};
function nd(a,b){for(var c="",d=0;d<b;d++)c+="..";M(c+"Entity "+a.D+" / type "+a.factory.Ga+(a.ha?" / owner "+a.ha.c:""));if(a.J.length)for(d=0;d<a.J.length;d++)nd(a.J[d],b+1)}t.ga=s("Y");t.getParent=s("P");function od(a,b){if(a.P!=b){var c=a.P;a.P=b;if(!(a.Ja&pd)){var d=a.Of(0);d.Hg=b?b.D:0;qd(a.Y,d)}a.Fg(c,b);c&&(Hb(c.J,a),c.$b(a));b&&b.tf(a)}}t.tf=function(a){this.J.push(a);this.Zd(a)};t.Fg=x;t.Zd=x;t.$b=x;t.jg=ca(p);t.read=function(a){this.g.read(a)};t.Sg=function(a){this.g.Sg(a)};t.write=function(a){this.g.write(a)};
t.zh=function(a){this.g.zh(a)};function rd(a,b){if(a.Ja&sd){1==a.zd.length&&(a.zd[0].time=b);var c=md(a.factory,a);c.time=b;a.g.Nf(c);a.zd.push(c)}}t.xi=x;t.Of=function(a){a=td(this.Y.Sa[a]||p);a.ta=this.D;return a};t.ma=aa();function ud(a,b,c){a.Xf||vd(a.Y.tb,b,c===j?0:c,a.update,a)}t.Mg=aa();t.Sl=x;t.wd=function(){this.T=0;this.g.wd()};var pd=1,sd=8;function wd(){this.Ic=[];this.f=0}wd.prototype.compact=aa();wd.prototype.fa=s("f");wd.prototype.yb=function(a){this.Ic[this.f++]=a};function xd(a){for(var b=0;b<a.f;b++){var c=a.Ic[b];c.factory.Ob(c)}a.f=0};function yd(){this.buffer=new Uint8Array(512);this.offset=0;this.U=new Float32Array(16);this.ea=new Uint8Array(this.U.buffer);this.Gk=(this.Yc=v.Float64Array?new Float64Array(1):p)?new Uint8Array(this.Yc.buffer):p}t=yd.prototype;t.hb=function(){this.offset=0};t.finish=function(){for(var a=new Uint8Array(this.offset),b=0;b<this.offset;b++)a[b]=this.buffer[b];this.offset=0;return a.buffer};
function zd(a,b){if(a.offset+b>a.buffer.length){var c=a.offset+b,d=a.buffer.length;do d+=1024;while(d<c);c=new Uint8Array(d);for(d=0;d<a.offset;d++)c[d]=a.buffer[d];a.buffer=c}}function Ad(a,b){zd(a,2);a.buffer[a.offset++]=b>>8;a.buffer[a.offset++]=b}function Bd(a,b){zd(a,4);a.buffer[a.offset++]=b>>24;a.buffer[a.offset++]=b>>16;a.buffer[a.offset++]=b>>8;a.buffer[a.offset++]=b}function Q(a,b){zd(a,1);a.buffer[a.offset++]=b}function Cd(a,b){zd(a,2);a.buffer[a.offset++]=b>>8;a.buffer[a.offset++]=b}
t.M=function(a){zd(this,4);this.buffer[this.offset++]=a>>24;this.buffer[this.offset++]=a>>16;this.buffer[this.offset++]=a>>8;this.buffer[this.offset++]=a};t.t=function(a){zd(this,5);for(a&=4294967295;a&4294967168;)this.buffer[this.offset++]=a&127|128,a>>>=7;this.buffer[this.offset++]=a&127};t.of=function(a){this.t(a<<1^a>>31)};
t.Uj=function(a){zd(this,4);this.U[0]=a;this.buffer[this.offset++]=this.ea[0];this.buffer[this.offset++]=this.ea[1];this.buffer[this.offset++]=this.ea[2];this.buffer[this.offset++]=this.ea[3]};t.Em=function(a){zd(this,12);this.U[0]=a[0];this.U[1]=a[1];this.U[2]=a[2];for(a=0;12>a;a++)this.buffer[this.offset++]=this.ea[a]};t.Fm=function(a){zd(this,16);this.U[0]=a[0];this.U[1]=a[1];this.U[2]=a[2];this.U[3]=a[3];for(a=0;16>a;a++)this.buffer[this.offset++]=this.ea[a]};
t.o=function(a){65535<=a.length&&(a=a.substr(0,65535));zd(this,4+3*a.length);Cd(this,a.length);var b=this.offset;this.offset+=2;for(var c=0,d=0;d<a.length;d++){var e=a.charCodeAt(d);128>e?(this.buffer[this.offset++]=e,c++):2048>e?(this.buffer[this.offset++]=e>>6|192,this.buffer[this.offset++]=e&63|128,c+=2):(this.buffer[this.offset++]=e>>12|224,this.buffer[this.offset++]=e>>6&63|128,this.buffer[this.offset++]=e&63|128,c+=3)}a=this.offset;this.offset=b;Cd(this,c);this.offset=a};var Dd=p;
function R(){Dd||(Dd=new yd);return Dd};function Ed(){this.Mh=this.Td=this.yn=this.Xm=this.Ii=this.Ji=this.Od=0}Ed.prototype.w=function(){return new Ed};Ed.prototype.toString=ca("[stats]");var Fd,Gd,Hd,Id,Jd;function Kd(){return v.navigator?v.navigator.userAgent:p}Id=Hd=Gd=Fd=r;var Ld;if(Ld=Kd()){var Md=v.navigator;Fd=0==Ld.indexOf("Opera");Gd=!Fd&&-1!=Ld.indexOf("MSIE");Hd=!Fd&&-1!=Ld.indexOf("WebKit");Id=!Fd&&!Hd&&"Gecko"==Md.product}var Pd=Fd,Qd=Gd,Rd=Id,Sd=Hd,Td,Ud=v.navigator;Td=Ud&&Ud.platform||"";Jd=-1!=Td.indexOf("Mac");var Vd=-1!=Td.indexOf("Win");function Wd(){var a=v.document;return a?a.documentMode:j}var Xd;
a:{var Yd="",Zd;if(Pd&&v.opera)var $d=v.opera.version,Yd="function"==typeof $d?$d():$d;else if(Rd?Zd=/rv\:([^\);]+)(\)|;)/:Qd?Zd=/MSIE\s+([^\);]+)(\)|;)/:Sd&&(Zd=/WebKit\/(\S+)/),Zd)var ae=Zd.exec(Kd()),Yd=ae?ae[1]:"";if(Qd){var be=Wd();if(be>parseFloat(Yd)){Xd=String(be);break a}}Xd=Yd}var ce={};
function de(a){var b;if(!(b=ce[a])){b=0;for(var c=qb(String(Xd)).split("."),d=qb(String(a)).split("."),e=Math.max(c.length,d.length),f=0;0==b&&f<e;f++){var h=c[f]||"",k=d[f]||"",i=RegExp("(\\d*)(\\D*)","g"),l=RegExp("(\\d*)(\\D*)","g");do{var n=i.exec(h)||["","",""],q=l.exec(k)||["","",""];if(0==n[0].length&&0==q[0].length)break;b=((0==n[1].length?0:parseInt(n[1],10))<(0==q[1].length?0:parseInt(q[1],10))?-1:(0==n[1].length?0:parseInt(n[1],10))>(0==q[1].length?0:parseInt(q[1],10))?1:0)||((0==n[2].length)<
(0==q[2].length)?-1:(0==n[2].length)>(0==q[2].length)?1:0)||(n[2]<q[2]?-1:n[2]>q[2]?1:0)}while(0==b)}b=ce[a]=0<=b}return b}var ee=v.document,fe=!ee||!Qd?j:Wd()||("CSS1Compat"==ee.compatMode?parseInt(Xd,10):5);(function(){var a;return Vd?(a=/Windows NT ([0-9.]+)/,(a=a.exec(Kd()))?a[1]:"0"):Jd?(a=/10[_.][0-9_.]+/,(a=a.exec(Kd()))?a[0].replace(/_/g,"."):"10"):""})();function ge(){this.Sj="";this.type=he;this.platform=ie;this.rd="";this.Tc=je}ge.prototype.w=function(){var a=new ge;a.Sj=this.Sj;a.type=this.type;a.platform=this.platform;a.rd=this.rd;a.Tc=this.Tc;return a};ge.prototype.toString=function(){return[this.type,this.platform+this.rd,this.Tc].join("/")};var he="unknown",ie="other",je="desktop";function ke(){this.Md="none";this.Ld="0";this.ya="User"}ke.prototype.w=function(){var a=new ke;a.Md=this.Md;a.Ld=this.Ld;a.ya=this.ya;return a};ke.prototype.toString=ca("[user]");function le(a,b,c,d,e){this.c=a||"";this.R=b||0;this.z=c||0;this.info=d||new ke;this.Jd=e||new ge;this.Tf=0;this.i=new Ed;this.data=this.ja=p}le.prototype.toString=function(){return this.info.ya+" ("+this.c+"/"+this.R+")"};function me(a){return new le(a.c,a.R,a.z,a.info.w(),a.Jd.w())};function ne(a){this.sa=a;this.eb=0;this.ae=[];this.Bb=0;this.de=[];this.Db=0;this.bf=[];this.Xb=0;this.fe=[];this.Eb=0}ne.prototype.ka=ba("eb");ne.prototype.yb=function(a){this.ae[this.Bb++]=a};
ne.prototype.finish=function(a){var b=R();Q(b,30);var c=0;b.t(1E3*a|0);b.t(this.eb);b.t(this.Db);b.t(this.Xb);b.t(this.Eb);b.t(this.Bb);for(a=0;a<this.Db;a++){var d=this.de[a];this.de[a]=p;c=b.offset;b.t(d.D>>1);b.t(d.factory.Ga);b.t(d.Ja);var e=d.ha;b.t(e?e.R:0);e=d.getParent();b.t(e?e.D:0);d.write(b);this.sa.je++;this.sa.cc+=b.offset-c}for(a=this.Db=0;a<this.Xb;a++)d=this.bf[a],this.bf[a]=p,c=b.offset,b.t(d.D>>1),d.zh(b),this.sa.le++,this.sa.ec+=b.offset-c;for(a=this.Xb=0;a<this.Eb;a++)d=this.fe[a],
this.fe[a]=p,c=b.offset,b.t(d.D>>1),this.sa.ke++,this.sa.dc+=b.offset-c;for(a=this.Eb=0;a<this.Bb;a++)d=this.ae[a],this.ae[a]=p,c=b.offset,b.t(d.factory.Ga),d.write(b),this.sa.Ce++,this.sa.pc+=b.offset-c;this.Bb=0;return b.finish()};ne.prototype.hb=function(){for(var a=this.eb=0;a<this.Db;a++)this.de[a]=p;for(a=this.Db=0;a<this.Xb;a++)this.bf[a]=p;for(a=this.Xb=0;a<this.Eb;a++)this.fe[a]=p;for(a=this.Eb=0;a<this.Bb;a++)this.ae[a]=p;this.Bb=0};function oe(a,b,c){E.call(this);this.Pa=a;this.X=b;this.Gc=c;this.eb=this.Ei=0;this.Aa=new wd;this.Ba=new wd;this.mh={};this.df={};this.cf=[];this.xl=0;this.S=new ne(a.i)}A(oe,E);oe.prototype.kb=s("Gc");oe.prototype.compact=function(){this.Aa.compact();this.Ba.compact()};function pe(a,b){var c=b.Ja;if(!(c&pd)&&!(c&64&&b.ha!=a.Gc)){var c=b.D,d=0;a.mh[c]||(d|=1,a.mh[c]=m);var e=a.df[c]|0,d=e|d|b.T;e||a.cf.push(b);e!=d&&(a.df[c]=d)}}
oe.prototype.flush=function(a){this.xl=a;var b=this.S;b.ka(this.eb);var c=this.eb!=this.Ei;this.Ei=this.eb;var d=this.Ba.Ic,e=this.Ba.fa();if(e){for(var f=0;f<e;f++){var h=d[f];(0==h.ta||this.mh[h.ta])&&b.yb(h)}this.Ba.f=0}for(f=0;f<this.cf.length;f++)d=this.cf[f],e=d.D,h=this.df[e],delete this.df[e],h&&5!=(h&5)&&(h&4?b.fe[b.Eb++]=d:h&1?b.de[b.Db++]=d:h&2&&(b.bf[b.Xb++]=d));c||0<b.Bb+b.Db+b.Xb+b.Eb?this.X.send(b.finish(a),this.Gc):b.hb();this.cf.length=0};function qe(a,b,c){oe.call(this,a,b,c)}A(qe,oe);var re=new function(){this.l=this.y=this.x=0};function se(){var a=R();Q(a,74);return a.finish()};function te(a){E.call(this);this.nj=a}A(te,E);function ue(a){E.call(this);this.cm=a;this.Wg=[[],[],[],[],[]];this.Qj=[]}A(ue,E);function vd(a,b,c,d,e){var f=a.Qj.pop()||new ve;f.uc=b;f.Vg=a.cm.G.Ib;f.Ze=-1==c?0:0==c?f.Vg+0.001:c;f.e=d;f.Ff=e||v;a=a.Wg[b];b=0;for(c=a.length;b<c;)d=b+c>>1,0<f.Ze-a[d].Ze?b=d+1:c=d;a.splice(b,0,f)}var we=Number.MAX_VALUE;
ue.prototype.update=function(a){a=a.time;for(var b=Hc(),c=this.Wg.length-1;0<=c;c--){for(var d=this.Wg[c];d.length;){var e=d[0];if(e.Ze>a)break;d.shift();var f=a-e.Vg,h=e.e,k=e.Ff;e.e=e.Ff=p;this.Qj.push(e);h.call(k,a,f)}if(Hc()-b>=we)break}};function ve(){this.uc=xe;this.Ze=this.Vg=0;this.Ff=this.e=p}var xe=0;function ye(){this.md=this.Ma=this.ue=this.Nl=this.ql=this.pc=this.Ce=this.kc=this.fd=this.dc=this.ke=this.ec=this.le=this.cc=this.je=0}ye.prototype.update=function(a){this.Ma+=this.cc;this.Ma+=this.ec;this.Ma+=this.dc;this.ue+=this.kc;this.Ma+=this.pc;1<=a-this.md&&(this.md=a,this.ql=this.ue,this.Nl=this.Ma,this.Ma=this.ue=0);this.Ce=this.pc=this.fd=this.kc=this.ke=this.dc=this.le=this.ec=this.je=this.cc=0};function ze(a,b,c){this.Ga=a;this.sk=b;this.z=c;this.qh=[]}function td(a){return a.qh.length?(a=a.qh.pop(),a.ta=0,a):new a.sk(a)}ze.prototype.Ob=function(a){this.qh.push(a)};function Ae(a){Ae[" "](a);return a}Ae[" "]=x;function Be(a,b){te.call(this,a);this.i=new ye;this.tb=new ue(a);J(this,this.tb);this.kf=[];this.Sa={};this.Zf={};this.Ag=b;this.v={};this.Ac=p;this.xa=Array(256);this.wa=0;var c=new ze(0,kd,0);this.Sa[c.Ga]=c}A(Be,te);function Ce(a,b){a.Zf[b.Ga]=b}function De(a){var b=a.Ag;a.Ag+=2;return b}t=Be.prototype;t.va=function(a,b){var c=this.Zf[a].va(this,De(this),b);this.Zb(c);return c};t.Zb=function(a){this.v[a.D]=a;var b=!!a.T;a.T|=1;b||(this.xa[this.wa++]=a);a.Ja&128&&(this.Ac=a)};
t.ji=function(a,b){for(var c in this.v)a.call(b||v,this.v[Number(c)])};t.qb=function(a,b){if(!(a.T&4)){switch(b||Ee){default:case Ee:for(var c=a.J.length-1;0<=c;c--){var d=a.J[c];a.$b(d);a.Y.qb(d)}if(d=a.jg())for(c=0;c<d.length;c++)a.Y.qb(d[c]);break;case Fe:for(c=0;c<a.J.length;c++)od(a.J[c],p);if(d=a.jg())for(c=0;c<d.length;c++)od(d[c],p);case Ge:}delete this.v[a.D];c=!!a.T;a.T|=4;c||(this.xa[this.wa++]=a);K(a)}};t.Of=function(a){a=td(this.Sa[a]||p);a.ta=0;return a};
t.Xc=function(a,b){for(var c=0;c<b;c++){var d=a[c],e=d.ta;0==e?this.ma(d):(e=this.v[e]||p)&&e.ma(d);d instanceof jd&&(d.qe=m)}};t.ma=x;t.Zi=function(){for(var a=0;a<this.wa;a++){var b=this.xa[a];b.Mg()}for(a=0;a<this.wa;a++){b=this.xa[a];this.xa[a]=p;if(b.T&1)for(var c=0;c<this.kf.length;c++)this.kf[c].$m(b);if(b.T&4)for(c=0;c<this.kf.length;c++)this.kf[c].an(b);b.wd()}this.wa=0};t.Og=function(a){for(var b=0;b<this.wa;b++){var c=this.xa[b];c.Sl(a);this.$i(a,c)}};t.$i=x;
t.tc=function(){for(var a=0;a<this.wa;a++){var b=this.xa[a];this.xa[a]=p;b.wd()}this.wa=0};var Ee=0,Fe=1,Ge=2,Be=Aa(Be,"gf.sim.Simulator",{ji:"forEachEntity",Xc:"executeCommands",Zi:"postNetworkUpdateEntities",Og:"postTickUpdateEntities",tc:"postUpdate"});function He(){this.Pi=1;this.oh=[];this.Vb=0;this.Cg=[];this.qc=0;this.Vi=[];this.Dg=0}He.prototype.compact=aa();He.prototype.yb=function(a){this.Cg[this.qc++]=a;a instanceof jd&&(a.pj=this.Pi++,a.qe=r,this.Vi[this.Dg++]=a)};
He.prototype.write=function(a){a.t(this.Pi-1);var b=this.qc;a.t(this.qc);for(var c=0;c<this.qc;c++){var d=this.Cg[c];this.Cg[c]=p;a.t(d.factory.Ga);d.write(a);d instanceof jd?this.oh[this.Vb++]=d:d.factory.Ob(d)}this.Dg=this.qc=0;1500<this.Vb&&M("massive backup of commands, dying");return b};function S(a,b){Be.call(this,a,1);this.X=b;Ie(b.Mb,30,this.ti,this);this.ve=[];this.Aa=new wd;this.Ba=new He;this.ld=0}A(S,Be);S.prototype.b=function(){S.d.b.call(this)};S.prototype.kb=function(a){return this.X.Yb[a]||p};S.prototype.Zb=function(a){S.d.Zb.call(this,a);a.Ja&(4|sd)&&this.ve.push(a)};S.prototype.qb=function(a,b){S.d.qb.call(this,a,b);a.Ja&(4|sd)&&Hb(this.ve,a)};S.Yj=20;
S.prototype.update=function(a){var b=Je(this.nj.G)+this.nj.G.$d;this.yi(b-0.5);this.Xc(this.Aa.Ic,this.Aa.fa());xd(this.Aa);this.tb.update(a);this.Og(a);this.oj(a);this.tc(a);this.Pc(a)};S.prototype.yi=function(a){for(var b=0;b<this.ve.length;b++)this.ve[b].xi(a);a=this.Ba;this.Xc(a.oh,a.Vb);this.Xc(a.Vi,a.Dg)};S.prototype.oj=function(a){if(this.Ba.qc&&a.time-this.ld>=1/S.Yj){this.ld=a.time;a=R();Q(a,31);var b=this.Ba.write(a);this.i.Ce+=b;this.i.pc+=a.offset;this.X.send(a.finish())}};S.rf=15;
S.prototype.Pc=function(a){a.time-this.tg<S.rf||(this.tg=a.time,this.Aa.compact(),this.Ba.compact())};
S.prototype.ti=function(a,b,c){b=c.s()/1E3;var d=c.s(),e=c.s(),f=c.s(),h=c.s();a=c.s();this.i.je+=e;this.i.le+=f;this.i.ke+=h;this.i.fd+=a;var k=this.Ba,i=k.oh,l=k.Vb;if(l)if(i[l-1].pj<=d){for(var n=0;n<l;n++){var q=i[n];q.factory.Ob(q)}k.Vb=0}else{for(var u=l,n=0;n<l;n++){q=i[n];if(q.pj>d){u=n;break}q.factory.Ob(q)}i.splice(0,u);k.Vb-=u}for(d=0;d<this.wa;d++)k=this.xa[d],this.xa[d]=p,k.wd();this.wa=0;i=p;for(d=k=0;d<e;d++){var k=c.offset,n=c.s()<<1,w=c.s(),q=c.s(),u=c.s(),l=c.s(),w=this.Zf[w]||p;
if(!w)return r;(u=u?this.X.wh[u]||p:p)&&(u!=this.X.dn()&&q&4)&&(q&=-5);n=w.va(this,n,q);n.ha=u;n.read(c);this.i.cc+=c.offset-k;rd(n,b);this.Zb(n);l&&(i||(i=[]),i.push([n,l]))}for(d=0;d<f;d++){k=c.offset;n=c.s()<<1;n=this.v[n]||p;if(!n)return r;n.Sg(c);this.i.ec+=c.offset-k;rd(n,b)}for(d=0;d<h;d++){k=c.offset;n=c.s()<<1;this.i.dc+=c.offset-k;n=this.v[n]||p;if(!n)return r;this.qb(n,Ge)}if(i)for(d=0;d<i.length;d++){n=i[d][0];b=this.v[i[d][1]]||p;if(!b)return r;od(n,b)}this.Zi();for(d=0;d<a;d++){k=c.offset;
b=c.s();b=this.Sa[b]||p;if(!b)return r;b=td(b);b.read(c);this.i.kc+=c.offset-k;this.Aa.yb(b)}return m};S=Aa(S,"gf.sim.ClientSimulator",{update:"update",yi:"interpolateEntities",oj:"sendPendingCommands_",Pc:"compact_",ti:"handleSyncSimulation_"});function Ke(a,b,c){Be.call(this,a,2);this.X=b;this.X.W.push(this);Ie(this.X.Mb,31,this.si,this);this.Kl=c;this.n=[];this.Dd={};this.Kf=new wd}A(Ke,Be);t=Ke.prototype;t.b=function(){nb(this.n);Ke.d.b.call(this)};t.kb=function(a){return this.X.Yb[a]||p};t.vf=function(a){this.n.push(a);var b=a.kb();b&&(this.Dd[b.c]=a);this.ji(function(b){pe(a,b)},this)};t.ij=function(a){var b=a.kb();b&&delete this.Dd[b.c];Hb(this.n,a);K(a)};
t.update=function(a){for(var b=0;b<this.n.length;b++){var c=this.n[b];c.Pa.Xc(c.Aa.Ic,c.Aa.fa());xd(c.Aa)}this.tb.update(a);this.Og(a);this.tc(a);this.Pc(a)};t.ma=aa();function qd(a,b,c){for(var d=0;d<a.n.length;d++){var e=a.n[d];if(!(c&&e.kb()==c))a:{if(0!=b.ta){var f=e.Pa.v[b.ta]||p;if(f.Ja&64&&f.ha!=e.Gc)break a}e.Ba.yb(b)}}a.Kf.yb(b)}t.$i=function(a,b){if(!(b.Ja&pd))for(var c=0;c<this.n.length;c++)pe(this.n[c],b)};
t.tc=function(a){for(var b=0;b<this.n.length;b++)this.n[b].flush(a.time);xd(this.Kf);Ke.d.tc.call(this,a)};Ke.rf=15;t=Ke.prototype;t.Pc=function(a){if(!(a.time-this.tg<Ke.rf)){this.tg=a.time;this.Kf.compact();for(a=0;a<this.n.length;a++)this.n[a].compact()}};t.fb=x;t.Uf=x;t.th=function(a){var b=this.Dd[a.c]||p;b||(b=new this.Kl(this,this.X,a),this.vf(b))};t.uh=function(a){(a=this.Dd[a.c]||p)&&this.ij(a)};t.vh=x;
t.si=function(a,b,c){if(!a.I)return r;b=this.Dd[a.I.c]||p;if(!b)return r;var d=c.s(),e=c.s();this.i.fd+=e;this.i.kc+=a.data.byteLength;for(var f=0;f<e;f++){var h=c.s(),h=this.Sa[h]||p;if(!h)return r;h=td(h);h.read(c);var k=0==h.ta;k||(k=this.v[h.ta]||p,k=!k||k.ha!=a.I);if(k)return h.Ob(),r;b.Aa.yb(h)}b.eb=d;return m};Ke=Aa(Ke,"gf.sim.ServerSimulator",{update:"update",tc:"postUpdate",Pc:"compact_",si:"handleExecCommands_"});function Le(a){return Me(a.Y.Ac.g)};function Ne(a,b,c,d){ld.call(this,a,b,c,d);this.mi=p}A(Ne,ld);function Oe(a){jd.call(this,a);this.$l=this.Jg=this.Ah=this.Yg=this.Xg=this.xb=this.nh=0}A(Oe,jd);var Pe=360*(1/32767)*Math.PI/180;Oe.prototype.read=function(a){Oe.d.read.call(this,a);this.nh=Qe(a);this.xb=Qe(a);this.xb&1&&(this.Xg=Re(a),this.Yg=Re(a));this.Ah=Se(a);this.Jg=Se(a)};Oe.prototype.write=function(a){Oe.d.write.call(this,a);Q(a,this.nh);Q(a,this.xb);this.xb&1&&(Cd(a,this.Xg),Cd(a,this.Yg));Ad(a,this.Ah);Ad(a,this.Jg)};function Te(a){id.call(this,a);this.yf=0}A(Te,id);Te.prototype.read=function(a){Te.d.read.call(this,a);this.yf=a.gj()};Te.prototype.write=function(a){Te.d.write.call(this,a);a.Uj(this.yf)};function Ue(a){id.call(this,a);this.data=this.l=this.y=this.x=0}A(Ue,id);Ue.prototype.read=function(a){Ue.d.read.call(this,a);this.x=a.Ie();this.y=a.Ie();this.l=a.Ie();this.data=Re(a)};Ue.prototype.write=function(a){Ue.d.write.call(this,a);a.of(this.x);a.of(this.y);a.of(this.l);Cd(a,this.data)};function Ve(a){jd.call(this,a);this.lh=0}A(Ve,jd);Ve.prototype.read=function(a){Ve.d.read.call(this,a);this.lh=a.ia()};Ve.prototype.write=function(a){Ve.d.write.call(this,a);a.M(this.lh)};function We(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],h=2*c,k=2*d,i=2*e,l=h*f,n=k*f,f=i*f,h=h*c,q=k*c,c=i*c,k=k*d,d=i*d,e=i*e;b[0]=1-(k+e);b[1]=q+f;b[2]=c-n;b[3]=0;b[4]=q-f;b[5]=1-(h+e);b[6]=d+l;b[7]=0;b[8]=c+n;b[9]=d-l;b[10]=1-(h+k);b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1}
function Xe(a,b,c,d){var e=a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3];if(1<e||-1>e)return cb(d,b),d;var f=1;0>e&&(f=-1,e=-e);var h=Math.acos(e);if(1E-6>=h)return cb(d,b),d;var k=1/Math.sin(h),e=Math.sin((1-c)*h)*k;c=f*Math.sin(c*h)*k;d[0]=a[0]*e+b[0]*c;d[1]=a[1]*e+b[1]*c;d[2]=a[2]*e+b[2]*c;d[3]=a[3]*e+b[3]*c;return d};function Ye(a,b,c,d){ld.call(this,a,b,c,d);this.wb=m;this.Kc=D();this.sm=new Float32Array(16);this.g.Bj(Ha(1,1,1))}A(Ye,ld);Ye.prototype.Mg=function(){Ye.d.Mg.call(this);this.wb=m};
function Ze(a,b){if(a.wb&&a.wb){a.wb=r;var c=a.g,d=c.bd(),e=c.Oa,f=c.Pe;a.Kc[0]=d[0];a.Kc[1]=d[1];a.Kc[2]=d[2];a.Kc[3]=c.Qd*Math.max(f[0],Math.max(f[1],f[2]));c=a.sm;We(e,c);var e=f[0],h=f[1],f=f[2],k=c[1],i=c[2],l=c[3],n=c[4],q=c[5],u=c[6],w=c[7],F=c[8],H=c[9],G=c[10],I=c[11],N=c[12],ga=c[13],Z=c[14],pa=c[15];c[0]*=e;c[1]=k*e;c[2]=i*e;c[3]=l*e;c[4]=n*h;c[5]=q*h;c[6]=u*h;c[7]=w*h;c[8]=F*f;c[9]=H*f;c[10]=G*f;c[11]=I*f;c[12]=N;c[13]=ga;c[14]=Z;c[15]=pa;e=d[0];h=d[1];d=d[2];f=c[1];k=c[2];i=c[3];l=c[4];
n=c[5];q=c[6];u=c[7];w=c[8];F=c[9];H=c[10];G=c[11];I=c[12];N=c[13];ga=c[14];Z=c[15];c[0]+=e*i;c[1]=f+h*i;c[2]=k+d*i;c[3]=i;c[4]=l+e*u;c[5]=n+h*u;c[6]=q+d*u;c[7]=u;c[8]=w+e*G;c[9]=F+h*G;c[10]=H+d*G;c[11]=G;c[12]=I+e*Z;c[13]=N+h*Z;c[14]=ga+d*Z;c[15]=Z;a.getParent()}cb(b,a.Kc)}
Ye.prototype.Vd=function(a){var b=this.g,c=a.jf,d=b.bd();We(b.Oa,c);if(c==c){var b=c[1],e=c[2],f=c[3],h=c[6],k=c[7],i=c[11];c[1]=c[4];c[2]=c[8];c[3]=c[12];c[4]=b;c[6]=c[9];c[7]=c[13];c[8]=e;c[9]=h;c[11]=c[14];c[12]=f;c[13]=k;c[14]=i}else c[0]=c[0],c[1]=c[4],c[2]=c[8],c[3]=c[12],c[4]=c[1],c[5]=c[5],c[6]=c[9],c[7]=c[13],c[8]=c[2],c[9]=c[6],c[10]=c[10],c[11]=c[14],c[12]=c[3],c[13]=c[7],c[14]=c[11],c[15]=c[15];b=-d[0];e=-d[1];d=-d[2];f=c[1]*b+c[5]*e+c[9]*d+c[13];h=c[2]*b+c[6]*e+c[10]*d+c[14];k=c[3]*b+
c[7]*e+c[11]*d+c[15];c[12]=c[0]*b+c[4]*e+c[8]*d+c[12];c[13]=f;c[14]=h;c[15]=k;a.De&&(a.De=r,c=2/a.width,d=2/-a.height,fb(a.Ml,c,d,1,0,-1,1,0,1),c=a.$a===j?a.width/a.height:a.$a,d=a.Hl,b=a.eg,f=Math.PI/4/2,e=b-d,h=Math.sin(f),0==e||(0==h||0==c)||(f=Math.cos(f)/h,fb(a.Qg,f/c,f,-(b+d)/e,-1,0,0,-(2*d*b)/e,0)),gb(a.Qg,a.jf,a.Fd),hb(a.Fd,a.mc));gb(a.Qg,a.jf,a.Fd);hb(a.jf,a.Ai);hb(a.Fd,a.mc);d=a.Fd;c=a.li;bb(c[0],d[3]+d[0],d[7]+d[4],d[11]+d[8],d[15]+d[12]);bb(c[1],d[3]-d[0],d[7]-d[4],d[11]-d[8],d[15]-d[12]);
bb(c[2],d[3]-d[1],d[7]-d[5],d[11]-d[9],d[15]-d[13]);bb(c[3],d[3]+d[1],d[7]+d[5],d[11]+d[9],d[15]+d[13]);bb(c[4],d[3]+d[2],d[7]+d[6],d[11]+d[10],d[15]+d[14]);bb(c[5],d[3]-d[2],d[7]-d[6],d[11]-d[10],d[15]-d[14]);for(d=0;d<c.length;d++)b=c[d],e=1/Math.sqrt(b[0]*b[0]+b[1]*b[1]+b[2]*b[2]),b[0]*=e,b[1]*=e,b[2]*=e,b[3]*=e;C(a.position,0,0,0);c=a.Ai;d=f=a.position;b=f[0];e=f[1];f=f[2];d[0]=b*c[0]+e*c[4]+f*c[8]+c[12];d[1]=b*c[1]+e*c[5]+f*c[9]+c[13];d[2]=b*c[2]+e*c[6]+f*c[10]+c[14];c=2*(0.5/a.width)-1;d=1-
2*(0.5/a.height);b=$e[0];e=$e[1];C(b,c,d,-1);C(e,c,d,1);ib(a.mc,b,b);ib(a.mc,e,e);Va(b,e,a.direction);a=c=a.direction;a[0]=-c[0];a[1]=-c[1];a[2]=-c[2]};function af(a,b,c,d){Ye.call(this,a,b,c,d);this.mb=p;this.Je=r}A(af,Ye);af.prototype.b=function(){K(this.mb);this.mb=p;af.d.b.call(this)};af.prototype.Xl=function(){var a=this.g.ad();if(this.Je){this.mb&&(K(this.mb),this.mb=p);if(a){a:{var b=this.Y.Ac.mi.Li,c=b.pd[a];if(!c){c=b.Mi[a];c=!c?p:c.xk(b.Jc);if(!c){a=p;break a}b.pd[a]=c}a=c.ee()}this.mb=a}this.Je=r}};af.prototype.ad=function(){return this.g.ad()};
af.prototype.Ve=function(a){this.g.Ve(a);a=this.g.ad();a=a.length?a:p;if(a!=(this.mb?this.mb.Ki.id:p)&&!this.Je)this.Je=m,vd(this.Y.tb,xe,0,this.Xl,this)};function bf(a,b,c,d){af.call(this,a,b,c,d)}A(bf,af);function cf(){this.buffer=new Uint8Array(0);this.offset=0;this.U=new Float32Array(16);this.ea=new Uint8Array(this.U.buffer);this.Gk=(this.Yc=v.Float64Array?new Float64Array(1):p)?new Uint8Array(this.Yc.buffer):p}t=cf.prototype;t.ka=function(a,b){this.buffer=a instanceof Uint8Array?a:new Uint8Array(a);this.offset=b};function Se(a){var b=a.buffer[a.offset++];a=a.buffer[a.offset++];b=b<<8|a;return 32767<b?b-65536:b}
function df(a){var b=a.buffer[a.offset++],c=a.buffer[a.offset++],d=a.buffer[a.offset++];a=a.buffer[a.offset++];b=b<<24|c<<16|d<<8|a;return 2147483647<b?b-4294967296:b}function Qe(a){return a.buffer[a.offset++]}function Re(a){var b=a.buffer[a.offset++];a=a.buffer[a.offset++];return b<<8|a}t.ia=function(){var a=this.buffer[this.offset++],b=this.buffer[this.offset++],c=this.buffer[this.offset++],d=this.buffer[this.offset++];return a<<24|b<<16|c<<8|d};
t.s=function(){for(var a=0,b=0,c;(c=this.buffer[this.offset++]&255)&128;)a|=(c&127)<<b,b+=7;return a|c<<b};t.Ie=function(){var a=this.s();return(a<<31>>31^a)>>1^a&-2147483648};t.gj=function(){this.ea[0]=this.buffer[this.offset++];this.ea[1]=this.buffer[this.offset++];this.ea[2]=this.buffer[this.offset++];this.ea[3]=this.buffer[this.offset++];return this.U[0]};t.Vl=function(){for(var a=0;12>a;a++)this.ea[a]=this.buffer[this.offset++];return this.U};
t.Wl=function(){for(var a=0;16>a;a++)this.ea[a]=this.buffer[this.offset++];return this.U};t.H=function(){var a=Re(this);Re(this);for(var b=Array(a),c=0;c<a;){var d=this.buffer[this.offset++];if(128>d)b[c++]=String.fromCharCode(d);else if(191<d&&224>d){var e=this.buffer[this.offset++];b[c++]=String.fromCharCode((d&31)<<6|e&63)}else{var e=this.buffer[this.offset++],f=this.buffer[this.offset++];b[c++]=String.fromCharCode((d&15)<<12|(e&63)<<6|f&63)}}return b.join("")};var ef=p;
function ff(){ef||(ef=new cf);return ef};function gf(a,b,c){var d=a>>24&255,e=a>>16&255,f=a>>8&255;a&=255;return(d+c*((b>>24&255)-d)&255)<<24|(e+c*((b>>16&255)-e)&255)<<16|(f+c*((b>>8&255)-f)&255)<<8|a+c*((b&255)-a)&255};function T(a,b){this.Xa=a;this.qd=0;this.z=b}T.prototype.pi=function(a){var b=U(a,this.j);return"target."+U(a,this.k)+"(source."+b+"());"};T.prototype.hc=function(a){var b=U(a,this.j);return"result."+U(a,this.k)+"(target."+b+"());"};var V=0;function hf(a,b){return(b.z&jf)-(a.z&jf)||a.qd-b.qd}function U(a,b){for(var c in a)if(a[c]===b)return c;return p}var jf=1;function kf(a,b,c,d){T.call(this,a,b);this.j=c;this.k=d}A(kf,T);t=kf.prototype;t.w=function(){return new kf(this.Xa,this.z,this.j,this.k)};
t.Va=function(a){a=U(a,this.k);var b=ff(),b=U(b,b.Ie);return"target."+a+"(reader."+b+"());"};t.Wa=function(a){a=U(a,this.j);var b=R();return"writer."+U(b,b.of)+"(target."+a+"() | 0);"};t.pi=function(a){var b=U(a,this.j);return"target."+U(a,this.k)+"(source."+b+"() | 0);"};t.hc=function(a){var b=U(a,this.j);a=U(a,this.k);return"var _s = source."+b+"();var _t = target."+b+"();target."+a+"((_s + t * (_t - _s)) | 0);"};function lf(a,b,c,d){T.call(this,a,b);this.j=c;this.k=d}A(lf,T);
lf.prototype.w=function(){return new lf(this.Xa,this.z,this.j,this.k)};lf.prototype.Va=function(a){a=U(a,this.k);var b=ff(),b=U(b,b.gj);return"target."+a+"(reader."+b+"());"};lf.prototype.Wa=function(a){a=U(a,this.j);var b=R();return"writer."+U(b,b.Uj)+"(target."+a+"());"};lf.prototype.hc=function(a){var b=U(a,this.j);a=U(a,this.k);return"var _s = source."+b+"();var _t = target."+b+"();result."+a+"((_s + t * (_t - _s)));"};function mf(a,b,c,d){T.call(this,a,b);this.j=c;this.k=d}A(mf,T);
mf.prototype.w=function(){return new mf(this.Xa,this.z,this.j,this.k)};mf.prototype.Va=function(a){a=U(a,this.k);var b=ff(),b=U(b,b.Vl);return"target."+a+"(reader."+b+"());"};mf.prototype.Wa=function(a){a=U(a,this.j);var b=R();return"writer."+U(b,b.Em)+"(target."+a+"());"};
mf.prototype.hc=function(a){var b=U(a,this.j),c=U(a,this.k);a=U(a,nf);return"var _sv3 = source."+b+"();var _tv3 = target."+b+"();var _rv3 = source."+a+";_rv3[0] = (_tv3[0] - _sv3[0]) * t + _sv3[0];_rv3[1] = (_tv3[1] - _sv3[1]) * t + _sv3[1];_rv3[2] = (_tv3[2] - _sv3[2]) * t + _sv3[2];result."+c+"(_rv3);"};function of(a,b,c,d,e){T.call(this,a,b);this.j=c;this.k=d;this.Jl=e}A(of,T);of.prototype.w=function(){return new of(this.Xa,this.z,this.j,this.k,this.Jl)};
of.prototype.Va=function(a){a=U(a,this.k);var b=ff(),b=U(b,b.Wl);return"target."+a+"(reader."+b+"());"};of.prototype.Wa=function(a){a=U(a,this.j);var b=R();return"writer."+U(b,b.Fm)+"(target."+a+"());"};of.prototype.hc=function(a){var b=U(a,this.j),c=U(a,this.k),d=U(a,pf);a=U(a,Xe);return"var _rq = source."+d+";source."+a+"(source."+b+"(), target."+b+"(), t, _rq);result."+c+"(_rq);"};function qf(a,b,c,d){T.call(this,a,b);this.j=c;this.k=d}A(qf,T);
qf.prototype.w=function(){return new qf(this.Xa,this.z,this.j,this.k)};qf.prototype.Va=function(a){a=U(a,this.k);var b=ff(),b=U(b,b.ia);return"target."+a+"(reader."+b+"());"};qf.prototype.Wa=function(a){a=U(a,this.j);var b=R();return"writer."+U(b,b.M)+"(target."+a+"());"};qf.prototype.hc=function(a){var b=U(a,this.j),c=U(a,this.k);a=U(a,gf);return"result."+c+"(source."+a+"(source."+b+"(), target."+b+"(), t));"};function rf(a,b,c,d){T.call(this,a,b);this.j=c;this.k=d}A(rf,T);
rf.prototype.w=function(){return new rf(this.Xa,this.z,this.j,this.k)};rf.prototype.Va=function(a){a=U(a,this.k);var b=ff(),b=U(b,b.H);return"target."+a+"(reader."+b+"());"};rf.prototype.Wa=function(a){a=U(a,this.j);var b=R();return"writer."+U(b,b.o)+"(target."+a+"());"};function sf(a,b,c,d){T.call(this,a,b);this.j=c;this.k=d}A(sf,T);sf.prototype.w=function(){return new sf(this.Xa,this.z,this.j,this.k)};
sf.prototype.Va=function(a){a=U(a,this.k);var b=ff(),b=U(b,b.H);return"target."+a+"(reader."+b+"());"};sf.prototype.Wa=function(a){a=U(a,this.j);var b=R();return"writer."+U(b,b.o)+"(target."+a+"());"};function tf(a,b,c,d){T.call(this,a,b);this.j=c;this.k=d}A(tf,T);tf.prototype.w=function(){return new tf(this.Xa,this.z,this.j,this.k)};tf.prototype.Va=function(a){a=U(a,this.k);var b=ff(),b=U(b,b.s);return"target."+a+"(reader."+b+"());"};
tf.prototype.Wa=function(a){a=U(a,this.j);var b=R();return"writer."+U(b,b.t)+"(target."+a+"());"};var nf=B(),pf=D();function uf(a,b){for(var c=0;c<a.length;c++)a[c].qd=c;a.sort(hf);this.Ui={};this.hj=Array(a.length);this.Wj=Array(a.length);var d="",e="",f="",h="",k="",i="",l="",n="";this.Tj=Array(a.length);for(c=0;c<a.length;c++){var q=a[c].w();this.Tj[c]=q;this.Ui[q.Xa]=q;q.qd=c;this.hj[c]=new Function("target","reader",q.Va(b));this.Wj[c]=new Function("target","writer",q.Wa(b));var d=d+q.Va(b),e=e+q.Wa(b),u=q.pi(b),f=f+u;q.z&6||(h+=u);q.z&2&&(i+=u);if(q.z&4){var w=q.hc(b),l=l+w,k=k+u;q.z&2||(n+=w)}}this.Ul=new Function("target",
"reader",d);this.Cm=new Function("target","writer",e);this.Um=new Function("source","target",f);this.Vh=new Function("source","target",h);this.Nf=new Function("source","target",k);this.Wh=new Function("source","target",i);this.sl=new Function("source","target","t","result",l);this.rl=new Function("source","target","t","result",n)}uf.prototype.fa=function(){return this.Tj.length};function W(a,b){return a.Ui[b].qd}function vf(a,b,c,d,e){for(a=a.hj;c;){if(c&1&&a[b])a[b](d,e);c>>=1;b++}}
function wf(a,b,c,d,e){for(a=a.Wj;c;){if(c&1)a[b](d,e);c>>=1;b++}};function X(a,b){this.O=a;this.time=0;this.Q=b;this.gb=this.Fb=0}t=X.prototype;t.reset=function(a){this.O=a;this.gb=this.Fb=this.time=0};function xf(a,b){if(!a.Q){var c=[];a(c);a.Q=new uf(c,b)}return a.Q}function Y(a,b){var c=a.Fb||a.gb;31>=b?a.Fb|=1<<b:a.gb|=1<<b-32;if(!c){var c=a.O,d=!!c.T;c.T|=2;d||(d=c.Y,d.xa[d.wa++]=c)}}t.wd=function(){this.Fb=this.gb=0};t.read=function(a){this.Q.Ul(this,a)};t.Sg=function(a){var b=a.s();vf(this.Q,0,b,this,a);31<this.Q.fa()&&(b=a.s(),vf(this.Q,32,b,this,a))};
t.write=function(a){this.Q.Cm(this,a)};t.zh=function(a){a.t(this.Fb);wf(this.Q,0,this.Fb,this,a);this.gb&&31<this.Q.fa()&&(a.t(this.gb),wf(this.Q,32,this.gb,this,a))};t.Vh=function(a){this.Q.Vh(this,a)};t.Wh=function(a){this.Q.Wh(this,a)};t.Nf=function(a){this.Q.Nf(this,a)};t.xi=function(a,b,c){var d=this.Q;this.O.Ja&4?d.rl(a,b,c,this):d.sl(a,b,c,this)};t.Kj=nf;t.kh=pf;t.Tl=Xe;t.rk=gf;X.prototype.Kj[0]=X.prototype.Kj[1];X.prototype.Tl(X.prototype.kh,X.prototype.kh,0,X.prototype.kh);
X.prototype.rk(0,0,0);function yf(a,b){var c=b||xf(zf,this);X.call(this,a,c);this.Lg=B();this.Rl=W(c,Af);this.Oa=D();this.bm=W(c,Bf);this.Pe=B();this.dm=W(c,Cf);this.Qd=0;this.mk=W(c,Df);this.hf=B();this.ym=W(c,Ef)}A(yf,X);var Af=V++,Bf=V++,Cf=V++,Df=V++,Ef=V++;t=yf.prototype;t.bd=s("Lg");t.setPosition=function(a){Wa(this.Lg,a)||(Ia(this.Lg,a),Y(this,this.Rl),this.O.wb=m)};t.Wk=s("Oa");
t.Aj=function(a){this.Oa.length==a.length&&this.Oa[0]==a[0]&&this.Oa[1]==a[1]&&this.Oa[2]==a[2]&&this.Oa[3]==a[3]||(cb(this.Oa,a),Y(this,this.bm),this.O.wb=m)};t.Xk=s("Pe");t.Bj=function(a){Wa(this.Pe,a)||(Ia(this.Pe,a),Y(this,this.dm),this.O.wb=m)};t.Ok=s("Qd");t.hm=function(a){this.Qd!=a&&(this.Qd=a,Y(this,this.mk),this.O.wb=m)};t.al=s("hf");t.setVelocity=function(a){Wa(this.hf,a)||(Ia(this.hf,a),Y(this,this.ym))};
function zf(a){a.push(new mf(Af,jf|6,yf.prototype.bd,yf.prototype.setPosition));a.push(new of(Bf,jf|6,yf.prototype.Wk,yf.prototype.Aj,m));a.push(new mf(Cf,jf|6,yf.prototype.Xk,yf.prototype.Bj));a.push(new lf(Df,jf|4,yf.prototype.Ok,yf.prototype.hm));a.push(new mf(Ef,jf|2,yf.prototype.al,yf.prototype.setVelocity))};function Ff(a,b){var c=b||xf(Gf,this);yf.call(this,a,c);this.xg="";this.El=W(c,Hf);this.wg=0;this.Dl=W(c,If);this.zf=0;this.ik=W(c,Jf)}A(Ff,yf);var Hf=V++,If=V++,Jf=V++;t=Ff.prototype;t.ad=s("xg");t.Ve=function(a){this.xg!=a&&(this.xg=a,Y(this,this.El))};t.Uk=s("wg");t.im=function(a){this.wg!=a&&(this.wg=a,Y(this,this.Dl))};t.Nk=s("zf");t.gm=function(a){this.zf!=a&&(this.zf=a,Y(this,this.ik))};
function Gf(a){zf(a);a.push(new rf(Hf,0,Ff.prototype.ad,Ff.prototype.Ve));a.push(new qf(If,jf|4,Ff.prototype.Uk,Ff.prototype.im));a.push(new kf(Jf,0,Ff.prototype.Nk,Ff.prototype.gm))};function Kf(a,b){var c=b||xf(Lf,this);Ff.call(this,a,c);this.ed=0;this.re=j;this.ol=W(c,Mf)}A(Kf,Ff);var Mf=V++;Kf.prototype.Rk=s("ed");Kf.prototype.$g=function(a){this.ed!=a&&(this.ed=a,Y(this,this.ol),this.re=j)};function Lf(a){Gf(a);a.push(new tf(Mf,0,Kf.prototype.Rk,Kf.prototype.$g))};B();B();function Nf(){this.height=this.width=1;this.$a=j;this.Hl=0.1;this.eg=100;this.De=m;this.Ml=eb();this.Qg=eb();this.jf=eb();this.Ai=eb();this.Fd=eb();this.mc=eb();this.position=B();this.direction=B();this.li=[D(),D(),D(),D(),D(),D()]}var $e=[B(),B(),B(),B(),B(),B(),B(),B()];function $(a,b){E.call(this);this.map=a;var c=$.bk;this.N=Math.min(Math.max(Math.floor(b),$.fk),c);this.Fa=2*this.N+1;this.ua=Array(this.Fa*$.Dh*this.Fa);this.Ha=B();this.K=new Int32Array(3);this.bb=Ya(this.Ha[0]-16*this.N,0,this.Ha[2]-16*this.N,this.Ha[0]+16*this.N,128,this.Ha[2]+16*this.N);this.n=[];this.nl=r}A($,E);$.Hm=8;$.ak=16;$.fk=1;$.bk=16;$.Dh=1;t=$.prototype;t.b=function(){nb(this.n);$.d.b.call(this)};t.vf=function(a){this.n.push(a)};t.ij=function(a){Hb(this.n,a)};
t.wi=function(a){Ia(this.Ha,a);this.Ug();this.nl=m};t.update=function(a){Ia(this.Ha,a);var b=a[0]>>4,c=a[2]>>4;a=b-this.K[0];var d=c-this.K[2];if(a||d){var b=b<<4,c=c<<4,e=this.bb,f=b+16*this.N,h=c+16*this.N;C(e.min,b-16*this.N,0,c-16*this.N);C(e.max,f,0,h);this.bb.max[0]+=16;this.bb.max[1]+=128;this.bb.max[2]+=16;this.K[0]+=a;this.K[1]+=0;this.K[2]+=d;this.Ug()}};t.Ug=function(){this.K[0]=this.Ha[0]>>4;this.K[1]=0;this.K[2]=this.Ha[2]>>4;this.fj(this.K[0]-this.N,0,this.K[2]-this.N,this.Fa,$.Dh,this.Fa)};
t.gc=function(a,b,c){a%=this.Fa;c%=this.Fa;0>a&&(a=this.Fa+a);0>c&&(c=this.Fa+c);return a+c*this.Fa};t.fj=function(a,b,c,d,e,f){for(b=a;b<a+d;b++)for(e=c;e<c+f;e++){var h=b,k=e,i=this.gc(h,0,k);if(!(0>i||i>this.ua.length))if(h=this.map.fc(h<<4,0,k<<4),h!=this.ua[i]){if(k=this.ua[i]){for(var l=0;l<this.n.length;l++)this.n[l].qk(k);k.Na--;k.Na||k.map.ze(k)}k=h;k.Na||k.map.Ae(k);k.Na++;this.ua[i]=h;for(l=0;l<this.n.length;l++)2==h.state&&this.n[l].ie(h)}}};
t.Be=function(a){for(var b=0;b<this.n.length;b++)this.n[b].ie(a),this.n[b].tl(a.x,a.y,a.l,a.x+16-1,a.y+128-1,a.l+16-1,3)};t.fc=function(a,b,c){if(0>b||128<=b)return p;a>>=4;b>>=7;c>>=4;var d=Math.abs(c-this.K[2]);if(Math.abs(a-this.K[0])>this.N||0!=b||d>this.N)return p;a=this.gc(a,b,c);return 0>a||a>this.ua.length?p:this.ua[a]};t.Ik=function(a,b){Cb(this.ua,a,b)};t.ki=function(a,b,c){Of(this,a,this.K[0]-this.N,this.K[2]-this.N,this.Fa,b,c)};
function Of(a,b,c,d,e,f,h){var k=$.qm,i=16*(c+e),l=16*(d+e);C(k.min,16*c,0,16*d);C(k.max,i,128,l);a:{i=k.min;l=k.max;Ia($e[0],i);C($e[1],i[0],i[1],l[2]);C($e[2],i[0],l[1],i[2]);C($e[3],i[0],l[1],l[2]);C($e[4],l[0],i[1],i[2]);C($e[5],l[0],i[1],l[2]);C($e[6],l[0],l[1],i[2]);Ia($e[7],l);for(var i=0,l=b.li,n=0;n<l.length;n++){for(var q=l[n],u=8,w=1,F=0;8>F;F++){var H=$e[F];0>q[0]*H[0]+q[1]*H[1]+q[2]*H[2]+q[3]&&(w=0,u--)}if(!u){i=-1;break a}i+=w}i=6==i?1:0}if(1==i){b=k.min[0]>>4;c=k.max[0]>>4;d=k.max[2]>>
4;for(k=k.min[2]>>4;k<d;k++)for(e=b;e<c;e++)(i=a.fc(e<<4,0,k<<4))&&f.call(h,i)}else if(0==i)if(1>=e)(a=a.fc(c<<4,0,d<<4))&&f.call(h,a);else{k=e/2|0;for(e=0;1>=e;e++)for(i=0;1>=i;i++)Of(a,b,c+i*k,d+e*k,k,f,h)}}
t.rg=function(a,b){var c=p,d=Math.floor(a[0]),e=Math.floor(a[1]),f=Math.floor(a[2]),h=0==a[3]?0:0>a[3]?-1:1,k=0==a[4]?0:0>a[4]?-1:1,i=0==a[5]?0:0>a[5]?-1:1,l=(d+(0<h?1:0)-a[0])/a[3],n=(e+(0<k?1:0)-a[1])/a[4],q=(f+(0<i?1:0)-a[2])/a[5];isNaN(l)&&(l=Number.POSITIVE_INFINITY);isNaN(n)&&(n=Number.POSITIVE_INFINITY);isNaN(q)&&(q=Number.POSITIVE_INFINITY);var u=h/a[3],w=k/a[4],F=i/a[5];isNaN(u)&&(u=Number.POSITIVE_INFINITY);isNaN(w)&&(w=Number.POSITIVE_INFINITY);isNaN(F)&&(F=Number.POSITIVE_INFINITY);for(var H=
Math.min(b,16*this.Fa),G=0;G<H;G++){var I=this.fc(d,e,f);if(I&&(c=I.rg(a)))break;l<n&&l<q?(l+=u,d+=h):n<q?(n+=w,e+=k):(q+=F,f+=i)}return c&&c.Yf>b?p:c};t.ra=function(a,b,c,d){var e=this.fc(a,b,c);if(!e||!e.ra(a,b,c,d))return r;for(d=0;d<this.n.length;d++)this.n[d].zi(a,b,c,0);return m};$.un=[B(),B()];$.qm=new Xa;$=Aa($,"blk.env.ChunkView",{wi:"initialize",update:"update",Ug:"rebuildCube_",fj:"pullChunks_",Ik:"forEachChunk",ki:"forEachInViewport"});function Pf(a){this.Th=fa(a)?a:1}Pf.Zj=1;Pf.prototype.yd=function(a){var b=R();if(this.qj(a,b))return b.finish();b.hb();return p};
Pf.prototype.qj=function(a,b){switch(Pf.Zj){case 1:Q(b,1);var c;a:{Bd(b,a.x);Bd(b,a.y);Bd(b,a.l);Q(b,this.Th);switch(this.Th){default:case 0:c=new Uint8Array(a.$.buffer);zd(b,4+c.length);b.M(c.length);for(var d=0;d<c.length;d++)b.buffer[b.offset++]=c[d];break;case 1:zd(b,65668);d=b.offset+4;c=a.$;for(var d=b.buffer.subarray(d,d+65664),e=0,f=0,h=0,k=0;k<c.length;k++){var i=c[k];k&&i==f?h++:(f=i,h=1);if(k>=c.length-2||c[k+1]!=f)1<h||255==f>>8?(d[e++]=255,d[e++]=h>>8,d[e++]=h&255,d[e++]=f>>8,d[e++]=
f&255):(d[e++]=i>>8,d[e++]=i&255)}c=e;if(0>c){c=r;break a}b.M(c);b.offset+=c;break;case 2:c=r;break a}c=m}return c;default:return r}};
Pf.prototype.$h=function(a,b){switch(Qe(b)){case 1:var c;a:{c=df(b);var d=df(b),e=df(b);a.x=c;a.y=d;a.l=e;var f=a.ab,h=c+16,k=d+128,i=e+16;C(f.min,c,d,e);C(f.max,h,k,i);d=Qe(b);c=a.$;switch(d){default:case 0:b.ia();d=0;for(e=b.offset;32768>d;d++,e+=2)c[d]=b.buffer[e+1]<<8|b.buffer[e];break;case 1:h=b.ia();d=b.buffer;f=b.offset;e=0;f=f?f:0;h=h?h:d.length;for(k=f;k<f+h;)if(i=d[k++],255==i)for(var i=d[k++]<<8|d[k++],l=d[k++]<<8|d[k++],n=0;n<i;n++)c[e++]=l;else c[e++]=i<<8|d[k++];break;case 2:c=r;break a}a.bc=
r;a.state=2;a.map.Be(a);c=m}return c;default:return r}};Pf.eh=p;Pf.Yk=function(){Pf.eh||(Pf.eh=new Pf(0));return Pf.eh};Pf=Aa(Pf,"blk.io.ChunkSerializer",{qj:"serializeToWriter",$h:"deserializeFromReader"});function Qf(a,b){E.call(this);this.X=a;this.Gc=b;this.Da=[];this.ug=-Qf.Ch;this.ld=0}A(Qf,E);Qf.Ch=3;Qf.ck=20;Qf.Xj=100;t=Qf.prototype;t.ie=function(a){0<=Bb(this.Da,a)||(this.Da.push(a),this.ug=0)};
t.bj=function(a,b){var c=Math.min(Qf.ck,this.Da.length);wa("count",this.Da.length);if(a-this.ug>Qf.Ch){this.ug=a;var d=Xb[0];Kb(this.Da,function(a,c){C(d,a.x+8,b[1],a.l+8);var e=Ua(b,d);C(d,c.x+8,b[1],c.l+8);return e-Ua(b,d)})}a-this.ld>1/Qf.Xj?this.ld=a:c=0;if(c)for(var e=R(),f=Pf.Yk(),h=0;h<c;h++){var k=this.Da.shift();re.x=k.x;re.y=k.y;re.l=k.l;var i=e,l=re;Q(i,73);Bd(i,l.x);Bd(i,l.y);Bd(i,l.l);k.ub||(k.ub=f.yd(k));i=e;k=k.ub;k instanceof Uint8Array||(k=new Uint8Array(k));zd(i,k.length);for(l=
0;l<k.length;l++)i.buffer[i.offset++]=k[l];this.X.send(e.finish(),this.Gc);e.hb()}};t.qk=x;t.zi=x;t.tl=x;Qf=Aa(Qf,"blk.env.server.ChunkSendQueue",{bj:"process"});function Rf(a,b,c,d){Ye.call(this,a,b,c,d);this.$a=j;this.Da=this.Qa=this.r=p}A(Rf,Ye);t=Rf.prototype;t.b=function(){this.r&&this.Qa&&(Hb(this.r.Ya,this.Qa),K(this.Qa));Rf.d.b.call(this)};t.dh=function(a){this.r=a;this.Qa=new $(a,$.ak);a.Ya.push(this.Qa);ud(this,1,0)};t.update=function(a){var b=Sf,c=this.getParent();c instanceof Ye?Ze(c,b):Ze(this,b);this.Qa.update(b);this.Da.bj(a,b);ud(this,1,0)};t.ma=function(a){Rf.d.ma.call(this,a);a instanceof Te&&(this.$a=a.yf)};
t.Tb=function(a){var b=this.ga(),c=Le(this).r;this.dh(c);this.Da=new Qf(b.X,a);J(this,this.Da);this.Qa.vf(this.Da);a=Ha(0,80,0);this.Qa.wi(a)};t.Vd=function(a){if(this.$a){var b=this.$a;a.$a!==b&&(a.$a=b,a.De=m)}b=this.getParent();b instanceof Ye?b.Vd(a):Rf.d.Vd.call(this,a)};var Sf=D();function Tf(a,b){var c=b||xf(Uf,this);yf.call(this,a,c)}A(Tf,yf);function Uf(a){zf(a)};function Vf(a,b,c,d){ld.call(this,a,b,c,d)}A(Vf,ld);Vf.prototype.kg=function(){return this.getParent()};Vf.prototype.Zd=function(a){Vf.d.Zd.call(this,a)};Vf.prototype.$b=function(a){Vf.d.$b.call(this,a)};Vf.prototype.ma=function(a){Vf.d.ma.call(this,a);if(a instanceof Ve){var b=this.kg();a:{for(var c=0;c<this.J.length;c++)if(this.J[c].D==a.lh){a=this.J[c];break a}a=p}a&&b.g.$g(a?a.D:0)}};function Wf(a,b){var c=b||xf(Xf,this);X.call(this,a,c)}A(Wf,X);function Xf(){};function Yf(){this.Jk=m}
Yf.prototype.ma=function(a,b){var c=a.jh,d=a.Ah*Pe,e=a.Jg*Pe,f=a.$l*Pe,h=Zf,k=Math.sin(d/2),d=Math.cos(d/2),i=Math.sin(e/2),e=Math.cos(e/2),l=Math.sin(f/2),f=Math.cos(f/2);h[0]=d*i*f+k*e*l;h[1]=k*e*f-d*i*l;h[2]=d*e*l-k*i*f;h[3]=d*e*f+k*i*l;b.Aj(Zf);if(this.Jk){h=b.bd();k=$f[4];i=b.Oa;d=b.hf;f=$f[5];e=La(d);1E-4<e?(l=Math.max(0,e-40*c),Ka(d,l/e,f)):C(f,0,0,0);d=a.nh;e=$f[0];e[0]=0;e[0]+=18*!!(d&1);e[0]-=18*!!(d&2);e[1]=0;e[1]+=18*!!(d&4);e[1]-=18*!!(d&8);e[2]=0;e[2]+=18*!!(d&16);e[2]-=18*!!(d&32);
var d=$f[1],l=i[0]*(i[0]+i[0]),n=i[3]*(i[0]+i[0]),q=i[0]*(i[1]+i[1]),u=i[1]*(i[1]+i[1]),w=i[3]*(i[1]+i[1]),F=i[0]*(i[2]+i[2]),H=i[1]*(i[2]+i[2]),G=i[2]*(i[2]+i[2]),i=i[3]*(i[2]+i[2]),I=e[0],N=e[1],e=e[2];d[0]=I*(1-u-G)+N*(q-i)+e*(F+w);d[1]=I*(q+i)+N*(1-l-G)+e*(H-n);d[2]=I*(F-w)+N*(H+n)+e*(1-l-u);i=$f[2];(e=La(d))?Ka(d,1/e,i):C(i,0,0,0);e=La(d);18<e&&(Ka(d,18/e,d),e=18);d=e-(f[0]*i[0]+f[1]*i[1]+f[2]*i[2]);0<d&&(e=20*e*c,e>d&&(e=d),Ka(i,e,i),Ja(i,f,f));d=$f[3];Ka(f,c,d);Ja(h,d,k);b.setPosition(k);b.setVelocity(f)}};
var $f=[B(),B(),B(),B(),B(),B()];D();D();D();new Float32Array(16);new Float32Array(6);var Zf=D();var ag=!Qd||Qd&&9<=fe,bg=Qd&&!de("9");!Sd||de("528");Rd&&de("1.9b")||Qd&&de("8")||Pd&&de("9.5")||Sd&&de("528");Rd&&!de("8")||Qd&&de("9");function cg(a,b){this.type=a;this.currentTarget=this.target=b}t=cg.prototype;t.b=aa();t.Uc=aa();t.wc=r;t.defaultPrevented=r;t.Oe=m;t.preventDefault=function(){this.defaultPrevented=m;this.Oe=r};function dg(a,b){a&&this.lb(a,b)}A(dg,cg);t=dg.prototype;t.target=p;t.relatedTarget=p;t.offsetX=0;t.offsetY=0;t.clientX=0;t.clientY=0;t.screenX=0;t.screenY=0;t.button=0;t.keyCode=0;t.charCode=0;t.ctrlKey=r;t.altKey=r;t.shiftKey=r;t.metaKey=r;t.Pl=r;t.cg=p;
t.lb=function(a,b){var c=this.type=a.type;cg.call(this,c);this.target=a.target||a.srcElement;this.currentTarget=b;var d=a.relatedTarget;if(d){if(Rd){var e;a:{try{Ae(d.nodeName);e=m;break a}catch(f){}e=r}e||(d=p)}}else"mouseover"==c?d=a.fromElement:"mouseout"==c&&(d=a.toElement);this.relatedTarget=d;this.offsetX=Sd||a.offsetX!==j?a.offsetX:a.layerX;this.offsetY=Sd||a.offsetY!==j?a.offsetY:a.layerY;this.clientX=a.clientX!==j?a.clientX:a.pageX;this.clientY=a.clientY!==j?a.clientY:a.pageY;this.screenX=
a.screenX||0;this.screenY=a.screenY||0;this.button=a.button;this.keyCode=a.keyCode||0;this.charCode=a.charCode||("keypress"==c?a.keyCode:0);this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.Pl=Jd?a.metaKey:a.ctrlKey;this.state=a.state;this.cg=a;a.defaultPrevented&&this.preventDefault();delete this.wc};
t.preventDefault=function(){dg.d.preventDefault.call(this);var a=this.cg;if(a.preventDefault)a.preventDefault();else if(a.returnValue=r,bg)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};t.b=aa();function eg(){}var fg=0;t=eg.prototype;t.key=0;t.xc=r;t.Wd=r;t.lb=function(a,b,c,d,e,f){na(a)?this.Bi=m:a&&a.handleEvent&&na(a.handleEvent)?this.Bi=r:g(Error("Invalid listener argument"));this.listener=a;this.ej=b;this.src=c;this.type=d;this.capture=!!e;this.ng=f;this.Wd=r;this.key=++fg;this.xc=r};t.handleEvent=function(a){return this.Bi?this.listener.call(this.ng||this.src,a):this.listener.handleEvent.call(this.listener,a)};var gg={},hg={},ig={},jg={};
function kg(a,b,c,d,e){if(ka(b)){for(var f=0;f<b.length;f++)kg(a,b[f],c,d,e);return p}a:{b||g(Error("Invalid event type"));d=!!d;var h=hg;b in h||(h[b]={f:0,qa:0});h=h[b];d in h||(h[d]={f:0,qa:0},h.f++);var h=h[d],f=qa(a),k;h.qa++;if(h[f]){k=h[f];for(var i=0;i<k.length;i++)if(h=k[i],h.listener==c&&h.ng==e){if(h.xc)break;k[i].Wd=r;a=k[i].key;break a}}else k=h[f]=[],h.f++;var l=lg,n=ag?function(a){return l.call(n.src,n.key,a)}:function(a){a=l.call(n.src,n.key,a);if(!a)return a},i=n;i.src=a;h=new eg;
h.lb(c,i,a,b,d,e);h.Wd=r;c=h.key;i.key=c;k.push(h);gg[c]=h;ig[f]||(ig[f]=[]);ig[f].push(h);a.addEventListener?(a==v||!a.Yh)&&a.addEventListener(b,i,d):a.attachEvent(b in jg?jg[b]:jg[b]="on"+b,i);a=c}return a}function mg(a,b,c,d,e){if(ka(b))for(var f=0;f<b.length;f++)mg(a,b[f],c,d,e);else{d=!!d;a:{f=hg;if(b in f&&(f=f[b],d in f&&(f=f[d],a=qa(a),f[a]))){a=f[a];break a}a=p}if(a)for(f=0;f<a.length;f++)if(a[f].listener==c&&a[f].capture==d&&a[f].ng==e){ng(a[f].key);break}}}
function ng(a){if(!gg[a])return r;var b=gg[a];if(b.xc)return r;var c=b.src,d=b.type,e=b.ej,f=b.capture;c.removeEventListener?(c==v||!c.Yh)&&c.removeEventListener(d,e,f):c.detachEvent&&c.detachEvent(d in jg?jg[d]:jg[d]="on"+d,e);c=qa(c);ig[c]&&(e=ig[c],Hb(e,b),0==e.length&&delete ig[c]);b.xc=m;if(b=hg[d][f][c])b.Oi=m,og(d,f,c,b);delete gg[a];return m}
function og(a,b,c,d){if(!d.ye&&d.Oi){for(var e=0,f=0;e<d.length;e++)d[e].xc?d[e].ej.src=p:(e!=f&&(d[f]=d[e]),f++);d.length=f;d.Oi=r;0==f&&(delete hg[a][b][c],hg[a][b].f--,0==hg[a][b].f&&(delete hg[a][b],hg[a].f--),0==hg[a].f&&delete hg[a])}}function pg(a,b,c,d,e){var f=1;b=qa(b);if(a[b]){a.qa--;a=a[b];a.ye?a.ye++:a.ye=1;try{for(var h=a.length,k=0;k<h;k++){var i=a[k];i&&!i.xc&&(f&=qg(i,e)!==r)}}finally{a.ye--,og(c,d,b,a)}}return Boolean(f)}function qg(a,b){a.Wd&&ng(a.key);return a.handleEvent(b)}
function lg(a,b){if(!gg[a])return m;var c=gg[a],d=c.type,e=hg;if(!(d in e))return m;var e=e[d],f,h;if(!ag){f=b||ha("window.event");var k=m in e,i=r in e;if(k){if(0>f.keyCode||f.returnValue!=j)return m;a:{var l=r;if(0==f.keyCode)try{f.keyCode=-1;break a}catch(n){l=m}if(l||f.returnValue==j)f.returnValue=m}}l=new dg;l.lb(f,this);f=m;try{if(k){for(var q=[],u=l.currentTarget;u;u=u.parentNode)q.push(u);h=e[m];h.qa=h.f;for(var w=q.length-1;!l.wc&&0<=w&&h.qa;w--)l.currentTarget=q[w],f&=pg(h,q[w],d,m,l);if(i){h=
e[r];h.qa=h.f;for(w=0;!l.wc&&w<q.length&&h.qa;w++)l.currentTarget=q[w],f&=pg(h,q[w],d,r,l)}}else f=qg(c,l)}finally{q&&(q.length=0)}return f}d=new dg(b,this);return f=qg(c,d)};function rg(a){E.call(this);this.ml=a;this.C=[]}A(rg,E);var sg=[];rg.prototype.listen=function(a,b,c,d,e){ka(b)||(sg[0]=b,b=sg);for(var f=0;f<b.length;f++){var h=kg(a,b[f],c||this,d||r,e||this.ml||this);this.C.push(h)}return this};rg.prototype.b=function(){rg.d.b.call(this);Cb(this.C,ng);this.C.length=0};rg.prototype.handleEvent=function(){g(Error("EventHandler.handleEvent not implemented"))};!Rd&&!Qd||Qd&&Qd&&9<=fe||Rd&&de("1.9.1");Qd&&de("9");function tg(a,b,c,d){ld.call(this,a,b,c,d)}A(tg,ld);tg.prototype.kg=function(){return this.getParent()};function ug(a,b,c,d){af.call(this,a,b,c,d)}A(ug,af);ug.prototype.Fg=function(a,b){ug.d.Fg.call(this,a,b)};ug.prototype.Ig=x;function vg(a,b,c,d){ld.call(this,a,b,c,d);this.zm=new Nf;this.Fl=new Yf}A(vg,tg);
vg.prototype.ma=function(a){vg.d.ma.call(this,a);var b=this.kg();if(b&&a instanceof Oe){this.Fl.ma(a,b.g);var c,d=this.g;d.Fe===j&&(d.Fe=d.sd?d.O.ga().v[d.sd]||p:p);c=d.Fe;var d=wg(c.g),e=d.Qa,f=this.zm,h=16*d.Qa.N+16;f.eg!=h&&(f.eg=h,f.De=m);d.Vd(f);if(a.xb&&(d=b.g,d.re===j&&(d.re=d.ed?d.O.ga().v[d.ed]||p:p),d=d.re)){h=xg;h.time=a.getTime();h.viewport=f;h.Rh=e;h.Kg=c;h.gk=b;h.screenX=0.5;h.screenY=0.5;a.xb&1&&(h.screenX=a.Xg/65535,h.screenY=a.Yg/65535);var b=h.Rg,k=2*(h.screenX/f.width)-1,i=1-2*
(h.screenY/f.height);c=$e[0];e=$e[1];C(c,k,i,-1);C(e,k,i,1);ib(f.mc,c,c);ib(f.mc,e,e);Va(c,e,e);var f=c[1],k=c[2],i=e[0],l=e[1],e=e[2];b[0]=c[0];b[1]=f;b[2]=k;b[3]=i;b[4]=l;b[5]=e;a.qe||(a=a.xb,a&4&&d.Ig(h,0),a&32&&d.Ig(h,1))}}};var xg=new function(){this.time=0;this.gk=this.Kg=this.Rh=this.viewport=p;this.screenY=this.screenX=0;this.Rg=new Float32Array(6)};function yg(a,b,c,d){af.call(this,a,b,c,d)}A(yg,ug);yg.prototype.pe=function(){var a=this.g.pe();return Le(this).r.A.q[a]};yg.prototype.Ue=function(a){this.g.Ue(a.id)};
yg.prototype.Ig=function(a,b){var c=a.Rh.rg(a.Rg,100);if(c&&100>=c.Yf)if(0==b){var d=c.Eh,e=c.Fh,f=c.Gh,h=0,k=0,i=0,c=c.Xi;c[0]==d?h--:c[0]==d+1&&h++;c[1]==e?k--:c[1]==e+1&&k++;c[2]==f?i--:c[2]==f+1&&i++;c=d+h;e+=k;f+=i;k=this.pe();i=a.Kg;k=k?k.id<<8:0;Le(this).ra(c,e,f,k,i)}else 1==b&&(f=c.Eh,i=c.Fh,c=c.Gh,e=a.Kg,Le(this).ra(f,i,c,0,e))};function zg(a,b,c,d){ld.call(this,a,b,c,d)}A(zg,ld);zg.prototype.kb=function(){var a=this.g;a.ef===j&&(a.ef=a.Cd?a.O.ga().kb(a.Cd):p);return a.ef};zg.prototype.jg=function(){var a=Ag(this.g),b=this.g;b.ce===j&&(b.ce=b.Qc?b.O.ga().v[b.Qc]||p:p);var b=b.ce,c=wg(this.g),d=this.g;d.we===j&&(d.we=d.gd?d.O.ga().v[d.gd]||p:p);return[a,b,c,d.we]};
zg.prototype.Tb=function(a){var b=this.ga(),c=this.g;this.ha=a;c.Dj(a.c);var d=this.Y.Ac,e=Me(d.g).r;od(this,d);d=b.va(69,sd|22);d.ha=a;d.Ve("pumpkin");c.uj(d.D);var f=b.va(68,66);f.ha=a;od(f,d);f.g.zj(this.D);c.wj(f.D);f=b.va(66,66);f.ha=a;od(f,d);f.Tb(a);c.vj(f.D);f=b.va(70,0);f.ha=a;od(f,d);c.xj(f.D);c=[e.A.q[1],e.A.q[2],e.A.q[3],e.A.q[4],e.A.q[5],e.A.q[6],e.A.q[7],e.A.q[8],e.A.q[9]];for(e=0;e<c.length;e++){var h=b.va(72,0);h.ha=a;od(h,f);h.Ue(c[e]);0==e&&d.g.$g(h?h.D:0)}};function Bg(a,b){var c=b||xf(Cg,this);X.call(this,a,c);this.Cd="";this.ef=j;this.xm=W(c,Dg);this.Hc=0;this.Id=j;this.hk=W(c,Eg);this.Qc=0;this.ce=j;this.wk=W(c,Fg);this.Lc=0;this.Xd=j;this.nk=W(c,Gg);this.gd=0;this.we=j;this.ul=W(c,Hg)}A(Bg,X);var Dg=V++,Eg=V++,Fg=V++,Gg=V++,Hg=V++;t=Bg.prototype;t.$k=s("Cd");t.Dj=function(a){this.Cd!=a&&(this.Cd=a,Y(this,this.xm),this.ef=j)};t.Mk=s("Hc");function Ag(a){a.Id===j&&(a.Id=a.Hc?a.O.ga().v[a.Hc]||p:p);return a.Id}
t.uj=function(a){this.Hc!=a&&(this.Hc=a,Y(this,this.hk),this.Id=j)};t.Qk=s("Qc");t.wj=function(a){this.Qc!=a&&(this.Qc=a,Y(this,this.wk),this.ce=j)};t.Pk=s("Lc");function wg(a){a.Xd===j&&(a.Xd=a.Lc?a.O.ga().v[a.Lc]||p:p);return a.Xd}t.vj=function(a){this.Lc!=a&&(this.Lc=a,Y(this,this.nk),this.Xd=j)};t.Sk=s("gd");t.xj=function(a){this.gd!=a&&(this.gd=a,Y(this,this.ul),this.we=j)};
function Cg(a){a.push(new sf(Dg,0,Bg.prototype.$k,Bg.prototype.Dj));a.push(new tf(Eg,0,Bg.prototype.Mk,Bg.prototype.uj));a.push(new tf(Fg,0,Bg.prototype.Qk,Bg.prototype.wj));a.push(new tf(Gg,0,Bg.prototype.Pk,Bg.prototype.vj));a.push(new tf(Hg,0,Bg.prototype.Sk,Bg.prototype.xj))};function Ig(a,b){var c=b||xf(Jg,this);X.call(this,a,c);this.Gd=0;this.lf=j;this.Bm=W(c,Kg)}A(Ig,X);var Kg=V++;Ig.prototype.bl=s("Gd");function Me(a){a.lf===j&&(a.lf=a.Gd?a.O.ga().v[a.Gd]||p:p);return a.lf}Ig.prototype.Ej=function(a){this.Gd!=a&&(this.Gd=a,Y(this,this.Bm),this.lf=j)};function Jg(a){a.push(new tf(Kg,0,Ig.prototype.bl,Ig.prototype.Ej))};function Lg(a,b,c,d,e){ld.call(this,a,b,c,d);this.Hj=e}A(Lg,ld);Lg.prototype.Zd=function(a){a instanceof Ye&&this.Hj.Zb(a)};Lg.prototype.$b=function(a){a instanceof Ye&&this.Hj.qb(a)};function Mg(a){this.vn=a||Ng;this.xn=[]}function Ng(){this.Rg=new Float32Array(6);this.end=this.start=this.kn=0;this.O=this.wn=p;this.Xi=B();this.Yf=0};function Og(){Mg.call(this);this.v=[]}A(Og,Mg);Og.prototype.Zb=function(a){this.v.push(a)};Og.prototype.qb=function(a){Hb(this.v,a)};Og.prototype.forEach=function(a,b){for(var c=0;c<this.v.length&&a.call(b||v,this.v[c])!==r;c++);};Og.prototype.ki=function(a,b,c){for(a=0;a<this.v.length&&b.call(c||v,this.v[a],0)!==r;a++);};D();function Pg(a,b,c,d){Lg.call(this,a,b,c,d,new Og);this.r=p}A(Pg,Lg);Pg.prototype.dh=ba("r");Pg.prototype.update=function(a){this.g.Cj(a|0);ud(this,2,a+1)};Pg.prototype.ra=function(a,b,c,d,e){var f=this.r;d&&!f.A.q[d>>8]?M("unknown block type",d):f.ra(a,b,c,d)!=d&&(f=this.Of(66),f.x=a,f.y=b,f.l=c,f.data=d,a=e?e.kb():p,qd(this.Y,f,a))};B();function Qg(a,b){var c=b||xf(Rg,this);X.call(this,a,c)}A(Qg,X);function Rg(){};function Sg(a,b){var c=b||xf(Tg,this);Qg.call(this,a,c);this.gh=0;this.mm=W(c,Ug)}A(Sg,Qg);var Ug=V++;Sg.prototype.Zk=s("gh");Sg.prototype.Cj=function(a){this.gh!=a&&(this.gh=a,Y(this,this.mm))};function Tg(a){a.push(new lf(Ug,0,Sg.prototype.Zk,Sg.prototype.Cj))};function Vg(a,b){var c=b||xf(Wg,this);X.call(this,a,c)}A(Vg,X);function Wg(){};function Xg(a,b){var c=b||xf(Yg,this);Vg.call(this,a,c);this.sd=0;this.Fe=j;this.Ql=W(c,Zg)}A(Xg,Vg);var Zg=V++;Xg.prototype.Vk=s("sd");Xg.prototype.zj=function(a){this.sd!=a&&(this.sd=a,Y(this,this.Ql),this.Fe=j)};function Yg(a){a.push(new tf(Zg,0,Xg.prototype.Vk,Xg.prototype.zj))};function $g(a,b){var c=b||xf(ah,this);Ff.call(this,a,c)}A($g,Ff);function ah(a){Gf(a)};function bh(a,b){var c=b||xf(ch,this);$g.call(this,a,c);this.Bf=0;this.jk=W(c,dh)}A(bh,$g);var dh=V++;bh.prototype.pe=s("Bf");bh.prototype.Ue=function(a){this.Bf!=a&&(this.Bf=a,Y(this,this.jk))};function ch(a){Gf(a);a.push(new kf(dh,0,bh.prototype.pe,bh.prototype.Ue))};function eh(a,b,c,d){af.call(this,a,b,c,d)}A(eh,ug);function fh(a,b){var c=b||xf(gh,this);$g.call(this,a,c)}A(fh,$g);function gh(a){Gf(a)};function hh(a,b,c){this.Ga=a;this.Bk=b;this.km=c;this.Xe=[]}hh.prototype.va=function(a,b,c){return new this.Bk(a,this,b,c)};function md(a,b){if(a.Xe.length){var c=a.Xe.pop();c.reset(b);return c}return new a.km(b)};function ih(a,b,c,d,e,f){this.Tm=a;this.type=b;this.zn=c;this.userName=d;this.timestamp=e;this.value=f||p};function jh(a){E.call(this);this.F=a;this.h=[];this.dg=[]}A(jh,E);jh.prototype.wf=function(a){if(0<=Bb(this.h,a))return p;this.h.push(a);a=new ih(this,0,a.c,a.info.ya,z());this.dg.push(a);return a};jh.prototype.Ke=function(a){return Hb(this.h,a)?(a=new ih(this,1,a.c,a.info.ya,z()),this.dg.push(a),a):p};jh.prototype.postMessage=function(a,b){if(!(0<=Bb(this.h,a)))return p;var c=new ih(this,2,a.c,a.info.ya,z(),b);this.dg.push(c);return c};function kh(a){E.call(this);this.Ea=a;this.Mc={};this.zg=[];this.Gj(a.Mb)}A(kh,E);t=kh.prototype;t.b=function(){Ic(this.Mc,K);this.Mc={};kh.d.b.call(this)};t.Gj=x;function lh(a,b,c){var d=a.Mc[b];!d&&c&&(d=new jh(b),a.Mc[b]=d);return d}t.Yi=function(){if(this.zg.length){var a=this.zg;this.zg=[];return a}return p};t.fb=x;t.Uf=x;t.th=x;t.uh=function(a){Ic(this.Mc,function(b){b.Ke(a)})};t.vh=x;function mh(){this.Ta="";this.name="Server";this.location="us";this.Zc="unknown";this.$c="0";this.oc=32;this.Nb={}}mh.prototype.w=function(){var a=new mh;a.Ta=this.Ta;a.name=this.name;a.location=this.location;a.Zc=this.Zc;a.$c=this.$c;a.oc=this.oc;a.Nb=Lc(this.Nb);return a};mh.prototype.toString=ca("[server]");function nh(){this.nc=this.R=0}function oh(a,b){var c=b||new ke;c.Md=a.H();c.Ld=a.H();c.ya=a.H();return c}function ph(a,b){a.o(b.Md);a.o(b.Ld);a.o(b.ya);return m}function qh(a,b){a.o(b.c);Q(a,b.R);a.M(b.z);var c;if(!(c=!ph(a,b.info)))c=b.Jd,a.o(c.type),a.o(c.platform),a.o(c.rd),a.o(c.Tc),c=r;return c?r:m}var rh=new function(){this.nc=this.Oc=this.Te=0},sh=new function(){this.Oc=this.Te=0;this.gf=[]};
function th(a,b){var c=rh.Oc,d=R();sh.Te=a;sh.Oc=c;sh.gf=b;Q(d,2);d.M(sh.Te);d.M(sh.Oc);d.M(sh.gf.length);for(c=0;c<sh.gf.length;c++){var e=d,f=sh.gf[c];Q(e,f.R);Cd(e,f.nc)}return d.finish()}var uh=new function(){this.info=new mh;this.h=[]};
function vh(a,b){var c=R();uh.info=a;uh.h=b;var d;a:{Q(c,3);d=uh.info;c.o(d.Ta);c.o(d.name);c.o(d.location);c.o(d.Zc);c.o(d.$c);c.M(d.oc);var e=0,f;for(f in d.Nb)e++;c.M(e);for(var h in d.Nb)e=d.Nb[h],c.o(h),c.o(e);c.M(uh.h.length);for(d=0;d<uh.h.length;d++)if(!qh(c,uh.h[d])){d=r;break a}d=m}return!d?(c.hb(),p):c.finish()}function wh(){this.Kd=this.Ye=0;this.I=new le}var xh=new wh,yh=new wh;
function zh(a,b){var c=R();yh.Ye=3;yh.Kd=a;yh.I=b;Q(c,4);Cd(c,yh.Ye);Cd(c,yh.Kd);return!qh(c,yh.I)?(c.hb(),p):c.finish()}function Ah(){this.reason=0}var Bh=new Ah,Ch=new Ah,Dh=new function(){this.I=new le};function Eh(a){var b=R();Dh.I=a;Q(b,6);return!qh(b,Dh.I)?(b.hb(),p):b.finish()}var Fh=new function(){this.c="";this.reason=0};function Gh(a,b){var c=R();Fh.c=a;Fh.reason=b;Q(c,7);c.o(Fh.c);c.M(Fh.reason);return c.finish()}function Hh(){this.c="";this.info=new ke}var Ih=new Hh,Jh=new Hh;
function Kh(a,b){var c=R();Jh.c=a;Jh.info=b;Q(c,8);c.o(Jh.c);return!ph(c,Jh.info)?(c.hb(),p):c.finish()}function Lh(){this.F=this.c="";this.timestamp=0;this.Fc=[]}var Mh=new Lh,Nh=new Lh;function Oh(a,b,c,d){var e=R();Nh.c=a;Nh.F=b;Nh.timestamp=c;Nh.Fc=d;Q(e,20);e.o(Nh.c);e.o(Nh.F);e.M(Nh.timestamp);e.M(Nh.Fc.length);for(a=0;a<Nh.Fc.length;a++)e.o(Nh.Fc[a]);return e.finish()}function Ph(){this.F=this.c="";this.timestamp=0}var Qh=new Ph,Rh=new Ph;
function Sh(){this.F=this.c="";this.timestamp=0;this.message=""}var Th=new Sh,Uh=new Sh;function Vh(a){kh.call(this,a);this.Se=a}A(Vh,kh);t=Vh.prototype;t.join=function(a,b,c){if(b=lh(this,b,m)){var d=z();fa(c)&&1E3>d-c&&(d=c);b.wf(a);var e=Array(b.h.length);for(c=0;c<b.h.length;c++){var f=b.h[c];e[c]=f.c}this.Se.send(Oh(f.c,b.F,d,e),a);d=Oh(a.c,b.F,d,[]);for(c=0;c<b.h.length;c++)f=b.h[c],f!=a&&this.Se.send(d,f)}};t.Gj=function(a){Ie(a,20,this.cl,this);Ie(a,21,this.dl,this);Ie(a,22,this.el,this)};
t.cl=function(a,b,c){a=a.I;if(!a)return r;Mh.c=c.H();Mh.F=c.H();Mh.timestamp=c.ia();b=c.ia();Mh.Fc.length=b;for(var d=0;d<b;d++)Mh.Fc[d]=c.H();if(!Mh)return r;if(Mh.c!=a.c)return M("user info mismatch"),r;this.join(a,Mh.F,Mh.timestamp);return m};
t.dl=function(a,b,c){a=a.I;if(!a)return r;Qh.c=c.H();Qh.F=c.H();Qh.timestamp=c.ia();if(!Qh)return r;if(Qh.c!=a.c)return M("user info mismatch"),r;b=Qh.timestamp;if(c=lh(this,Qh.F,r)){var d=z();fa(b)&&1E3>d-b&&(d=b);b=a.c;var e=c.F,f=R();Rh.c=b;Rh.F=e;Rh.timestamp=d;Q(f,21);f.o(Rh.c);f.o(Rh.F);f.M(Rh.timestamp);b=f.finish();for(e=0;e<c.h.length;e++)this.Se.send(b,c.h[e]);c.Ke(a)}return m};
t.el=function(a,b,c){a=a.I;if(!a)return r;Th.c=c.H();Th.F=c.H();Th.timestamp=c.ia();Th.message=c.H();if(!Th)return r;if(Th.c!=a.c)return M("user info mismatch"),r;c=lh(this,Th.F,r);if(!c)return m;c.postMessage(a,Th.message);a=a.c;b=c.F;var d=z(),e=Th.message,f=R();Uh.c=a;Uh.F=b;Uh.timestamp=d;Uh.message=e;Q(f,22);f.o(Uh.c);f.o(Uh.F);f.M(Uh.timestamp);f.o(Uh.message);a=f.finish();for(b=0;b<c.h.length;b++)this.Se.send(a,c.h[b]);return m};function Wh(a,b,c){E.call(this);a.G=b.G;this.Kk=a;this.Ea=b;this.Ea.W.push(this);this.Ph=new Vh(b);this.Ea.W.push(this.Ph);b=a.Fi;var d=new Rb;d.ni=b.yl;d.Qe=b.Al;this.r=new gd(d,c);J(this,this.r);this.Pa=new Ke(a,this.Ea,qe);J(this,this.Pa);a=this.Pa;c=new ze(64,Te,0);a.Sa[c.Ga]=c;c=new ze(65,Oe,2);a.Sa[c.Ga]=c;c=new ze(66,Ue,0);a.Sa[c.Ga]=c;c=new ze(67,Ve,2);a.Sa[c.Ga]=c;a=this.Pa;Ce(a,new hh(64,Ne,Ig));Ce(a,new hh(65,Pg,Sg));Ce(a,new hh(66,Rf,Tf));Ce(a,new hh(67,zg,Bg));Ce(a,new hh(68,vg,Xg));
Ce(a,new hh(69,bf,Kf));Ce(a,new hh(70,Vf,Wf));Ce(a,new hh(71,eh,fh));Ce(a,new hh(72,yg,bh));this.rb=p;this.Wi=[];this.Li=new Qb(this.Kk.Jc);J(this,this.Li)}A(Wh,E);t=Wh.prototype;t.ga=s("Pa");t.ic=s("rb");t.kl=x;t.load=function(){var a=new O;this.rb=this.Pa.va(64,128);this.rb.mi=this;this.Fj();var b=this.Ea;b.Tg=m;b.state=1;b.ja.ka(y(b.lg,b));for(var c=0;c<b.W.length;c++)b.W[c].fb();M("Server ready, listening on",b.ja.Ta.toString());a.e(p);return a};
t.th=function(a){M("client connected",a.c,a.info,a.Jd);this.Ph.join(a,"main");var b=this.Xh(a);a.data=b;this.Wi.push(b);this.Ea.send(se(),a);this.kl()};t.uh=function(a){M("client disconnected",a.c);if(a=a.data)this.ga().qb(a),nd(a.Y.Ac,0),Hb(this.Wi,a),K(a)};t.vh=x;Wh.dk=5;Wh.prototype.update=function(a){2!=this.Ea.state&&(this.Ea.Yi(Wh.dk),2==this.Ea.state?M("Server disconnected!?"):(this.r.update(a),this.Pa.update(a)))};Wh.prototype.yc=aa();Wh.prototype.fb=x;Wh.prototype.Uf=x;
Wh=Aa(Wh,"blk.game.server.ServerController",{load:"load",update:"update",yc:"render"});function Xh(a,b,c){Wh.call(this,a,b,c);this.mf=p}A(Xh,Wh);Xh.prototype.Fj=function(){var a=this.ic();this.mf=this.Pa.va(65,0);od(this.mf,a);this.mf.dh(this.r);a.g.Ej(this.mf.D)};Xh.prototype.Xh=function(a){var b=this.ga().va(67,0);b.Tb(a);a=Ag(b.g);od(a,Le(b));var c=Ha(0,80,0);a.g.setPosition(c);nd(b.Y.Ac,0);return b};Xh=Aa(Xh,"blk.game.fps.FpsServerController",{Fj:"setupSimulation",Xh:"createPlayer"});function Yh(){this.nm=this.ih=this.time=this.ig=0}Yh.prototype.lb=function(a,b,c,d){this.ig=a;this.time=b;this.ih=c;this.nm=d};function Zh(a){this.Me=a}Zh.prototype.yd=function(a){var b=[];$h(this,a,b);return b.join("")};
function $h(a,b,c){switch(typeof b){case "string":ai(b,c);break;case "number":c.push(isFinite(b)&&!isNaN(b)?b:"null");break;case "boolean":c.push(b);break;case "undefined":c.push("null");break;case "object":if(b==p){c.push("null");break}if(ka(b)){var d=b.length;c.push("[");for(var e="",f=0;f<d;f++)c.push(e),e=b[f],$h(a,a.Me?a.Me.call(b,String(f),e):e,c),e=",";c.push("]");break}c.push("{");d="";for(f in b)Object.prototype.hasOwnProperty.call(b,f)&&(e=b[f],"function"!=typeof e&&(c.push(d),ai(f,c),c.push(":"),
$h(a,a.Me?a.Me.call(b,f,e):e,c),d=","));c.push("}");break;case "function":break;default:g(Error("Unknown type: "+typeof b))}}var bi={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\x0B":"\\u000b"},ci=/\uffff/.test("\uffff")?/[\\\"\x00-\x1f\x7f-\uffff]/g:/[\\\"\x00-\x1f\x7f-\xff]/g;
function ai(a,b){b.push('"',a.replace(ci,function(a){if(a in bi)return bi[a];var b=a.charCodeAt(0),e="\\u";16>b?e+="000":256>b?e+="00":4096>b&&(e+="0");return bi[a]=e+b.toString(16)}),'"')};function di(){this.om=Hc();this.$d=this.nc=this.Ib=0;this.en=r}function Je(a){return(Hc()-a.om)/1E3};function ei(a,b){E.call(this);this.Fi=a;this.G=b||new di;this.Lf=[];this.Rm=p}A(ei,E);ei.prototype.b=function(){nb(this.Lf);this.Lf.length=0;ei.d.b.call(this)};ei.prototype.getTime=function(){return Je(this.G)+this.G.$d};function fi(){this.ih=this.time=this.ig=0;this.hasFocus=r}fi.prototype.lb=function(a,b,c,d){this.ig=a;this.time=b;this.ih=c;this.hasFocus=d};function gi(a,b,c,d){E.call(this);this.ib=new rg(this);J(this,this.ib);this.sh=a;this.Gf=this.zc=this.Vf=p;if(!b){if(a=v.requestAnimationFrame||v.webkitRequestAnimationFrame||v.mozRequestAnimationFrame||v.oRequestAnimationFrame||v.msRequestAnimationFrame)this.zc=a;if(a=v.cancelAnimationFrame||v.webkitCancelAnimationFrame||v.mozCancelAnimationFrame||v.oCancelAnimationFrame||v.msCancelAnimationFrame)this.Gf=a}this.Pb=0;this.lc=p;this.vg=0;this.Dc=m;this.hg=d||0;this.We=p;c&&(this.ib.listen(v,"blur",
function(){this.Dc=r}),this.ib.listen(v,"focus",function(){this.Dc||(this.Dc=m,this.Pb&&this.start(m))}))}A(gi,E);gi.prototype.b=function(){this.stop(m);this.Vf=p;gi.d.b.call(this)};gi.prototype.hasFocus=s("Dc");
gi.prototype.start=function(a){if(!a&&(this.Pb++,1<this.Pb))return;if(this.Dc){var b=this;this.lc=this.zc?this.zc.call(v,function(){hi(b)},this.Vf):v.setTimeout(function(){hi(b)},62.5)}this.sh(Hc());this.hg&&(b=this,this.We=v.setInterval(za(function(){var a=b;if(Hc()-a.vg>=a.hg&&a.Pb){var d=Hc();a.vg=d;a.sh(d)}},"gf.timing.RenderTimer#simulateTick"),this.hg))};
gi.prototype.stop=function(a){if(a||this.Pb)a||this.Pb--,this.Pb||(a=this.lc,this.Gf?this.Gf.call(v,a):this.zc||v.clearTimeout(a),this.lc=p,this.We!==p&&(v.clearInterval(this.We),this.We=p))};function hi(a){if(a.lc!==p){a.lc=p;a.Dc&&(a.lc=a.zc?a.zc.call(v,function(){hi(a)},a.Vf):v.setTimeout(function(){hi(a)},16));var b=Hc();a.vg=b;a.sh(b)}};function ii(a,b){ei.call(this,a,b);this.zk=new rg(this);J(this,this.zk);this.md=Je(this.G);this.Ek=m;this.Fk=ii.$j;this.Ec=0;this.vm=new fi;this.um=0;this.Zl=new Yh;this.Yl=0;var c=this;this.Le=new gi(function(a){c.jj(a)},j,j,500);J(this,this.Le);this.hh=r}A(ii,ei);ii.$j=0.016777;ii.Bh=0.25;t=ii.prototype;
t.jj=function(){var a=Je(this.G),b=a-this.md;this.md=a;b>ii.Bh&&(b=ii.Bh);this.Ec+=b;a=1;if(this.Ek){for(a=this.Fk;this.Ec>=a;){this.rh(this.G.Ib,a);var c=this.G;c.Ib+=a;this.Ec-=a;if(!this.hh)break}a=this.Ec/a}else this.rh(this.G.Ib,b),c=this.G,c.Ib+=b;this.Le.hasFocus()&&this.kj(Je(this.G)+this.G.$d,b,a)};t.rh=function(a,b){if(!(0>=b)){var c=this.vm;c.lb(this.um++,a,b,this.Le.hasFocus());this.update(c)}};t.kj=function(a,b,c){var d=this.Zl;d.lb(this.Yl++,a,b,c);this.yc(d)};t.update=x;t.yc=x;
ii=Aa(ii,"gf.Game",{jj:"renderTick_",rh:"update_",kj:"render_"});function ji(a,b){te.call(this,a);this.Wm=b||p}A(ji,te);ji.prototype.load=function(a){var b=new O(function(){a.cancel()},this);a.load(b);return b};function ki(a,b,c,d){E.call(this);this.method=a;this.url=b;this.content=c||p;this.headers=d?Lc(d):{}}A(ki,E);function li(a,b){this.statusCode=a;this.content=b||p};function mi(){E.call(this)}A(mi,E);t=mi.prototype;t.Yh=m;t.Gg=p;t.addEventListener=function(a,b,c,d){kg(this,a,b,c,d)};t.removeEventListener=function(a,b,c,d){mg(this,a,b,c,d)};
t.dispatchEvent=function(a){var b=a.type||a,c=hg;if(b in c){if(ma(a))a=new cg(a,this);else if(a instanceof cg)a.target=a.target||this;else{var d=a;a=new cg(b,this);Nc(a,d)}var d=1,e,c=c[b],b=m in c,f;if(b){e=[];for(f=this;f;f=f.Gg)e.push(f);f=c[m];f.qa=f.f;for(var h=e.length-1;!a.wc&&0<=h&&f.qa;h--)a.currentTarget=e[h],d&=pg(f,e[h],a.type,m,a)&&a.Oe!=r}if(r in c)if(f=c[r],f.qa=f.f,b)for(h=0;!a.wc&&h<e.length&&f.qa;h++)a.currentTarget=e[h],d&=pg(f,e[h],a.type,r,a)&&a.Oe!=r;else for(e=this;!a.wc&&e&&
f.qa;e=e.Gg)a.currentTarget=e,d&=pg(f,e,a.type,r,a)&&a.Oe!=r;a=Boolean(d)}else a=m;return a};t.b=function(){mi.d.b.call(this);var a=0;if(this!=p){var b=qa(this);if(ig[b])for(var b=ig[b],c=b.length-1;0<=c;c--)ng(b[c].key),a++}else Ic(gg,function(b,c){ng(c);a++});this.Gg=p};var ni=v.window;var oi="StopIteration"in v?v.StopIteration:Error("StopIteration");function pi(){}pi.prototype.next=function(){g(oi)};pi.prototype.sf=function(){return this};function qi(a){if(a instanceof pi)return a;if("function"==typeof a.sf)return a.sf(r);if(la(a)){var b=0,c=new pi;c.next=function(){for(;;){b>=a.length&&g(oi);if(b in a)return a[b++];b++}};return c}g(Error("Not implemented"))};function ri(a,b){this.r={};this.C=[];var c=arguments.length;if(1<c){c%2&&g(Error("Uneven number of arguments"));for(var d=0;d<c;d+=2)this.set(arguments[d],arguments[d+1])}else if(a){a instanceof ri?(c=a.Ka(),d=a.za()):(c=Kc(a),d=Jc(a));for(var e=0;e<c.length;e++)this.set(c[e],d[e])}}t=ri.prototype;t.f=0;t.Ed=0;t.fa=s("f");t.za=function(){si(this);for(var a=[],b=0;b<this.C.length;b++)a.push(this.r[this.C[b]]);return a};t.Ka=function(){si(this);return this.C.concat()};
t.Cb=function(a){return ti(this.r,a)};t.clear=function(){this.r={};this.Ed=this.f=this.C.length=0};t.remove=function(a){return ti(this.r,a)?(delete this.r[a],this.f--,this.Ed++,this.C.length>2*this.f&&si(this),m):r};function si(a){if(a.f!=a.C.length){for(var b=0,c=0;b<a.C.length;){var d=a.C[b];ti(a.r,d)&&(a.C[c++]=d);b++}a.C.length=c}if(a.f!=a.C.length){for(var e={},c=b=0;b<a.C.length;)d=a.C[b],ti(e,d)||(a.C[c++]=d,e[d]=1),b++;a.C.length=c}}t.get=function(a,b){return ti(this.r,a)?this.r[a]:b};
t.set=function(a,b){ti(this.r,a)||(this.f++,this.C.push(a),this.Ed++);this.r[a]=b};t.w=function(){return new ri(this)};t.sf=function(a){si(this);var b=0,c=this.C,d=this.r,e=this.Ed,f=this,h=new pi;h.next=function(){for(;;){e!=f.Ed&&g(Error("The map has changed since the iterator was created"));b>=c.length&&g(oi);var h=c[b++];return a?h:d[h]}};return h};function ti(a,b){return Object.prototype.hasOwnProperty.call(a,b)};function ui(a){return vi(a||arguments.callee.caller,[])}
function vi(a,b){var c=[];if(0<=Bb(b,a))c.push("[...circular reference...]");else if(a&&50>b.length){c.push(wi(a)+"(");for(var d=a.arguments,e=0;e<d.length;e++){0<e&&c.push(", ");var f;f=d[e];switch(typeof f){case "object":f=f?"object":"null";break;case "string":break;case "number":f=String(f);break;case "boolean":f=f?"true":"false";break;case "function":f=(f=wi(f))?f:"[fn]";break;default:f=typeof f}40<f.length&&(f=f.substr(0,40)+"...");c.push(f)}b.push(a);c.push(")\n");try{c.push(vi(a.caller,b))}catch(h){c.push("[exception trying to get caller]\n")}}else a?
c.push("[...long stack...]"):c.push("[end]");return c.join("")}function wi(a){if(xi[a])return xi[a];a=String(a);if(!xi[a]){var b=/function ([^\(]+)/.exec(a);xi[a]=b?b[1]:"[Anonymous]"}return xi[a]}var xi={};function yi(a,b,c,d,e){this.reset(a,b,c,d,e)}yi.prototype.em=0;yi.prototype.fi=p;yi.prototype.ei=p;var zi=0;yi.prototype.reset=function(a,b,c,d,e){this.em="number"==typeof e?e:zi++;this.$e=d||z();this.nd=a;this.Gl=b;this.hn=c;delete this.fi;delete this.ei};yi.prototype.yj=ba("nd");function Ai(a){this.Ni=a}Ai.prototype.P=p;Ai.prototype.nd=p;Ai.prototype.J=p;Ai.prototype.dd=p;function Bi(a,b){this.name=a;this.value=b}Bi.prototype.toString=s("name");var Ci=new Bi("SEVERE",1E3),Di=new Bi("WARNING",900),Ei=new Bi("INFO",800),Fi=new Bi("CONFIG",700),Gi=new Bi("FINE",500);t=Ai.prototype;t.getName=s("Ni");t.getParent=s("P");t.yj=ba("nd");function Hi(a){return a.nd?a.nd:a.P?Hi(a.P):p}
t.log=function(a,b,c){if(a.value>=Hi(this).value){a=this.Tk(a,b,c);b="log:"+a.Gl;v.console&&(v.console.timeStamp?v.console.timeStamp(b):v.console.markTimeline&&v.console.markTimeline(b));v.msWriteProfilerMark&&v.msWriteProfilerMark(b);for(b=this;b;){c=b;var d=a;if(c.dd)for(var e=0,f=j;f=c.dd[e];e++)f(d);b=b.getParent()}}};
t.Tk=function(a,b,c){var d=new yi(a,String(b),this.Ni);if(c){d.fi=c;var e;var f=arguments.callee.caller;try{var h;var k=ha("window.location.href");if(ma(c))h={message:c,name:"Unknown error",lineNumber:"Not available",fileName:k,stack:"Not available"};else{var i,l,n=r;try{i=c.lineNumber||c.fn||"Not available"}catch(q){i="Not available",n=m}try{l=c.fileName||c.filename||c.sourceURL||k}catch(u){l="Not available",n=m}h=n||!c.lineNumber||!c.fileName||!c.stack?{message:c.message,name:c.name,lineNumber:i,
fileName:l,stack:c.stack||"Not available"}:c}e="Message: "+rb(h.message)+'\nUrl: <a href="view-source:'+h.fileName+'" target="_new">'+h.fileName+"</a>\nLine: "+h.lineNumber+"\n\nBrowser stack:\n"+rb(h.stack+"-> ")+"[end]\n\nJS stack traversal:\n"+rb(ui(f)+"-> ")}catch(w){e="Exception trying to expose exception! You win, we lose. "+w}d.ei=e}return d};t.info=function(a,b){this.log(Ei,a,b)};function Ii(a,b){a.log(Gi,b,j)}t.tf=function(a,b){this.J||(this.J={});this.J[a]=b};var Ji={},Ki=p;
function Li(a){Ki||(Ki=new Ai(""),Ji[""]=Ki,Ki.yj(Fi));var b;if(!(b=Ji[a])){b=new Ai(a);var c=a.lastIndexOf("."),d=a.substr(c+1),c=Li(a.substr(0,c));c.tf(d,b);b.P=c;Ji[a]=b}return b};function Mi(){}Mi.prototype.Oh=p;function Ni(a){var b;if(!(b=a.Oh))b={},Oi(a)&&(b[0]=m,b[1]=m),b=a.Oh=b;return b};var Pi;function Qi(){}A(Qi,Mi);Qi.prototype.ee=function(){var a=Oi(this);return a?new ActiveXObject(a):new XMLHttpRequest};
function Oi(a){if(!a.ui&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var b=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],c=0;c<b.length;c++){var d=b[c];try{return new ActiveXObject(d),a.ui=d}catch(e){}}g(Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed"))}return a.ui}Pi=new Qi;var Ri=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#(.*))?$");function Si(a){E.call(this);this.headers=new ri;this.qf=a||p}A(Si,mi);Si.prototype.V=Li("goog.net.XhrIo");var Ti=/^https?$/i;t=Si.prototype;t.Za=r;t.u=p;t.pf=p;t.xe="";t.Di="";t.jd=0;t.kd="";t.$f=r;t.te=r;t.qg=r;t.Lb=r;t.Bd=0;t.Ub=p;t.mj="";t.Am=r;
t.send=function(a,b,c,d){this.u&&g(Error("[goog.net.XhrIo] Object is active with another request="+this.xe+"; newUri="+a));b=b?b.toUpperCase():"GET";this.xe=a;this.kd="";this.jd=0;this.Di=b;this.$f=r;this.Za=m;this.u=this.qf?this.qf.ee():Pi.ee();this.pf=this.qf?Ni(this.qf):Ni(Pi);this.u.onreadystatechange=y(this.Ti,this);try{Ii(this.V,Ui(this,"Opening Xhr")),this.qg=m,this.u.open(b,a,m),this.qg=r}catch(e){Ii(this.V,Ui(this,"Error opening Xhr: "+e.message));Vi(this,e);return}a=c||"";var f=this.headers.w();
d&&Pc(d,function(a,b){f.set(b,a)});d=v.FormData&&a instanceof v.FormData;"POST"==b&&(!f.Cb("Content-Type")&&!d)&&f.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");Pc(f,function(a,b){this.u.setRequestHeader(b,a)},this);this.mj&&(this.u.responseType=this.mj);"withCredentials"in this.u&&(this.u.withCredentials=this.Am);try{this.Ub&&(ni.clearTimeout(this.Ub),this.Ub=p),0<this.Bd&&(Ii(this.V,Ui(this,"Will abort after "+this.Bd+"ms if incomplete")),this.Ub=ni.setTimeout(y(this.pm,
this),this.Bd)),Ii(this.V,Ui(this,"Sending request")),this.te=m,this.u.send(a),this.te=r}catch(h){Ii(this.V,Ui(this,"Send error: "+h.message)),Vi(this,h)}};t.pm=function(){"undefined"!=typeof da&&this.u&&(this.kd="Timed out after "+this.Bd+"ms, aborting",this.jd=8,Ii(this.V,Ui(this,this.kd)),this.dispatchEvent("timeout"),this.abort(8))};function Vi(a,b){a.Za=r;a.u&&(a.Lb=m,a.u.abort(),a.Lb=r);a.kd=b;a.jd=5;Wi(a);Xi(a)}
function Wi(a){a.$f||(a.$f=m,a.dispatchEvent("complete"),a.dispatchEvent("error"))}t.abort=function(a){this.u&&this.Za&&(Ii(this.V,Ui(this,"Aborting")),this.Za=r,this.Lb=m,this.u.abort(),this.Lb=r,this.jd=a||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Xi(this))};t.b=function(){this.u&&(this.Za&&(this.Za=r,this.Lb=m,this.u.abort(),this.Lb=r),Xi(this,m));Si.d.b.call(this)};t.Ti=function(){!this.qg&&!this.te&&!this.Lb?this.Ll():Yi(this)};t.Ll=function(){Yi(this)};
function Yi(a){if(a.Za&&"undefined"!=typeof da)if(a.pf[1]&&4==a.Kb()&&2==Zi(a))Ii(a.V,Ui(a,"Local request error detected and ignored"));else if(a.te&&4==a.Kb())ni.setTimeout(y(a.Ti,a),0);else if(a.dispatchEvent("readystatechange"),4==a.Kb()){Ii(a.V,Ui(a,"Request complete"));a.Za=r;try{if($i(a))a.dispatchEvent("complete"),a.dispatchEvent("success");else{a.jd=6;var b;try{b=2<a.Kb()?a.u.statusText:""}catch(c){Ii(a.V,"Can not get status: "+c.message),b=""}a.kd=b+" ["+Zi(a)+"]";Wi(a)}}finally{Xi(a)}}}
function Xi(a,b){if(a.u){var c=a.u,d=a.pf[0]?x:p;a.u=p;a.pf=p;a.Ub&&(ni.clearTimeout(a.Ub),a.Ub=p);b||a.dispatchEvent("ready");try{c.onreadystatechange=d}catch(e){a.V.log(Ci,"Problem encountered resetting onreadystatechange: "+e.message,j)}}}
function $i(a){var b=Zi(a),c;a:switch(b){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:c=m;break a;default:c=r}if(!c){if(b=0===b)a=String(a.xe).match(Ri)[1]||p,!a&&self.location&&(a=self.location.protocol,a=a.substr(0,a.length-1)),b=!Ti.test(a?a.toLowerCase():"");c=b}return c}t.Kb=function(){return this.u?this.u.readyState:0};function Zi(a){try{return 2<a.Kb()?a.u.status:-1}catch(b){return a.V.log(Di,"Can not get status: "+b.message,j),-1}}
function Ui(a,b){return b+" ["+a.Di+" "+a.xe+" "+Zi(a)+"]"};function aj(a,b,c,d){ki.call(this,a,b,c,d)}A(aj,ki);function bj(a,b,c,d){a=new aj(a,b,c,d);var e=new O,f=new Si;f.Bd=Math.max(0,2E4);var h=kg(f,"complete",function(){var a=Zi(f),b;try{b=f.u?f.u.responseText:""}catch(c){Ii(f.V,"Can not get responseText: "+c.message),b=""}a=new li(a,b);ng(h);K(f);$i(f)?e.e(a):e.a(a)});f.send(a.url,a.method,a.content,a.headers);return e};function cj(a,b,c){E.call(this);this.Pm=a;this.Zg=a+"api/server/"+b;this.og={"X-GF-Version":"1","X-GF-Server-ID":b,"X-GF-Server-Key":c}}A(cj,E);function dj(a,b,c){ii.call(this,a,b.G);this.Jc=new ji(this);J(this,this.Jc);this.Lf.push(this.Jc);this.ac=new Xh(this,b,c);J(this,this.ac);this.cb=p;1==b.type&&(a.Ef&&a.rj&&a.tj)&&(this.cb=new cj(a.Ef,a.rj,a.tj),J(this,this.cb));this.Sd=p}A(dj,ii);t=dj.prototype;t.b=function(){this.Sd&&(v.clearTimeout(this.Sd),this.Sd=p);if(this.cb){var a=this.cb;bj("DELETE",a.Zg,j,a.og)}dj.d.b.call(this)};
t.Rj=function(){if(this.cb){for(var a=this.ac.Ea,b=[],c=0;c<a.h.length;c++)b.push(a.h[c].info);for(var a=this.cb,c=[],d=0;d<b.length;d++)c.push({display_name:b[d].ya});b=(new Zh(j)).yd({user_count:c.length,users:c});b=bj("POST",a.Zg,b,a.og);a=function(){this.Sd=v.setTimeout(y(this.Rj,this),5E3)};P(b,a,a,this)}};
t.load=function(){if(this.cb){var a=this.Fi,b;b=this.cb;var c=this.ac.Ea.sj,d=[],e;for(e in c.Nb)d.push(e+"="+c.Nb[e]);c=(new Zh(j)).yd({endpoint:c.Ta,server_name:c.name,server_location:c.location,game_type:c.Zc,game_version:c.$c,game_properties:d,user_max:c.oc});b=bj("PUT",b.Zg,c,b.og);P(b,function(){M("Registered with server browser at "+a.Ef);this.Rj()},function(a){M("Unable to register with server browser: ",a)},this)}return this.ac.load()};t.update=function(a){this.ac.update(a)};t.yc=function(a){this.ac.yc(a)};
dj=Aa(dj,"blk.game.server.ServerGame",{update:"update",yc:"render"});function ej(){this.version=0};function fj(){E.call(this);this.pa=[];this.Ng=[];this.yg=r;this.se=0;this.rc=m;this.Qh=new Pf}A(fj,E);fj.ek=8;fj.prototype.update=function(){this.ob();for(var a=Hc();this.Ng.length&&!(Hc()-a>fj.ek);){var b=this.Ng.shift(),c=b.Ck,d=b.error,b=b.data,e;if(e=!d)if(e=b)if(e=c.Nc){e=this.Qh;var f=c.Nc,h=b,k=ff();k.ka(h,0);e=e.$h(f,k)}e?(c.Nc.ub=b,c.la.e(p)):c.la.a(d)}};function gj(a,b,c,d){hj(a,b);a=new ej;!c&&d?b.la.e(a):b.la.a(c)}function ij(a,b,c){hj(a,b);c?b.la.a(c):b.la.e(p)}
function jj(a,b,c,d){hj(a,b);a.Ng.push({Ck:b,error:c,data:d})}function hd(a,b){var c=new O,d=new Vc(c,kj,b.x,b.y,b.l);d.version=b.version;b.ub?d.data=b.ub:(d.data=a.Qh.yd(b),b.ub=d.data);d.data?(a.pa.push(d),a.rc||a.ob()):c.a(p);return c}function lj(a,b,c){hj(a,b);c?b.la.a(c):b.la.e(p)}function mj(a,b,c){hj(a,b);c?b.la.a(c):b.la.e(p)}fj.prototype.ob=function(){if(!this.rc){!this.se&&this.yg&&(this.yg=r,this.lj());for(;1>this.se&&this.pa.length;){var a=this.pa[0];this.se++;this.Pg(a)}}};
fj.prototype.lj=function(){for(var a=this.pa.length-1,b=0;b<this.pa.length;b++)if(this.pa[b].uc==Number.MAX_VALUE){a=b-1;break}if(a)if(a==this.pa.length-1)Kb(this.pa,nj);else{a=this.pa.slice(0,a);Kb(a,nj);for(b=0;b<a.length;b++)this.pa[b]=a[b]}};function hj(a,b){a.se--;Hb(a.pa,b);a.ob()}var Wc=2,kj=3;function Vc(a,b,c,d,e){this.la=a;this.action=b;this.x=c;this.y=d;this.l=e;this.Nc=p;this.uc=Number.MAX_VALUE;this.version=0;this.data=p}function nj(a,b){return a.uc-b.uc}
fj=Aa(fj,"blk.io.MapStore",{update:"update",ob:"pump_",lj:"resortQueue_"});function oj(a,b,c,d,e,f){E.call(this);this.x=a;this.y=b;this.l=c;this.key=d;this.fg=e;this.bn=f;this.sg=z();this.aj=r;this.aa=new Uint32Array(1024);this.L=[m];this.S=this.m=p}A(oj,E);function pj(a,b){return b.sg-a.sg}oj.prototype.b=function(){K(this.m);K(this.S);oj.d.b.call(this)};oj.prototype.gc=function(a,b,c){return 32*(c>>4&31)+(a>>4&31)};oj.prototype.Hd=function(a,b){var c=Array.prototype.slice.call(arguments,1);c.unshift(4096*a);return this.S.write.apply(this.S,c)};function qj(a,b){E.call(this);this.Cl=a;this.Ud={};this.q=[];this.am=b}A(qj,E);qj.prototype.b=function(){this.clear();qj.d.b.call(this)};
qj.prototype.get=function(a,b,c){var d=a>>9,e=c>>9,f=[d,0,e,"blkregion"].join("."),h=new O;(a=this.Ud[f])?(a.sg=z(),h.e(a)):P(this.am.getFile(f,2),function(a){if(this.q.length>=this.Cl&&this.q.length){Kb(this.q,pj);var b=this.q[this.q.length-1];delete this.Ud[b.key];K(b);this.q.length--}var c=new oj(d<<9,0,e<<9,f,a,0);this.Ud[f]=c;this.q.push(c);var n=new O;a=[c.fg.createReader(),c.fg.createWriter()];a=new fd(a,r,m);P(a,function(a){return Eb(a,function(a){return a[1]})},p,j);P(a,function(a){this.m=
a[0];this.S=a[1];this.m.jb()?P(this.m.read(0,4096,this.aa.buffer),function(a){a!=this.aa.buffer&&(this.aa=new Uint32Array(a));a=this.S.jb()/4096;this.L.length=a;this.L[0]=m;for(a=1;a<this.L.length;a++)this.L[a]=r;for(a=0;a<this.aa.length;a++){var b=this.aa[a],c=b>>8,b=b&255;if(c)for(var d=0;d<b;d++)this.L[c+d]=m}this.aj=m;n.e(p)},function(a){n.a(a)},this):P(this.Hd(0,this.aa.buffer),function(){this.aj=m;n.e(p)},function(a){n.a(a)},this)},function(a){n.a(a)},c);P(n,function(){h.e(c)},function(a){h.a(a)},
this)},function(a){h.a(a)},this);return h};qj.prototype.clear=function(){Cb(this.q,K);this.q.length=0;this.Ud={}};function rj(a,b){E.call(this);this.type=a;this.size=b}A(rj,E);function sj(a,b){ob.call(this,b+": "+tj(a));this.code=a;this.action=b}A(sj,ob);
function tj(a){switch(a){case 1:return"File or directory not found";case 2:return"Insecure or disallowed operation";case 3:return"Operation aborted";case 4:return"File or directory not readable";case 5:return"Invalid encoding";case 6:return"Cannot modify file or directory";case 7:return"Invalid state";case 8:return"Invalid line-ending specifier";case 9:return"Invalid modification";case 10:return"Quota exceeded";case 11:return"Invalid filetype";case 12:return"File or directory already exists at specified path";
default:return"Unknown error"}};function uj(a,b){return new sj(a?a.code:0,b)};function vj(a,b){ob.call(this,pb("Error %s: %s",b,wj(a)));this.code=a}A(vj,ob);
function wj(a){switch(a){case 1:return"File or directory not found";case 2:return"Insecure or disallowed operation";case 3:return"Operation aborted";case 4:return"File or directory not readable";case 5:return"Invalid encoding";case 6:return"Cannot modify file or directory";case 7:return"Invalid state";case 8:return"Invalid line-ending specifier";case 9:return"Invalid modification";case 10:return"Quota exceeded";case 11:return"Invalid filetype";case 12:return"File or directory already exists at specified path";
default:return"Unrecognized error"}};function xj(a,b){cg.call(this,a.type,b);this.cg=a}A(xj,cg);function yj(){E.call(this);this.m=new FileReader;this.m.onloadstart=y(this.ba,this);this.m.onprogress=y(this.ba,this);this.m.onload=y(this.ba,this);this.m.onabort=y(this.ba,this);this.m.onerror=y(this.ba,this);this.m.onloadend=y(this.ba,this)}A(yj,mi);t=yj.prototype;t.abort=function(){try{this.m.abort()}catch(a){g(new vj(a.code,"aborting read"))}};t.Kb=function(){return this.m.readyState};t.getError=function(){return this.m.error&&new vj(this.m.error.code,"reading file")};
t.ba=function(a){this.dispatchEvent(new xj(a,this))};t.b=function(){yj.d.b.call(this);delete this.m};t.readAsArrayBuffer=function(a){this.m.readAsArrayBuffer(a)};function zj(a,b){E.call(this);this.Hi=b;this.Hb=[];a>this.Hi&&g(Error("[goog.structs.SimplePool] Initial cannot be greater than max"));for(var c=0;c<a;c++)this.Hb.push(this.Rc())}A(zj,E);t=zj.prototype;t.Pf=p;t.bi=p;function Aj(a,b){a.Hb.length<a.Hi?a.Hb.push(b):a.Wf(b)}t.Rc=function(){return this.Pf?this.Pf():{}};t.Wf=function(a){if(this.bi)this.bi(a);else if(oa(a))if(na(a.Uc))a.Uc();else for(var b in a)delete a[b]};t.b=function(){zj.d.b.call(this);for(var a=this.Hb;a.length;)this.Wf(a.pop());delete this.Hb};function Bj(a){E.call(this);this.zb=a;this.nb=new zj(0,5);J(this,this.nb);a=y(function(){return new Cj(this.nb)},this);this.nb.Pf=a}A(Bj,E);Bj.prototype.jb=function(){return this.zb.size};Bj.prototype.read=function(a,b){var c=this.zb.size,d=a||0;if(d>=c)return c=new O,c.a(new sj(7,"read file")),c;var e=d+(fa(b)?b:c);e>c&&(e=c);var e=e||0,f=p;0==d&&e==c?f=this.zb:this.zb.slice?f=this.zb.slice(d,e):this.zb.webkitSlice&&(f=this.zb.webkitSlice(d,e));return(this.nb.Hb.length?this.nb.Hb.pop():this.nb.Rc()).ka(f)};
function Cj(a){rg.call(this,this);this.nb=a;this.Rf=p;this.m=new yj;J(this,this.m);this.listen(this.m,"loadend",this.uk)}A(Cj,rg);Cj.prototype.ka=function(a){var b=new O(this.pk,this);this.Rf=b;this.m.readAsArrayBuffer(a);return b};Cj.prototype.pk=function(){this.m.abort()};Cj.prototype.uk=function(){var a=this.Rf;if(a){this.Rf=p;var b=this.m.m.result,c=this.m.getError();Aj(this.nb,this);b?a.e(b):a.a(uj(c,"read"))}};function Dj(a){E.call(this);this.Ca=a;this.Ca.onwritestart=y(this.ba,this);this.Ca.onprogress=y(this.ba,this);this.Ca.onwrite=y(this.ba,this);this.Ca.onabort=y(this.ba,this);this.Ca.onerror=y(this.ba,this);this.Ca.onwriteend=y(this.ba,this)}A(Dj,mi);t=Dj.prototype;t.abort=function(){try{this.Ca.abort()}catch(a){g(new vj(a.code,"aborting save"))}};t.Kb=function(){return this.Ca.readyState};t.getError=function(){return this.Ca.error&&new vj(this.Ca.error.code,"saving file")};
t.ba=function(a){this.dispatchEvent(new xj(a,this))};t.b=function(){delete this.Ca;Dj.d.b.call(this)};function Ej(a){E.call(this);this.oa=a;J(this,this.oa);this.Ra=this.Z=p;this.ib=new rg(this);J(this,this.ib);this.ib.listen(this.oa,"writeend",function(){if(this.Z){var a=this.Z;this.Ra=this.Z=p;a.e(p)}});this.ib.listen(this.oa,"error",function(){if(this.Z&&this.Ra){var a=this.Z,c=new sj(2,this.Ra);this.Ra=this.Z=p;a.a(c)}});this.ib.listen(this.oa,"abort",function(){if(this.Z&&this.Ra){var a=this.Z,c=new sj(3,this.Ra);this.Ra=this.Z=p;a.a(c)}})}A(Ej,E);Ej.prototype.jb=function(){return this.oa.jb()};
Ej.prototype.bh=function(a){var b=new O;this.Z?b.a(new sj(7,"overlapped set length")):a==this.jb()?b.e(p):(this.Z=b,this.Ra="set length",this.oa.truncate(a));return b};
Ej.prototype.write=function(a,b){var c=new O;if(this.Z)return c.a(new sj(7,"overlapped write")),c;for(var d=Array.prototype.slice.call(arguments,1),e=0;e<d.length;e++)d[e]instanceof ArrayBuffer&&(d[e]=new Uint8Array(d[e]));var f=new Blob(d);a>this.jb()?P(this.bh(a+f.size),function(){this.Z=c;this.Ra="write";this.oa.seek(a);this.oa.write(f)},function(a){c.a(a)},this):(this.Z=c,this.Ra="write",this.oa.seek(a),this.oa.write(f));return c};function Fj(a,b){this.gg=a;this.fullPath=b.da.fullPath;this.name=b.getName();this.type=b.isFile()?0:1;this.oa=b}Fj.prototype.isFile=function(){return 0==this.type};Fj.prototype.remove=function(){var a=new O;P(this.oa.remove(),function(){a.e(p)},function(b){a.a(uj(b,"remove "+this.fullPath))},this);return a};function Gj(a,b){return b.isFile()?new Hj(a.gg,b):new Ij(a.gg,b)}function Hj(a,b){Fj.call(this,a,b);this.gi=b}A(Hj,Fj);
Hj.prototype.createReader=function(){var a=new O;P(this.gi.file(),function(b){a.e(new Bj(b))},function(b){a.a(uj(b,"create reader "+this.fullPath))},this);return a};Hj.prototype.createWriter=function(){var a=new O;P(this.gi.createWriter(),function(b){a.e(new Ej(b))},function(b){a.a(uj(b,"create writer "+this.fullPath))},this);return a};Hj.prototype.read=function(){var a=new O;P(this.createReader(),function(b){P(b.read(),function(c){K(b);a.e(c)},function(c){K(b);a.a(c)})},function(b){a.a(b)});return a};
Hj.prototype.write=function(a){var b=new O;P(this.createWriter(),function(c){P(c.bh(0),function(){P(c.write(a),function(){K(c);b.e(p)},function(a){K(c);b.a(a)})},function(a){K(c);b.a(a)})},function(a){b.a(a)});return b};function Ij(a,b){Fj.call(this,a,b);this.Sf=b}A(Ij,Fj);Ij.prototype.getFile=function(a,b){var c=new O;P(this.Sf.getFile(a,b),function(a){c.e(Gj(this,a))},function(b){c.a(uj(b,"get file "+a+" in "+this.fullPath))},this);return c};
Ij.prototype.getDirectory=function(a,b){var c=new O;P(this.Sf.getDirectory(a,b),function(a){c.e(Gj(this,a))},function(b){c.a(uj(b,"get directory "+a+" in "+this.fullPath))},this);return c};Ij.prototype.Sc=function(a){var b=new O;P(this.Sf.Sc(a),function(a){b.e(Gj(this,a))},function(c){b.a(uj(c,"create path "+a+" in "+this.fullPath))},this);return b};function Jj(a){Dj.call(this,a);this.S=a}A(Jj,Dj);t=Jj.prototype;t.bd=function(){return this.S.position};t.jb=function(){return this.S.length};t.write=function(a){try{this.S.write(a)}catch(b){g(new vj(b.code,"writing file"))}};t.seek=function(a){try{this.S.seek(a)}catch(b){g(new vj(b.code,"seeking in file"))}};t.truncate=function(a){try{this.S.truncate(a)}catch(b){g(new vj(b.code,"truncating file"))}};function Kj(a){return a};function Lj(a,b){this.Ua=a;this.da=b}Lj.prototype.isFile=function(){return this.da.isFile};Lj.prototype.getName=function(){return this.da.name};Lj.prototype.remove=function(){var a=new O;this.da.remove(y(a.e,a,m),y(function(b){a.a(new vj(b.code,"removing "+this.da.fullPath))},this));return a};Lj.prototype.getParent=function(){var a=new O;this.da.getParent(y(function(b){a.e(new Mj(this.Ua,b))},this),y(function(b){a.a(new vj(b.code,"getting parent of "+this.da.fullPath))},this));return a};
function Mj(a,b){Lj.call(this,a,b);this.ai=b}A(Mj,Lj);var Nj=2;Mj.prototype.getFile=function(a,b){var c=new O;this.ai.getFile(a,Oj(b),y(function(a){c.e(new Pj(this.Ua,a))},this),y(function(b){c.a(new vj(b.code,"loading file "+a+" from "+this.da.fullPath))},this));return c};Mj.prototype.getDirectory=function(a,b){var c=new O;this.ai.getDirectory(a,Oj(b),y(function(a){c.e(new Mj(this.Ua,a))},this),y(function(b){c.a(new vj(b.code,"loading directory "+a+" from "+this.da.fullPath))},this));return c};
Mj.prototype.Sc=function(a){function b(a){if(!d.length)return dd(a);var c=d.shift();a=".."==c?a.getParent():"."==c?dd(a):a.getDirectory(c,Nj);return P(a,b,p,j)}if(0==a.lastIndexOf("/",0)){var c=this.Ua.ic();if(this.da.fullPath!=c.da.fullPath)return c.Sc(a)}var d=Db(a.split("/"),Kj);return b(this)};function Oj(a){return a==Nj?{create:m}:3==a?{create:m,exclusive:m}:{}}function Pj(a,b){Lj.call(this,a,b);this.hi=b}A(Pj,Lj);
Pj.prototype.createWriter=function(){var a=new O;this.hi.createWriter(function(b){a.e(new Jj(b))},y(function(b){a.a(new vj(b.code,"creating writer for "+this.da.fullPath))},this));return a};Pj.prototype.file=function(){var a=new O;this.hi.file(function(b){a.e(b)},y(function(b){a.a(new vj(b.code,"getting file for "+this.da.fullPath))},this));return a};function Qj(a){this.Ua=a}Qj.prototype.getName=function(){return this.Ua.name};Qj.prototype.ic=function(){return new Mj(this,this.Ua.root)};function Rj(a,b,c){rj.call(this,a,b);this.pl=c}A(Rj,rj);Rj.prototype.ic=function(){return new Ij(this,this.pl.ic())};function Sj(a){fj.call(this);this.Af=a;this.vd=this.rb=this.Ua=p}A(Sj,fj);
Sj.prototype.Tb=function(){var a=new O,b=new O,c=p;if(c=v.requestFileSystem||v.webkitRequestFileSystem,na(c)){var d=new O;c(1,1073741824,function(a){d.e(new Qj(a))},function(a){d.a(new vj(a.code,"requesting filesystem"))});c=d}else c=ed(Error("File API unsupported"));c?P(c,function(a){b.e(new Rj(1,1073741824,a))},function(a){b.a(uj(a,"requesting filesystem"))}):b.a(p);P(b,function(b){this.Ua=b;P(b.ic().Sc(this.Af),function(b){this.rb=b;P(this.rb.Sc("regions"),function(b){this.vd=new qj(256,b);J(this,
this.vd);this.rc=r;this.ob();a.e(p)},function(b){a.a(b)},this)},function(b){a.a(b)},this)},function(b){a.a(b)},this);return a};
Sj.prototype.Pg=function(a){switch(a.action){case 0:P(this.rb.getFile("info.bin"),function(b){P(b.read(),function(b){gj(this,a,p,b)},function(b){gj(this,a,b,p)},this)},function(b){gj(this,a,b,p)},this);break;case 1:P(this.rb.getFile("info.bin"),function(b){P(b.write(a.data),function(){ij(this,a,p)},function(b){ij(this,a,b)},this)},function(b){ij(this,a,b)},this);break;case Wc:P(this.vd.get(a.x,a.y,a.l),function(b){var c=new O,d=b.aa[b.gc(a.x,a.y,a.l)],e=4096*(d&255);e?P(b.m.read(4096*(d>>8),e),function(a){c.e(a)},
function(a){c.a(a)},b):c.e(p);P(c,function(b){jj(this,a,p,b)},function(b){jj(this,a,b,p)},this)},function(b){jj(this,a,b,p)},this);break;case kj:P(this.vd.get(a.x,a.y,a.l),function(b){var c=a.data,d=new O,e=b.gc(a.x,a.y,a.l),f=b.aa[e],h=f>>8,k=f&255,i=Math.ceil(c.byteLength/4096);if(255<i)d.a(p);else if(h&&k==i)P(b.Hd(h,c),function(){d.e()},function(a){d.a(a)});else{if(h)for(var l=0;l<k;l++)b.L[h+l]=r;var n=new O,k=b.L.indexOf(r),l=0;if(1<i&&-1!=k)for(h=k;h<b.L.length&&!(l?b.L[h]?l=0:l++:b.L[h]||
(k=h,l=1),l>=i);h++);if(l>=i){for(h=0;h<i;h++)b.L[k+h]=m;n.e(k)}else{var q=Math.max(i,32),h=b.S.jb()+4096*q;P(b.S.bh(h),function(){var a=this.L.length;this.L.length+=q;for(var b=0;b<q;b++)this.L[a+b]=r;for(b=0;b<i;b++)this.L[a+b]=m;K(this.m);this.m=p;P(this.fg.createReader(),function(b){this.m=b;n.e(a)},function(a){n.a(a)},this)},function(a){n.a(a)},b)}P(n,function(a){f=a<<8|i;this.aa[e]=f;P(this.Hd(a,c),function(){P(this.Hd(0,this.aa.buffer),function(){d.e()},function(a){d.a(a)})},function(a){d.a(a)},
this)},function(a){d.a(a)},b)}P(d,function(){lj(this,a,p)},function(b){lj(this,a,b)},this)},function(b){lj(this,a,b)},this);break;case 4:P(this.vd.get(a.x,a.y,a.l),function(b){var c=b.gc(a.x,a.y,a.l),d=b.aa[c],e=d>>8,d=d&255;if(e){for(var f=0;f<d;f++)b.L[e+f]=r;b.aa[c]=0;b=b.Hd(0,b.aa.buffer)}else b=dd(p);P(b,function(){mj(this,a,p)},function(b){mj(this,a,b)},this)},function(b){mj(this,a,b)},this)}};function Tj(a){fj.call(this);this.Af=a;this.Ia=p}A(Tj,fj);var Uj=v.indexedDB||v.mozIndexedDB||v.webkitIndexedDB||v.msIndexedDB;Tj.prototype.Tb=function(){if(!Uj)return ed(p);var a=new O,b=Uj.open(this.Af,2);b.onerror=function(){a.a(p)};b.onsuccess=y(function(){this.Ia=b.result;this.Ia.onerror=function(a){M("idb error: "+a)};this.rc=r;this.ob();a.e(p)},this);b.onupgradeneeded=function(a){a=a.target.result;a.createObjectStore("info");a.createObjectStore("chunks")};return a};
Tj.prototype.b=function(){this.Ia&&(this.Ia.close(),this.Ia=p);Tj.d.b.call(this)};Tj.prototype.Jb=function(a){return[a.x,a.y,a.l].join(".")};
Tj.prototype.Pg=function(a){switch(a.action){case 0:var b=this.Ia.transaction(["info"],"readonly").objectStore("info").get("info");b.onsuccess=y(function(){gj(this,a,p,b.result)},this);b.onerror=y(function(b){b.preventDefault();gj(this,a,b,p)},this);break;case 1:var c=this.Ia.transaction(["info"],"readwrite").objectStore("info").put(a.data,"info");c.onsuccess=y(function(){ij(this,a,p)},this);c.onerror=y(function(b){b.preventDefault();ij(this,a,b)},this);break;case Wc:var d=this.Ia.transaction(["chunks"],
"readonly").objectStore("chunks").get(this.Jb(a));d.onsuccess=y(function(){jj(this,a,p,d.result)},this);d.onerror=y(function(b){b.preventDefault();jj(this,a,b,p)},this);break;case kj:c=this.Ia.transaction(["chunks"],"readwrite").objectStore("chunks").put(a.data,this.Jb(a));c.onsuccess=y(function(){lj(this,a,p)},this);c.onerror=y(function(b){b.preventDefault();lj(this,a,b)},this);break;case 4:c=this.Ia.transaction(["chunks"],"readwrite").objectStore("chunks")["delete"](this.Jb(a)),c.onsuccess=y(function(){mj(this,
a,p)},this),c.onerror=y(function(b){b.preventDefault();mj(this,a,b)},this)}};function Vj(){fj.call(this);this.vi=p;this.If={}}A(Vj,fj);Vj.prototype.Tb=function(){this.rc=r;this.ob();return dd(p)};Vj.prototype.Jb=function(a){return[a.x,a.y,a.l].join(".")};Vj.prototype.Pg=function(a){switch(a.action){case 0:gj(this,a,p,this.vi);break;case 1:this.vi=a.data;ij(this,a,p);break;case Wc:var b=this.If[this.Jb(a)];jj(this,a,p,b);break;case kj:this.If[this.Jb(a)]=a.data;lj(this,a,p);break;case 4:delete this.If[this.Jb(a)],mj(this,a,p)}};function Wj(a,b){var c;if(a instanceof Wj)this.na=fa(b)?b:a.na,Xj(this,a.Bc),c=a.ff,Yj(this),this.ff=c,c=a.Vc,Yj(this),this.Vc=c,Zj(this,a.Ge),c=a.Ee,Yj(this),this.Ee=c,$j(this,a.pb.w()),c=a.ne,Yj(this),this.ne=c;else if(a&&(c=String(a).match(Ri))){this.na=!!b;Xj(this,c[1]||"",m);var d=c[2]||"";Yj(this);this.ff=d?decodeURIComponent(d):"";d=c[3]||"";Yj(this);this.Vc=d?decodeURIComponent(d):"";Zj(this,c[4]);d=c[5]||"";Yj(this);this.Ee=d?decodeURIComponent(d):"";$j(this,c[6]||"",m);c=c[7]||"";Yj(this);
this.ne=c?decodeURIComponent(c):""}else this.na=!!b,this.pb=new ak(p,0,this.na)}t=Wj.prototype;t.Bc="";t.ff="";t.Vc="";t.Ge=p;t.Ee="";t.ne="";t.wl=r;t.na=r;
t.toString=function(){var a=[],b=this.Bc;b&&a.push(bk(b,ck),":");if(b=this.Vc){a.push("//");var c=this.ff;c&&a.push(bk(c,ck),"@");a.push(encodeURIComponent(String(b)));b=this.Ge;b!=p&&a.push(":",String(b))}if(b=this.Ee)this.Vc&&"/"!=b.charAt(0)&&a.push("/"),a.push(bk(b,"/"==b.charAt(0)?dk:ek));(b=this.pb.toString())&&a.push("?",b);(b=this.ne)&&a.push("#",bk(b,fk));return a.join("")};t.w=function(){return new Wj(this)};
function Xj(a,b,c){Yj(a);a.Bc=c?b?decodeURIComponent(b):"":b;a.Bc&&(a.Bc=a.Bc.replace(/:$/,""))}function Zj(a,b){Yj(a);b?(b=Number(b),(isNaN(b)||0>b)&&g(Error("Bad port number "+b)),a.Ge=b):a.Ge=p}function $j(a,b,c){Yj(a);b instanceof ak?(a.pb=b,a.pb.ah(a.na)):(c||(b=bk(b,gk)),a.pb=new ak(b,0,a.na))}function Yj(a){a.wl&&g(Error("Tried to modify a read-only Uri"))}t.ah=function(a){this.na=a;this.pb&&this.pb.ah(a);return this};function bk(a,b){return ma(a)?encodeURI(a).replace(b,hk):p}
function hk(a){a=a.charCodeAt(0);return"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var ck=/[#\/\?@]/g,ek=/[\#\?:]/g,dk=/[\#\?]/g,gk=/[\#\?@]/g,fk=/#/g;function ak(a,b,c){this.ca=a||p;this.na=!!c}function ik(a){if(!a.B&&(a.B=new ri,a.f=0,a.ca))for(var b=a.ca.split("&"),c=0;c<b.length;c++){var d=b[c].indexOf("="),e=p,f=p;0<=d?(e=b[c].substring(0,d),f=b[c].substring(d+1)):e=b[c];e=decodeURIComponent(e.replace(/\+/g," "));e=jk(a,e);a.add(e,f?decodeURIComponent(f.replace(/\+/g," ")):"")}}t=ak.prototype;
t.B=p;t.f=p;t.fa=function(){ik(this);return this.f};t.add=function(a,b){ik(this);this.ca=p;a=jk(this,a);var c=this.B.get(a);c||this.B.set(a,c=[]);c.push(b);this.f++;return this};t.remove=function(a){ik(this);a=jk(this,a);return this.B.Cb(a)?(this.ca=p,this.f-=this.B.get(a).length,this.B.remove(a)):r};t.clear=function(){this.B=this.ca=p;this.f=0};t.Cb=function(a){ik(this);a=jk(this,a);return this.B.Cb(a)};
t.Ka=function(){ik(this);for(var a=this.B.za(),b=this.B.Ka(),c=[],d=0;d<b.length;d++)for(var e=a[d],f=0;f<e.length;f++)c.push(b[d]);return c};t.za=function(a){ik(this);var b=[];if(a)this.Cb(a)&&(b=Ib(b,this.B.get(jk(this,a))));else{a=this.B.za();for(var c=0;c<a.length;c++)b=Ib(b,a[c])}return b};t.set=function(a,b){ik(this);this.ca=p;a=jk(this,a);this.Cb(a)&&(this.f-=this.B.get(a).length);this.B.set(a,[b]);this.f++;return this};
t.get=function(a,b){var c=a?this.za(a):[];return 0<c.length?String(c[0]):b};t.toString=function(){if(this.ca)return this.ca;if(!this.B)return"";for(var a=[],b=this.B.Ka(),c=0;c<b.length;c++)for(var d=b[c],e=encodeURIComponent(String(d)),d=this.za(d),f=0;f<d.length;f++){var h=e;""!==d[f]&&(h+="="+encodeURIComponent(String(d[f])));a.push(h)}return this.ca=a.join("&")};t.w=function(){var a=new ak;a.ca=this.ca;this.B&&(a.B=this.B.w(),a.f=this.f);return a};
function jk(a,b){var c=String(b);a.na&&(c=c.toLowerCase());return c}t.ah=function(a){a&&!this.na&&(ik(this),this.ca=p,Pc(this.B,function(a,c){var d=c.toLowerCase();c!=d&&(this.remove(c),this.remove(d),0<a.length&&(this.ca=p,this.B.set(jk(this,d),Jb(a)),this.f+=a.length))},this));this.na=a};t.extend=function(a){for(var b=0;b<arguments.length;b++)Pc(arguments[b],function(a,b){this.add(b,a)},this)};function kk(a,b,c){this.xf=a;Nc(this.xf,lk());this.uri=new Wj(b);this.He=new ak(j,0,m);(a=this.uri.pb)&&this.He.extend(a);this.He.extend(c);this.Sm=mk(this,"buildServer")}function lk(){return{buildServer:{help:"Build server daemon address.",type:String,defaultValue:p}}}function nk(a,b){var c=parseFloat(a.xf[b].defaultValue),d=a.He.get(b,c);return!fa(d)?c:Number(d)}function mk(a,b){var c=a.xf[b].defaultValue,d=a.He.get(b,c);return!fa(d)||!d||!d.length||/^[\s\xa0]*$/.test(String(d))?c:String(d)};function ok(a,b){kk.call(this,pk(),a,b);this.gn=nk(this,"listenPort");this.gg=mk(this,"fileSystem");this.zl=mk(this,"mapPath");this.yl=mk(this,"mapGenerator");this.Al=nk(this,"mapSeed");this.Ef=mk(this,"browserUrl");this.rj=mk(this,"serverId");this.tj=mk(this,"serverKey");this.fm=mk(this,"serverName");this.wm=nk(this,"userCount")}A(ok,kk);
function pk(){return{listenPort:{help:"Port to use for game connections.",type:Number,defaultValue:1337},fileSystem:{help:"File system root path.",type:String,defaultValue:"/tmp/blk/"},mapPath:{help:"Map path.",type:String,defaultValue:"/maps/map01/"},mapGenerator:{help:"Map generator name.",type:String,defaultValue:"improved"},mapSeed:{help:"Map generator random seed.",type:Number,defaultValue:0},browserUrl:{help:"Server browser base API URL.",type:String,defaultValue:"http://localhost:8081/"},serverId:{help:"Server registration UUID.",
type:String,defaultValue:p},serverKey:{help:"Server private key.",type:String,defaultValue:p},serverName:{help:"Human-readable server name.",type:String,defaultValue:p},userCount:{help:"Maximum simultaneous user count.",type:Number,defaultValue:8}}};function qk(){E.call(this);this.type="none"}A(qk,E);function rk(){this.dd=Array(256)}function Ie(a,b,c,d){c=d?y(c,d):c;a.dd[b]=c};function sk(a,b,c){E.call(this);this.Mb=new rk;this.G=new di;this.id=a;this.type=b;this.dj=c;this.info=new mh;this.Om=new qk;this.state=0;this.h=[];this.Yb={};this.wh=Array(256);this.W=[]}A(sk,E);sk.prototype.b=function(){this.W.length=0;sk.d.b.call(this)};sk.prototype.wf=function(a){this.h.push(a);this.Yb[a.c]=a;this.wh[a.R]=a;for(var b=0;b<this.W.length;b++)this.W[b].th(a)};sk.prototype.Ke=function(a){var b=this.Yb,c=a.c,d;(d=c in b)&&delete b[c];if(d){this.wh[a.R]=p;Hb(this.h,a);for(b=0;b<this.W.length;b++)this.W[b].uh(a)}};function tk(a){this.timestamp=z();this.I=p;this.data=a};function uk(a){E.call(this);this.Ta=a;this.vl=r;this.state=vk;this.Yd=r;this.Cc=0;this.vb=p;this.ud=[];this.nf=[]}A(uk,E);uk.prototype.b=function(){this.close();uk.d.b.call(this)};var vk=0;uk.prototype.read=function(){if(!this.ud.length)return p;var a=this.ud[0];a.timestamp<=z()?this.ud.shift():a=p;this.ud.length||(this.Yd=r);return a};
uk.prototype.write=function(a){a=new tk(a);if(this.Cc){var b=this.Cc+(Math.random()-0.5)*this.Cc/2;a.timestamp+=b;this.vb===p&&(this.vb=v.setInterval(y(function(){1==this.state&&this.flush()},this),5))}else this.vb!==p&&(v.clearInterval(this.vb),this.vb=p);this.nf.push(a);1==this.state&&this.flush()};function wk(a,b){if(a.Cc){var c=a.Cc+(Math.random()-0.5)*a.Cc/2;b.timestamp+=c}a.ud.push(b);a.Yd=m}
uk.prototype.flush=function(a){for(var b=z();this.nf.length;){var c=this.nf[0];if(c.timestamp>b&&!a)break;this.nf.shift();this.Vj(c.data)}};uk.prototype.close=function(){2!=this.state&&(this.vb!==p&&(v.clearInterval(this.vb),this.vb=p),this.state=2)};function xk(a,b,c,d){sk.call(this,"0",0,b);Ie(this.Mb,1,this.jl,this);Ie(this.Mb,8,this.ll,this);Ie(this.Mb,5,this.hl,this);this.ja=a;this.sj=d;this.Tg=r;this.hd=[];this.Nd=Array(255);for(a=1;a<this.Nd.length;a++)this.Nd[a-1]=a}A(xk,sk);t=xk.prototype;t.b=function(){if(this.Tg){this.Tg=r;this.state=0;this.ja.ka(p);for(var a=0;a<this.W.length;a++)this.W[a].Uf()}xk.d.b.call(this)};t.lg=function(a){var b=a.Ta;0<=Bb(Mb,b)||Mb.push(b);this.hd.push(a)};
function yk(a,b){if(b.ja&&(a.Yb[b.c]||p)==b)b.ja.close(),a.Ke(b),a.send(Gh(b.c,b.Tf)),0!=b.R&&(a.Nd.push(b.R),b.R=0)}
t.Yi=function(a){if(this.hd.length)for(var b=ff(),c=0;c<this.hd.length;c++){var d=this.hd[c],e=r,f=r,h=1;if(2!=d.state)for(;d.Yd;){var k=d.read();if(!k)break;b.ka(k.data,0);if(4==Qe(b)){var i=b,e=xh;e.Ye=Re(i);e.Kd=Re(i);k=e.I||new le;k.c=i.H();k.R=Qe(i);k.z=i.ia();var l;if(!(l=!oh(i,k.info)))l=k.Jd||new ge,l.type=i.H(),l.platform=i.H(),l.rd=i.H(),l.Tc=i.H(),l=!l;e=!(l?0:k)?p:e;this.h.length+1>this.sj.oc&&(f=m,h=7);if(!f&&(3!=e.Ye||e.Kd!=this.dj))f=m,h=2;if(!f){e=me(e.I);for(e.ja=d;!(e.c=Math.floor(2147483648*
Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^z()).toString(36),!this.Yb[e.c]););e.R=this.Nd.shift();this.send(Eh(me(e)));this.send(zh(this.dj,e),e);k=Eb(this.h,me);k.push(me(e));this.send(vh(this.info.w(),k),e);this.wf(e)}e=m}else f=e=m,h=3}else f=e=m,h=1;e&&(f&&(f=h,h=R(),Ch.reason=f,Q(h,5),h.M(Ch.reason),(f=h.finish())&&d.write(f),K(d)),this.hd.splice(c,1),c--)}b=Hc();for(c=0;c<this.h.length;c++){for(d=this.h[c];d.ja.Yd;){h=d.ja.read();if(!h)break;h.I=d;d.Mh+=h.data.byteLength;
f=this.Mb;e=ff();e.ka(h.data,0);e.offset+1<=e.buffer.length&&(k=Qe(e),(f=f.dd[k])&&f(h,k,e))}if(!d.ja||2==d.ja.state)d.Tf=1,yk(this,d);else if(a&&Hc()-b>=a)break}};t.jl=function(a,b,c){a=a.I;rh.Te=c.ia();rh.Oc=c.ia();rh.nc=c.ia();if(!rh)return r;c=a.i;b=Math.abs(rh.nc);c.Od=c.Od?(c.Od+b)/2:b;c.Ji=Math.min(c.Ji,b);c.Ii=Math.max(c.Ii,b);c=Je(this.G)+this.G.$d;b=Array(this.h.length);for(var d=0;d<this.h.length;d++)b[d]=new nh,b[d].R=this.h[d].R,b[d].nc=this.h[d].i.Od;this.send(th(1E3*c|0,b),a);return m};
t.ll=function(a,b,c){Ih.c=c.H();c=!oh(c,Ih.info)?p:Ih;if(!c)return r;b=this.Yb[c.c]||p;if(!b)return m;if(b!=a.I)return r;a=c.info.ya;a=qb(a).replace(/\xa0|\s/g," ").replace(/\xa0|[ \t]+/g," ");a=!a.length?"User":a;b.info.ya=a;for(a=0;a<this.W.length;a++)this.W[a].vh(b);this.send(Kh(b.c,b.info));return m};t.hl=function(a,b,c){a=a.I;Bh.reason=c.ia();if(!Bh)return r;M("["+a.c+"] disconnect req",Bh.reason);return m};
t.send=function(a,b){if(a)if(b){var c=b.ja;2!=c.state?(c.write(a),b.i.Td+=a.byteLength):yk(this,b)}else for(var d=0;d<this.h.length;d++){var e=this.h[d],c=e.ja;2!=c.state?(e.i.Td+=a.byteLength,c.write(a)):(e.Tf=1,yk(this,e))}};function zk(a){a=new Uint8Array(a);for(var b=Array(a.length),c=0;c<b.length;c++)b[c]=a[c];return String.fromCharCode.apply(p,b)};function Ak(a,b){uk.call(this,a);this.vl=m;this.state=1;this.p=b;this.lm=!!b.webkitPostMessage&&!(v.Im&&b instanceof MessagePort);this.ok=!Pd;var c=this;this.p.onmessage=function(a){c.mg(a)};this.p.onerror=function(a){M("port error",a)}}A(Ak,uk);
Ak.prototype.mg=function(a){a=a.data;var b=p;if(a instanceof ArrayBuffer)b=new tk(a);else if(ma(a)){for(var b=new Uint8Array(2*a.length),c=0,d=0;d<a.length;d++){for(var e=a.charCodeAt(d);255<e;)b[c++]=e,e>>=8;b[c++]=e}b=new tk(b.subarray(0,c).buffer)}else a&&a.close&&this.close();b&&wk(this,b)};Ak.prototype.Vj=function(a){this.lm?this.p.webkitPostMessage(a,[a]):this.ok?this.p.postMessage(a):this.p.postMessage(zk(a))};
Ak.prototype.close=function(){this.p.onmessage=p;try{this.p.postMessage({close:m}),this.p.close&&this.p.close()}catch(a){}Ak.d.close.call(this)};function Bk(a){E.call(this);this.Ta=a;this.fb=m;this.Mf=[];this.be=p}A(Bk,E);Bk.prototype.b=function(){this.close();this.be=p;Bk.d.b.call(this)};Bk.prototype.ka=function(a){if(this.be=a)for(;this.Mf.length;){var b=this.Mf.shift();a.call(p,b)}};function Ck(a,b){a.be?a.be.call(p,b):a.Mf.push(b)};function Dk(a,b){Bk.call(this,a);this.p=b;this.Ih=y(this.lg,this);this.p.addEventListener("connect",this.Ih,r);if(v.WorkerLocation){var c=new Ak(b,b);Ck(this,c)}}A(Dk,Bk);Dk.prototype.lg=function(a){a=a.ports[0];a=new Ak(a,a);Ck(this,a)};Dk.prototype.close=function(){this.fb&&(this.fb=r,this.p.removeEventListener("connect",this.Ih,r))};function Ek(a,b){uk.call(this,a);this.state=1;this.p=b;this.Kh=y(this.il,this);this.Hh=y(this.fl,this);this.Lh=y(this.mg,this);this.Dm={binary:m,mask:r};this.p.addListener("error",this.Kh);this.p.addListener("close",this.Hh);this.p.addListener("message",this.Lh)}A(Ek,uk);t=Ek.prototype;t.il=function(a){M("socket error",a)};t.fl=function(a){M("socket closed",a.code);this.close()};t.mg=function(a){for(var b=new Uint8Array(a.length),c=0;c<a.length;c++)b[c]=a[c];a=new tk(b.buffer);wk(this,a)};
t.Vj=function(a){var b=new Buffer(a.byteLength);a=new Uint8Array(a);for(var c=0;c<a.length;c++)b[c]=a[c];try{this.p.send(b,this.Dm)}catch(d){M("socket error: "+d),this.close()}};t.close=function(){this.p.removeListener("error",this.Kh);this.p.removeListener("close",this.Hh);this.p.removeListener("message",this.Lh);try{this.p.close(1E3,"")}catch(a){}Ek.d.close.call(this)};function Fk(a){Bk.call(this,a);this.p=new (require("ws").Server)({host:j,port:Number(a)});this.Jh=y(this.gl,this);this.p.addListener("connection",this.Jh)}A(Fk,Bk);Fk.prototype.gl=function(a){a=new Ek(a,a);Ck(this,a)};Fk.prototype.close=function(){this.fb&&(this.fb=r,this.p.removeListener("connection",this.Jh),this.p.close())};function Gk(){this.Wc=[];this.Eg=new ri;this.Nj=this.Oj=this.Pj=this.Ij=0;this.Ad=new ri;this.Sh=this.Mj=0;this.Il=1;this.ag=new zj(0,4E3);this.ag.Rc=function(){return new Hk};this.Jj=new zj(0,50);this.Jj.Rc=function(){return new Ik};var a=this;this.pg=new zj(0,2E3);this.pg.Rc=function(){return String(a.Il++)};this.pg.Wf=aa();this.yk=3}Gk.prototype.V=Li("goog.debug.Trace");function Ik(){this.yh=this.time=this.count=0}
Ik.prototype.toString=function(){var a=[];a.push(this.type," ",this.count," (",Math.round(10*this.time)/10," ms)");this.yh&&a.push(" [VarAlloc = ",this.yh,"]");return a.join("")};function Hk(){}function Jk(a,b,c,d){var e=[];-1==c?e.push("    "):e.push(Kk(a.di-c));e.push(" ",Lk(a.di-b));0==a.bg?e.push(" Start        "):1==a.bg?(e.push(" Done "),e.push(Kk(a.nn-a.startTime)," ms ")):e.push(" Comment      ");e.push(d,a);0<a.rm&&e.push("[VarAlloc ",a.rm,"] ");return e.join("")}
Hk.prototype.toString=function(){return this.type==p?this.tk:"["+this.type+"] "+this.tk};Gk.prototype.reset=function(a){this.yk=a;for(a=0;a<this.Wc.length;a++){var b=this.ag.id;b&&Aj(this.pg,b);Aj(this.ag,this.Wc[a])}this.Wc.length=0;this.Eg.clear();this.Ij=z();this.Sh=this.Mj=this.Nj=this.Oj=this.Pj=0;b=this.Ad.Ka();for(a=0;a<b.length;a++){var c=this.Ad.get(b[a]);c.count=0;c.time=0;c.yh=0;Aj(this.Jj,c)}this.Ad.clear()};
Gk.prototype.toString=function(){for(var a=[],b=-1,c=[],d=0;d<this.Wc.length;d++){var e=this.Wc[d];1==e.bg&&c.pop();a.push(" ",Jk(e,this.Ij,b,c.join("")));b=e.di;a.push("\n");0==e.bg&&c.push("|  ")}if(0!=this.Eg.fa()){var f=z();a.push(" Unstopped timers:\n");d=this.Eg;b=function(b){a.push("  ",b," (",f-b.startTime," ms, started at ",Lk(b.startTime),")\n")};if(la(d))try{Cb(d,b,j)}catch(h){h!==oi&&g(h)}else{d=qi(d);try{for(;;)b.call(j,d.next())}catch(k){k!==oi&&g(k)}}}b=this.Ad.Ka();for(d=0;d<b.length;d++)c=
this.Ad.get(b[d]),1<c.count&&a.push(" TOTAL ",c,"\n");a.push("Total tracers created ",this.Mj,"\n","Total comments created ",this.Sh,"\n","Overhead start: ",this.Pj," ms\n","Overhead end: ",this.Oj," ms\n","Overhead comment: ",this.Nj," ms\n");return a.join("")};function Kk(a){a=Math.round(a);var b="";1E3>a&&(b=" ");100>a&&(b="  ");10>a&&(b="   ");return b+a}function Lk(a){a=Math.round(a);return String(100+a/1E3%60).substring(1,3)+"."+String(1E3+a%1E3).substring(1,4)}new Gk;var Nk=za(function(a,b){function c(a,b,d){var e=new (b.shift())(a);P(e.Tb(),function(){d(e)},function(){c(a,b,d)})}for(var d=new O,e={},f=0;f<b.length;f++){var h=b[f];if(0==h.indexOf("--")){var h=h.split("="),k=h[1];e[h[0].substring(2)]=1<h.length?k:m}}if(e.help)return M("BLK game server","(release)"),M("gf:"),M(lk()),M("blk:"),M(pk()),d.a("help query"),d;var i=new ok(a,e),e=new mh;e.Ta="blk://local-0";e.name=i.fm||"Server";e.Zc="blk";e.$c="0.0.1";e.oc=i.wm;f=p;ma(v)?f=new Fk(v):oa(v)&&(f=new Dk(v,
v));e=new xk(f,7,0,e);e=dd(e);P(e,function(a){var b=i.zl,e=[Tj,Sj,Vj],f=xa("MapStore:setup");c(b,e,function(b){ya(f);Mk(i,a,b,d)})},function(a){d.a(a)});return d},"blk.server.start"),Mk=za(function(a,b,c,d){var e=new dj(a,b,c);P(e.load(),function(){e.hh||(e.hh=m,e.Le.start());d.e(e)},function(a){d.a(a)})},"blk.server.launchServer_");ea("blk.server.start",Nk);
