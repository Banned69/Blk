function g(a){throw a;}var j=void 0,m=!0,p=null,q=!1;function aa(){return function(){}}function ba(a){return function(b){this[a]=b}}function s(a){return function(){return this[a]}}function ca(a){return function(){return a}}var t,da=da||{},w=this;function ea(a,b){var c=a.split("."),d=w;!(c[0]in d)&&d.execScript&&d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)!c.length&&fa(b)?d[e]=b:d=d[e]?d[e]:d[e]={}}
function ha(a){a=a.split(".");for(var b=w,c;c=a.shift();)if(b[c]!=p)b=b[c];else return p;return b}function x(){}function ia(a){return a}
function ja(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function fa(a){return a!==j}function ka(a){return"array"==ja(a)}function la(a){var b=ja(a);return"array"==b||"object"==b&&"number"==typeof a.length}function ma(a){return"string"==typeof a}function na(a){return"function"==ja(a)}function oa(a){var b=typeof a;return"object"==b&&a!=p||"function"==b}function pa(a){return a[ra]||(a[ra]=++sa)}var ra="closure_uid_"+Math.floor(2147483648*Math.random()).toString(36),sa=0;
function ta(a,b,c){return a.call.apply(a.bind,arguments)}function ua(a,b,c){a||g(Error());if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}function y(a,b,c){y=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ta:ua;return y.apply(p,arguments)}var va=Date.now||function(){return+new Date};
function z(a,b){function c(){}c.prototype=b.prototype;a.d=b.prototype;a.prototype=new c;a.prototype.constructor=a};function wa(a,b){this.attributes=[new xa(3,0),new xa(2,24)];this.sm=a;this.Cm=b}function xa(a,b){this.size=a;this.type=5126;this.Nm=q;this.Sm=32;this.offset=b};function ya(){};function za(a){this.length=a.length||a;for(var b=0;b<this.length;b++)this[b]=a[b]||0}za.prototype.BYTES_PER_ELEMENT=4;za.prototype.set=function(a,b){b=b||0;for(var c=0;c<a.length&&b+c<this.length;c++)this[b+c]=a[c]};za.prototype.toString=Array.prototype.join;"undefined"==typeof Float32Array&&(za.BYTES_PER_ELEMENT=4,za.prototype.BYTES_PER_ELEMENT=za.prototype.BYTES_PER_ELEMENT,za.prototype.set=za.prototype.set,za.prototype.toString=za.prototype.toString,ea("Float32Array",za));function Aa(a){this.length=a.length||a;for(var b=0;b<this.length;b++)this[b]=a[b]||0}Aa.prototype.BYTES_PER_ELEMENT=8;Aa.prototype.set=function(a,b){b=b||0;for(var c=0;c<a.length&&b+c<this.length;c++)this[b+c]=a[c]};Aa.prototype.toString=Array.prototype.join;if("undefined"==typeof Float64Array){try{Aa.BYTES_PER_ELEMENT=8}catch(Ba){}Aa.prototype.BYTES_PER_ELEMENT=Aa.prototype.BYTES_PER_ELEMENT;Aa.prototype.set=Aa.prototype.set;Aa.prototype.toString=Aa.prototype.toString;ea("Float64Array",Aa)};function A(){return new Float32Array(3)}function Ca(a,b,c){var d=A();B(d,a,b,c);return d}function B(a,b,c,d){a[0]=b;a[1]=c;a[2]=d}function Da(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2]}function Ea(a,b,c){c[0]=a[0]+b[0];c[1]=a[1]+b[1];c[2]=a[2]+b[2]}function Fa(a,b,c){c[0]=a[0]*b;c[1]=a[1]*b;c[2]=a[2]*b}function Ga(a){var b=a[0],c=a[1];a=a[2];return Math.sqrt(b*b+c*c+a*a)}function Ha(a,b){var c=a[0]-b[0],d=a[1]-b[1],e=a[2]-b[2];return c*c+d*d+e*e}
function Ia(a,b,c){var d=b[0]-a[0],e=b[1]-a[1];a=b[2]-a[2];(b=Math.sqrt(d*d+e*e+a*a))?(b=1/b,c[0]=d*b,c[1]=e*b,c[2]=a*b):c[0]=c[1]=c[2]=0}function Ja(a,b){return a.length==b.length&&a[0]==b[0]&&a[1]==b[1]&&a[2]==b[2]};function Ka(){var a=A(),b=A();this.min=a;this.max=b}function Ta(a,b,c,d,e,f){var h=new Ka;h.min[0]=a<d?a:d;h.min[1]=b<e?b:e;h.min[2]=c<f?c:f;h.max[0]=a<d?d:a;h.max[1]=b<e?e:b;h.max[2]=c<f?f:c;return h}
function Ua(a,b,c){var d=a.min;a=a.max;var e=Va[0];e[0]=Math.abs(b[3]);e[1]=Math.abs(b[4]);e[2]=Math.abs(b[5]);var f=0,h=1,k=2;e[0]<e[2]&&(f=2,k=0);e[1]<e[k]?(h=k,k=1):e[1]>e[f]&&(h=f,f=1);var i=0,l=Number.MAX_VALUE,n=b[3+f],r=(d[f]-b[f])/n,f=(a[f]-b[f])/n;r>f&&(n=r,r=f,f=n);if(!(r>l||f<i)){r>i&&(i=r);f<l&&(l=f);if(1E-6>e[h]){if(b[h]<d[h]||b[h]>a[h]||b[k]<d[k]||b[k]>a[k])return}else{n=b[3+h];r=(d[h]-b[h])/n;f=(a[h]-b[h])/n;r>f&&(n=r,r=f,f=n);if(r>l||f<i)return;r>i&&(i=r);f<l&&(l=f);if(1E-6>e[k]){if(b[k]<
d[k]||b[k]>a[k])return}else{n=b[3+k];r=(d[k]-b[k])/n;f=(a[k]-b[k])/n;r>f&&(n=r,r=f,f=n);if(r>l||f<i)return;r>i&&(i=r)}}c&&(c[0]=b[0]+b[3]*i,c[1]=b[1]+b[4]*i,c[2]=b[2]+b[5]*i)}}var Va=[A(),A(),A()];function C(){return new Float32Array(4)}function Wa(a,b,c,d){var e=C();Xa(e,a,b,c,d);return e}function Xa(a,b,c,d,e){a[0]=b;a[1]=c;a[2]=d;a[3]=e}function Ya(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3]}function Za(a,b){var c=1/256;b[0]=a[0]*c;b[1]=a[1]*c;b[2]=a[2]*c;b[3]=a[3]*c};function $a(){var a=new Float32Array(16);a[0]=a[5]=a[10]=a[15]=1;return a}function ab(a,b,c,d,e,f,h,k,i){a[0]=b;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=c;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=d;a[11]=e;a[12]=f;a[13]=h;a[14]=k;a[15]=i}
function bb(a,b,c){var d=a[0],e=a[1],f=a[2],h=a[3],k=a[4],i=a[5],l=a[6],n=a[7],r=a[8],u=a[9],v=a[10],F=a[11],H=a[12],G=a[13],I=a[14];a=a[15];var M=b[0],ga=b[1],Z=b[2],qa=b[3],La=b[4],Ma=b[5],Na=b[6],Oa=b[7],Pa=b[8],Qa=b[9],Ra=b[10],Sa=b[11],K=b[12],Jd=b[13],Kd=b[14];b=b[15];c[0]=d*M+k*ga+r*Z+H*qa;c[1]=e*M+i*ga+u*Z+G*qa;c[2]=f*M+l*ga+v*Z+I*qa;c[3]=h*M+n*ga+F*Z+a*qa;c[4]=d*La+k*Ma+r*Na+H*Oa;c[5]=e*La+i*Ma+u*Na+G*Oa;c[6]=f*La+l*Ma+v*Na+I*Oa;c[7]=h*La+n*Ma+F*Na+a*Oa;c[8]=d*Pa+k*Qa+r*Ra+H*Sa;c[9]=e*Pa+
i*Qa+u*Ra+G*Sa;c[10]=f*Pa+l*Qa+v*Ra+I*Sa;c[11]=h*Pa+n*Qa+F*Ra+a*Sa;c[12]=d*K+k*Jd+r*Kd+H*b;c[13]=e*K+i*Jd+u*Kd+G*b;c[14]=f*K+l*Jd+v*Kd+I*b;c[15]=h*K+n*Jd+F*Kd+a*b}
function cb(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],h=a[4],k=a[5],i=a[6],l=a[7],n=a[8],r=a[9],u=a[10],v=a[11],F=a[12],H=a[13],G=a[14],I=a[15],M=c*k-d*h,ga=c*i-e*h,Z=c*l-f*h,qa=d*i-e*k,La=d*l-f*k,Ma=e*l-f*i,Na=n*H-r*F,Oa=n*G-u*F,Pa=n*I-v*F,Qa=r*G-u*H,Ra=r*I-v*H,Sa=u*I-v*G,K=M*Sa-ga*Ra+Z*Qa+qa*Pa-La*Oa+Ma*Na;0!=K&&(K=1/K,b[0]=(k*Sa-i*Ra+l*Qa)*K,b[1]=(-d*Sa+e*Ra-f*Qa)*K,b[2]=(H*Ma-G*La+I*qa)*K,b[3]=(-r*Ma+u*La-v*qa)*K,b[4]=(-h*Sa+i*Pa-l*Oa)*K,b[5]=(c*Sa-e*Pa+f*Oa)*K,b[6]=(-F*Ma+G*Z-I*ga)*K,b[7]=(n*Ma-u*
Z+v*ga)*K,b[8]=(h*Ra-k*Pa+l*Na)*K,b[9]=(-c*Ra+d*Pa-f*Na)*K,b[10]=(F*La-H*Z+I*M)*K,b[11]=(-n*La+r*Z-v*M)*K,b[12]=(-h*Qa+k*Oa-i*Na)*K,b[13]=(c*Qa-d*Oa+e*Na)*K,b[14]=(-F*qa+H*ga-G*M)*K,b[15]=(n*qa-r*ga+u*M)*K)}function db(a,b,c){var d=b[0],e=b[1];b=b[2];var f=1/(d*a[3]+e*a[7]+b*a[11]+a[15]);c[0]=(d*a[0]+e*a[4]+b*a[8]+a[12])*f;c[1]=(d*a[1]+e*a[5]+b*a[9]+a[13])*f;c[2]=(d*a[2]+e*a[6]+b*a[10]+a[14])*f}new Float64Array(3);new Float64Array(3);new Float64Array(4);new Float64Array(4);new Float64Array(4);new Float64Array(16);function eb(){this.name=p;this.index=0;this.parent=p;this.children=[];this.transform=$a();this.ab=new Ka;this.Od=C()};function fb(a){this.yi=a;a=a.Md;this.Uj=new Float32Array(16*a.length);this.om=new Float32Array(16*a.length);this.Zl=m;this.reset()}fb.prototype.reset=function(){this.Zl=m;for(var a=this.yi.Md,b=0,c=0;b<a.length;b++,c+=16)for(var d=a[b],e=0;16>e;e++)this.Uj[c+e]=d.transform[e]};function D(){0!=gb&&(this.Am=Error().stack,hb[pa(this)]=this)}var gb=0,hb={};D.prototype.Rf=q;D.prototype.Uc=function(){if(!this.Rf&&(this.Rf=m,this.b(),0!=gb)){var a=pa(this);delete hb[a]}};function E(a,b){a.de||(a.de=[]);a.de.push(b)}D.prototype.b=function(){this.de&&ib.apply(p,this.de);if(this.Gi)for(;this.Gi.length;)this.Gi.shift()()};function J(a){a&&"function"==typeof a.Uc&&a.Uc()}function ib(a){for(var b=0,c=arguments.length;b<c;++b){var d=arguments[b];la(d)?ib.apply(p,d):J(d)}};function jb(a){Error.captureStackTrace?Error.captureStackTrace(this,jb):this.stack=Error().stack||"";a&&(this.message=String(a))}z(jb,Error);jb.prototype.name="CustomError";function kb(a,b){for(var c=1;c<arguments.length;c++){var d=String(arguments[c]).replace(/\$/g,"$$$$");a=a.replace(/\%s/,d)}return a}function lb(a){return a.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")}function mb(a){if(!nb.test(a))return a;-1!=a.indexOf("&")&&(a=a.replace(ob,"&amp;"));-1!=a.indexOf("<")&&(a=a.replace(pb,"&lt;"));-1!=a.indexOf(">")&&(a=a.replace(qb,"&gt;"));-1!=a.indexOf('"')&&(a=a.replace(rb,"&quot;"));return a}var ob=/&/g,pb=/</g,qb=/>/g,rb=/\"/g,nb=/[&<>\"]/;Math.random();function sb(a){D.call(this);this.id=a;this.ab=new Ka;this.Od=C();this.sk=p;this.ul=[];this.Md=[];this.vm={}}z(sb,D);sb.prototype.be=function(){return new fb(this)};function tb(){this.il=new ya;this.primitiveType=4;this.Dm=this.hk=0};function ub(){var a=new sb("pumpkin"),b=a.ab,c=[-0.5,-1,0,0.5,1,0.5],d=b.min,b=b.max;if(c.length){var e=0;B(d,c[e],c[e+1],c[e+2]);B(b,c[e],c[e+1],c[e+2]);e++;for(var f=1;f<c.length/3;f++,e++)c[e]<d[0]?d[0]=c[e]:c[e]>b[0]&&(b[0]=c[e]),c[e+1]<d[1]?d[1]=c[e+1]:c[e+1]>b[1]&&(b[1]=c[e+1]),c[e+2]<d[2]?d[2]=c[e+2]:c[e+2]>b[2]&&(b[2]=c[e+2])}else B(d,0,0,0),B(b,0,0,0);Xa(a.Od,0,0,0,1);c=Wa(96,112,112,128);d=Wa(112,112,128,128);b=Wa(96,96,112,112);Za(c,c);Za(d,d);Za(b,b);c=new Float32Array([-0.5,-1,0.5,0,
0,1,c[2],c[3],0.5,-1,0.5,0,0,1,c[0],c[3],0.5,1,0.5,0,0,1,c[0],c[1],-0.5,1,0.5,0,0,1,c[2],c[1],-0.5,-1,-0.5,0,0,-1,d[0],d[3],-0.5,1,-0.5,0,0,-1,d[0],d[1],0.5,1,-0.5,0,0,-1,d[2],d[1],0.5,-1,-0.5,0,0,-1,d[2],d[3],-0.5,1,-0.5,0,1,0,b[2],b[1],-0.5,1,0.5,0,1,0,b[2],b[3],0.5,1,0.5,0,1,0,b[0],b[3],0.5,1,-0.5,0,1,0,b[0],b[1],-0.5,-1,-0.5,0,-1,0,c[0],c[1],0.5,-1,-0.5,0,-1,0,c[2],c[1],0.5,-1,0.5,0,-1,0,c[2],c[3],-0.5,-1,0.5,0,-1,0,c[0],c[3],0.5,-1,-0.5,1,0,0,c[0],c[3],0.5,1,-0.5,1,0,0,c[0],c[1],0.5,1,0.5,1,
0,0,c[2],c[1],0.5,-1,0.5,1,0,0,c[2],c[3],-0.5,-1,-0.5,-1,0,0,c[2],c[3],-0.5,-1,0.5,-1,0,0,c[0],c[3],-0.5,1,0.5,-1,0,0,c[0],c[1],-0.5,1,-0.5,-1,0,0,c[2],c[1]]);d=new Uint16Array(36);for(f=e=b=0;6>b;b++,e+=6,f+=4)d[e+0]=0+f,d[e+1]=1+f,d[e+2]=2+f,d[e+3]=0+f,d[e+4]=2+f,d[e+5]=3+f;a.sk=new wa(c.buffer,d);c=new tb;a.ul.push(c);c.primitiveType=4;c.hk=36;c=new eb;c.index=a.Md.length;c.name=p;c.parent=p;a.Md.push(c);d=c.ab;b=a.ab;Da(d.min,b.min);Da(d.max,b.max);Ya(c.Od,a.Od);return a};var vb=Array.prototype,wb=vb.indexOf?function(a,b,c){return vb.indexOf.call(a,b,c)}:function(a,b,c){c=c==p?0:0>c?Math.max(0,a.length+c):c;if(ma(a))return!ma(b)||1!=b.length?-1:a.indexOf(b,c);for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},xb=vb.forEach?function(a,b,c){vb.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=ma(a)?a.split(""):a,f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)},yb=vb.filter?function(a,b,c){return vb.filter.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=[],f=
0,h=ma(a)?a.split(""):a,k=0;k<d;k++)if(k in h){var i=h[k];b.call(c,i,k,a)&&(e[f++]=i)}return e},zb=vb.map?function(a,b,c){return vb.map.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=Array(d),f=ma(a)?a.split(""):a,h=0;h<d;h++)h in f&&(e[h]=b.call(c,f[h],h,a));return e},Ab=vb.some?function(a,b,c){return vb.some.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=ma(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return m;return q};
function Bb(a){if(!ka(a))for(var b=a.length-1;0<=b;b--)delete a[b];a.length=0}function Cb(a,b){var c=wb(a,b),d;(d=0<=c)&&vb.splice.call(a,c,1);return d}function Db(a){return vb.concat.apply(vb,arguments)}function Eb(a){var b=a.length;if(0<b){for(var c=Array(b),d=0;d<b;d++)c[d]=a[d];return c}return[]}function Fb(a,b){vb.sort.call(a,b||Gb)}function Gb(a,b){return a>b?1:a<b?-1:0};var Hb=w.postMessage?[w]:[];function L(a){for(var b=0;b<Hb.length;b++){for(var c=Array(arguments.length),d=0;d<c.length;d++)c[d]=arguments[d];try{Hb[b].postMessage({type:"gf_log",args:c},p)}catch(e){}}}if(w.console)var Ib=w.console,L=y(Ib.log,Ib);function Jb(){D.call(this);this.od={}}z(Jb,D);Jb.prototype.b=function(){for(var a in this.od)J(this.od[a]);this.od={};Jb.d.b.call(this)};Jb.prototype.update=aa();function Kb(a){Jb.call(this);this.Jc=a;this.Ai={}}z(Kb,Jb);function Lb(a){Kb.call(this,a);this.Ai.pumpkin={id:"pumpkin",ek:ub}}z(Lb,Kb);function Mb(){this.bi="improved";this.Ne=0};function Nb(){this.q=Array(256)}function Ob(a,b){a.q[b.id]=b};function Pb(a,b,c,d,e,f,h){this.Nc=a;this.uh=b;this.vh=c;this.wh=d;this.Z=e;this.Sf=f;this.Li=h};function Qb(a,b,c,d){this.map=a;this.x=b;this.y=c;this.l=d;this.ab=Ta(b,c,d,b+16,c+128,d+16);this.state=Rb;this.bc=m;this.version=this.Ma=0;this.Z=new Uint16Array(32768);this.Pm=this.ub=p}var Rb=0;Qb.prototype.fill=function(a){for(var b=0;32768>b;b++)this.Z[b]=a[b];this.bc=m;this.state=2;this.map.ye(this);this.map.qf(this)};Qb.prototype.ra=function(a,b,c,d){b=(a&15)+16*(c&15)+256*(b&127);a=this.Z[b];this.Z[b]=d;a!=d&&!this.bc&&(d=this.bc,this.bc=m,this.ub=p,d||this.map.qf(this));return a};
Qb.prototype.ig=function(a){var b=Sb[0];Ua(this.ab,a,b);var c=Math.floor(b[0]),d=Math.floor(b[1]),e=Math.floor(b[2]),f=0==a[3]?0:0>a[3]?-1:1,h=0==a[4]?0:0>a[4]?-1:1,k=0==a[5]?0:0>a[5]?-1:1,i=(c+(0<f?1:0)-b[0])/a[3],l=(d+(0<h?1:0)-b[1])/a[4],n=(e+(0<k?1:0)-b[2])/a[5];isNaN(i)&&(i=Number.POSITIVE_INFINITY);isNaN(l)&&(l=Number.POSITIVE_INFINITY);isNaN(n)&&(n=Number.POSITIVE_INFINITY);var r=f/a[3],u=h/a[4],v=k/a[5];isNaN(r)&&(r=Number.POSITIVE_INFINITY);isNaN(u)&&(u=Number.POSITIVE_INFINITY);isNaN(v)&&
(v=Number.POSITIVE_INFINITY);for(var F=this.Z,H=b=0;256>H;H++){var G=c-this.x,I=d-this.y,M=e-this.l;if(0<=G&&(16>G&&0<=I&&128>I&&0<=M&&16>M)&&(b=F[G+16*M+256*I],b>>8))break;i<l&&i<n?(i+=r,c+=f):l<n?(l+=u,d+=h):(n+=v,e+=k)}return b?(f=Tb,h=c+1,k=d+1,i=e+1,B(f.min,c,d,e),B(f.max,h,k,i),f=A(),Ua(Tb,a,f),new Pb(this,c,d,e,b,Math.sqrt(Ha(a,f)),f)):p};var Sb=[A(),A()],Tb=new Ka;function Ub(){D.call(this);this.ua={};this.Wb=[];this.Ye=this.xj=0}z(Ub,D);t=Ub.prototype;t.b=function(){this.Wb.length=0;Ub.d.b.call(this)};t.update=function(){for(;this.Wb.length;){var a=this.Wb.shift();Vb(this,a)}};t.get=function(a,b,c){return 0!=b>>7?p:this.ua[(a>>4&65535)<<16|c>>4&65535]||p};t.add=function(a){this.ua[(a.x>>4&65535)<<16|a.l>>4&65535]=a;0<a.Ma||this.Wb.push(a);this.xj++;this.Ye+=65792};t.remove=function(a){Vb(this,a);0<a.Ma||Cb(this.Wb,a)};
function Vb(a,b){delete a.ua[(b.x>>4&65535)<<16|b.l>>4&65535];a.Ye-=65792;a.xj--}t.we=function(a){this.Wb.push(a)};t.xe=function(a){Cb(this.Wb,a)};function Wb(){D.call(this);this.Ql=Ca(0,191/255,1);this.qm=Ca(110/255,110/255,110/255);this.Um=Ca(1,1,-0.5);this.Tm=Ca(130/255,130/255,130/255);this.ok=Ca(1,1,1);Da(this.ok,this.Ql)}z(Wb,D);Wb.prototype.update=aa();function Xb(a,b,c,d,e){this.id=a;this.name=b;this.il=c;this.z=d;this.Rm=0;this.Hm=1;this.Vm=0;this.rm=e};function Yb(a,b,c,d,e){Xb.call(this,a,b,c,d,e)}z(Yb,Xb);function Zb(a,b){var c=Wa(0,0,0,0);this.z=a;this.pm=b||p;this.Qm=p;this.color=c||C()};var $b=new Zb(17,"block_gravel"),ac=new Zb(17,"block_stone"),bc=new Zb(17,"block_wood"),cc=new Zb(97,"block_stone"),dc=new Zb(17,"block_cloth");function ec(){Xb.call(this,6,"Red Cloth",dc,17,129)}z(ec,Yb);function fc(){Xb.call(this,7,"Green Cloth",dc,17,145)}z(fc,Yb);function gc(){Xb.call(this,8,"Yellow Cloth",dc,17,162)}z(gc,Yb);function hc(){Xb.call(this,9,"Blue Cloth",dc,17,177)}z(hc,Yb);function ic(){Xb.call(this,3,"Brick",ac,17,7)}z(ic,Yb);function jc(){Xb.call(this,1,"Dirt",$b,17,2)}z(jc,Yb);function kc(){Xb.call(this,5,"Glass",cc,17,49)}z(kc,Yb);function lc(){Xb.call(this,2,"Stone",ac,17,1)}z(lc,Yb);function mc(){Xb.call(this,4,"Wood",bc,17,4)}z(mc,Yb);function nc(){D.call(this);this.A=new Nb;Ob(this.A,new jc);Ob(this.A,new lc);Ob(this.A,new ic);Ob(this.A,new mc);Ob(this.A,new kc);Ob(this.A,new ec);Ob(this.A,new fc);Ob(this.A,new gc);Ob(this.A,new hc);this.Sh=new Wb;E(this,this.Sh);this.Ya=[];this.Ab=new Ub;E(this,this.Ab)}z(nc,D);t=nc.prototype;t.b=function(){nc.d.b.call(this)};t.update=function(a){this.Sh.update(a);this.Ab.update(a)};
t.fc=function(a,b,c){var d=this.Ab.get(a,b,c);if(d)return d;d=new Qb(this,a&-16,b&-128,c&-16);this.Ab.add(d);this.Ke(d);return d};t.ye=function(a){for(var b=0;b<this.Ya.length;b++){var c=this.Ya[b],d=c.bb,e=a.ab,f=d.min,d=d.max,h=e.min,e=e.max;-1!=(d[0]<h[0]||f[0]>e[0]||d[1]<h[1]||f[1]>e[1]||d[2]<h[2]||f[2]>e[2]?-1:f[0]>h[0]||e[0]>d[0]||f[1]>h[1]||e[1]>d[1]||f[2]>h[2]||e[2]>d[2]?0:1)&&c.ye(a)}};t.qf=x;t.we=function(a){this.Ab.we(a)};t.xe=function(a){this.Ab.xe(a)};t.Ke=x;
t.ra=function(a,b,c,d){var e=this.Ab.get(a,b,c);if(e){if(2!=e.state)return L("setBlock before chunk fully loaded - inconsistent state!"),0}else return 0;e=e.ra(a,b,c,d);if(e!=d)for(d=0;d<this.Ya.length;d++)for(var f=this.Ya[d],h=a,k=b,i=c,l=0;l<f.n.length;l++)f.n[l].ni(h,k,i,0);return e};function oc(a,b){this.ui=a;this.A=b}oc.prototype.je=x;function pc(a,b){oc.call(this,a,b)}z(pc,oc);pc.prototype.je=function(a,b,c,d,e){if(0>=c&&0<=c){a=b+16;for(c=d+16;b<a;b++)for(var f=d;f<c;f++)e.ra(b,0,f,256)}};function qc(a){this.Qb=rc(32);this.Rb=rc(32);this.Sb=rc(32);this.Dh=1;a=fa(a)?a:va();this.Qb-=rc(a);0>this.Qb&&(this.Qb+=1);this.Rb-=rc(a);0>this.Rb&&(this.Rb+=1);this.Sb-=rc(a);0>this.Sb&&(this.Sb+=1);for(a=0;100>a;a++)this.random()}function rc(a){a=a.toString();for(var b=4022871197,c=0;c<a.length;c++)var b=b+a.charCodeAt(c),d=0.02519603282416938*b,b=d>>>0,d=d-b,d=d*b,b=d>>>0,d=d-b,b=b+4294967296*d;return 2.3283064365386963E-10*(b>>>0)}
qc.prototype.random=function(){var a=2091639*this.Qb+2.3283064365386963E-10*this.Dh;this.Qb=this.Rb;this.Rb=this.Sb;return this.Sb=a-(this.Dh=a|0)};function sc(a){this.jc=new Float32Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1]);this.sc=new Uint8Array(512);for(var b=0;256>b;b++)this.sc[b]=this.sc[256+b]=~~(255*a.random())}function tc(a,b,c,d){a=a.jc;return a[3*b]*c+a[3*b+1]*d}
sc.prototype.sb=function(a,b){var c,d,e;e=(a+b)*0.5*(Math.sqrt(3)-1);var f=Math.floor(a+e),h=Math.floor(b+e),k=(3-Math.sqrt(3))/6;e=(f+h)*k;c=a-(f-e);var i=b-(h-e),l,n;c>i?(l=1,n=0):(l=0,n=1);d=c-l+k;var r=i-n+k;e=c-1+2*k;var k=i-1+2*k,u=f&255,h=h&255,v=this.sc,f=v[u+v[h]]%12;l=v[u+l+v[h+n]]%12;n=v[u+1+v[h+1]]%12;u=0.5-c*c-i*i;0>u?c=0:(u*=u,c=u*u*tc(this,f,c,i));i=0.5-d*d-r*r;0>i?d=0:(i*=i,d=i*i*tc(this,l,d,r));r=0.5-e*e-k*k;0>r?e=0:(r*=r,e=r*r*tc(this,n,e,k));return 70*(c+d+e)};function uc(a,b){oc.call(this,a,b);var c=new qc(a.Ne);this.sg=new sc(c)}z(uc,oc);uc.prototype.je=function(a,b,c,d,e){a=this.sg;for(c=0;16>c;c++)for(var f=b+c,h=0;16>h;h++){var k=d+h,i=0.5*a.sb(0.0010*f,0.0010*k),i=i+0.25*a.sb(0.0020*(f+100),0.0020*k),i=i+0.25*a.sb(0.01*(f+100),0.01*k),l=25.6*i+64|0;1>l&&(l=1);e.ra(c,l,h,257);var k=e,n=c&15,i=0,l=l-1&127,r=h&15;if(i>l)var u=i,i=l,l=u;for(n=n+16*r+256*i;i<=l;i++,n+=256)k.Z[n]=256}};function vc(a,b){this.ei=b||15;this.jc=new Float32Array(512);this.sc=new Uint8Array(256);for(var c=0;256>c;c++){var d=2*Math.PI*a.random();this.jc[c]=Math.cos(d);this.jc[256+c]=Math.sin(d);this.sc[c]=~~(255*a.random())}}
vc.prototype.sb=function(a,b){for(var c=a/this.ei,d=b/this.ei,e=~~c,f=~~d,h=0;4>h;h++){var k=e+h%2,i=f+~~(h/2),l=i+this.sc[k]&255;wc[h]=this.jc[l]*(c-k)+this.jc[256+l]*(d-i)}c-=~~c;d-=~~d;c=3*Math.pow(c,2)-2*Math.pow(c,3);e=wc[0]+c*(wc[1]-wc[0]);return e+(3*Math.pow(d,2)-2*Math.pow(d,3))*(wc[2]+c*(wc[3]-wc[2])-e)};var wc=new Float32Array(4);function xc(a,b){oc.call(this,a,b);var c=new qc(a.Ne);this.sg=new vc(c,15)}z(xc,oc);xc.prototype.je=function(a,b,c,d,e){a=this.sg;c=b+16;for(var f=d+16;b<c;b++)for(var h=d;h<f;h++){var k;k=a;var i=b+1E3,l=h+1E3;k=(k.sb(i+16,l+16)*(16-i)*(16-l)+k.sb(i,l+16)*i*(16-l)+k.sb(i,l)*i*l+k.sb(i+16,l)*(16-i)*l)/256;k=Math.max(0,Math.min(15,k/1E3|0));for(i=0;i<=64+k;i++)l=256,i>=64+k&&(l|=1),e.ra(b,i,h,l)}};var yc={flat:pc,noise:xc,improved:uc};function zc(){this.Z=new Uint16Array(32768);this.lm=new Uint16Array(32768)}zc.prototype.ja=function(){this.Z.set(this.lm)};zc.prototype.end=s("Z");zc.prototype.ra=function(a,b,c,d){this.Z[(a&15)+16*(c&15)+256*(b&127)]=d};var Ac;var Bc=w.performance;Ac=Bc&&Bc.now?function(){return Bc.now()}:Bc&&Bc.webkitNow?function(){return Bc.webkitNow()}:j;var Cc=Ac?Ac:Date.now;function Dc(a,b){for(var c in a)b.call(j,a[c],c,a)}function Ec(a){var b=[],c=0,d;for(d in a)b[c++]=a[d];return b}function Fc(a){var b=[],c=0,d;for(d in a)b[c++]=d;return b}function Gc(a){var b={},c;for(c in a)b[c]=a[c];return b}var Hc="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");
function Ic(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var f=0;f<Hc.length;f++)c=Hc[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}};function Jc(a){if("function"==typeof a.za)return a.za();if(ma(a))return a.split("");if(la(a)){for(var b=[],c=a.length,d=0;d<c;d++)b.push(a[d]);return b}return Ec(a)}function Kc(a,b,c){if("function"==typeof a.forEach)a.forEach(b,c);else if(la(a)||ma(a))xb(a,b,c);else{var d;if("function"==typeof a.jb)d=a.jb();else if("function"!=typeof a.za)if(la(a)||ma(a)){d=[];for(var e=a.length,f=0;f<e;f++)d.push(f)}else d=Fc(a);else d=j;for(var e=Jc(a),f=e.length,h=0;h<f;h++)b.call(c,e[h],d&&d[h],a)}};function Lc(a,b){this.qi=a;this.nh=b}Lc.prototype.getKey=s("qi");Lc.prototype.w=function(){return new Lc(this.qi,this.nh)};function Mc(a){this.Ka=[];if(a)a:{var b,c;if(a instanceof Mc){if(b=a.jb(),c=a.za(),0>=a.ma()){a=this.Ka;for(var d=0;d<b.length;d++)a.push(new Lc(b[d],c[d]));break a}}else b=Fc(a),c=Ec(a);for(d=0;d<b.length;d++)Nc(this,b[d],c[d])}}function Nc(a,b,c){var d=a.Ka;d.push(new Lc(b,c));b=d.length-1;a=a.Ka;for(c=a[b];0<b;)if(d=b-1>>1,a[d].getKey()>c.getKey())a[b]=a[d],b=d;else break;a[b]=c}t=Mc.prototype;
t.remove=function(){var a=this.Ka,b=a.length,c=a[0];if(!(0>=b)){if(1==b)Bb(a);else{a[0]=a.pop();for(var a=0,b=this.Ka,d=b.length,e=b[a];a<d>>1;){var f=2*a+1,h=2*a+2,f=h<d&&b[h].getKey()<b[f].getKey()?h:f;if(b[f].getKey()>e.getKey())break;b[a]=b[f];a=f}b[a]=e}return c.nh}};t.za=function(){for(var a=this.Ka,b=[],c=a.length,d=0;d<c;d++)b.push(a[d].nh);return b};t.jb=function(){for(var a=this.Ka,b=[],c=a.length,d=0;d<c;d++)b.push(a[d].getKey());return b};
t.Cb=function(a){return Ab(this.Ka,function(b){return b.getKey()==a})};t.w=function(){return new Mc(this)};t.ma=function(){return this.Ka.length};t.clear=function(){Bb(this.Ka)};function Oc(){Mc.call(this)}z(Oc,Mc);Oc.prototype.fe=function(a,b){Nc(this,a,b)};function Pc(a,b,c){D.call(this);this.ci=b;this.nd=c;this.le=new Oc;this.vc=q;this.sd=p;this.Df=new zc}z(Pc,D);Pc.prototype.b=function(){this.vc&&(this.vc=q,w.clearTimeout(this.sd),this.sd=p);Pc.d.b.call(this)};Pc.prototype.update=aa();Pc.prototype.Ke=function(a,b){var c=fa(b)?b:Number.MAX_VALUE;a.state=1;var d=this.nd,e=new N,f=new Qc(e,Rc,a.x,a.y,a.l);f.Nc=a;f.uc=c;d.pa.push(f);d.rc||d.ob();d.pg=m;O(e,aa(),function(){this.le.fe(c,a);this.vc||(this.vc=m,this.sd=w.setTimeout(y(this.Ri,this),5))},this)};
Pc.prototype.Ri=function(){for(var a=Cc();this.le.ma();){var b=this.le.remove(),c=new qc(this.ci.ui.Ne);this.Df.ja();this.ci.je(c,b.x,b.y,b.l,this.Df);b.fill(this.Df.end());if(16<Cc()-a)break}this.le.ma()?(this.vc=m,this.sd=w.setTimeout(y(this.Ri,this),5)):(this.vc=q,this.sd=p)};function Sc(){D.call(this)}z(Sc,D);Sc.prototype.update=aa();/*
 Portions of this code are from MochiKit, received by
 The Closure Authors under the MIT license. All other code is Copyright
 2005-2009 The Closure Authors. All Rights Reserved.
*/
function N(a,b){this.Oe=[];this.Fi=a;this.Oh=b||p}t=N.prototype;t.Gb=q;t.bd=q;t.yf=q;t.Tj=q;t.Vg=q;t.zf=0;t.cancel=function(a){if(this.Gb)this.wd instanceof N&&this.wd.cancel();else{if(this.P){var b=this.P;delete this.P;a?b.cancel(a):(b.zf--,0>=b.zf&&b.cancel())}this.Fi?this.Fi.call(this.Oh,this):this.Vg=m;this.Gb||this.a(new Tc(this))}};t.Jh=function(a,b){this.yf=q;Uc(this,a,b)};function Uc(a,b,c){a.Gb=m;a.wd=c;a.bd=!b;Vc(a)}function Wc(a){a.Gb&&(a.Vg||g(new Xc(a)),a.Vg=q)}
t.e=function(a){Wc(this);Uc(this,m,a)};t.a=function(a){Wc(this);Uc(this,q,a)};function O(a,b,c,d){a.Oe.push([b,c,d]);a.Gb&&Vc(a);return a}function Yc(a){return Ab(a.Oe,function(a){return na(a[1])})}
function Vc(a){a.fh&&(a.Gb&&Yc(a))&&(w.clearTimeout(a.fh),delete a.fh);a.P&&(a.P.zf--,delete a.P);for(var b=a.wd,c=q,d=q;a.Oe.length&&!a.yf;){var e=a.Oe.shift(),f=e[0],h=e[1],e=e[2];if(f=a.bd?h:f)try{var k=f.call(e||a.Oh,b);fa(k)&&(a.bd=a.bd&&(k==b||k instanceof Error),a.wd=b=k);b instanceof N&&(d=m,a.yf=m)}catch(i){b=i,a.bd=m,Yc(a)||(c=m)}}a.wd=b;d&&(O(b,y(a.Jh,a,m),y(a.Jh,a,q)),b.Tj=m);c&&(a.fh=w.setTimeout(function(){g(b)},0))}function Zc(a){var b=new N;b.e(a);return b}
function $c(a){var b=new N;b.a(a);return b}function Xc(a){jb.call(this);this.ka=a}z(Xc,jb);Xc.prototype.message="Deferred has already fired";Xc.prototype.name="AlreadyCalledError";function Tc(a){jb.call(this);this.ka=a}z(Tc,jb);Tc.prototype.message="Deferred was cancelled";Tc.prototype.name="CancelledError";function ad(a,b,c,d,e,f){N.call(this,e,f);this.q=a;this.Lf=[];this.Xh=!!b;this.kk=!!c;this.ck=!!d;for(b=0;b<a.length;b++)O(a[b],y(this.fi,this,b,m),y(this.fi,this,b,q));0==a.length&&!this.Xh&&this.e(this.Lf)}z(ad,N);ad.prototype.Ei=0;ad.prototype.fi=function(a,b,c){this.Ei++;this.Lf[a]=[b,c];this.Gb||(this.Xh&&b?this.e([a,c]):this.kk&&!b?this.a(c):this.Ei==this.q.length&&this.e(this.Lf));this.ck&&!b&&(c=p);return c};ad.prototype.a=function(a){ad.d.a.call(this,a);xb(this.q,function(a){a.cancel()})};function bd(a,b){nc.call(this);var c;(c=yc[a.bi])||(c=yc.flat);c=new c(a,this.A);this.ui=a;this.nd=b;E(this,this.nd);this.tb=new Sc;E(this,this.tb);this.Ff=new Pc(0,c,b);E(this,this.Ff);this.ee=[]}z(bd,nc);bd.prototype.update=function(a){bd.d.update.call(this,a);this.tb.update(a);this.Ff.update(a);this.flush();this.nd.update(a)};bd.prototype.qf=function(a){this.ee.push(a);a.Ma||a.map.xe(a);a.Ma++};
bd.prototype.flush=function(){for(var a=[],b=0;b<this.ee.length;b++){var c=this.ee[b];a.push(cd(this.nd,c));c.bc=q;c.Ma--;c.Ma||c.map.we(c)}this.ee.length=0;return new ad(a)};bd.prototype.Ke=function(a){for(var b=Number.MAX_VALUE,c=0;c<this.Ya.length;c++){var d=this.Ya[c],e=a.x-d.Ha[0],d=a.l-d.Ha[2],e=e*e+d*d;e<b&&(b=e)}b==Number.MAX_VALUE&&(b=j);this.Ff.Ke(a,b)};function dd(a){this.factory=a;this.ta=this.Xe=0}dd.prototype.getTime=s("Xe");dd.prototype.read=function(a){var b=this.factory.z;b&2&&(this.Xe=a.r()/1E3);b&4||(this.ta=a.r())};dd.prototype.write=function(a){var b=this.factory.z;b&2&&a.s(1E3*this.Xe|0);b&4||a.s(this.ta)};dd.prototype.Ob=function(){this.factory.Ob(this)};function ed(a){dd.call(this,a);this.Zg=0;this.ne=q}z(ed,dd);ed.prototype.read=function(a){ed.d.read.call(this,a);this.Zg=a.r()/1E3;this.ne=q};
ed.prototype.write=function(a){ed.d.write.call(this,a);a.s(1E3*this.Zg|0)};function fd(a){dd.call(this,a);this.xg=0}z(fd,dd);fd.prototype.read=function(a){fd.d.read.call(this,a);this.xg=a.r()};fd.prototype.write=function(a){fd.d.write.call(this,a);a.s(this.xg)};function P(a,b,c,d){D.call(this);this.X=a;this.factory=b;this.ga=p;this.C=c;this.Ja=d;this.P=p;this.J=[];this.T=0;this.g=gd(b,this);this.yd=[]}z(P,D);t=P.prototype;t.b=function(){var a=this.getParent();a&&(Cb(a.J,this),a.$b(this));this.factory.Ue.push(this.g);for(a=0;a<this.yd.length;a++)this.factory.Ue.push(this.yd[a]);P.d.b.call(this)};
function hd(a,b){for(var c="",d=0;d<b;d++)c+="..";L(c+"Entity "+a.C+" / type "+a.factory.Ga+(a.ga?" / owner "+a.ga.c:""));if(a.J.length)for(d=0;d<a.J.length;d++)hd(a.J[d],b+1)}t.ea=s("X");t.getParent=s("P");function id(a,b){if(a.P!=b){var c=a.P;a.P=b;if(!(a.Ja&jd)){var d=a.Kf(0);d.xg=b?b.C:0;kd(a.X,d)}a.vg(c,b);c&&(Cb(c.J,a),c.$b(a));b&&b.pf(a)}}t.pf=function(a){this.J.push(a);this.Wd(a)};t.vg=x;t.Wd=x;t.$b=x;t.bg=ca(p);t.read=function(a){this.g.read(a)};t.Ig=function(a){this.g.Ig(a)};t.write=function(a){this.g.write(a)};
t.ph=function(a){this.g.ph(a)};function ld(a,b){if(a.Ja&md){1==a.yd.length&&(a.yd[0].time=b);var c=gd(a.factory,a);c.time=b;a.g.Jf(c);a.yd.push(c)}}t.li=x;t.Kf=function(a){a=nd(this.X.Ra[a]||p);a.ta=this.C;return a};t.la=aa();function od(a,b,c){a.Rf||pd(a.X.tb,b,c===j?0:c,a.update,a)}t.Cg=aa();t.yl=x;t.vd=function(){this.T=0;this.g.vd()};var jd=1,md=8;function qd(){this.Ic=[];this.f=0}qd.prototype.compact=aa();qd.prototype.ma=s("f");qd.prototype.yb=function(a){this.Ic[this.f++]=a};function rd(a){for(var b=0;b<a.f;b++){var c=a.Ic[b];c.factory.Ob(c)}a.f=0};function sd(){this.buffer=new Uint8Array(512);this.offset=0;this.U=new Float32Array(16);this.da=new Uint8Array(this.U.buffer);this.nk=(this.Xc=w.Float64Array?new Float64Array(1):p)?new Uint8Array(this.Xc.buffer):p}t=sd.prototype;t.hb=function(){this.offset=0};t.finish=function(){for(var a=new Uint8Array(this.offset),b=0;b<this.offset;b++)a[b]=this.buffer[b];this.offset=0;return a.buffer};
function td(a,b){if(a.offset+b>a.buffer.length){var c=a.offset+b,d=a.buffer.length;do d+=1024;while(d<c);c=new Uint8Array(d);for(d=0;d<a.offset;d++)c[d]=a.buffer[d];a.buffer=c}}function ud(a,b){td(a,2);a.buffer[a.offset++]=b>>8;a.buffer[a.offset++]=b}function vd(a,b){td(a,4);a.buffer[a.offset++]=b>>24;a.buffer[a.offset++]=b>>16;a.buffer[a.offset++]=b>>8;a.buffer[a.offset++]=b}function Q(a,b){td(a,1);a.buffer[a.offset++]=b}function wd(a,b){td(a,2);a.buffer[a.offset++]=b>>8;a.buffer[a.offset++]=b}
t.M=function(a){td(this,4);this.buffer[this.offset++]=a>>24;this.buffer[this.offset++]=a>>16;this.buffer[this.offset++]=a>>8;this.buffer[this.offset++]=a};t.s=function(a){td(this,5);for(a&=4294967295;a&4294967168;)this.buffer[this.offset++]=a&127|128,a>>>=7;this.buffer[this.offset++]=a&127};t.lf=function(a){this.s(a<<1^a>>31)};
t.Cj=function(a){td(this,4);this.U[0]=a;this.buffer[this.offset++]=this.da[0];this.buffer[this.offset++]=this.da[1];this.buffer[this.offset++]=this.da[2];this.buffer[this.offset++]=this.da[3]};t.jm=function(a){td(this,12);this.U[0]=a[0];this.U[1]=a[1];this.U[2]=a[2];for(a=0;12>a;a++)this.buffer[this.offset++]=this.da[a]};t.km=function(a){td(this,16);this.U[0]=a[0];this.U[1]=a[1];this.U[2]=a[2];this.U[3]=a[3];for(a=0;16>a;a++)this.buffer[this.offset++]=this.da[a]};
t.o=function(a){65535<=a.length&&(a=a.substr(0,65535));td(this,4+3*a.length);wd(this,a.length);var b=this.offset;this.offset+=2;for(var c=0,d=0;d<a.length;d++){var e=a.charCodeAt(d);128>e?(this.buffer[this.offset++]=e,c++):2048>e?(this.buffer[this.offset++]=e>>6|192,this.buffer[this.offset++]=e&63|128,c+=2):(this.buffer[this.offset++]=e>>12|224,this.buffer[this.offset++]=e>>6&63|128,this.buffer[this.offset++]=e&63|128,c+=3)}a=this.offset;this.offset=b;wd(this,c);this.offset=a};var xd=p;
function R(){xd||(xd=new sd);return xd};function yd(){this.Ch=this.Qd=this.$m=this.Bm=this.wi=this.xi=this.Ld=0}yd.prototype.w=function(){return new yd};yd.prototype.toString=ca("[stats]");var zd,Ad,Bd,Cd,Dd;function Ed(){return w.navigator?w.navigator.userAgent:p}Cd=Bd=Ad=zd=q;var Fd;if(Fd=Ed()){var Gd=w.navigator;zd=0==Fd.indexOf("Opera");Ad=!zd&&-1!=Fd.indexOf("MSIE");Bd=!zd&&-1!=Fd.indexOf("WebKit");Cd=!zd&&!Bd&&"Gecko"==Gd.product}var Hd=zd,Id=Ad,Ld=Cd,Md=Bd,Nd,Od=w.navigator;Nd=Od&&Od.platform||"";Dd=-1!=Nd.indexOf("Mac");var Pd=-1!=Nd.indexOf("Win");function Qd(){var a=w.document;return a?a.documentMode:j}var Rd;
a:{var Sd="",Td;if(Hd&&w.opera)var Ud=w.opera.version,Sd="function"==typeof Ud?Ud():Ud;else if(Ld?Td=/rv\:([^\);]+)(\)|;)/:Id?Td=/MSIE\s+([^\);]+)(\)|;)/:Md&&(Td=/WebKit\/(\S+)/),Td)var Vd=Td.exec(Ed()),Sd=Vd?Vd[1]:"";if(Id){var Wd=Qd();if(Wd>parseFloat(Sd)){Rd=String(Wd);break a}}Rd=Sd}var Xd={};
function Yd(a){var b;if(!(b=Xd[a])){b=0;for(var c=lb(String(Rd)).split("."),d=lb(String(a)).split("."),e=Math.max(c.length,d.length),f=0;0==b&&f<e;f++){var h=c[f]||"",k=d[f]||"",i=RegExp("(\\d*)(\\D*)","g"),l=RegExp("(\\d*)(\\D*)","g");do{var n=i.exec(h)||["","",""],r=l.exec(k)||["","",""];if(0==n[0].length&&0==r[0].length)break;b=((0==n[1].length?0:parseInt(n[1],10))<(0==r[1].length?0:parseInt(r[1],10))?-1:(0==n[1].length?0:parseInt(n[1],10))>(0==r[1].length?0:parseInt(r[1],10))?1:0)||((0==n[2].length)<
(0==r[2].length)?-1:(0==n[2].length)>(0==r[2].length)?1:0)||(n[2]<r[2]?-1:n[2]>r[2]?1:0)}while(0==b)}b=Xd[a]=0<=b}return b}var Zd=w.document,$d=!Zd||!Id?j:Qd()||("CSS1Compat"==Zd.compatMode?parseInt(Rd,10):5);(function(){var a;return Pd?(a=/Windows NT ([0-9.]+)/,(a=a.exec(Ed()))?a[1]:"0"):Dd?(a=/10[_.][0-9_.]+/,(a=a.exec(Ed()))?a[0].replace(/_/g,"."):"10"):""})();function ae(){this.Aj="";this.type=be;this.platform=ce;this.qd="";this.Tc=de}ae.prototype.w=function(){var a=new ae;a.Aj=this.Aj;a.type=this.type;a.platform=this.platform;a.qd=this.qd;a.Tc=this.Tc;return a};ae.prototype.toString=function(){return[this.type,this.platform+this.qd,this.Tc].join("/")};var be="unknown",ce="other",de="desktop";function ee(){this.Jd="none";this.Id="0";this.ya="User"}ee.prototype.w=function(){var a=new ee;a.Jd=this.Jd;a.Id=this.Id;a.ya=this.ya;return a};ee.prototype.toString=ca("[user]");function fe(a,b,c,d,e){this.c=a||"";this.R=b||0;this.z=c||0;this.info=d||new ee;this.Gd=e||new ae;this.Of=0;this.i=new yd;this.data=this.ia=p}fe.prototype.toString=function(){return this.info.ya+" ("+this.c+"/"+this.R+")"};function ge(a){return new fe(a.c,a.R,a.z,a.info.w(),a.Gd.w())};function he(a){this.sa=a;this.eb=0;this.Yd=[];this.Bb=0;this.ae=[];this.Db=0;this.Ze=[];this.Xb=0;this.ce=[];this.Eb=0}he.prototype.ja=ba("eb");he.prototype.yb=function(a){this.Yd[this.Bb++]=a};
he.prototype.finish=function(a){var b=R();Q(b,30);var c=0;b.s(1E3*a|0);b.s(this.eb);b.s(this.Db);b.s(this.Xb);b.s(this.Eb);b.s(this.Bb);for(a=0;a<this.Db;a++){var d=this.ae[a];this.ae[a]=p;c=b.offset;b.s(d.C>>1);b.s(d.factory.Ga);b.s(d.Ja);var e=d.ga;b.s(e?e.R:0);e=d.getParent();b.s(e?e.C:0);d.write(b);this.sa.ge++;this.sa.cc+=b.offset-c}for(a=this.Db=0;a<this.Xb;a++)d=this.Ze[a],this.Ze[a]=p,c=b.offset,b.s(d.C>>1),d.ph(b),this.sa.ie++,this.sa.ec+=b.offset-c;for(a=this.Xb=0;a<this.Eb;a++)d=this.ce[a],
this.ce[a]=p,c=b.offset,b.s(d.C>>1),this.sa.he++,this.sa.dc+=b.offset-c;for(a=this.Eb=0;a<this.Bb;a++)d=this.Yd[a],this.Yd[a]=p,c=b.offset,b.s(d.factory.Ga),d.write(b),this.sa.ze++,this.sa.pc+=b.offset-c;this.Bb=0;return b.finish()};he.prototype.hb=function(){for(var a=this.eb=0;a<this.Db;a++)this.ae[a]=p;for(a=this.Db=0;a<this.Xb;a++)this.Ze[a]=p;for(a=this.Xb=0;a<this.Eb;a++)this.ce[a]=p;for(a=this.Eb=0;a<this.Bb;a++)this.Yd[a]=p;this.Bb=0};function ie(a,b,c){D.call(this);this.Oa=a;this.W=b;this.Gc=c;this.eb=this.si=0;this.Aa=new qd;this.Ba=new qd;this.bh={};this.af={};this.$e=[];this.el=0;this.S=new he(a.i)}z(ie,D);ie.prototype.lb=s("Gc");ie.prototype.compact=function(){this.Aa.compact();this.Ba.compact()};function je(a,b){var c=b.Ja;if(!(c&jd)&&!(c&64&&b.ga!=a.Gc)){var c=b.C,d=0;a.bh[c]||(d|=1,a.bh[c]=m);var e=a.af[c]|0,d=e|d|b.T;e||a.$e.push(b);e!=d&&(a.af[c]=d)}}
ie.prototype.flush=function(a){this.el=a;var b=this.S;b.ja(this.eb);var c=this.eb!=this.si;this.si=this.eb;var d=this.Ba.Ic,e=this.Ba.ma();if(e){for(var f=0;f<e;f++){var h=d[f];(0==h.ta||this.bh[h.ta])&&b.yb(h)}this.Ba.f=0}for(f=0;f<this.$e.length;f++)d=this.$e[f],e=d.C,h=this.af[e],delete this.af[e],h&&5!=(h&5)&&(h&4?b.ce[b.Eb++]=d:h&1?b.ae[b.Db++]=d:h&2&&(b.Ze[b.Xb++]=d));c||0<b.Bb+b.Db+b.Xb+b.Eb?this.W.send(b.finish(a),this.Gc):b.hb();this.$e.length=0};function ke(a,b,c){ie.call(this,a,b,c)}z(ke,ie);var le=new function(){this.l=this.y=this.x=0};function me(){var a=R();Q(a,74);return a.finish()};function ne(a){D.call(this);this.bj=a}z(ne,D);function oe(a){D.call(this);this.Jl=a;this.Mg=[[],[],[],[],[]];this.yj=[]}z(oe,D);function pd(a,b,c,d,e){var f=a.yj.pop()||new pe;f.uc=b;f.Lg=a.Jl.G.Ib;f.We=-1==c?0:0==c?f.Lg+0.0010:c;f.e=d;f.Bf=e||w;a=a.Mg[b];b=0;for(c=a.length;b<c;)d=b+c>>1,0<f.We-a[d].We?b=d+1:c=d;a.splice(b,0,f)}var qe=Number.MAX_VALUE;
oe.prototype.update=function(a){a=a.time;for(var b=Cc(),c=this.Mg.length-1;0<=c;c--){for(var d=this.Mg[c];d.length;){var e=d[0];if(e.We>a)break;d.shift();var f=a-e.Lg,h=e.e,k=e.Bf;e.e=e.Bf=p;this.yj.push(e);h.call(k,a,f)}if(Cc()-b>=qe)break}};function pe(){this.uc=re;this.We=this.Lg=0;this.Bf=this.e=p}var re=0;function se(){this.ld=this.La=this.re=this.tl=this.Yk=this.pc=this.ze=this.kc=this.ed=this.dc=this.he=this.ec=this.ie=this.cc=this.ge=0}se.prototype.update=function(a){this.La+=this.cc;this.La+=this.ec;this.La+=this.dc;this.re+=this.kc;this.La+=this.pc;1<=a-this.ld&&(this.ld=a,this.Yk=this.re,this.tl=this.La,this.La=this.re=0);this.ze=this.pc=this.ed=this.kc=this.he=this.dc=this.ie=this.ec=this.ge=this.cc=0};function te(a,b,c){this.Ga=a;this.ak=b;this.z=c;this.gh=[]}function nd(a){return a.gh.length?(a=a.gh.pop(),a.ta=0,a):new a.ak(a)}te.prototype.Ob=function(a){this.gh.push(a)};function ue(a){ue[" "](a);return a}ue[" "]=x;var ve=!!w.wtf&&2==w.wtf.trace.API_VERSION,we=ve?w.wtf.trace.appendScopeData:x,xe=ve?w.wtf.trace.instrument:ia,ye=ve?w.wtf.trace.instrumentType:ia;function ze(a,b){ne.call(this,a);this.i=new se;this.tb=new oe(a);E(this,this.tb);this.gf=[];this.Ra={};this.Tf={};this.rg=b;this.u={};this.Ac=p;this.xa=Array(256);this.wa=0;var c=new te(0,fd,0);this.Ra[c.Ga]=c}z(ze,ne);function Ae(a,b){a.Tf[b.Ga]=b}function Be(a){var b=a.rg;a.rg+=2;return b}t=ze.prototype;t.va=function(a,b){var c=this.Tf[a].va(this,Be(this),b);this.Zb(c);return c};t.Zb=function(a){this.u[a.C]=a;var b=!!a.T;a.T|=1;b||(this.xa[this.wa++]=a);a.Ja&128&&(this.Ac=a)};
t.Yh=function(a,b){for(var c in this.u)a.call(b||w,this.u[Number(c)])};t.qb=function(a,b){if(!(a.T&4)){switch(b||Ce){default:case Ce:for(var c=a.J.length-1;0<=c;c--){var d=a.J[c];a.$b(d);a.X.qb(d)}if(d=a.bg())for(c=0;c<d.length;c++)a.X.qb(d[c]);break;case De:for(c=0;c<a.J.length;c++)id(a.J[c],p);if(d=a.bg())for(c=0;c<d.length;c++)id(d[c],p);case Ee:}delete this.u[a.C];c=!!a.T;a.T|=4;c||(this.xa[this.wa++]=a);J(a)}};t.Kf=function(a){a=nd(this.Ra[a]||p);a.ta=0;return a};
t.Wc=function(a,b){for(var c=0;c<b;c++){var d=a[c],e=d.ta;0==e?this.la(d):(e=this.u[e]||p)&&e.la(d);d instanceof ed&&(d.ne=m)}};t.la=x;t.Ni=function(){for(var a=0;a<this.wa;a++){var b=this.xa[a];b.Cg()}for(a=0;a<this.wa;a++){b=this.xa[a];this.xa[a]=p;if(b.T&1)for(var c=0;c<this.gf.length;c++)this.gf[c].Em(b);if(b.T&4)for(c=0;c<this.gf.length;c++)this.gf[c].Fm(b);b.vd()}this.wa=0};t.Eg=function(a){for(var b=0;b<this.wa;b++){var c=this.xa[b];c.yl(a);this.Oi(a,c)}};t.Oi=x;
t.tc=function(){for(var a=0;a<this.wa;a++){var b=this.xa[a];this.xa[a]=p;b.vd()}this.wa=0};var Ce=0,De=1,Ee=2,ze=ye(ze,"gf.sim.Simulator",{Yh:"forEachEntity",Wc:"executeCommands",Ni:"postNetworkUpdateEntities",Eg:"postTickUpdateEntities",tc:"postUpdate"});function Fe(){this.Di=1;this.eh=[];this.Vb=0;this.tg=[];this.qc=0;this.Ji=[];this.ug=0}Fe.prototype.compact=aa();Fe.prototype.yb=function(a){this.tg[this.qc++]=a;a instanceof ed&&(a.dj=this.Di++,a.ne=q,this.Ji[this.ug++]=a)};
Fe.prototype.write=function(a){a.s(this.Di-1);var b=this.qc;a.s(this.qc);for(var c=0;c<this.qc;c++){var d=this.tg[c];this.tg[c]=p;a.s(d.factory.Ga);d.write(a);d instanceof ed?this.eh[this.Vb++]=d:d.factory.Ob(d)}this.ug=this.qc=0;1500<this.Vb&&L("massive backup of commands, dying");return b};function S(a,b){ze.call(this,a,1);this.W=b;Ge(b.Mb,30,this.hi,this);this.se=[];this.Aa=new qd;this.Ba=new Fe;this.kd=0}z(S,ze);S.prototype.b=function(){S.d.b.call(this)};S.prototype.lb=function(a){return this.W.Yb[a]||p};S.prototype.Zb=function(a){S.d.Zb.call(this,a);a.Ja&(4|md)&&this.se.push(a)};S.prototype.qb=function(a,b){S.d.qb.call(this,a,b);a.Ja&(4|md)&&Cb(this.se,a)};S.Gj=20;
S.prototype.update=function(a){var b=He(this.bj.G)+this.bj.G.Xd;this.mi(b-0.5);this.Wc(this.Aa.Ic,this.Aa.ma());rd(this.Aa);this.tb.update(a);this.Eg(a);this.cj(a);this.tc(a);this.Pc(a)};S.prototype.mi=function(a){for(var b=0;b<this.se.length;b++)this.se[b].li(a);a=this.Ba;this.Wc(a.eh,a.Vb);this.Wc(a.Ji,a.ug)};S.prototype.cj=function(a){if(this.Ba.qc&&a.time-this.kd>=1/S.Gj){this.kd=a.time;a=R();Q(a,31);var b=this.Ba.write(a);this.i.ze+=b;this.i.pc+=a.offset;this.W.send(a.finish())}};S.of=15;
S.prototype.Pc=function(a){a.time-this.kg<S.of||(this.kg=a.time,this.Aa.compact(),this.Ba.compact())};
S.prototype.hi=function(a,b,c){b=c.r()/1E3;var d=c.r(),e=c.r(),f=c.r(),h=c.r();a=c.r();this.i.ge+=e;this.i.ie+=f;this.i.he+=h;this.i.ed+=a;var k=this.Ba,i=k.eh,l=k.Vb;if(l)if(i[l-1].dj<=d){for(var n=0;n<l;n++){var r=i[n];r.factory.Ob(r)}k.Vb=0}else{for(var u=l,n=0;n<l;n++){r=i[n];if(r.dj>d){u=n;break}r.factory.Ob(r)}i.splice(0,u);k.Vb-=u}for(d=0;d<this.wa;d++)k=this.xa[d],this.xa[d]=p,k.vd();this.wa=0;i=p;for(d=k=0;d<e;d++){var k=c.offset,n=c.r()<<1,v=c.r(),r=c.r(),u=c.r(),l=c.r(),v=this.Tf[v]||p;
if(!v)return q;(u=u?this.W.mh[u]||p:p)&&(u!=this.W.Im()&&r&4)&&(r&=-5);n=v.va(this,n,r);n.ga=u;n.read(c);this.i.cc+=c.offset-k;ld(n,b);this.Zb(n);l&&(i||(i=[]),i.push([n,l]))}for(d=0;d<f;d++){k=c.offset;n=c.r()<<1;n=this.u[n]||p;if(!n)return q;n.Ig(c);this.i.ec+=c.offset-k;ld(n,b)}for(d=0;d<h;d++){k=c.offset;n=c.r()<<1;this.i.dc+=c.offset-k;n=this.u[n]||p;if(!n)return q;this.qb(n,Ee)}if(i)for(d=0;d<i.length;d++){n=i[d][0];b=this.u[i[d][1]]||p;if(!b)return q;id(n,b)}this.Ni();for(d=0;d<a;d++){k=c.offset;
b=c.r();b=this.Ra[b]||p;if(!b)return q;b=nd(b);b.read(c);this.i.kc+=c.offset-k;this.Aa.yb(b)}return m};S=ye(S,"gf.sim.ClientSimulator",{update:"update",mi:"interpolateEntities",cj:"sendPendingCommands_",Pc:"compact_",hi:"handleSyncSimulation_"});function Ie(a,b,c){ze.call(this,a,2);this.W=b;this.W.V.push(this);Ge(this.W.Mb,31,this.gi,this);this.ql=c;this.n=[];this.Bd={};this.Gf=new qd}z(Ie,ze);t=Ie.prototype;t.b=function(){ib(this.n);Ie.d.b.call(this)};t.lb=function(a){return this.W.Yb[a]||p};t.rf=function(a){this.n.push(a);var b=a.lb();b&&(this.Bd[b.c]=a);this.Yh(function(b){je(a,b)},this)};t.Xi=function(a){var b=a.lb();b&&delete this.Bd[b.c];Cb(this.n,a);J(a)};
t.update=function(a){for(var b=0;b<this.n.length;b++){var c=this.n[b];c.Oa.Wc(c.Aa.Ic,c.Aa.ma());rd(c.Aa)}this.tb.update(a);this.Eg(a);this.tc(a);this.Pc(a)};t.la=aa();function kd(a,b,c){for(var d=0;d<a.n.length;d++){var e=a.n[d];if(!(c&&e.lb()==c))a:{if(0!=b.ta){var f=e.Oa.u[b.ta]||p;if(f.Ja&64&&f.ga!=e.Gc)break a}e.Ba.yb(b)}}a.Gf.yb(b)}t.Oi=function(a,b){if(!(b.Ja&jd))for(var c=0;c<this.n.length;c++)je(this.n[c],b)};
t.tc=function(a){for(var b=0;b<this.n.length;b++)this.n[b].flush(a.time);rd(this.Gf);Ie.d.tc.call(this,a)};Ie.of=15;t=Ie.prototype;t.Pc=function(a){if(!(a.time-this.kg<Ie.of)){this.kg=a.time;this.Gf.compact();for(a=0;a<this.n.length;a++)this.n[a].compact()}};t.fb=x;t.Pf=x;t.jh=function(a){var b=this.Bd[a.c]||p;b||(b=new this.ql(this,this.W,a),this.rf(b))};t.kh=function(a){(a=this.Bd[a.c]||p)&&this.Xi(a)};t.lh=x;
t.gi=function(a,b,c){if(!a.I)return q;b=this.Bd[a.I.c]||p;if(!b)return q;var d=c.r(),e=c.r();this.i.ed+=e;this.i.kc+=a.data.length;for(var f=0;f<e;f++){var h=c.r(),h=this.Ra[h]||p;if(!h)return q;h=nd(h);h.read(c);var k=0==h.ta;k||(k=this.u[h.ta]||p,k=!k||k.ga!=a.I);if(k)return h.Ob(),q;b.Aa.yb(h)}b.eb=d;return m};Ie=ye(Ie,"gf.sim.ServerSimulator",{update:"update",tc:"postUpdate",Pc:"compact_",gi:"handleExecCommands_"});function Je(a){return Ke(a.X.Ac.g)};function Le(a,b,c,d){P.call(this,a,b,c,d);this.ai=p}z(Le,P);function Me(a){ed.call(this,a);this.Gl=this.zg=this.qh=this.Og=this.Ng=this.xb=this.dh=0}z(Me,ed);var Ne=360*(1/32767)*Math.PI/180;Me.prototype.read=function(a){Me.d.read.call(this,a);this.dh=Oe(a);this.xb=Oe(a);this.xb&1&&(this.Ng=Pe(a),this.Og=Pe(a));this.qh=Qe(a);this.zg=Qe(a)};Me.prototype.write=function(a){Me.d.write.call(this,a);Q(a,this.dh);Q(a,this.xb);this.xb&1&&(wd(a,this.Ng),wd(a,this.Og));ud(a,this.qh);ud(a,this.zg)};function Re(a){dd.call(this,a);this.uf=0}z(Re,dd);Re.prototype.read=function(a){Re.d.read.call(this,a);this.uf=a.Vi()};Re.prototype.write=function(a){Re.d.write.call(this,a);a.Cj(this.uf)};function Se(a){dd.call(this,a);this.data=this.l=this.y=this.x=0}z(Se,dd);Se.prototype.read=function(a){Se.d.read.call(this,a);this.x=a.Fe();this.y=a.Fe();this.l=a.Fe();this.data=Pe(a)};Se.prototype.write=function(a){Se.d.write.call(this,a);a.lf(this.x);a.lf(this.y);a.lf(this.l);wd(a,this.data)};function Te(a){ed.call(this,a);this.ah=0}z(Te,ed);Te.prototype.read=function(a){Te.d.read.call(this,a);this.ah=a.ha()};Te.prototype.write=function(a){Te.d.write.call(this,a);a.M(this.ah)};var Ue=ed.mm;function Ve(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],h=2*c,k=2*d,i=2*e,l=h*f,n=k*f,f=i*f,h=h*c,r=k*c,c=i*c,k=k*d,d=i*d,e=i*e;b[0]=1-(k+e);b[1]=r+f;b[2]=c-n;b[3]=0;b[4]=r-f;b[5]=1-(h+e);b[6]=d+l;b[7]=0;b[8]=c+n;b[9]=d-l;b[10]=1-(h+k);b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1}
function We(a,b,c,d){var e=a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3];if(1<e||-1>e)return Ya(d,b),d;var f=1;0>e&&(f=-1,e=-e);var h=Math.acos(e);if(1E-6>=h)return Ya(d,b),d;var k=1/Math.sin(h),e=Math.sin((1-c)*h)*k;c=f*Math.sin(c*h)*k;d[0]=a[0]*e+b[0]*c;d[1]=a[1]*e+b[1]*c;d[2]=a[2]*e+b[2]*c;d[3]=a[3]*e+b[3]*c;return d};function Xe(a,b,c,d){P.call(this,a,b,c,d);this.wb=m;this.Kc=C();this.Yl=new Float32Array(16);this.g.pj(Ca(1,1,1))}z(Xe,P);Xe.prototype.Cg=function(){Xe.d.Cg.call(this);this.wb=m};
function Ye(a,b){if(a.wb&&a.wb){a.wb=q;var c=a.g,d=c.ad(),e=c.Na,f=c.Me;a.Kc[0]=d[0];a.Kc[1]=d[1];a.Kc[2]=d[2];a.Kc[3]=c.Nd*Math.max(f[0],Math.max(f[1],f[2]));c=a.Yl;Ve(e,c);var e=f[0],h=f[1],f=f[2],k=c[1],i=c[2],l=c[3],n=c[4],r=c[5],u=c[6],v=c[7],F=c[8],H=c[9],G=c[10],I=c[11],M=c[12],ga=c[13],Z=c[14],qa=c[15];c[0]*=e;c[1]=k*e;c[2]=i*e;c[3]=l*e;c[4]=n*h;c[5]=r*h;c[6]=u*h;c[7]=v*h;c[8]=F*f;c[9]=H*f;c[10]=G*f;c[11]=I*f;c[12]=M;c[13]=ga;c[14]=Z;c[15]=qa;e=d[0];h=d[1];d=d[2];f=c[1];k=c[2];i=c[3];l=c[4];
n=c[5];r=c[6];u=c[7];v=c[8];F=c[9];H=c[10];G=c[11];I=c[12];M=c[13];ga=c[14];Z=c[15];c[0]+=e*i;c[1]=f+h*i;c[2]=k+d*i;c[3]=i;c[4]=l+e*u;c[5]=n+h*u;c[6]=r+d*u;c[7]=u;c[8]=v+e*G;c[9]=F+h*G;c[10]=H+d*G;c[11]=G;c[12]=I+e*Z;c[13]=M+h*Z;c[14]=ga+d*Z;c[15]=Z;a.getParent()}Ya(b,a.Kc)}
Xe.prototype.Sd=function(a){var b=this.g,c=a.ff,d=b.ad();Ve(b.Na,c);if(c==c){var b=c[1],e=c[2],f=c[3],h=c[6],k=c[7],i=c[11];c[1]=c[4];c[2]=c[8];c[3]=c[12];c[4]=b;c[6]=c[9];c[7]=c[13];c[8]=e;c[9]=h;c[11]=c[14];c[12]=f;c[13]=k;c[14]=i}else c[0]=c[0],c[1]=c[4],c[2]=c[8],c[3]=c[12],c[4]=c[1],c[5]=c[5],c[6]=c[9],c[7]=c[13],c[8]=c[2],c[9]=c[6],c[10]=c[10],c[11]=c[14],c[12]=c[3],c[13]=c[7],c[14]=c[11],c[15]=c[15];b=-d[0];e=-d[1];d=-d[2];f=c[1]*b+c[5]*e+c[9]*d+c[13];h=c[2]*b+c[6]*e+c[10]*d+c[14];k=c[3]*b+
c[7]*e+c[11]*d+c[15];c[12]=c[0]*b+c[4]*e+c[8]*d+c[12];c[13]=f;c[14]=h;c[15]=k;a.Ae&&(a.Ae=q,c=2/a.width,d=2/-a.height,ab(a.sl,c,d,1,0,-1,1,0,1),c=a.$a===j?a.width/a.height:a.$a,d=a.ol,b=a.Xf,f=Math.PI/4/2,e=b-d,h=Math.sin(f),0==e||(0==h||0==c)||(f=Math.cos(f)/h,ab(a.Gg,f/c,f,-(b+d)/e,-1,0,0,-(2*d*b)/e,0)),bb(a.Gg,a.ff,a.Cd),cb(a.Cd,a.mc));bb(a.Gg,a.ff,a.Cd);cb(a.ff,a.oi);cb(a.Cd,a.mc);d=a.Cd;c=a.$h;Xa(c[0],d[3]+d[0],d[7]+d[4],d[11]+d[8],d[15]+d[12]);Xa(c[1],d[3]-d[0],d[7]-d[4],d[11]-d[8],d[15]-d[12]);
Xa(c[2],d[3]-d[1],d[7]-d[5],d[11]-d[9],d[15]-d[13]);Xa(c[3],d[3]+d[1],d[7]+d[5],d[11]+d[9],d[15]+d[13]);Xa(c[4],d[3]+d[2],d[7]+d[6],d[11]+d[10],d[15]+d[14]);Xa(c[5],d[3]-d[2],d[7]-d[6],d[11]-d[10],d[15]-d[14]);for(d=0;d<c.length;d++)b=c[d],e=1/Math.sqrt(b[0]*b[0]+b[1]*b[1]+b[2]*b[2]),b[0]*=e,b[1]*=e,b[2]*=e,b[3]*=e;B(a.position,0,0,0);c=a.oi;d=f=a.position;b=f[0];e=f[1];f=f[2];d[0]=b*c[0]+e*c[4]+f*c[8]+c[12];d[1]=b*c[1]+e*c[5]+f*c[9]+c[13];d[2]=b*c[2]+e*c[6]+f*c[10]+c[14];c=2*(0.5/a.width)-1;d=1-
2*(0.5/a.height);b=Ze[0];e=Ze[1];B(b,c,d,-1);B(e,c,d,1);db(a.mc,b,b);db(a.mc,e,e);Ia(b,e,a.direction);a=c=a.direction;a[0]=-c[0];a[1]=-c[1];a[2]=-c[2]};function $e(a,b,c,d){Xe.call(this,a,b,c,d);this.nb=p;this.Ge=q}z($e,Xe);$e.prototype.b=function(){J(this.nb);this.nb=p;$e.d.b.call(this)};$e.prototype.Dl=function(){var a=this.g.$c();if(this.Ge){this.nb&&(J(this.nb),this.nb=p);if(a){a:{var b=this.X.Ac.ai.zi,c=b.od[a];if(!c){c=b.Ai[a];c=!c?p:c.ek(b.Jc);if(!c){a=p;break a}b.od[a]=c}a=c.be()}this.nb=a}this.Ge=q}};$e.prototype.$c=function(){return this.g.$c()};
$e.prototype.Se=function(a){this.g.Se(a);a=this.g.$c();a=a.length?a:p;if(a!=(this.nb?this.nb.yi.id:p)&&!this.Ge)this.Ge=m,pd(this.X.tb,re,0,this.Dl,this)};function af(a,b,c,d){$e.call(this,a,b,c,d)}z(af,$e);function bf(){this.buffer=new Uint8Array(0);this.offset=0;this.U=new Float32Array(16);this.da=new Uint8Array(this.U.buffer);this.nk=(this.Xc=w.Float64Array?new Float64Array(1):p)?new Uint8Array(this.Xc.buffer):p}t=bf.prototype;t.ja=function(a,b){this.buffer=a instanceof Uint8Array?a:new Uint8Array(a);this.offset=b};function Qe(a){var b=a.buffer[a.offset++];a=a.buffer[a.offset++];b=b<<8|a;return 32767<b?b-65536:b}
function cf(a){var b=a.buffer[a.offset++],c=a.buffer[a.offset++],d=a.buffer[a.offset++];a=a.buffer[a.offset++];b=b<<24|c<<16|d<<8|a;return 2147483647<b?b-4294967296:b}function Oe(a){return a.buffer[a.offset++]}function Pe(a){var b=a.buffer[a.offset++];a=a.buffer[a.offset++];return b<<8|a}t.ha=function(){var a=this.buffer[this.offset++],b=this.buffer[this.offset++],c=this.buffer[this.offset++],d=this.buffer[this.offset++];return a<<24|b<<16|c<<8|d};
t.r=function(){for(var a=0,b=0,c;(c=this.buffer[this.offset++]&255)&128;)a|=(c&127)<<b,b+=7;return a|c<<b};t.Fe=function(){var a=this.r();return(a<<31>>31^a)>>1^a&-2147483648};t.Vi=function(){this.da[0]=this.buffer[this.offset++];this.da[1]=this.buffer[this.offset++];this.da[2]=this.buffer[this.offset++];this.da[3]=this.buffer[this.offset++];return this.U[0]};t.Bl=function(){for(var a=0;12>a;a++)this.da[a]=this.buffer[this.offset++];return this.U};
t.Cl=function(){for(var a=0;16>a;a++)this.da[a]=this.buffer[this.offset++];return this.U};t.H=function(){var a=Pe(this);Pe(this);for(var b=Array(a),c=0;c<a;){var d=this.buffer[this.offset++];if(128>d)b[c++]=String.fromCharCode(d);else if(191<d&&224>d){var e=this.buffer[this.offset++];b[c++]=String.fromCharCode((d&31)<<6|e&63)}else{var e=this.buffer[this.offset++],f=this.buffer[this.offset++];b[c++]=String.fromCharCode((d&15)<<12|(e&63)<<6|f&63)}}return b.join("")};var df=p;
function ef(){df||(df=new bf);return df};function ff(a,b,c){var d=a>>24&255,e=a>>16&255,f=a>>8&255;a&=255;return(d+c*((b>>24&255)-d)&255)<<24|(e+c*((b>>16&255)-e)&255)<<16|(f+c*((b>>8&255)-f)&255)<<8|a+c*((b&255)-a)&255};function T(a,b){this.Xa=a;this.pd=0;this.z=b}T.prototype.di=function(a){var b=U(a,this.j);return"target."+U(a,this.k)+"(source."+b+"());"};T.prototype.hc=function(a){var b=U(a,this.j);return"result."+U(a,this.k)+"(target."+b+"());"};var V=0;function gf(a,b){return(b.z&hf)-(a.z&hf)||a.pd-b.pd}function U(a,b){for(var c in a)if(a[c]===b)return c;return p}var hf=1;function jf(a,b,c,d){T.call(this,a,b);this.j=c;this.k=d}z(jf,T);t=jf.prototype;t.w=function(){return new jf(this.Xa,this.z,this.j,this.k)};
t.Ua=function(a){a=U(a,this.k);var b=ef(),b=U(b,b.Fe);return"target."+a+"(reader."+b+"());"};t.Va=function(a){a=U(a,this.j);var b=R();return"writer."+U(b,b.lf)+"(target."+a+"() | 0);"};t.di=function(a){var b=U(a,this.j);return"target."+U(a,this.k)+"(source."+b+"() | 0);"};t.hc=function(a){var b=U(a,this.j);a=U(a,this.k);return"var _s = source."+b+"();var _t = target."+b+"();target."+a+"((_s + t * (_t - _s)) | 0);"};function kf(a,b,c,d){T.call(this,a,b);this.j=c;this.k=d}z(kf,T);
kf.prototype.w=function(){return new kf(this.Xa,this.z,this.j,this.k)};kf.prototype.Ua=function(a){a=U(a,this.k);var b=ef(),b=U(b,b.Vi);return"target."+a+"(reader."+b+"());"};kf.prototype.Va=function(a){a=U(a,this.j);var b=R();return"writer."+U(b,b.Cj)+"(target."+a+"());"};kf.prototype.hc=function(a){var b=U(a,this.j);a=U(a,this.k);return"var _s = source."+b+"();var _t = target."+b+"();result."+a+"((_s + t * (_t - _s)));"};function lf(a,b,c,d){T.call(this,a,b);this.j=c;this.k=d}z(lf,T);
lf.prototype.w=function(){return new lf(this.Xa,this.z,this.j,this.k)};lf.prototype.Ua=function(a){a=U(a,this.k);var b=ef(),b=U(b,b.Bl);return"target."+a+"(reader."+b+"());"};lf.prototype.Va=function(a){a=U(a,this.j);var b=R();return"writer."+U(b,b.jm)+"(target."+a+"());"};
lf.prototype.hc=function(a){var b=U(a,this.j),c=U(a,this.k);a=U(a,mf);return"var _sv3 = source."+b+"();var _tv3 = target."+b+"();var _rv3 = source."+a+";_rv3[0] = (_tv3[0] - _sv3[0]) * t + _sv3[0];_rv3[1] = (_tv3[1] - _sv3[1]) * t + _sv3[1];_rv3[2] = (_tv3[2] - _sv3[2]) * t + _sv3[2];result."+c+"(_rv3);"};function nf(a,b,c,d,e){T.call(this,a,b);this.j=c;this.k=d;this.pl=e}z(nf,T);nf.prototype.w=function(){return new nf(this.Xa,this.z,this.j,this.k,this.pl)};
nf.prototype.Ua=function(a){a=U(a,this.k);var b=ef(),b=U(b,b.Cl);return"target."+a+"(reader."+b+"());"};nf.prototype.Va=function(a){a=U(a,this.j);var b=R();return"writer."+U(b,b.km)+"(target."+a+"());"};nf.prototype.hc=function(a){var b=U(a,this.j),c=U(a,this.k),d=U(a,of);a=U(a,We);return"var _rq = source."+d+";source."+a+"(source."+b+"(), target."+b+"(), t, _rq);result."+c+"(_rq);"};function pf(a,b,c,d){T.call(this,a,b);this.j=c;this.k=d}z(pf,T);
pf.prototype.w=function(){return new pf(this.Xa,this.z,this.j,this.k)};pf.prototype.Ua=function(a){a=U(a,this.k);var b=ef(),b=U(b,b.ha);return"target."+a+"(reader."+b+"());"};pf.prototype.Va=function(a){a=U(a,this.j);var b=R();return"writer."+U(b,b.M)+"(target."+a+"());"};pf.prototype.hc=function(a){var b=U(a,this.j),c=U(a,this.k);a=U(a,ff);return"result."+c+"(source."+a+"(source."+b+"(), target."+b+"(), t));"};function qf(a,b,c,d){T.call(this,a,b);this.j=c;this.k=d}z(qf,T);
qf.prototype.w=function(){return new qf(this.Xa,this.z,this.j,this.k)};qf.prototype.Ua=function(a){a=U(a,this.k);var b=ef(),b=U(b,b.H);return"target."+a+"(reader."+b+"());"};qf.prototype.Va=function(a){a=U(a,this.j);var b=R();return"writer."+U(b,b.o)+"(target."+a+"());"};function rf(a,b,c,d){T.call(this,a,b);this.j=c;this.k=d}z(rf,T);rf.prototype.w=function(){return new rf(this.Xa,this.z,this.j,this.k)};
rf.prototype.Ua=function(a){a=U(a,this.k);var b=ef(),b=U(b,b.H);return"target."+a+"(reader."+b+"());"};rf.prototype.Va=function(a){a=U(a,this.j);var b=R();return"writer."+U(b,b.o)+"(target."+a+"());"};function sf(a,b,c,d){T.call(this,a,b);this.j=c;this.k=d}z(sf,T);sf.prototype.w=function(){return new sf(this.Xa,this.z,this.j,this.k)};sf.prototype.Ua=function(a){a=U(a,this.k);var b=ef(),b=U(b,b.r);return"target."+a+"(reader."+b+"());"};
sf.prototype.Va=function(a){a=U(a,this.j);var b=R();return"writer."+U(b,b.s)+"(target."+a+"());"};var mf=A(),of=C();function tf(a,b){for(var c=0;c<a.length;c++)a[c].pd=c;a.sort(gf);this.Ii={};this.Wi=Array(a.length);this.Ej=Array(a.length);var d="",e="",f="",h="",k="",i="",l="",n="";this.Bj=Array(a.length);for(c=0;c<a.length;c++){var r=a[c].w();this.Bj[c]=r;this.Ii[r.Xa]=r;r.pd=c;this.Wi[c]=new Function("target","reader",r.Ua(b));this.Ej[c]=new Function("target","writer",r.Va(b));var d=d+r.Ua(b),e=e+r.Va(b),u=r.di(b),f=f+u;r.z&6||(h+=u);r.z&2&&(i+=u);if(r.z&4){var v=r.hc(b),l=l+v,k=k+u;r.z&2||(n+=v)}}this.Al=new Function("target",
"reader",d);this.hm=new Function("target","writer",e);this.zm=new Function("source","target",f);this.Kh=new Function("source","target",h);this.Jf=new Function("source","target",k);this.Lh=new Function("source","target",i);this.$k=new Function("source","target","t","result",l);this.Zk=new Function("source","target","t","result",n)}tf.prototype.ma=function(){return this.Bj.length};function W(a,b){return a.Ii[b].pd}function uf(a,b,c,d,e){for(a=a.Wi;c;){if(c&1&&a[b])a[b](d,e);c>>=1;b++}}
function vf(a,b,c,d,e){for(a=a.Ej;c;){if(c&1)a[b](d,e);c>>=1;b++}};function X(a,b){this.O=a;this.time=0;this.Q=b;this.gb=this.Fb=0}t=X.prototype;t.reset=function(a){this.O=a;this.gb=this.Fb=this.time=0};function wf(a,b){if(!a.Q){var c=[];a(c);a.Q=new tf(c,b)}return a.Q}function Y(a,b){var c=a.Fb||a.gb;31>=b?a.Fb|=1<<b:a.gb|=1<<b-32;if(!c){var c=a.O,d=!!c.T;c.T|=2;d||(d=c.X,d.xa[d.wa++]=c)}}t.vd=function(){this.Fb=this.gb=0};t.read=function(a){this.Q.Al(this,a)};t.Ig=function(a){var b=a.r();uf(this.Q,0,b,this,a);31<this.Q.ma()&&(b=a.r(),uf(this.Q,32,b,this,a))};
t.write=function(a){this.Q.hm(this,a)};t.ph=function(a){a.s(this.Fb);vf(this.Q,0,this.Fb,this,a);this.gb&&31<this.Q.ma()&&(a.s(this.gb),vf(this.Q,32,this.gb,this,a))};t.Kh=function(a){this.Q.Kh(this,a)};t.Lh=function(a){this.Q.Lh(this,a)};t.Jf=function(a){this.Q.Jf(this,a)};t.li=function(a,b,c){var d=this.Q;this.O.Ja&4?d.Zk(a,b,c,this):d.$k(a,b,c,this)};t.wj=mf;t.$g=of;t.zl=We;t.$j=ff;X.prototype.wj[0]=X.prototype.wj[1];X.prototype.zl(X.prototype.$g,X.prototype.$g,0,X.prototype.$g);
X.prototype.$j(0,0,0);function xf(a,b){var c=b||wf(yf,this);X.call(this,a,c);this.Bg=A();this.xl=W(c,zf);this.Na=C();this.Il=W(c,Af);this.Me=A();this.Kl=W(c,Bf);this.Nd=0;this.Vj=W(c,Cf);this.ef=A();this.dm=W(c,Df)}z(xf,X);var zf=V++,Af=V++,Bf=V++,Cf=V++,Df=V++;t=xf.prototype;t.ad=s("Bg");t.setPosition=function(a){Ja(this.Bg,a)||(Da(this.Bg,a),Y(this,this.xl),this.O.wb=m)};t.Dk=s("Na");
t.oj=function(a){this.Na.length==a.length&&this.Na[0]==a[0]&&this.Na[1]==a[1]&&this.Na[2]==a[2]&&this.Na[3]==a[3]||(Ya(this.Na,a),Y(this,this.Il),this.O.wb=m)};t.Ek=s("Me");t.pj=function(a){Ja(this.Me,a)||(Da(this.Me,a),Y(this,this.Kl),this.O.wb=m)};t.vk=s("Nd");t.Ol=function(a){this.Nd!=a&&(this.Nd=a,Y(this,this.Vj),this.O.wb=m)};t.Ik=s("ef");t.setVelocity=function(a){Ja(this.ef,a)||(Da(this.ef,a),Y(this,this.dm))};
function yf(a){a.push(new lf(zf,hf|6,xf.prototype.ad,xf.prototype.setPosition));a.push(new nf(Af,hf|6,xf.prototype.Dk,xf.prototype.oj,m));a.push(new lf(Bf,hf|6,xf.prototype.Ek,xf.prototype.pj));a.push(new kf(Cf,hf|4,xf.prototype.vk,xf.prototype.Ol));a.push(new lf(Df,hf|2,xf.prototype.Ik,xf.prototype.setVelocity))};function Ef(a,b){var c=b||wf(Ff,this);xf.call(this,a,c);this.og="";this.ll=W(c,Gf);this.ng=0;this.kl=W(c,Hf);this.vf=0;this.Rj=W(c,If)}z(Ef,xf);var Gf=V++,Hf=V++,If=V++;t=Ef.prototype;t.$c=s("og");t.Se=function(a){this.og!=a&&(this.og=a,Y(this,this.ll))};t.Bk=s("ng");t.Pl=function(a){this.ng!=a&&(this.ng=a,Y(this,this.kl))};t.uk=s("vf");t.Nl=function(a){this.vf!=a&&(this.vf=a,Y(this,this.Rj))};
function Ff(a){yf(a);a.push(new qf(Gf,0,Ef.prototype.$c,Ef.prototype.Se));a.push(new pf(Hf,hf|4,Ef.prototype.Bk,Ef.prototype.Pl));a.push(new jf(If,0,Ef.prototype.uk,Ef.prototype.Nl))};function Jf(a,b){var c=b||wf(Kf,this);Ef.call(this,a,c);this.dd=0;this.oe=j;this.Wk=W(c,Lf)}z(Jf,Ef);var Lf=V++;Jf.prototype.yk=s("dd");Jf.prototype.Qg=function(a){this.dd!=a&&(this.dd=a,Y(this,this.Wk),this.oe=j)};function Kf(a){Ff(a);a.push(new sf(Lf,0,Jf.prototype.yk,Jf.prototype.Qg))};A();A();function Mf(){this.height=this.width=1;this.$a=j;this.ol=0.1;this.Xf=100;this.Ae=m;this.sl=$a();this.Gg=$a();this.ff=$a();this.oi=$a();this.Cd=$a();this.mc=$a();this.position=A();this.direction=A();this.$h=[C(),C(),C(),C(),C(),C()]}var Ze=[A(),A(),A(),A(),A(),A(),A(),A()];function $(a,b){D.call(this);this.map=a;var c=$.Kj;this.N=Math.min(Math.max(Math.floor(b),$.Oj),c);this.Fa=2*this.N+1;this.ua=Array(this.Fa*$.th*this.Fa);this.Ha=A();this.K=new Int32Array(3);this.bb=Ta(this.Ha[0]-16*this.N,0,this.Ha[2]-16*this.N,this.Ha[0]+16*this.N,128,this.Ha[2]+16*this.N);this.n=[];this.Vk=q}z($,D);$.nm=8;$.Jj=16;$.Oj=1;$.Kj=16;$.th=1;t=$.prototype;t.b=function(){ib(this.n);$.d.b.call(this)};t.rf=function(a){this.n.push(a)};t.Xi=function(a){Cb(this.n,a)};
t.ki=function(a){Da(this.Ha,a);this.Kg();this.Vk=m};t.update=function(a){Da(this.Ha,a);var b=a[0]>>4,c=a[2]>>4;a=b-this.K[0];var d=c-this.K[2];if(a||d){var b=b<<4,c=c<<4,e=this.bb,f=b+16*this.N,h=c+16*this.N;B(e.min,b-16*this.N,0,c-16*this.N);B(e.max,f,0,h);this.bb.max[0]+=16;this.bb.max[1]+=128;this.bb.max[2]+=16;this.K[0]+=a;this.K[1]+=0;this.K[2]+=d;this.Kg()}};t.Kg=function(){this.K[0]=this.Ha[0]>>4;this.K[1]=0;this.K[2]=this.Ha[2]>>4;this.Ui(this.K[0]-this.N,0,this.K[2]-this.N,this.Fa,$.th,this.Fa)};
t.gc=function(a,b,c){a%=this.Fa;c%=this.Fa;0>a&&(a=this.Fa+a);0>c&&(c=this.Fa+c);return a+c*this.Fa};t.Ui=function(a,b,c,d,e,f){for(b=a;b<a+d;b++)for(e=c;e<c+f;e++){var h=b,k=e,i=this.gc(h,0,k);if(!(0>i||i>this.ua.length))if(h=this.map.fc(h<<4,0,k<<4),h!=this.ua[i]){if(k=this.ua[i]){for(var l=0;l<this.n.length;l++)this.n[l].Zj(k);k.Ma--;k.Ma||k.map.we(k)}k=h;k.Ma||k.map.xe(k);k.Ma++;this.ua[i]=h;for(l=0;l<this.n.length;l++)2==h.state&&this.n[l].fe(h)}}};
t.ye=function(a){for(var b=0;b<this.n.length;b++)this.n[b].fe(a),this.n[b].al(a.x,a.y,a.l,a.x+16-1,a.y+128-1,a.l+16-1,3)};t.fc=function(a,b,c){if(0>b||128<=b)return p;a>>=4;b>>=7;c>>=4;var d=Math.abs(c-this.K[2]);if(Math.abs(a-this.K[0])>this.N||0!=b||d>this.N)return p;a=this.gc(a,b,c);return 0>a||a>this.ua.length?p:this.ua[a]};t.pk=function(a,b){xb(this.ua,a,b)};t.Zh=function(a,b,c){Nf(this,a,this.K[0]-this.N,this.K[2]-this.N,this.Fa,b,c)};
function Nf(a,b,c,d,e,f,h){var k=$.Xl,i=16*(c+e),l=16*(d+e);B(k.min,16*c,0,16*d);B(k.max,i,128,l);a:{i=k.min;l=k.max;Da(Ze[0],i);B(Ze[1],i[0],i[1],l[2]);B(Ze[2],i[0],l[1],i[2]);B(Ze[3],i[0],l[1],l[2]);B(Ze[4],l[0],i[1],i[2]);B(Ze[5],l[0],i[1],l[2]);B(Ze[6],l[0],l[1],i[2]);Da(Ze[7],l);for(var i=0,l=b.$h,n=0;n<l.length;n++){for(var r=l[n],u=8,v=1,F=0;8>F;F++){var H=Ze[F];0>r[0]*H[0]+r[1]*H[1]+r[2]*H[2]+r[3]&&(v=0,u--)}if(!u){i=-1;break a}i+=v}i=6==i?1:0}if(1==i){b=k.min[0]>>4;c=k.max[0]>>4;d=k.max[2]>>
4;for(k=k.min[2]>>4;k<d;k++)for(e=b;e<c;e++)(i=a.fc(e<<4,0,k<<4))&&f.call(h,i)}else if(0==i)if(1>=e)(a=a.fc(c<<4,0,d<<4))&&f.call(h,a);else{k=e/2|0;for(e=0;1>=e;e++)for(i=0;1>=i;i++)Nf(a,b,c+i*k,d+e*k,k,f,h)}}
t.ig=function(a,b){var c=p,d=Math.floor(a[0]),e=Math.floor(a[1]),f=Math.floor(a[2]),h=0==a[3]?0:0>a[3]?-1:1,k=0==a[4]?0:0>a[4]?-1:1,i=0==a[5]?0:0>a[5]?-1:1,l=(d+(0<h?1:0)-a[0])/a[3],n=(e+(0<k?1:0)-a[1])/a[4],r=(f+(0<i?1:0)-a[2])/a[5];isNaN(l)&&(l=Number.POSITIVE_INFINITY);isNaN(n)&&(n=Number.POSITIVE_INFINITY);isNaN(r)&&(r=Number.POSITIVE_INFINITY);var u=h/a[3],v=k/a[4],F=i/a[5];isNaN(u)&&(u=Number.POSITIVE_INFINITY);isNaN(v)&&(v=Number.POSITIVE_INFINITY);isNaN(F)&&(F=Number.POSITIVE_INFINITY);for(var H=
Math.min(b,16*this.Fa),G=0;G<H;G++){var I=this.fc(d,e,f);if(I&&(c=I.ig(a)))break;l<n&&l<r?(l+=u,d+=h):n<r?(n+=v,e+=k):(r+=F,f+=i)}return c&&c.Sf>b?p:c};t.ra=function(a,b,c,d){var e=this.fc(a,b,c);if(!e||!e.ra(a,b,c,d))return q;for(d=0;d<this.n.length;d++)this.n[d].ni(a,b,c,0);return m};$.Wm=[A(),A()];$.Xl=new Ka;$=ye($,"blk.env.ChunkView",{ki:"initialize",update:"update",Kg:"rebuildCube_",Ui:"pullChunks_",pk:"forEachChunk",Zh:"forEachInViewport"});function Of(a){this.Ih=fa(a)?a:1}Of.Hj=1;Of.prototype.xd=function(a){var b=R();if(this.ej(a,b))return b.finish();b.hb();return p};
Of.prototype.ej=function(a,b){switch(Of.Hj){case 1:Q(b,1);var c;a:{vd(b,a.x);vd(b,a.y);vd(b,a.l);Q(b,this.Ih);switch(this.Ih){default:case 0:c=new Uint8Array(a.Z.buffer);td(b,4+c.length);b.M(c.length);for(var d=0;d<c.length;d++)b.buffer[b.offset++]=c[d];break;case 1:td(b,65668);d=b.offset+4;c=a.Z;for(var d=b.buffer.subarray(d,d+65664),e=0,f=0,h=0,k=0;k<c.length;k++){var i=c[k];k&&i==f?h++:(f=i,h=1);if(k>=c.length-2||c[k+1]!=f)1<h||255==f>>8?(d[e++]=255,d[e++]=h>>8,d[e++]=h&255,d[e++]=f>>8,d[e++]=
f&255):(d[e++]=i>>8,d[e++]=i&255)}c=e;if(0>c){c=q;break a}b.M(c);b.offset+=c;break;case 2:c=q;break a}c=m}return c;default:return q}};
Of.prototype.Ph=function(a,b){switch(Oe(b)){case 1:var c;a:{c=cf(b);var d=cf(b),e=cf(b);a.x=c;a.y=d;a.l=e;var f=a.ab,h=c+16,k=d+128,i=e+16;B(f.min,c,d,e);B(f.max,h,k,i);d=Oe(b);c=a.Z;switch(d){default:case 0:b.ha();d=0;for(e=b.offset;32768>d;d++,e+=2)c[d]=b.buffer[e+1]<<8|b.buffer[e];break;case 1:h=b.ha();d=b.buffer;f=b.offset;e=0;f=f?f:0;h=h?h:d.length;for(k=f;k<f+h;)if(i=d[k++],255==i)for(var i=d[k++]<<8|d[k++],l=d[k++]<<8|d[k++],n=0;n<i;n++)c[e++]=l;else c[e++]=i<<8|d[k++];break;case 2:c=q;break a}a.bc=
q;a.state=2;a.map.ye(a);c=m}return c;default:return q}};Of.Ug=p;Of.Fk=function(){Of.Ug||(Of.Ug=new Of(0));return Of.Ug};Of=ye(Of,"blk.io.ChunkSerializer",{ej:"serializeToWriter",Ph:"deserializeFromReader"});function Pf(a,b){D.call(this);this.W=a;this.Gc=b;this.Da=[];this.lg=-Pf.sh;this.kd=0}z(Pf,D);Pf.sh=3;Pf.Lj=20;Pf.Fj=100;t=Pf.prototype;t.fe=function(a){0<=wb(this.Da,a)||(this.Da.push(a),this.lg=0)};
t.Qi=function(a,b){var c=Math.min(Pf.Lj,this.Da.length);we("count",this.Da.length);if(a-this.lg>Pf.sh){this.lg=a;var d=Sb[0];Fb(this.Da,function(a,c){B(d,a.x+8,b[1],a.l+8);var e=Ha(b,d);B(d,c.x+8,b[1],c.l+8);return e-Ha(b,d)})}a-this.kd>1/Pf.Fj?this.kd=a:c=0;if(c)for(var e=R(),f=Of.Fk(),h=0;h<c;h++){var k=this.Da.shift();le.x=k.x;le.y=k.y;le.l=k.l;var i=e,l=le;Q(i,73);vd(i,l.x);vd(i,l.y);vd(i,l.l);k.ub||(k.ub=f.xd(k));i=e;k=k.ub;k instanceof Uint8Array||(k=new Uint8Array(k));td(i,k.length);for(l=
0;l<k.length;l++)i.buffer[i.offset++]=k[l];this.W.send(e.finish(),this.Gc);e.hb()}};t.Zj=x;t.ni=x;t.al=x;Pf=ye(Pf,"blk.env.server.ChunkSendQueue",{Qi:"process"});function Qf(a,b,c,d){Xe.call(this,a,b,c,d);this.$a=j;this.Da=this.Pa=this.v=p}z(Qf,Xe);t=Qf.prototype;t.b=function(){this.v&&this.Pa&&(Cb(this.v.Ya,this.Pa),J(this.Pa));Qf.d.b.call(this)};t.Tg=function(a){this.v=a;this.Pa=new $(a,$.Jj);a.Ya.push(this.Pa);od(this,1,0)};t.update=function(a){var b=Rf,c=this.getParent();c instanceof Xe?Ye(c,b):Ye(this,b);this.Pa.update(b);this.Da.Qi(a,b);od(this,1,0)};t.la=function(a){Qf.d.la.call(this,a);a instanceof Re&&(this.$a=a.uf)};
t.Tb=function(a){var b=this.ea(),c=Je(this).v;this.Tg(c);this.Da=new Pf(b.W,a);E(this,this.Da);this.Pa.rf(this.Da);a=Ca(0,80,0);this.Pa.ki(a)};t.Sd=function(a){if(this.$a){var b=this.$a;a.$a!==b&&(a.$a=b,a.Ae=m)}b=this.getParent();b instanceof Xe?b.Sd(a):Qf.d.Sd.call(this,a)};var Rf=C();function Sf(a,b){var c=b||wf(Tf,this);xf.call(this,a,c)}z(Sf,xf);function Tf(a){yf(a)};function Uf(a,b,c,d){P.call(this,a,b,c,d)}z(Uf,P);Uf.prototype.cg=function(){return this.getParent()};Uf.prototype.Wd=function(a){Uf.d.Wd.call(this,a)};Uf.prototype.$b=function(a){Uf.d.$b.call(this,a)};Uf.prototype.la=function(a){Uf.d.la.call(this,a);if(a instanceof Te){var b=this.cg();a:{for(var c=0;c<this.J.length;c++)if(this.J[c].C==a.ah){a=this.J[c];break a}a=p}a&&b.g.Qg(a?a.C:0)}};function Vf(a,b){var c=b||wf(Wf,this);X.call(this,a,c)}z(Vf,X);function Wf(){};function Xf(){this.qk=m}
Xf.prototype.la=function(a,b){var c=a.Zg,d=a.qh*Ne,e=a.zg*Ne,f=a.Gl*Ne,h=Yf,k=Math.sin(d/2),d=Math.cos(d/2),i=Math.sin(e/2),e=Math.cos(e/2),l=Math.sin(f/2),f=Math.cos(f/2);h[0]=d*i*f+k*e*l;h[1]=k*e*f-d*i*l;h[2]=d*e*l-k*i*f;h[3]=d*e*f+k*i*l;b.oj(Yf);if(this.qk){h=b.ad();k=Zf[4];i=b.Na;d=b.ef;f=Zf[5];e=Ga(d);1E-4<e?(l=Math.max(0,e-40*c),Fa(d,l/e,f)):B(f,0,0,0);d=a.dh;e=Zf[0];e[0]=0;e[0]+=18*!!(d&1);e[0]-=18*!!(d&2);e[1]=0;e[1]+=18*!!(d&4);e[1]-=18*!!(d&8);e[2]=0;e[2]+=18*!!(d&16);e[2]-=18*!!(d&32);
var d=Zf[1],l=i[0]*(i[0]+i[0]),n=i[3]*(i[0]+i[0]),r=i[0]*(i[1]+i[1]),u=i[1]*(i[1]+i[1]),v=i[3]*(i[1]+i[1]),F=i[0]*(i[2]+i[2]),H=i[1]*(i[2]+i[2]),G=i[2]*(i[2]+i[2]),i=i[3]*(i[2]+i[2]),I=e[0],M=e[1],e=e[2];d[0]=I*(1-u-G)+M*(r-i)+e*(F+v);d[1]=I*(r+i)+M*(1-l-G)+e*(H-n);d[2]=I*(F-v)+M*(H+n)+e*(1-l-u);i=Zf[2];(e=Ga(d))?Fa(d,1/e,i):B(i,0,0,0);e=Ga(d);18<e&&(Fa(d,18/e,d),e=18);d=e-(f[0]*i[0]+f[1]*i[1]+f[2]*i[2]);0<d&&(e=20*e*c,e>d&&(e=d),Fa(i,e,i),Ea(i,f,f));d=Zf[3];Fa(f,c,d);Ea(h,d,k);b.setPosition(k);b.setVelocity(f)}};
var Zf=[A(),A(),A(),A(),A(),A()];C();C();C();new Float32Array(16);new Float32Array(6);var Yf=C();function $f(a,b,c,d){P.call(this,a,b,c,d)}z($f,P);$f.prototype.cg=function(){return this.getParent()};function ag(a,b,c,d){$e.call(this,a,b,c,d)}z(ag,$e);ag.prototype.vg=function(a,b){ag.d.vg.call(this,a,b)};ag.prototype.yg=x;function bg(a,b,c,d){P.call(this,a,b,c,d);this.em=new Mf;this.ml=new Xf}z(bg,$f);
bg.prototype.la=function(a){bg.d.la.call(this,a);var b=this.cg();if(b&&a instanceof Me){this.ml.la(a,b.g);var c,d=this.g;d.Ce===j&&(d.Ce=d.rd?d.O.ea().u[d.rd]||p:p);c=d.Ce;var d=cg(c.g),e=d.Pa,f=this.em,h=16*d.Pa.N+16;f.Xf!=h&&(f.Xf=h,f.Ae=m);d.Sd(f);if(a.xb&&(d=b.g,d.oe===j&&(d.oe=d.dd?d.O.ea().u[d.dd]||p:p),d=d.oe)){h=dg;h.time=a.getTime();h.viewport=f;h.Hh=e;h.Ag=c;h.Pj=b;h.screenX=0.5;h.screenY=0.5;a.xb&1&&(h.screenX=a.Ng/65535,h.screenY=a.Og/65535);var b=h.Hg,k=2*(h.screenX/f.width)-1,i=1-2*
(h.screenY/f.height);c=Ze[0];e=Ze[1];B(c,k,i,-1);B(e,k,i,1);db(f.mc,c,c);db(f.mc,e,e);Ia(c,e,e);var f=c[1],k=c[2],i=e[0],l=e[1],e=e[2];b[0]=c[0];b[1]=f;b[2]=k;b[3]=i;b[4]=l;b[5]=e;a.ne||(a=a.xb,a&4&&d.yg(h,0),a&32&&d.yg(h,1))}}};var dg=new function(){this.time=0;this.Pj=this.Ag=this.Hh=this.viewport=p;this.screenY=this.screenX=0;this.Hg=new Float32Array(6)};function eg(a,b,c,d){$e.call(this,a,b,c,d)}z(eg,ag);eg.prototype.me=function(){var a=this.g.me();return Je(this).v.A.q[a]};eg.prototype.Re=function(a){this.g.Re(a.id)};
eg.prototype.yg=function(a,b){var c=a.Hh.ig(a.Hg,100);if(c&&100>=c.Sf)if(0==b){var d=c.uh,e=c.vh,f=c.wh,h=0,k=0,i=0,c=c.Li;c[0]==d?h--:c[0]==d+1&&h++;c[1]==e?k--:c[1]==e+1&&k++;c[2]==f?i--:c[2]==f+1&&i++;c=d+h;e+=k;f+=i;k=this.me();i=a.Ag;k=k?k.id<<8:0;Je(this).ra(c,e,f,k,i)}else 1==b&&(f=c.uh,i=c.vh,c=c.wh,e=a.Ag,Je(this).ra(f,i,c,0,e))};function fg(a,b,c,d){P.call(this,a,b,c,d)}z(fg,P);fg.prototype.lb=function(){var a=this.g;a.bf===j&&(a.bf=a.Ad?a.O.ea().lb(a.Ad):p);return a.bf};fg.prototype.bg=function(){var a=gg(this.g),b=this.g;b.$d===j&&(b.$d=b.Qc?b.O.ea().u[b.Qc]||p:p);var b=b.$d,c=cg(this.g),d=this.g;d.te===j&&(d.te=d.fd?d.O.ea().u[d.fd]||p:p);return[a,b,c,d.te]};
fg.prototype.Tb=function(a){var b=this.ea(),c=this.g;this.ga=a;c.rj(a.c);var d=this.X.Ac,e=Ke(d.g).v;id(this,d);d=b.va(69,md|22);d.ga=a;d.Se("pumpkin");c.ij(d.C);var f=b.va(68,66);f.ga=a;id(f,d);f.g.nj(this.C);c.kj(f.C);f=b.va(66,66);f.ga=a;id(f,d);f.Tb(a);c.jj(f.C);f=b.va(70,0);f.ga=a;id(f,d);c.lj(f.C);c=[e.A.q[1],e.A.q[2],e.A.q[3],e.A.q[4],e.A.q[5],e.A.q[6],e.A.q[7],e.A.q[8],e.A.q[9]];for(e=0;e<c.length;e++){var h=b.va(72,0);h.ga=a;id(h,f);h.Re(c[e]);0==e&&d.g.Qg(h?h.C:0)}};function hg(a,b){var c=b||wf(ig,this);X.call(this,a,c);this.Ad="";this.bf=j;this.cm=W(c,jg);this.Hc=0;this.Fd=j;this.Qj=W(c,kg);this.Qc=0;this.$d=j;this.dk=W(c,lg);this.Lc=0;this.Ud=j;this.Wj=W(c,mg);this.fd=0;this.te=j;this.bl=W(c,ng)}z(hg,X);var jg=V++,kg=V++,lg=V++,mg=V++,ng=V++;t=hg.prototype;t.Hk=s("Ad");t.rj=function(a){this.Ad!=a&&(this.Ad=a,Y(this,this.cm),this.bf=j)};t.tk=s("Hc");function gg(a){a.Fd===j&&(a.Fd=a.Hc?a.O.ea().u[a.Hc]||p:p);return a.Fd}
t.ij=function(a){this.Hc!=a&&(this.Hc=a,Y(this,this.Qj),this.Fd=j)};t.xk=s("Qc");t.kj=function(a){this.Qc!=a&&(this.Qc=a,Y(this,this.dk),this.$d=j)};t.wk=s("Lc");function cg(a){a.Ud===j&&(a.Ud=a.Lc?a.O.ea().u[a.Lc]||p:p);return a.Ud}t.jj=function(a){this.Lc!=a&&(this.Lc=a,Y(this,this.Wj),this.Ud=j)};t.zk=s("fd");t.lj=function(a){this.fd!=a&&(this.fd=a,Y(this,this.bl),this.te=j)};
function ig(a){a.push(new rf(jg,0,hg.prototype.Hk,hg.prototype.rj));a.push(new sf(kg,0,hg.prototype.tk,hg.prototype.ij));a.push(new sf(lg,0,hg.prototype.xk,hg.prototype.kj));a.push(new sf(mg,0,hg.prototype.wk,hg.prototype.jj));a.push(new sf(ng,0,hg.prototype.zk,hg.prototype.lj))};function og(a,b){var c=b||wf(pg,this);X.call(this,a,c);this.Dd=0;this.hf=j;this.gm=W(c,qg)}z(og,X);var qg=V++;og.prototype.Jk=s("Dd");function Ke(a){a.hf===j&&(a.hf=a.Dd?a.O.ea().u[a.Dd]||p:p);return a.hf}og.prototype.sj=function(a){this.Dd!=a&&(this.Dd=a,Y(this,this.gm),this.hf=j)};function pg(a){a.push(new sf(qg,0,og.prototype.Jk,og.prototype.sj))};function rg(a,b,c,d,e){P.call(this,a,b,c,d);this.vj=e}z(rg,P);rg.prototype.Wd=function(a){a instanceof Xe&&this.vj.Zb(a)};rg.prototype.$b=function(a){a instanceof Xe&&this.vj.qb(a)};function sg(a){this.Xm=a||tg;this.Zm=[]}function tg(){this.Hg=new Float32Array(6);this.end=this.start=this.Om=0;this.O=this.Ym=p;this.Li=A();this.Sf=0};function ug(){sg.call(this);this.u=[]}z(ug,sg);ug.prototype.Zb=function(a){this.u.push(a)};ug.prototype.qb=function(a){Cb(this.u,a)};ug.prototype.forEach=function(a,b){for(var c=0;c<this.u.length&&a.call(b||w,this.u[c])!==q;c++);};ug.prototype.Zh=function(a,b,c){for(a=0;a<this.u.length&&b.call(c||w,this.u[a],0)!==q;a++);};C();function vg(a,b,c,d){rg.call(this,a,b,c,d,new ug);this.v=p}z(vg,rg);vg.prototype.Tg=ba("v");vg.prototype.update=function(a){this.g.qj(a|0);od(this,2,a+1)};vg.prototype.ra=function(a,b,c,d,e){var f=this.v;d&&!f.A.q[d>>8]?L("unknown block type",d):f.ra(a,b,c,d)!=d&&(f=this.Kf(66),f.x=a,f.y=b,f.l=c,f.data=d,a=e?e.lb():p,kd(this.X,f,a))};A();function wg(a,b){var c=b||wf(xg,this);X.call(this,a,c)}z(wg,X);function xg(){};function yg(a,b){var c=b||wf(zg,this);wg.call(this,a,c);this.Wg=0;this.Tl=W(c,Ag)}z(yg,wg);var Ag=V++;yg.prototype.Gk=s("Wg");yg.prototype.qj=function(a){this.Wg!=a&&(this.Wg=a,Y(this,this.Tl))};function zg(a){a.push(new kf(Ag,0,yg.prototype.Gk,yg.prototype.qj))};function Bg(a,b){var c=b||wf(Cg,this);X.call(this,a,c)}z(Bg,X);function Cg(){};function Dg(a,b){var c=b||wf(Eg,this);Bg.call(this,a,c);this.rd=0;this.Ce=j;this.wl=W(c,Fg)}z(Dg,Bg);var Fg=V++;Dg.prototype.Ck=s("rd");Dg.prototype.nj=function(a){this.rd!=a&&(this.rd=a,Y(this,this.wl),this.Ce=j)};function Eg(a){a.push(new sf(Fg,0,Dg.prototype.Ck,Dg.prototype.nj))};function Gg(a,b){var c=b||wf(Hg,this);Ef.call(this,a,c)}z(Gg,Ef);function Hg(a){Ff(a)};function Ig(a,b){var c=b||wf(Jg,this);Gg.call(this,a,c);this.xf=0;this.Sj=W(c,Kg)}z(Ig,Gg);var Kg=V++;Ig.prototype.me=s("xf");Ig.prototype.Re=function(a){this.xf!=a&&(this.xf=a,Y(this,this.Sj))};function Jg(a){Ff(a);a.push(new jf(Kg,0,Ig.prototype.me,Ig.prototype.Re))};function Lg(a,b,c,d){$e.call(this,a,b,c,d)}z(Lg,ag);function Mg(a,b){var c=b||wf(Ng,this);Gg.call(this,a,c)}z(Mg,Gg);function Ng(a){Ff(a)};function Og(a,b,c){this.Ga=a;this.ik=b;this.Rl=c;this.Ue=[]}Og.prototype.va=function(a,b,c){return new this.ik(a,this,b,c)};function gd(a,b){if(a.Ue.length){var c=a.Ue.pop();c.reset(b);return c}return new a.Rl(b)};function Pg(a,b,c,d,e,f){this.ym=a;this.type=b;this.an=c;this.userName=d;this.timestamp=e;this.value=f||p};function Qg(a){D.call(this);this.F=a;this.h=[];this.Wf=[]}z(Qg,D);Qg.prototype.sf=function(a){if(0<=wb(this.h,a))return p;this.h.push(a);a=new Pg(this,0,a.c,a.info.ya,va());this.Wf.push(a);return a};Qg.prototype.He=function(a){return Cb(this.h,a)?(a=new Pg(this,1,a.c,a.info.ya,va()),this.Wf.push(a),a):p};Qg.prototype.postMessage=function(a,b){if(!(0<=wb(this.h,a)))return p;var c=new Pg(this,2,a.c,a.info.ya,va(),b);this.Wf.push(c);return c};function Rg(a){D.call(this);this.Ea=a;this.Mc={};this.qg=[];this.uj(a.Mb)}z(Rg,D);t=Rg.prototype;t.b=function(){Dc(this.Mc,J);this.Mc={};Rg.d.b.call(this)};t.uj=x;function Sg(a,b,c){var d=a.Mc[b];!d&&c&&(d=new Qg(b),a.Mc[b]=d);return d}t.Mi=function(){if(this.qg.length){var a=this.qg;this.qg=[];return a}return p};t.fb=x;t.Pf=x;t.jh=x;t.kh=function(a){Dc(this.Mc,function(b){b.He(a)})};t.lh=x;function Tg(){this.Sa="";this.name="Server";this.location="us";this.Yc="unknown";this.Zc="0";this.oc=32;this.Nb={}}Tg.prototype.w=function(){var a=new Tg;a.Sa=this.Sa;a.name=this.name;a.location=this.location;a.Yc=this.Yc;a.Zc=this.Zc;a.oc=this.oc;a.Nb=Gc(this.Nb);return a};Tg.prototype.toString=ca("[server]");function Ug(){this.nc=this.R=0}function Vg(a,b){var c=b||new ee;c.Jd=a.H();c.Id=a.H();c.ya=a.H();return c}function Wg(a,b){a.o(b.Jd);a.o(b.Id);a.o(b.ya);return m}function Xg(a,b){a.o(b.c);Q(a,b.R);a.M(b.z);var c;if(!(c=!Wg(a,b.info)))c=b.Gd,a.o(c.type),a.o(c.platform),a.o(c.qd),a.o(c.Tc),c=q;return c?q:m}var Yg=new function(){this.nc=this.Oc=this.Qe=0},Zg=new function(){this.Oc=this.Qe=0;this.df=[]};
function $g(a,b){var c=Yg.Oc,d=R();Zg.Qe=a;Zg.Oc=c;Zg.df=b;Q(d,2);d.M(Zg.Qe);d.M(Zg.Oc);d.M(Zg.df.length);for(c=0;c<Zg.df.length;c++){var e=d,f=Zg.df[c];Q(e,f.R);wd(e,f.nc)}return d.finish()}var ah=new function(){this.info=new Tg;this.h=[]};
function bh(a,b){var c=R();ah.info=a;ah.h=b;var d;a:{Q(c,3);d=ah.info;c.o(d.Sa);c.o(d.name);c.o(d.location);c.o(d.Yc);c.o(d.Zc);c.M(d.oc);var e=0,f;for(f in d.Nb)e++;c.M(e);for(var h in d.Nb)e=d.Nb[h],c.o(h),c.o(e);c.M(ah.h.length);for(d=0;d<ah.h.length;d++)if(!Xg(c,ah.h[d])){d=q;break a}d=m}return!d?(c.hb(),p):c.finish()}function ch(){this.Hd=this.Ve=0;this.I=new fe}var dh=new ch,eh=new ch;
function fh(a,b){var c=R();eh.Ve=3;eh.Hd=a;eh.I=b;Q(c,4);wd(c,eh.Ve);wd(c,eh.Hd);return!Xg(c,eh.I)?(c.hb(),p):c.finish()}function gh(){this.reason=0}var hh=new gh,ih=new gh,jh=new function(){this.I=new fe};function kh(a){var b=R();jh.I=a;Q(b,6);return!Xg(b,jh.I)?(b.hb(),p):b.finish()}var lh=new function(){this.c="";this.reason=0};function mh(a,b){var c=R();lh.c=a;lh.reason=b;Q(c,7);c.o(lh.c);c.M(lh.reason);return c.finish()}function nh(){this.c="";this.info=new ee}var oh=new nh,ph=new nh;
function qh(a,b){var c=R();ph.c=a;ph.info=b;Q(c,8);c.o(ph.c);return!Wg(c,ph.info)?(c.hb(),p):c.finish()}function rh(){this.F=this.c="";this.timestamp=0;this.Fc=[]}var sh=new rh,th=new rh;function uh(a,b,c,d){var e=R();th.c=a;th.F=b;th.timestamp=c;th.Fc=d;Q(e,20);e.o(th.c);e.o(th.F);e.M(th.timestamp);e.M(th.Fc.length);for(a=0;a<th.Fc.length;a++)e.o(th.Fc[a]);return e.finish()}function vh(){this.F=this.c="";this.timestamp=0}var wh=new vh,xh=new vh;
function yh(){this.F=this.c="";this.timestamp=0;this.message=""}var zh=new yh,Ah=new yh;function Bh(a){Rg.call(this,a);this.Pe=a}z(Bh,Rg);t=Bh.prototype;t.join=function(a,b,c){if(b=Sg(this,b,m)){var d=va();fa(c)&&1E3>d-c&&(d=c);b.sf(a);var e=Array(b.h.length);for(c=0;c<b.h.length;c++){var f=b.h[c];e[c]=f.c}this.Pe.send(uh(f.c,b.F,d,e),a);d=uh(a.c,b.F,d,[]);for(c=0;c<b.h.length;c++)f=b.h[c],f!=a&&this.Pe.send(d,f)}};t.uj=function(a){Ge(a,20,this.Kk,this);Ge(a,21,this.Lk,this);Ge(a,22,this.Mk,this)};
t.Kk=function(a,b,c){a=a.I;if(!a)return q;sh.c=c.H();sh.F=c.H();sh.timestamp=c.ha();b=c.ha();sh.Fc.length=b;for(var d=0;d<b;d++)sh.Fc[d]=c.H();if(!sh)return q;if(sh.c!=a.c)return L("user info mismatch"),q;this.join(a,sh.F,sh.timestamp);return m};
t.Lk=function(a,b,c){a=a.I;if(!a)return q;wh.c=c.H();wh.F=c.H();wh.timestamp=c.ha();if(!wh)return q;if(wh.c!=a.c)return L("user info mismatch"),q;b=wh.timestamp;if(c=Sg(this,wh.F,q)){var d=va();fa(b)&&1E3>d-b&&(d=b);b=a.c;var e=c.F,f=R();xh.c=b;xh.F=e;xh.timestamp=d;Q(f,21);f.o(xh.c);f.o(xh.F);f.M(xh.timestamp);b=f.finish();for(e=0;e<c.h.length;e++)this.Pe.send(b,c.h[e]);c.He(a)}return m};
t.Mk=function(a,b,c){a=a.I;if(!a)return q;zh.c=c.H();zh.F=c.H();zh.timestamp=c.ha();zh.message=c.H();if(!zh)return q;if(zh.c!=a.c)return L("user info mismatch"),q;c=Sg(this,zh.F,q);if(!c)return m;c.postMessage(a,zh.message);a=a.c;b=c.F;var d=va(),e=zh.message,f=R();Ah.c=a;Ah.F=b;Ah.timestamp=d;Ah.message=e;Q(f,22);f.o(Ah.c);f.o(Ah.F);f.M(Ah.timestamp);f.o(Ah.message);a=f.finish();for(b=0;b<c.h.length;b++)this.Pe.send(a,c.h[b]);return m};function Ch(a,b,c){D.call(this);a.G=b.G;this.rk=a;this.Ea=b;this.Ea.V.push(this);this.Fh=new Bh(b);this.Ea.V.push(this.Fh);b=a.ti;var d=new Mb;d.bi=b.fl;d.Ne=b.hl;this.v=new bd(d,c);E(this,this.v);this.Oa=new Ie(a,this.Ea,ke);E(this,this.Oa);a=this.Oa;c=new te(64,Re,0);a.Ra[c.Ga]=c;c=new te(65,Me,2);a.Ra[c.Ga]=c;c=new te(66,Se,0);a.Ra[c.Ga]=c;c=new te(67,Te,Ue);a.Ra[c.Ga]=c;a=this.Oa;Ae(a,new Og(64,Le,og));Ae(a,new Og(65,vg,yg));Ae(a,new Og(66,Qf,Sf));Ae(a,new Og(67,fg,hg));Ae(a,new Og(68,bg,Dg));
Ae(a,new Og(69,af,Jf));Ae(a,new Og(70,Uf,Vf));Ae(a,new Og(71,Lg,Mg));Ae(a,new Og(72,eg,Ig));this.rb=p;this.Ki=[];this.zi=new Lb(this.rk.Jc);E(this,this.zi)}z(Ch,D);t=Ch.prototype;t.ea=s("Oa");t.ic=s("rb");t.Sk=x;t.load=function(){var a=new N;this.rb=this.Oa.va(64,128);this.rb.ai=this;this.tj();var b=this.Ea;b.Jg=m;b.state=1;b.ia.ja(y(b.dg,b));for(var c=0;c<b.V.length;c++)b.V[c].fb();L("Server ready, listening on",b.ia.Sa.toString());a.e(p);return a};
t.jh=function(a){L("client connected",a.c,a.info,a.Gd);this.Fh.join(a,"main");var b=this.Mh(a);a.data=b;this.Ki.push(b);this.Ea.send(me(),a);this.Sk()};t.kh=function(a){L("client disconnected",a.c);if(a=a.data)this.ea().qb(a),hd(a.X.Ac,0),Cb(this.Ki,a),J(a)};t.lh=x;Ch.Mj=5;Ch.prototype.update=function(a){2!=this.Ea.state&&(this.Ea.Mi(Ch.Mj),2==this.Ea.state?L("Server disconnected!?"):(this.v.update(a),this.Oa.update(a)))};Ch.prototype.yc=aa();Ch.prototype.fb=x;Ch.prototype.Pf=x;
Ch=ye(Ch,"blk.game.server.ServerController",{load:"load",update:"update",yc:"render"});function Dh(a,b,c){Ch.call(this,a,b,c);this.jf=p}z(Dh,Ch);Dh.prototype.tj=function(){var a=this.ic();this.jf=this.Oa.va(65,0);id(this.jf,a);this.jf.Tg(this.v);a.g.sj(this.jf.C)};Dh.prototype.Mh=function(a){var b=this.ea().va(67,0);b.Tb(a);a=gg(b.g);id(a,Je(b));var c=Ca(0,80,0);a.g.setPosition(c);hd(b.X.Ac,0);return b};Dh=ye(Dh,"blk.game.fps.FpsServerController",{tj:"setupSimulation",Mh:"createPlayer"});function Eh(){this.Ul=this.Yg=this.time=this.ag=0}Eh.prototype.mb=function(a,b,c,d){this.ag=a;this.time=b;this.Yg=c;this.Ul=d};function Fh(a){this.Je=a}Fh.prototype.xd=function(a){var b=[];Gh(this,a,b);return b.join("")};
function Gh(a,b,c){switch(typeof b){case "string":Hh(b,c);break;case "number":c.push(isFinite(b)&&!isNaN(b)?b:"null");break;case "boolean":c.push(b);break;case "undefined":c.push("null");break;case "object":if(b==p){c.push("null");break}if(ka(b)){var d=b.length;c.push("[");for(var e="",f=0;f<d;f++)c.push(e),e=b[f],Gh(a,a.Je?a.Je.call(b,String(f),e):e,c),e=",";c.push("]");break}c.push("{");d="";for(f in b)Object.prototype.hasOwnProperty.call(b,f)&&(e=b[f],"function"!=typeof e&&(c.push(d),Hh(f,c),c.push(":"),
Gh(a,a.Je?a.Je.call(b,f,e):e,c),d=","));c.push("}");break;case "function":break;default:g(Error("Unknown type: "+typeof b))}}var Ih={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\x0B":"\\u000b"},Jh=/\uffff/.test("\uffff")?/[\\\"\x00-\x1f\x7f-\uffff]/g:/[\\\"\x00-\x1f\x7f-\xff]/g;
function Hh(a,b){b.push('"',a.replace(Jh,function(a){if(a in Ih)return Ih[a];var b=a.charCodeAt(0),e="\\u";16>b?e+="000":256>b?e+="00":4096>b&&(e+="0");return Ih[a]=e+b.toString(16)}),'"')};function Kh(){this.Vl=Cc();this.Xd=this.nc=this.Ib=0;this.Jm=q}function He(a){return(Cc()-a.Vl)/1E3};function Lh(a,b){D.call(this);this.ti=a;this.G=b||new Kh;this.Hf=[];this.wm=p}z(Lh,D);Lh.prototype.b=function(){ib(this.Hf);this.Hf.length=0;Lh.d.b.call(this)};Lh.prototype.getTime=function(){return He(this.G)+this.G.Xd};function Mh(){this.Yg=this.time=this.ag=0;this.hasFocus=q}Mh.prototype.mb=function(a,b,c,d){this.ag=a;this.time=b;this.Yg=c;this.hasFocus=d};var Nh;if(!(Nh=!Id))Nh=Id&&9<=$d;var Oh=Nh,Ph=Id&&!Yd("9");!Md||Yd("528");Ld&&Yd("1.9b")||Id&&Yd("8")||Hd&&Yd("9.5")||Md&&Yd("528");Ld&&!Yd("8")||Id&&Yd("9");function Qh(a,b){this.type=a;this.currentTarget=this.target=b}t=Qh.prototype;t.b=aa();t.Uc=aa();t.wc=q;t.defaultPrevented=q;t.Le=m;t.preventDefault=function(){this.defaultPrevented=m;this.Le=q};function Rh(a,b){a&&this.mb(a,b)}z(Rh,Qh);t=Rh.prototype;t.target=p;t.relatedTarget=p;t.offsetX=0;t.offsetY=0;t.clientX=0;t.clientY=0;t.screenX=0;t.screenY=0;t.button=0;t.keyCode=0;t.charCode=0;t.ctrlKey=q;t.altKey=q;t.shiftKey=q;t.metaKey=q;t.vl=q;t.Vf=p;
t.mb=function(a,b){var c=this.type=a.type;Qh.call(this,c);this.target=a.target||a.srcElement;this.currentTarget=b;var d=a.relatedTarget;if(d){if(Ld){var e;a:{try{ue(d.nodeName);e=m;break a}catch(f){}e=q}e||(d=p)}}else"mouseover"==c?d=a.fromElement:"mouseout"==c&&(d=a.toElement);this.relatedTarget=d;this.offsetX=Md||a.offsetX!==j?a.offsetX:a.layerX;this.offsetY=Md||a.offsetY!==j?a.offsetY:a.layerY;this.clientX=a.clientX!==j?a.clientX:a.pageX;this.clientY=a.clientY!==j?a.clientY:a.pageY;this.screenX=
a.screenX||0;this.screenY=a.screenY||0;this.button=a.button;this.keyCode=a.keyCode||0;this.charCode=a.charCode||("keypress"==c?a.keyCode:0);this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.vl=Dd?a.metaKey:a.ctrlKey;this.state=a.state;this.Vf=a;a.defaultPrevented&&this.preventDefault();delete this.wc};
t.preventDefault=function(){Rh.d.preventDefault.call(this);var a=this.Vf;if(a.preventDefault)a.preventDefault();else if(a.returnValue=q,Ph)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};t.b=aa();function Sh(){}var Th=0;t=Sh.prototype;t.key=0;t.xc=q;t.Td=q;t.mb=function(a,b,c,d,e,f){na(a)?this.pi=m:a&&a.handleEvent&&na(a.handleEvent)?this.pi=q:g(Error("Invalid listener argument"));this.listener=a;this.Ti=b;this.src=c;this.type=d;this.capture=!!e;this.fg=f;this.Td=q;this.key=++Th;this.xc=q};t.handleEvent=function(a){return this.pi?this.listener.call(this.fg||this.src,a):this.listener.handleEvent.call(this.listener,a)};var Uh={},Vh={},Wh={},Xh={};
function Yh(a,b,c,d,e){if(ka(b)){for(var f=0;f<b.length;f++)Yh(a,b[f],c,d,e);return p}a:{b||g(Error("Invalid event type"));d=!!d;var h=Vh;b in h||(h[b]={f:0,qa:0});h=h[b];d in h||(h[d]={f:0,qa:0},h.f++);var h=h[d],f=pa(a),k;h.qa++;if(h[f]){k=h[f];for(var i=0;i<k.length;i++)if(h=k[i],h.listener==c&&h.fg==e){if(h.xc)break;k[i].Td=q;a=k[i].key;break a}}else k=h[f]=[],h.f++;var l=Zh,n=Oh?function(a){return l.call(n.src,n.key,a)}:function(a){a=l.call(n.src,n.key,a);if(!a)return a},i=n;i.src=a;h=new Sh;
h.mb(c,i,a,b,d,e);h.Td=q;c=h.key;i.key=c;k.push(h);Uh[c]=h;Wh[f]||(Wh[f]=[]);Wh[f].push(h);a.addEventListener?(a==w||!a.Nh)&&a.addEventListener(b,i,d):a.attachEvent(b in Xh?Xh[b]:Xh[b]="on"+b,i);a=c}return a}function $h(a,b,c,d,e){if(ka(b))for(var f=0;f<b.length;f++)$h(a,b[f],c,d,e);else{d=!!d;a:{f=Vh;if(b in f&&(f=f[b],d in f&&(f=f[d],a=pa(a),f[a]))){a=f[a];break a}a=p}if(a)for(f=0;f<a.length;f++)if(a[f].listener==c&&a[f].capture==d&&a[f].fg==e){ai(a[f].key);break}}}
function ai(a){if(!Uh[a])return q;var b=Uh[a];if(b.xc)return q;var c=b.src,d=b.type,e=b.Ti,f=b.capture;c.removeEventListener?(c==w||!c.Nh)&&c.removeEventListener(d,e,f):c.detachEvent&&c.detachEvent(d in Xh?Xh[d]:Xh[d]="on"+d,e);c=pa(c);Wh[c]&&(e=Wh[c],Cb(e,b),0==e.length&&delete Wh[c]);b.xc=m;if(b=Vh[d][f][c])b.Ci=m,bi(d,f,c,b);delete Uh[a];return m}
function bi(a,b,c,d){if(!d.ve&&d.Ci){for(var e=0,f=0;e<d.length;e++)d[e].xc?d[e].Ti.src=p:(e!=f&&(d[f]=d[e]),f++);d.length=f;d.Ci=q;0==f&&(delete Vh[a][b][c],Vh[a][b].f--,0==Vh[a][b].f&&(delete Vh[a][b],Vh[a].f--),0==Vh[a].f&&delete Vh[a])}}function ci(a,b,c,d,e){var f=1;b=pa(b);if(a[b]){a.qa--;a=a[b];a.ve?a.ve++:a.ve=1;try{for(var h=a.length,k=0;k<h;k++){var i=a[k];i&&!i.xc&&(f&=di(i,e)!==q)}}finally{a.ve--,bi(c,d,b,a)}}return Boolean(f)}function di(a,b){a.Td&&ai(a.key);return a.handleEvent(b)}
function Zh(a,b){if(!Uh[a])return m;var c=Uh[a],d=c.type,e=Vh;if(!(d in e))return m;var e=e[d],f,h;if(!Oh){f=b||ha("window.event");var k=m in e,i=q in e;if(k){if(0>f.keyCode||f.returnValue!=j)return m;a:{var l=q;if(0==f.keyCode)try{f.keyCode=-1;break a}catch(n){l=m}if(l||f.returnValue==j)f.returnValue=m}}l=new Rh;l.mb(f,this);f=m;try{if(k){for(var r=[],u=l.currentTarget;u;u=u.parentNode)r.push(u);h=e[m];h.qa=h.f;for(var v=r.length-1;!l.wc&&0<=v&&h.qa;v--)l.currentTarget=r[v],f&=ci(h,r[v],d,m,l);if(i){h=
e[q];h.qa=h.f;for(v=0;!l.wc&&v<r.length&&h.qa;v++)l.currentTarget=r[v],f&=ci(h,r[v],d,q,l)}}else f=di(c,l)}finally{r&&(r.length=0)}return f}d=new Rh(b,this);return f=di(c,d)};function ei(a){D.call(this);this.Uk=a;this.D=[]}z(ei,D);var fi=[];ei.prototype.listen=function(a,b,c,d,e){ka(b)||(fi[0]=b,b=fi);for(var f=0;f<b.length;f++){var h=Yh(a,b[f],c||this,d||q,e||this.Uk||this);this.D.push(h)}return this};ei.prototype.b=function(){ei.d.b.call(this);xb(this.D,ai);this.D.length=0};ei.prototype.handleEvent=function(){g(Error("EventHandler.handleEvent not implemented"))};function gi(a,b,c,d){D.call(this);this.ib=new ei(this);E(this,this.ib);this.ih=a;this.Cf=this.zc=this.Qf=p;if(!b){if(a=w.requestAnimationFrame||w.webkitRequestAnimationFrame||w.mozRequestAnimationFrame||w.oRequestAnimationFrame||w.msRequestAnimationFrame)this.zc=a;if(a=w.cancelAnimationFrame||w.webkitCancelAnimationFrame||w.mozCancelAnimationFrame||w.oCancelAnimationFrame||w.msCancelAnimationFrame)this.Cf=a}this.Pb=0;this.lc=p;this.mg=0;this.Dc=m;this.$f=d||0;this.Te=p;c&&(this.ib.listen(w,"blur",
function(){this.Dc=q}),this.ib.listen(w,"focus",function(){this.Dc||(this.Dc=m,this.Pb&&this.start(m))}))}z(gi,D);gi.prototype.b=function(){this.stop(m);this.Qf=p;gi.d.b.call(this)};gi.prototype.hasFocus=s("Dc");
gi.prototype.start=function(a){if(!a&&(this.Pb++,1<this.Pb))return;if(this.Dc){var b=this;this.lc=this.zc?this.zc.call(w,function(){hi(b)},this.Qf):w.setTimeout(function(){hi(b)},62.5)}this.ih(Cc());this.$f&&(b=this,this.Te=w.setInterval(xe(function(){var a=b;if(Cc()-a.mg>=a.$f&&a.Pb){var d=Cc();a.mg=d;a.ih(d)}},"gf.timing.RenderTimer#simulateTick"),this.$f))};
gi.prototype.stop=function(a){if(a||this.Pb)a||this.Pb--,this.Pb||(a=this.lc,this.Cf?this.Cf.call(w,a):this.zc||w.clearTimeout(a),this.lc=p,this.Te!==p&&(w.clearInterval(this.Te),this.Te=p))};function hi(a){if(a.lc!==p){a.lc=p;a.Dc&&(a.lc=a.zc?a.zc.call(w,function(){hi(a)},a.Qf):w.setTimeout(function(){hi(a)},16));var b=Cc();a.mg=b;a.ih(b)}};function ii(a,b){Lh.call(this,a,b);this.gk=new ei(this);E(this,this.gk);this.ld=He(this.G);this.lk=m;this.mk=ii.Ij;this.Ec=0;this.am=new Mh;this.$l=0;this.Fl=new Eh;this.El=0;var c=this;this.Ie=new gi(function(a){c.Yi(a)},j,j,500);E(this,this.Ie);this.Xg=q}z(ii,Lh);ii.Ij=0.016777;ii.rh=0.25;t=ii.prototype;
t.Yi=function(){var a=He(this.G),b=a-this.ld;this.ld=a;b>ii.rh&&(b=ii.rh);this.Ec+=b;a=1;if(this.lk){for(a=this.mk;this.Ec>=a;){this.hh(this.G.Ib,a);var c=this.G;c.Ib+=a;this.Ec-=a;if(!this.Xg)break}a=this.Ec/a}else this.hh(this.G.Ib,b),c=this.G,c.Ib+=b;this.Ie.hasFocus()&&this.Zi(He(this.G)+this.G.Xd,b,a)};t.hh=function(a,b){if(!(0>=b)){var c=this.am;c.mb(this.$l++,a,b,this.Ie.hasFocus());this.update(c)}};t.Zi=function(a,b,c){var d=this.Fl;d.mb(this.El++,a,b,c);this.yc(d)};t.update=x;t.yc=x;
ii=ye(ii,"gf.Game",{Yi:"renderTick_",hh:"update_",Zi:"render_"});function ji(a,b){ne.call(this,a);this.fk=b||p}z(ji,ne);ji.prototype.load=function(a){var b=new N(function(){a.cancel()},this);a.load(b);return b};function ki(a,b,c,d){D.call(this);this.method=a;this.url=b;this.content=c||p;this.headers=d?Gc(d):{}}z(ki,D);function li(a,b){this.statusCode=a;this.content=b||p};function mi(){D.call(this)}z(mi,D);t=mi.prototype;t.Nh=m;t.wg=p;t.addEventListener=function(a,b,c,d){Yh(this,a,b,c,d)};t.removeEventListener=function(a,b,c,d){$h(this,a,b,c,d)};
t.dispatchEvent=function(a){var b=a.type||a,c=Vh;if(b in c){if(ma(a))a=new Qh(a,this);else if(a instanceof Qh)a.target=a.target||this;else{var d=a;a=new Qh(b,this);Ic(a,d)}var d=1,e,c=c[b],b=m in c,f;if(b){e=[];for(f=this;f;f=f.wg)e.push(f);f=c[m];f.qa=f.f;for(var h=e.length-1;!a.wc&&0<=h&&f.qa;h--)a.currentTarget=e[h],d&=ci(f,e[h],a.type,m,a)&&a.Le!=q}if(q in c)if(f=c[q],f.qa=f.f,b)for(h=0;!a.wc&&h<e.length&&f.qa;h++)a.currentTarget=e[h],d&=ci(f,e[h],a.type,q,a)&&a.Le!=q;else for(e=this;!a.wc&&e&&
f.qa;e=e.wg)a.currentTarget=e,d&=ci(f,e,a.type,q,a)&&a.Le!=q;a=Boolean(d)}else a=m;return a};t.b=function(){mi.d.b.call(this);var a=0;if(this!=p){var b=pa(this);if(Wh[b])for(var b=Wh[b],c=b.length-1;0<=c;c--)ai(b[c].key),a++}else Dc(Uh,function(b,c){ai(c);a++});this.wg=p};var ni=w.window;function oi(a,b){this.v={};this.D=[];var c=arguments.length;if(1<c){c%2&&g(Error("Uneven number of arguments"));for(var d=0;d<c;d+=2)this.set(arguments[d],arguments[d+1])}else if(a){a instanceof oi?(c=a.jb(),d=a.za()):(c=Fc(a),d=Ec(a));for(var e=0;e<c.length;e++)this.set(c[e],d[e])}}t=oi.prototype;t.f=0;t.oh=0;t.ma=s("f");t.za=function(){pi(this);for(var a=[],b=0;b<this.D.length;b++)a.push(this.v[this.D[b]]);return a};t.jb=function(){pi(this);return this.D.concat()};
t.Cb=function(a){return qi(this.v,a)};t.clear=function(){this.v={};this.oh=this.f=this.D.length=0};t.remove=function(a){return qi(this.v,a)?(delete this.v[a],this.f--,this.oh++,this.D.length>2*this.f&&pi(this),m):q};function pi(a){if(a.f!=a.D.length){for(var b=0,c=0;b<a.D.length;){var d=a.D[b];qi(a.v,d)&&(a.D[c++]=d);b++}a.D.length=c}if(a.f!=a.D.length){for(var e={},c=b=0;b<a.D.length;)d=a.D[b],qi(e,d)||(a.D[c++]=d,e[d]=1),b++;a.D.length=c}}t.get=function(a,b){return qi(this.v,a)?this.v[a]:b};
t.set=function(a,b){qi(this.v,a)||(this.f++,this.D.push(a),this.oh++);this.v[a]=b};t.w=function(){return new oi(this)};function qi(a,b){return Object.prototype.hasOwnProperty.call(a,b)};function ri(a){return si(a||arguments.callee.caller,[])}
function si(a,b){var c=[];if(0<=wb(b,a))c.push("[...circular reference...]");else if(a&&50>b.length){c.push(ti(a)+"(");for(var d=a.arguments,e=0;e<d.length;e++){0<e&&c.push(", ");var f;f=d[e];switch(typeof f){case "object":f=f?"object":"null";break;case "string":break;case "number":f=String(f);break;case "boolean":f=f?"true":"false";break;case "function":f=(f=ti(f))?f:"[fn]";break;default:f=typeof f}40<f.length&&(f=f.substr(0,40)+"...");c.push(f)}b.push(a);c.push(")\n");try{c.push(si(a.caller,b))}catch(h){c.push("[exception trying to get caller]\n")}}else a?
c.push("[...long stack...]"):c.push("[end]");return c.join("")}function ti(a){if(ui[a])return ui[a];a=String(a);if(!ui[a]){var b=/function ([^\(]+)/.exec(a);ui[a]=b?b[1]:"[Anonymous]"}return ui[a]}var ui={};function vi(a,b,c,d,e){this.reset(a,b,c,d,e)}vi.prototype.Ll=0;vi.prototype.Uh=p;vi.prototype.Th=p;var wi=0;vi.prototype.reset=function(a,b,c,d,e){this.Ll="number"==typeof e?e:wi++;this.Xe=d||va();this.md=a;this.nl=b;this.Mm=c;delete this.Uh;delete this.Th};vi.prototype.mj=ba("md");function xi(a){this.Bi=a}xi.prototype.P=p;xi.prototype.md=p;xi.prototype.J=p;xi.prototype.cd=p;function yi(a,b){this.name=a;this.value=b}yi.prototype.toString=s("name");var zi=new yi("SEVERE",1E3),Ai=new yi("WARNING",900),Bi=new yi("INFO",800),Ci=new yi("CONFIG",700),Di=new yi("FINE",500);t=xi.prototype;t.getName=s("Bi");t.getParent=s("P");t.mj=ba("md");function Ei(a){return a.md?a.md:a.P?Ei(a.P):p}
t.log=function(a,b,c){if(a.value>=Ei(this).value){a=this.Ak(a,b,c);b="log:"+a.nl;w.console&&(w.console.timeStamp?w.console.timeStamp(b):w.console.markTimeline&&w.console.markTimeline(b));w.msWriteProfilerMark&&w.msWriteProfilerMark(b);for(b=this;b;){c=b;var d=a;if(c.cd)for(var e=0,f=j;f=c.cd[e];e++)f(d);b=b.getParent()}}};
t.Ak=function(a,b,c){var d=new vi(a,String(b),this.Bi);if(c){d.Uh=c;var e;var f=arguments.callee.caller;try{var h;var k=ha("window.location.href");if(ma(c))h={message:c,name:"Unknown error",lineNumber:"Not available",fileName:k,stack:"Not available"};else{var i,l,n=q;try{i=c.lineNumber||c.Km||"Not available"}catch(r){i="Not available",n=m}try{l=c.fileName||c.filename||c.sourceURL||k}catch(u){l="Not available",n=m}h=n||!c.lineNumber||!c.fileName||!c.stack?{message:c.message,name:c.name,lineNumber:i,
fileName:l,stack:c.stack||"Not available"}:c}e="Message: "+mb(h.message)+'\nUrl: <a href="view-source:'+h.fileName+'" target="_new">'+h.fileName+"</a>\nLine: "+h.lineNumber+"\n\nBrowser stack:\n"+mb(h.stack+"-> ")+"[end]\n\nJS stack traversal:\n"+mb(ri(f)+"-> ")}catch(v){e="Exception trying to expose exception! You win, we lose. "+v}d.Th=e}return d};t.info=function(a,b){this.log(Bi,a,b)};function Fi(a,b){a.log(Di,b,j)}t.pf=function(a,b){this.J||(this.J={});this.J[a]=b};var Gi={},Hi=p;
function Ii(a){Hi||(Hi=new xi(""),Gi[""]=Hi,Hi.mj(Ci));var b;if(!(b=Gi[a])){b=new xi(a);var c=a.lastIndexOf("."),d=a.substr(c+1),c=Ii(a.substr(0,c));c.pf(d,b);b.P=c;Gi[a]=b}return b};function Ji(){}Ji.prototype.Eh=p;function Ki(a){var b;if(!(b=a.Eh))b={},Li(a)&&(b[0]=m,b[1]=m),b=a.Eh=b;return b};var Mi;function Ni(){}z(Ni,Ji);Ni.prototype.be=function(){var a=Li(this);return a?new ActiveXObject(a):new XMLHttpRequest};
function Li(a){if(!a.ii&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var b=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],c=0;c<b.length;c++){var d=b[c];try{return new ActiveXObject(d),a.ii=d}catch(e){}}g(Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed"))}return a.ii}Mi=new Ni;var Oi=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#(.*))?$");function Pi(a){D.call(this);this.headers=new oi;this.nf=a||p}z(Pi,mi);Pi.prototype.fa=Ii("goog.net.XhrIo");var Qi=/^https?$/i;t=Pi.prototype;t.Za=q;t.t=p;t.mf=p;t.ue="";t.ri="";t.hd=0;t.jd="";t.Uf=q;t.qe=q;t.hg=q;t.Lb=q;t.zd=0;t.Ub=p;t.aj="";t.fm=q;
t.send=function(a,b,c,d){this.t&&g(Error("[goog.net.XhrIo] Object is active with another request="+this.ue+"; newUri="+a));b=b?b.toUpperCase():"GET";this.ue=a;this.jd="";this.hd=0;this.ri=b;this.Uf=q;this.Za=m;this.t=this.nf?this.nf.be():Mi.be();this.mf=this.nf?Ki(this.nf):Ki(Mi);this.t.onreadystatechange=y(this.Hi,this);try{Fi(this.fa,Ri(this,"Opening Xhr")),this.hg=m,this.t.open(b,a,m),this.hg=q}catch(e){Fi(this.fa,Ri(this,"Error opening Xhr: "+e.message));Si(this,e);return}a=c||"";var f=this.headers.w();
d&&Kc(d,function(a,b){f.set(b,a)});d=w.FormData&&a instanceof w.FormData;"POST"==b&&(!f.Cb("Content-Type")&&!d)&&f.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");Kc(f,function(a,b){this.t.setRequestHeader(b,a)},this);this.aj&&(this.t.responseType=this.aj);"withCredentials"in this.t&&(this.t.withCredentials=this.fm);try{this.Ub&&(ni.clearTimeout(this.Ub),this.Ub=p),0<this.zd&&(Fi(this.fa,Ri(this,"Will abort after "+this.zd+"ms if incomplete")),this.Ub=ni.setTimeout(y(this.Wl,
this),this.zd)),Fi(this.fa,Ri(this,"Sending request")),this.qe=m,this.t.send(a),this.qe=q}catch(h){Fi(this.fa,Ri(this,"Send error: "+h.message)),Si(this,h)}};t.Wl=function(){"undefined"!=typeof da&&this.t&&(this.jd="Timed out after "+this.zd+"ms, aborting",this.hd=8,Fi(this.fa,Ri(this,this.jd)),this.dispatchEvent("timeout"),this.abort(8))};function Si(a,b){a.Za=q;a.t&&(a.Lb=m,a.t.abort(),a.Lb=q);a.jd=b;a.hd=5;Ti(a);Ui(a)}
function Ti(a){a.Uf||(a.Uf=m,a.dispatchEvent("complete"),a.dispatchEvent("error"))}t.abort=function(a){this.t&&this.Za&&(Fi(this.fa,Ri(this,"Aborting")),this.Za=q,this.Lb=m,this.t.abort(),this.Lb=q,this.hd=a||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Ui(this))};t.b=function(){this.t&&(this.Za&&(this.Za=q,this.Lb=m,this.t.abort(),this.Lb=q),Ui(this,m));Pi.d.b.call(this)};t.Hi=function(){!this.hg&&!this.qe&&!this.Lb?this.rl():Vi(this)};t.rl=function(){Vi(this)};
function Vi(a){if(a.Za&&"undefined"!=typeof da)if(a.mf[1]&&4==a.Kb()&&2==Wi(a))Fi(a.fa,Ri(a,"Local request error detected and ignored"));else if(a.qe&&4==a.Kb())ni.setTimeout(y(a.Hi,a),0);else if(a.dispatchEvent("readystatechange"),4==a.Kb()){Fi(a.fa,Ri(a,"Request complete"));a.Za=q;try{if(Xi(a))a.dispatchEvent("complete"),a.dispatchEvent("success");else{a.hd=6;var b;try{b=2<a.Kb()?a.t.statusText:""}catch(c){Fi(a.fa,"Can not get status: "+c.message),b=""}a.jd=b+" ["+Wi(a)+"]";Ti(a)}}finally{Ui(a)}}}
function Ui(a,b){if(a.t){var c=a.t,d=a.mf[0]?x:p;a.t=p;a.mf=p;a.Ub&&(ni.clearTimeout(a.Ub),a.Ub=p);b||a.dispatchEvent("ready");try{c.onreadystatechange=d}catch(e){a.fa.log(zi,"Problem encountered resetting onreadystatechange: "+e.message,j)}}}
function Xi(a){var b=Wi(a),c;a:switch(b){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:c=m;break a;default:c=q}if(!c){if(b=0===b)a=String(a.ue).match(Oi)[1]||p,!a&&self.location&&(a=self.location.protocol,a=a.substr(0,a.length-1)),b=!Qi.test(a?a.toLowerCase():"");c=b}return c}t.Kb=function(){return this.t?this.t.readyState:0};function Wi(a){try{return 2<a.Kb()?a.t.status:-1}catch(b){return a.fa.log(Ai,"Can not get status: "+b.message,j),-1}}
function Ri(a,b){return b+" ["+a.ri+" "+a.ue+" "+Wi(a)+"]"};function Yi(a,b,c,d){ki.call(this,a,b,c,d)}z(Yi,ki);function Zi(a,b,c,d){a=new Yi(a,b,c,d);var e=new N,f=new Pi;f.zd=Math.max(0,2E4);var h=Yh(f,"complete",function(){var a=Wi(f),b;try{b=f.t?f.t.responseText:""}catch(c){Fi(f.fa,"Can not get responseText: "+c.message),b=""}a=new li(a,b);ai(h);J(f);Xi(f)?e.e(a):e.a(a)});f.send(a.url,a.method,a.content,a.headers);return e};function $i(a,b,c){D.call(this);this.um=a;this.Pg=a+"api/server/"+b;this.gg={"X-GF-Version":"1","X-GF-Server-ID":b,"X-GF-Server-Key":c}}z($i,D);function aj(a,b,c){ii.call(this,a,b.G);this.Jc=new ji(this,this.fk);E(this,this.Jc);this.Hf.push(this.Jc);this.ac=new Dh(this,b,c);E(this,this.ac);this.cb=p;1==b.type&&(a.Af&&a.fj&&a.hj)&&(this.cb=new $i(a.Af,a.fj,a.hj),E(this,this.cb));this.Pd=p}z(aj,ii);t=aj.prototype;t.b=function(){this.Pd&&(w.clearTimeout(this.Pd),this.Pd=p);if(this.cb){var a=this.cb;Zi("DELETE",a.Pg,j,a.gg)}aj.d.b.call(this)};
t.zj=function(){if(this.cb){for(var a=this.ac.Ea,b=[],c=0;c<a.h.length;c++)b.push(a.h[c].info);for(var a=this.cb,c=[],d=0;d<b.length;d++)c.push({display_name:b[d].ya});b=(new Fh(j)).xd({user_count:c.length,users:c});b=Zi("POST",a.Pg,b,a.gg);a=function(){this.Pd=w.setTimeout(y(this.zj,this),5E3)};O(b,a,a,this)}};
t.load=function(){if(this.cb){var a=this.ti,b;b=this.cb;var c=this.ac.Ea.gj,d=[],e;for(e in c.Nb)d.push(e+"="+c.Nb[e]);c=(new Fh(j)).xd({endpoint:c.Sa,server_name:c.name,server_location:c.location,game_type:c.Yc,game_version:c.Zc,game_properties:d,user_max:c.oc});b=Zi("PUT",b.Pg,c,b.gg);O(b,function(){L("Registered with server browser at "+a.Af);this.zj()},function(a){L("Unable to register with server browser: ",a)},this)}return this.ac.load()};t.update=function(a){this.ac.update(a)};t.yc=function(a){this.ac.yc(a)};
aj=ye(aj,"blk.game.server.ServerGame",{update:"update",yc:"render"});function bj(){this.version=0};function cj(){D.call(this);this.pa=[];this.Dg=[];this.pg=q;this.pe=0;this.rc=m;this.Gh=new Of}z(cj,D);cj.Nj=8;cj.prototype.update=function(){this.ob();for(var a=Cc();this.Dg.length&&!(Cc()-a>cj.Nj);){var b=this.Dg.shift(),c=b.jk,d=b.error,b=b.data,e;if(e=!d)if(e=b)if(e=c.Nc){e=this.Gh;var f=c.Nc,h=b,k=ef();k.ja(h,0);e=e.Ph(f,k)}e?(c.Nc.ub=b,c.ka.e(p)):c.ka.a(d)}};function dj(a,b,c,d){ej(a,b);a=new bj;!c&&d?b.ka.e(a):b.ka.a(c)}function fj(a,b,c){ej(a,b);c?b.ka.a(c):b.ka.e(p)}
function gj(a,b,c,d){ej(a,b);a.Dg.push({jk:b,error:c,data:d})}function cd(a,b){var c=new N,d=new Qc(c,hj,b.x,b.y,b.l);d.version=b.version;b.ub?d.data=b.ub:(d.data=a.Gh.xd(b),b.ub=d.data);d.data?(a.pa.push(d),a.rc||a.ob()):c.a(p);return c}function ij(a,b,c){ej(a,b);c?b.ka.a(c):b.ka.e(p)}function jj(a,b,c){ej(a,b);c?b.ka.a(c):b.ka.e(p)}cj.prototype.ob=function(){if(!this.rc){!this.pe&&this.pg&&(this.pg=q,this.$i());for(;1>this.pe&&this.pa.length;){var a=this.pa[0];this.pe++;this.Fg(a)}}};
cj.prototype.$i=function(){for(var a=this.pa.length-1,b=0;b<this.pa.length;b++)if(this.pa[b].uc==Number.MAX_VALUE){a=b-1;break}if(a)if(a==this.pa.length-1)Fb(this.pa,kj);else{a=this.pa.slice(0,a);Fb(a,kj);for(b=0;b<a.length;b++)this.pa[b]=a[b]}};function ej(a,b){a.pe--;Cb(a.pa,b);a.ob()}var Rc=2,hj=3;function Qc(a,b,c,d,e){this.ka=a;this.action=b;this.x=c;this.y=d;this.l=e;this.Nc=p;this.uc=Number.MAX_VALUE;this.version=0;this.data=p}function kj(a,b){return a.uc-b.uc}
cj=ye(cj,"blk.io.MapStore",{update:"update",ob:"pump_",$i:"resortQueue_"});function lj(a,b,c,d,e,f){D.call(this);this.x=a;this.y=b;this.l=c;this.key=d;this.Yf=e;this.Gm=f;this.jg=va();this.Pi=q;this.$=new Uint32Array(1024);this.L=[m];this.S=this.m=p}z(lj,D);function mj(a,b){return b.jg-a.jg}lj.prototype.b=function(){J(this.m);J(this.S);lj.d.b.call(this)};lj.prototype.gc=function(a,b,c){return 32*(c>>4&31)+(a>>4&31)};lj.prototype.Ed=function(a,b){var c=Array.prototype.slice.call(arguments,1);c.unshift(4096*a);return this.S.write.apply(this.S,c)};function nj(a,b){D.call(this);this.jl=a;this.Rd={};this.q=[];this.Hl=b}z(nj,D);nj.prototype.b=function(){this.clear();nj.d.b.call(this)};
nj.prototype.get=function(a,b,c){var d=a>>9,e=c>>9,f=[d,0,e,"blkregion"].join("."),h=new N;(a=this.Rd[f])?(a.jg=va(),h.e(a)):O(this.Hl.getFile(f,2),function(a){if(this.q.length>=this.jl&&this.q.length){Fb(this.q,mj);var b=this.q[this.q.length-1];delete this.Rd[b.key];J(b);this.q.length--}var c=new lj(d<<9,0,e<<9,f,a,0);this.Rd[f]=c;this.q.push(c);var n=new N;a=[c.Yf.createReader(),c.Yf.createWriter()];a=new ad(a,q,m);O(a,function(a){return zb(a,function(a){return a[1]})},p,j);O(a,function(a){this.m=
a[0];this.S=a[1];this.m.kb()?O(this.m.read(0,4096,this.$.buffer),function(a){a!=this.$.buffer&&(this.$=new Uint32Array(a));a=this.S.kb()/4096;this.L.length=a;this.L[0]=m;for(a=1;a<this.L.length;a++)this.L[a]=q;for(a=0;a<this.$.length;a++){var b=this.$[a],c=b>>8,b=b&255;if(c)for(var d=0;d<b;d++)this.L[c+d]=m}this.Pi=m;n.e(p)},function(a){n.a(a)},this):O(this.Ed(0,this.$.buffer),function(){this.Pi=m;n.e(p)},function(a){n.a(a)},this)},function(a){n.a(a)},c);O(n,function(){h.e(c)},function(a){h.a(a)},
this)},function(a){h.a(a)},this);return h};nj.prototype.clear=function(){xb(this.q,J);this.q.length=0;this.Rd={}};function oj(a,b){D.call(this);this.type=a;this.size=b}z(oj,D);function pj(a,b){jb.call(this,b+": "+qj(a));this.code=a;this.action=b}z(pj,jb);
function qj(a){switch(a){case 1:return"File or directory not found";case 2:return"Insecure or disallowed operation";case 3:return"Operation aborted";case 4:return"File or directory not readable";case 5:return"Invalid encoding";case 6:return"Cannot modify file or directory";case 7:return"Invalid state";case 8:return"Invalid line-ending specifier";case 9:return"Invalid modification";case 10:return"Quota exceeded";case 11:return"Invalid filetype";case 12:return"File or directory already exists at specified path";
default:return"Unknown error"}};function rj(a,b){return new pj(a?a.code:0,b)};function sj(a,b){jb.call(this,kb("Error %s: %s",b,tj(a)));this.code=a}z(sj,jb);
function tj(a){switch(a){case 1:return"File or directory not found";case 2:return"Insecure or disallowed operation";case 3:return"Operation aborted";case 4:return"File or directory not readable";case 5:return"Invalid encoding";case 6:return"Cannot modify file or directory";case 7:return"Invalid state";case 8:return"Invalid line-ending specifier";case 9:return"Invalid modification";case 10:return"Quota exceeded";case 11:return"Invalid filetype";case 12:return"File or directory already exists at specified path";
default:return"Unrecognized error"}};function uj(a,b){Qh.call(this,a.type,b);this.Vf=a}z(uj,Qh);function vj(){D.call(this);this.m=new FileReader;this.m.onloadstart=y(this.aa,this);this.m.onprogress=y(this.aa,this);this.m.onload=y(this.aa,this);this.m.onabort=y(this.aa,this);this.m.onerror=y(this.aa,this);this.m.onloadend=y(this.aa,this)}z(vj,mi);t=vj.prototype;t.abort=function(){try{this.m.abort()}catch(a){g(new sj(a.code,"aborting read"))}};t.Kb=function(){return this.m.readyState};t.getError=function(){return this.m.error&&new sj(this.m.error.code,"reading file")};
t.aa=function(a){this.dispatchEvent(new uj(a,this))};t.b=function(){vj.d.b.call(this);delete this.m};t.readAsArrayBuffer=function(a){this.m.readAsArrayBuffer(a)};function wj(a,b){D.call(this);this.vi=b;this.Hb=[];a>this.vi&&g(Error("[goog.structs.SimplePool] Initial cannot be greater than max"));for(var c=0;c<a;c++)this.Hb.push(this.Rc?this.Rc():{})}z(wj,D);wj.prototype.Rc=p;wj.prototype.Rh=p;function xj(a,b){if(a.Rh)a.Rh(b);else if(oa(b))if(na(b.Uc))b.Uc();else for(var c in b)delete b[c]}wj.prototype.b=function(){wj.d.b.call(this);for(var a=this.Hb;a.length;)xj(this,a.pop());delete this.Hb};function yj(a){D.call(this);this.zb=a;this.Wa=new wj(0,5);E(this,this.Wa);a=y(function(){return new zj(this.Wa)},this);this.Wa.Rc=a}z(yj,D);yj.prototype.kb=function(){return this.zb.size};
yj.prototype.read=function(a,b){var c=this.zb.size,d=a||0;if(d>=c)return c=new N,c.a(new pj(7,"read file")),c;var e=d+(fa(b)?b:c);e>c&&(e=c);var e=e||0,f=p;0==d&&e==c?f=this.zb:this.zb.slice?f=this.zb.slice(d,e):this.zb.webkitSlice&&(f=this.zb.webkitSlice(d,e));return(this.Wa.Hb.length?this.Wa.Hb.pop():this.Wa.Rc?this.Wa.Rc():{}).ja(f)};function zj(a){ei.call(this,this);this.Wa=a;this.Mf=p;this.m=new vj;E(this,this.m);this.listen(this.m,"loadend",this.bk)}z(zj,ei);
zj.prototype.ja=function(a){var b=new N(this.Yj,this);this.Mf=b;this.m.readAsArrayBuffer(a);return b};zj.prototype.Yj=function(){this.m.abort()};zj.prototype.bk=function(){var a=this.Mf;if(a){this.Mf=p;var b=this.m.m.result,c=this.m.getError(),d=this.Wa;d.Hb.length<d.vi?d.Hb.push(this):xj(d,this);b?a.e(b):a.a(rj(c,"read"))}};function Aj(a){D.call(this);this.Ca=a;this.Ca.onwritestart=y(this.aa,this);this.Ca.onprogress=y(this.aa,this);this.Ca.onwrite=y(this.aa,this);this.Ca.onabort=y(this.aa,this);this.Ca.onerror=y(this.aa,this);this.Ca.onwriteend=y(this.aa,this)}z(Aj,mi);t=Aj.prototype;t.abort=function(){try{this.Ca.abort()}catch(a){g(new sj(a.code,"aborting save"))}};t.Kb=function(){return this.Ca.readyState};t.getError=function(){return this.Ca.error&&new sj(this.Ca.error.code,"saving file")};
t.aa=function(a){this.dispatchEvent(new uj(a,this))};t.b=function(){delete this.Ca;Aj.d.b.call(this)};function Bj(a){D.call(this);this.oa=a;E(this,this.oa);this.Qa=this.Y=p;this.ib=new ei(this);E(this,this.ib);this.ib.listen(this.oa,"writeend",function(){if(this.Y){var a=this.Y;this.Qa=this.Y=p;a.e(p)}});this.ib.listen(this.oa,"error",function(){if(this.Y&&this.Qa){var a=this.Y,c=new pj(2,this.Qa);this.Qa=this.Y=p;a.a(c)}});this.ib.listen(this.oa,"abort",function(){if(this.Y&&this.Qa){var a=this.Y,c=new pj(3,this.Qa);this.Qa=this.Y=p;a.a(c)}})}z(Bj,D);Bj.prototype.kb=function(){return this.oa.kb()};
Bj.prototype.Sg=function(a){var b=new N;this.Y?b.a(new pj(7,"overlapped set length")):a==this.kb()?b.e(p):(this.Y=b,this.Qa="set length",this.oa.truncate(a));return b};
Bj.prototype.write=function(a,b){var c=new N;if(this.Y)return c.a(new pj(7,"overlapped write")),c;for(var d=Array.prototype.slice.call(arguments,1),e=0;e<d.length;e++)d[e]instanceof ArrayBuffer&&(d[e]=new Uint8Array(d[e]));var f=new Blob(d);a>this.kb()?O(this.Sg(a+f.size),function(){this.Y=c;this.Qa="write";this.oa.seek(a);this.oa.write(f)},function(a){c.a(a)},this):(this.Y=c,this.Qa="write",this.oa.seek(a),this.oa.write(f));return c};function Cj(a,b){this.Zf=a;this.fullPath=b.ca.fullPath;this.name=b.getName();this.type=b.isFile()?0:1;this.oa=b}Cj.prototype.isFile=function(){return 0==this.type};Cj.prototype.remove=function(){var a=new N;O(this.oa.remove(),function(){a.e(p)},function(b){a.a(rj(b,"remove "+this.fullPath))},this);return a};function Dj(a,b){return b.isFile()?new Ej(a.Zf,b):new Fj(a.Zf,b)}function Ej(a,b){Cj.call(this,a,b);this.Vh=b}z(Ej,Cj);
Ej.prototype.createReader=function(){var a=new N;O(this.Vh.file(),function(b){a.e(new yj(b))},function(b){a.a(rj(b,"create reader "+this.fullPath))},this);return a};Ej.prototype.createWriter=function(){var a=new N;O(this.Vh.createWriter(),function(b){a.e(new Bj(b))},function(b){a.a(rj(b,"create writer "+this.fullPath))},this);return a};Ej.prototype.read=function(){var a=new N;O(this.createReader(),function(b){O(b.read(),function(c){J(b);a.e(c)},function(c){J(b);a.a(c)})},function(b){a.a(b)});return a};
Ej.prototype.write=function(a){var b=new N;O(this.createWriter(),function(c){O(c.Sg(0),function(){O(c.write(a),function(){J(c);b.e(p)},function(a){J(c);b.a(a)})},function(a){J(c);b.a(a)})},function(a){b.a(a)});return b};function Fj(a,b){Cj.call(this,a,b);this.Nf=b}z(Fj,Cj);Fj.prototype.getFile=function(a,b){var c=new N;O(this.Nf.getFile(a,b),function(a){c.e(Dj(this,a))},function(b){c.a(rj(b,"get file "+a+" in "+this.fullPath))},this);return c};
Fj.prototype.getDirectory=function(a,b){var c=new N;O(this.Nf.getDirectory(a,b),function(a){c.e(Dj(this,a))},function(b){c.a(rj(b,"get directory "+a+" in "+this.fullPath))},this);return c};Fj.prototype.Sc=function(a){var b=new N;O(this.Nf.Sc(a),function(a){b.e(Dj(this,a))},function(c){b.a(rj(c,"create path "+a+" in "+this.fullPath))},this);return b};function Gj(a){Aj.call(this,a);this.S=a}z(Gj,Aj);t=Gj.prototype;t.ad=function(){return this.S.position};t.kb=function(){return this.S.length};t.write=function(a){try{this.S.write(a)}catch(b){g(new sj(b.code,"writing file"))}};t.seek=function(a){try{this.S.seek(a)}catch(b){g(new sj(b.code,"seeking in file"))}};t.truncate=function(a){try{this.S.truncate(a)}catch(b){g(new sj(b.code,"truncating file"))}};function Hj(a){return a};function Ij(a,b){this.Ta=a;this.ca=b}Ij.prototype.isFile=function(){return this.ca.isFile};Ij.prototype.getName=function(){return this.ca.name};Ij.prototype.remove=function(){var a=new N;this.ca.remove(y(a.e,a,m),y(function(b){a.a(new sj(b.code,"removing "+this.ca.fullPath))},this));return a};Ij.prototype.getParent=function(){var a=new N;this.ca.getParent(y(function(b){a.e(new Jj(this.Ta,b))},this),y(function(b){a.a(new sj(b.code,"getting parent of "+this.ca.fullPath))},this));return a};
function Jj(a,b){Ij.call(this,a,b);this.Qh=b}z(Jj,Ij);var Kj=2;Jj.prototype.getFile=function(a,b){var c=new N;this.Qh.getFile(a,Lj(b),y(function(a){c.e(new Mj(this.Ta,a))},this),y(function(b){c.a(new sj(b.code,"loading file "+a+" from "+this.ca.fullPath))},this));return c};Jj.prototype.getDirectory=function(a,b){var c=new N;this.Qh.getDirectory(a,Lj(b),y(function(a){c.e(new Jj(this.Ta,a))},this),y(function(b){c.a(new sj(b.code,"loading directory "+a+" from "+this.ca.fullPath))},this));return c};
Jj.prototype.Sc=function(a){function b(a){if(!d.length)return Zc(a);var c=d.shift();a=".."==c?a.getParent():"."==c?Zc(a):a.getDirectory(c,Kj);return O(a,b,p,j)}if(0==a.lastIndexOf("/",0)){var c=this.Ta.ic();if(this.ca.fullPath!=c.ca.fullPath)return c.Sc(a)}var d=yb(a.split("/"),Hj);return b(this)};function Lj(a){return a==Kj?{create:m}:3==a?{create:m,exclusive:m}:{}}function Mj(a,b){Ij.call(this,a,b);this.Wh=b}z(Mj,Ij);
Mj.prototype.createWriter=function(){var a=new N;this.Wh.createWriter(function(b){a.e(new Gj(b))},y(function(b){a.a(new sj(b.code,"creating writer for "+this.ca.fullPath))},this));return a};Mj.prototype.file=function(){var a=new N;this.Wh.file(function(b){a.e(b)},y(function(b){a.a(new sj(b.code,"getting file for "+this.ca.fullPath))},this));return a};function Nj(a){this.Ta=a}Nj.prototype.getName=function(){return this.Ta.name};Nj.prototype.ic=function(){return new Jj(this,this.Ta.root)};function Oj(a,b,c){oj.call(this,a,b);this.Xk=c}z(Oj,oj);Oj.prototype.ic=function(){return new Fj(this,this.Xk.ic())};function Pj(a){cj.call(this);this.wf=a;this.ud=this.rb=this.Ta=p}z(Pj,cj);
Pj.prototype.Tb=function(){var a=new N,b=new N,c=p;if(c=w.requestFileSystem||w.webkitRequestFileSystem,na(c)){var d=new N;c(1,1073741824,function(a){d.e(new Nj(a))},function(a){d.a(new sj(a.code,"requesting filesystem"))});c=d}else c=$c(Error("File API unsupported"));c?O(c,function(a){b.e(new Oj(1,1073741824,a))},function(a){b.a(rj(a,"requesting filesystem"))}):b.a(p);O(b,function(b){this.Ta=b;O(b.ic().Sc(this.wf),function(b){this.rb=b;O(this.rb.Sc("regions"),function(b){this.ud=new nj(256,b);E(this,
this.ud);this.rc=q;this.ob();a.e(p)},function(b){a.a(b)},this)},function(b){a.a(b)},this)},function(b){a.a(b)},this);return a};
Pj.prototype.Fg=function(a){switch(a.action){case 0:O(this.rb.getFile("info.bin"),function(b){O(b.read(),function(b){dj(this,a,p,b)},function(b){dj(this,a,b,p)},this)},function(b){dj(this,a,b,p)},this);break;case 1:O(this.rb.getFile("info.bin"),function(b){O(b.write(a.data),function(){fj(this,a,p)},function(b){fj(this,a,b)},this)},function(b){fj(this,a,b)},this);break;case Rc:O(this.ud.get(a.x,a.y,a.l),function(b){var c=new N,d=b.$[b.gc(a.x,a.y,a.l)],e=4096*(d&255);e?O(b.m.read(4096*(d>>8),e),function(a){c.e(a)},
function(a){c.a(a)},b):c.e(p);O(c,function(b){gj(this,a,p,b)},function(b){gj(this,a,b,p)},this)},function(b){gj(this,a,b,p)},this);break;case hj:O(this.ud.get(a.x,a.y,a.l),function(b){var c=a.data,d=new N,e=b.gc(a.x,a.y,a.l),f=b.$[e],h=f>>8,k=f&255,i=Math.ceil(c.byteLength/4096);if(255<i)d.a(p);else if(h&&k==i)O(b.Ed(h,c),function(){d.e()},function(a){d.a(a)});else{if(h)for(var l=0;l<k;l++)b.L[h+l]=q;var n=new N,k=b.L.indexOf(q),l=0;if(1<i&&-1!=k)for(h=k;h<b.L.length&&!(l?b.L[h]?l=0:l++:b.L[h]||(k=
h,l=1),l>=i);h++);if(l>=i){for(h=0;h<i;h++)b.L[k+h]=m;n.e(k)}else{var r=Math.max(i,32),h=b.S.kb()+4096*r;O(b.S.Sg(h),function(){var a=this.L.length;this.L.length+=r;for(var b=0;b<r;b++)this.L[a+b]=q;for(b=0;b<i;b++)this.L[a+b]=m;J(this.m);this.m=p;O(this.Yf.createReader(),function(b){this.m=b;n.e(a)},function(a){n.a(a)},this)},function(a){n.a(a)},b)}O(n,function(a){f=a<<8|i;this.$[e]=f;O(this.Ed(a,c),function(){O(this.Ed(0,this.$.buffer),function(){d.e()},function(a){d.a(a)})},function(a){d.a(a)},
this)},function(a){d.a(a)},b)}O(d,function(){ij(this,a,p)},function(b){ij(this,a,b)},this)},function(b){ij(this,a,b)},this);break;case 4:O(this.ud.get(a.x,a.y,a.l),function(b){var c=b.gc(a.x,a.y,a.l),d=b.$[c],e=d>>8,d=d&255;if(e){for(var f=0;f<d;f++)b.L[e+f]=q;b.$[c]=0;b=b.Ed(0,b.$.buffer)}else b=Zc(p);O(b,function(){jj(this,a,p)},function(b){jj(this,a,b)},this)},function(b){jj(this,a,b)},this)}};function Qj(a){cj.call(this);this.wf=a;this.Ia=p}z(Qj,cj);var Rj=w.indexedDB||w.mozIndexedDB||w.webkitIndexedDB||w.msIndexedDB;Qj.prototype.Tb=function(){if(!Rj)return $c(p);var a=new N,b=Rj.open(this.wf,2);b.onerror=function(){a.a(p)};b.onsuccess=y(function(){this.Ia=b.result;this.Ia.onerror=function(a){L("idb error: "+a)};this.rc=q;this.ob();a.e(p)},this);b.onupgradeneeded=function(a){a=a.target.result;a.createObjectStore("info");a.createObjectStore("chunks")};return a};
Qj.prototype.b=function(){this.Ia&&(this.Ia.close(),this.Ia=p);Qj.d.b.call(this)};Qj.prototype.Jb=function(a){return[a.x,a.y,a.l].join(".")};
Qj.prototype.Fg=function(a){switch(a.action){case 0:var b=this.Ia.transaction(["info"],"readonly").objectStore("info").get("info");b.onsuccess=y(function(){dj(this,a,p,b.result)},this);b.onerror=y(function(b){b.preventDefault();dj(this,a,b,p)},this);break;case 1:var c=this.Ia.transaction(["info"],"readwrite").objectStore("info").put(a.data,"info");c.onsuccess=y(function(){fj(this,a,p)},this);c.onerror=y(function(b){b.preventDefault();fj(this,a,b)},this);break;case Rc:var d=this.Ia.transaction(["chunks"],
"readonly").objectStore("chunks").get(this.Jb(a));d.onsuccess=y(function(){gj(this,a,p,d.result)},this);d.onerror=y(function(b){b.preventDefault();gj(this,a,b,p)},this);break;case hj:c=this.Ia.transaction(["chunks"],"readwrite").objectStore("chunks").put(a.data,this.Jb(a));c.onsuccess=y(function(){ij(this,a,p)},this);c.onerror=y(function(b){b.preventDefault();ij(this,a,b)},this);break;case 4:c=this.Ia.transaction(["chunks"],"readwrite").objectStore("chunks")["delete"](this.Jb(a)),c.onsuccess=y(function(){jj(this,
a,p)},this),c.onerror=y(function(b){b.preventDefault();jj(this,a,b)},this)}};function Sj(){cj.call(this);this.ji=p;this.Ef={}}z(Sj,cj);Sj.prototype.Tb=function(){this.rc=q;this.ob();return Zc(p)};Sj.prototype.Jb=function(a){return[a.x,a.y,a.l].join(".")};Sj.prototype.Fg=function(a){switch(a.action){case 0:dj(this,a,p,this.ji);break;case 1:this.ji=a.data;fj(this,a,p);break;case Rc:var b=this.Ef[this.Jb(a)];gj(this,a,p,b);break;case hj:this.Ef[this.Jb(a)]=a.data;ij(this,a,p);break;case 4:delete this.Ef[this.Jb(a)],jj(this,a,p)}};function Tj(a,b){var c;if(a instanceof Tj)this.na=fa(b)?b:a.na,Uj(this,a.Bc),c=a.cf,Vj(this),this.cf=c,c=a.Vc,Vj(this),this.Vc=c,Wj(this,a.De),c=a.Be,Vj(this),this.Be=c,Xj(this,a.pb.w()),c=a.ke,Vj(this),this.ke=c;else if(a&&(c=String(a).match(Oi))){this.na=!!b;Uj(this,c[1]||"",m);var d=c[2]||"";Vj(this);this.cf=d?decodeURIComponent(d):"";d=c[3]||"";Vj(this);this.Vc=d?decodeURIComponent(d):"";Wj(this,c[4]);d=c[5]||"";Vj(this);this.Be=d?decodeURIComponent(d):"";Xj(this,c[6]||"",m);c=c[7]||"";Vj(this);
this.ke=c?decodeURIComponent(c):""}else this.na=!!b,this.pb=new Yj(p,0,this.na)}t=Tj.prototype;t.Bc="";t.cf="";t.Vc="";t.De=p;t.Be="";t.ke="";t.dl=q;t.na=q;
t.toString=function(){var a=[],b=this.Bc;b&&a.push(Zj(b,$j),":");if(b=this.Vc){a.push("//");var c=this.cf;c&&a.push(Zj(c,$j),"@");a.push(encodeURIComponent(String(b)));b=this.De;b!=p&&a.push(":",String(b))}if(b=this.Be)this.Vc&&"/"!=b.charAt(0)&&a.push("/"),a.push(Zj(b,"/"==b.charAt(0)?ak:bk));(b=this.pb.toString())&&a.push("?",b);(b=this.ke)&&a.push("#",Zj(b,ck));return a.join("")};t.w=function(){return new Tj(this)};
function Uj(a,b,c){Vj(a);a.Bc=c?b?decodeURIComponent(b):"":b;a.Bc&&(a.Bc=a.Bc.replace(/:$/,""))}function Wj(a,b){Vj(a);b?(b=Number(b),(isNaN(b)||0>b)&&g(Error("Bad port number "+b)),a.De=b):a.De=p}function Xj(a,b,c){Vj(a);b instanceof Yj?(a.pb=b,a.pb.Rg(a.na)):(c||(b=Zj(b,dk)),a.pb=new Yj(b,0,a.na))}function Vj(a){a.dl&&g(Error("Tried to modify a read-only Uri"))}t.Rg=function(a){this.na=a;this.pb&&this.pb.Rg(a);return this};function Zj(a,b){return ma(a)?encodeURI(a).replace(b,ek):p}
function ek(a){a=a.charCodeAt(0);return"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var $j=/[#\/\?@]/g,bk=/[\#\?:]/g,ak=/[\#\?]/g,dk=/[\#\?@]/g,ck=/#/g;function Yj(a,b,c){this.ba=a||p;this.na=!!c}function fk(a){if(!a.B&&(a.B=new oi,a.f=0,a.ba))for(var b=a.ba.split("&"),c=0;c<b.length;c++){var d=b[c].indexOf("="),e=p,f=p;0<=d?(e=b[c].substring(0,d),f=b[c].substring(d+1)):e=b[c];e=decodeURIComponent(e.replace(/\+/g," "));e=gk(a,e);a.add(e,f?decodeURIComponent(f.replace(/\+/g," ")):"")}}t=Yj.prototype;
t.B=p;t.f=p;t.ma=function(){fk(this);return this.f};t.add=function(a,b){fk(this);this.ba=p;a=gk(this,a);var c=this.B.get(a);c||this.B.set(a,c=[]);c.push(b);this.f++;return this};t.remove=function(a){fk(this);a=gk(this,a);return this.B.Cb(a)?(this.ba=p,this.f-=this.B.get(a).length,this.B.remove(a)):q};t.clear=function(){this.B=this.ba=p;this.f=0};t.Cb=function(a){fk(this);a=gk(this,a);return this.B.Cb(a)};
t.jb=function(){fk(this);for(var a=this.B.za(),b=this.B.jb(),c=[],d=0;d<b.length;d++)for(var e=a[d],f=0;f<e.length;f++)c.push(b[d]);return c};t.za=function(a){fk(this);var b=[];if(a)this.Cb(a)&&(b=Db(b,this.B.get(gk(this,a))));else{a=this.B.za();for(var c=0;c<a.length;c++)b=Db(b,a[c])}return b};t.set=function(a,b){fk(this);this.ba=p;a=gk(this,a);this.Cb(a)&&(this.f-=this.B.get(a).length);this.B.set(a,[b]);this.f++;return this};
t.get=function(a,b){var c=a?this.za(a):[];return 0<c.length?String(c[0]):b};t.toString=function(){if(this.ba)return this.ba;if(!this.B)return"";for(var a=[],b=this.B.jb(),c=0;c<b.length;c++)for(var d=b[c],e=encodeURIComponent(String(d)),d=this.za(d),f=0;f<d.length;f++){var h=e;""!==d[f]&&(h+="="+encodeURIComponent(String(d[f])));a.push(h)}return this.ba=a.join("&")};t.w=function(){var a=new Yj;a.ba=this.ba;this.B&&(a.B=this.B.w(),a.f=this.f);return a};
function gk(a,b){var c=String(b);a.na&&(c=c.toLowerCase());return c}t.Rg=function(a){a&&!this.na&&(fk(this),this.ba=p,Kc(this.B,function(a,c){var d=c.toLowerCase();c!=d&&(this.remove(c),this.remove(d),0<a.length&&(this.ba=p,this.B.set(gk(this,d),Eb(a)),this.f+=a.length))},this));this.na=a};t.extend=function(a){for(var b=0;b<arguments.length;b++)Kc(arguments[b],function(a,b){this.add(b,a)},this)};function hk(a,b,c){this.tf=a;Ic(this.tf,ik());this.uri=new Tj(b);this.Ee=new Yj(j,0,m);(a=this.uri.pb)&&this.Ee.extend(a);this.Ee.extend(c);this.xm=jk(this,"buildServer")}function ik(){return{buildServer:{help:"Build server daemon address.",type:String,defaultValue:p}}}function kk(a,b){var c=parseFloat(a.tf[b].defaultValue),d=a.Ee.get(b,c);return!fa(d)?c:Number(d)}function jk(a,b){var c=a.tf[b].defaultValue,d=a.Ee.get(b,c);return!fa(d)||!d||!d.length||/^[\s\xa0]*$/.test(String(d))?c:String(d)};function lk(a,b){hk.call(this,mk(),a,b);this.Lm=kk(this,"listenPort");this.Zf=jk(this,"fileSystem");this.gl=jk(this,"mapPath");this.fl=jk(this,"mapGenerator");this.hl=kk(this,"mapSeed");this.Af=jk(this,"browserUrl");this.fj=jk(this,"serverId");this.hj=jk(this,"serverKey");this.Ml=jk(this,"serverName");this.bm=kk(this,"userCount")}z(lk,hk);
function mk(){return{listenPort:{help:"Port to use for game connections.",type:Number,defaultValue:1337},fileSystem:{help:"File system root path.",type:String,defaultValue:"/tmp/blk/"},mapPath:{help:"Map path.",type:String,defaultValue:"/maps/map01/"},mapGenerator:{help:"Map generator name.",type:String,defaultValue:"improved"},mapSeed:{help:"Map generator random seed.",type:Number,defaultValue:0},browserUrl:{help:"Server browser base API URL.",type:String,defaultValue:"http://localhost:8081/"},serverId:{help:"Server registration UUID.",
type:String,defaultValue:p},serverKey:{help:"Server private key.",type:String,defaultValue:p},serverName:{help:"Human-readable server name.",type:String,defaultValue:p},userCount:{help:"Maximum simultaneous user count.",type:Number,defaultValue:8}}};function nk(){D.call(this);this.type="none"}z(nk,D);function ok(){this.cd=Array(256)}function Ge(a,b,c,d){c=d?y(c,d):c;a.cd[b]=c};function pk(a,b,c){D.call(this);this.Mb=new ok;this.G=new Kh;this.id=a;this.type=b;this.Si=c;this.info=new Tg;this.tm=new nk;this.state=0;this.h=[];this.Yb={};this.mh=Array(256);this.V=[]}z(pk,D);pk.prototype.b=function(){this.V.length=0;pk.d.b.call(this)};pk.prototype.sf=function(a){this.h.push(a);this.Yb[a.c]=a;this.mh[a.R]=a;for(var b=0;b<this.V.length;b++)this.V[b].jh(a)};pk.prototype.He=function(a){var b=this.Yb,c=a.c,d;(d=c in b)&&delete b[c];if(d){this.mh[a.R]=p;Cb(this.h,a);for(b=0;b<this.V.length;b++)this.V[b].kh(a)}};function qk(a){this.timestamp=va();this.I=p;this.data=a};function rk(a){D.call(this);this.Sa=a;this.cl=q;this.state=sk;this.Vd=q;this.Cc=0;this.vb=p;this.td=[];this.kf=[]}z(rk,D);rk.prototype.b=function(){this.close();rk.d.b.call(this)};var sk=0;rk.prototype.read=function(){if(!this.td.length)return p;var a=this.td[0];a.timestamp<=va()?this.td.shift():a=p;this.td.length||(this.Vd=q);return a};
rk.prototype.write=function(a){a=new qk(a);if(this.Cc){var b=this.Cc+(Math.random()-0.5)*this.Cc/2;a.timestamp+=b;this.vb===p&&(this.vb=w.setInterval(y(function(){1==this.state&&this.flush()},this),5))}else this.vb!==p&&(w.clearInterval(this.vb),this.vb=p);this.kf.push(a);1==this.state&&this.flush()};function tk(a,b){if(a.Cc){var c=a.Cc+(Math.random()-0.5)*a.Cc/2;b.timestamp+=c}a.td.push(b);a.Vd=m}
rk.prototype.flush=function(a){for(var b=va();this.kf.length;){var c=this.kf[0];if(c.timestamp>b&&!a)break;this.kf.shift();this.Dj(c.data)}};rk.prototype.close=function(){2!=this.state&&(this.vb!==p&&(w.clearInterval(this.vb),this.vb=p),this.state=2)};function uk(a,b,c,d){pk.call(this,"0",0,b);Ge(this.Mb,1,this.Rk,this);Ge(this.Mb,8,this.Tk,this);Ge(this.Mb,5,this.Pk,this);this.ia=a;this.gj=d;this.Jg=q;this.gd=[];this.Kd=Array(255);for(a=1;a<this.Kd.length;a++)this.Kd[a-1]=a}z(uk,pk);t=uk.prototype;t.b=function(){if(this.Jg){this.Jg=q;this.state=0;this.ia.ja(p);for(var a=0;a<this.V.length;a++)this.V[a].Pf()}uk.d.b.call(this)};t.dg=function(a){var b=a.Sa;0<=wb(Hb,b)||Hb.push(b);this.gd.push(a)};
function vk(a,b){if(b.ia&&(a.Yb[b.c]||p)==b)b.ia.close(),a.He(b),a.send(mh(b.c,b.Of)),0!=b.R&&(a.Kd.push(b.R),b.R=0)}
t.Mi=function(a){if(this.gd.length)for(var b=ef(),c=0;c<this.gd.length;c++){var d=this.gd[c],e=q,f=q,h=1;if(2!=d.state)for(;d.Vd;){var k=d.read();if(!k)break;b.ja(k.data,0);if(4==Oe(b)){var i=b,e=dh;e.Ve=Pe(i);e.Hd=Pe(i);k=e.I||new fe;k.c=i.H();k.R=Oe(i);k.z=i.ha();var l;if(!(l=!Vg(i,k.info)))l=k.Gd||new ae,l.type=i.H(),l.platform=i.H(),l.qd=i.H(),l.Tc=i.H(),l=!l;e=!(l?0:k)?p:e;this.h.length+1>this.gj.oc&&(f=m,h=7);if(!f&&(3!=e.Ve||e.Hd!=this.Si))f=m,h=2;if(!f){e=ge(e.I);for(e.ia=d;!(e.c=Math.floor(2147483648*
Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^va()).toString(36),!this.Yb[e.c]););e.R=this.Kd.shift();this.send(kh(ge(e)));this.send(fh(this.Si,e),e);k=zb(this.h,ge);k.push(ge(e));this.send(bh(this.info.w(),k),e);this.sf(e)}e=m}else f=e=m,h=3}else f=e=m,h=1;e&&(f&&(f=h,h=R(),ih.reason=f,Q(h,5),h.M(ih.reason),(f=h.finish())&&d.write(f),J(d)),this.gd.splice(c,1),c--)}b=Cc();for(c=0;c<this.h.length;c++){for(d=this.h[c];d.ia.Vd;){h=d.ia.read();if(!h)break;h.I=d;d.Ch+=h.data.byteLength;
f=this.Mb;e=ef();e.ja(h.data,0);e.offset+1<=e.buffer.length&&(k=Oe(e),(f=f.cd[k])&&f(h,k,e))}if(!d.ia||2==d.ia.state)d.Of=1,vk(this,d);else if(a&&Cc()-b>=a)break}};t.Rk=function(a,b,c){a=a.I;Yg.Qe=c.ha();Yg.Oc=c.ha();Yg.nc=c.ha();if(!Yg)return q;c=a.i;b=Math.abs(Yg.nc);c.Ld=c.Ld?(c.Ld+b)/2:b;c.xi=Math.min(c.xi,b);c.wi=Math.max(c.wi,b);c=He(this.G)+this.G.Xd;b=Array(this.h.length);for(var d=0;d<this.h.length;d++)b[d]=new Ug,b[d].R=this.h[d].R,b[d].nc=this.h[d].i.Ld;this.send($g(1E3*c|0,b),a);return m};
t.Tk=function(a,b,c){oh.c=c.H();c=!Vg(c,oh.info)?p:oh;if(!c)return q;b=this.Yb[c.c]||p;if(!b)return m;if(b!=a.I)return q;a=c.info.ya;a=lb(a).replace(/\xa0|\s/g," ").replace(/\xa0|[ \t]+/g," ");a=!a.length?"User":a;b.info.ya=a;for(a=0;a<this.V.length;a++)this.V[a].lh(b);this.send(qh(b.c,b.info));return m};t.Pk=function(a,b,c){a=a.I;hh.reason=c.ha();if(!hh)return q;L("["+a.c+"] disconnect req",hh.reason);return m};
t.send=function(a,b){if(a)if(b){var c=b.ia;2!=c.state?(c.write(a),b.i.Qd+=a.byteLength):vk(this,b)}else for(var d=0;d<this.h.length;d++){var e=this.h[d],c=e.ia;2!=c.state?(e.i.Qd+=a.byteLength,c.write(a)):(e.Of=1,vk(this,e))}};function wk(a,b){if(!a)return q;for(var c=a.constructor,d=0;d<b.length;d++){var e=b[d];if(c==e||c.name==e)return m;ma(e)&&(e=w[e]);if(e&&(c==e||c.name==e.name))return m}return q}function xk(a){a=new Uint8Array(a);for(var b=Array(a.length),c=0;c<b.length;c++)b[c]=a[c];return String.fromCharCode.apply(p,b)};function yk(a,b){rk.call(this,a);this.cl=m;this.state=1;this.p=b;this.Sl=!!b.webkitPostMessage&&!wk(b,["MessagePort"]);this.Xj=!Hd;var c=this;this.p.onmessage=function(a){c.eg(a)};this.p.onerror=function(a){L("port error",a)}}z(yk,rk);
yk.prototype.eg=function(a){a=a.data;var b=p;if(a instanceof ArrayBuffer)b=new qk(a);else if(ma(a)){for(var b=new Uint8Array(2*a.length),c=0,d=0;d<a.length;d++){for(var e=a.charCodeAt(d);255<e;)b[c++]=e,e>>=8;b[c++]=e}b=new qk(b.subarray(0,c).buffer)}else a&&a.close&&this.close();b&&tk(this,b)};yk.prototype.Dj=function(a){this.Sl?this.p.webkitPostMessage(a,[a]):this.Xj?this.p.postMessage(a):this.p.postMessage(xk(a))};
yk.prototype.close=function(){this.p.onmessage=p;try{this.p.postMessage({close:m}),this.p.close&&this.p.close()}catch(a){}yk.d.close.call(this)};function zk(a){D.call(this);this.Sa=a;this.fb=m;this.If=[];this.Zd=p}z(zk,D);zk.prototype.b=function(){this.close();this.Zd=p;zk.d.b.call(this)};zk.prototype.ja=function(a){if(this.Zd=a)for(;this.If.length;){var b=this.If.shift();a.call(p,b)}};function Ak(a,b){a.Zd?a.Zd.call(p,b):a.If.push(b)};function Bk(a,b){zk.call(this,a);this.p=b;this.yh=y(this.dg,this);this.p.addEventListener("connect",this.yh,q);if(wk(b,["DedicatedWorkerContext","DedicatedWorkerGlobalScope"])){var c=new yk(b,b);Ak(this,c)}}z(Bk,zk);Bk.prototype.dg=function(a){a=a.ports[0];a=new yk(a,a);Ak(this,a)};Bk.prototype.close=function(){this.fb&&(this.fb=q,this.p.removeEventListener("connect",this.yh,q))};function Ck(a,b){rk.call(this,a);this.state=1;this.p=b;this.Ah=y(this.Qk,this);this.xh=y(this.Nk,this);this.Bh=y(this.eg,this);this.im={binary:m,mask:q};this.p.addListener("error",this.Ah);this.p.addListener("close",this.xh);this.p.addListener("message",this.Bh)}z(Ck,rk);t=Ck.prototype;t.Qk=function(a){L("socket error",a)};t.Nk=function(a){L("socket closed",a.code);this.close()};t.eg=function(a){for(var b=new Uint8Array(a.length),c=0;c<a.length;c++)b[c]=a[c];a=new qk(b.buffer);tk(this,a)};
t.Dj=function(a){var b=new Buffer(a.byteLength);a=new Uint8Array(a);for(var c=0;c<a.length;c++)b[c]=a[c];try{this.p.send(b,this.im)}catch(d){L("socket error: "+d),this.close()}};t.close=function(){this.p.removeListener("error",this.Ah);this.p.removeListener("close",this.xh);this.p.removeListener("message",this.Bh);try{this.p.close(1E3,"")}catch(a){}Ck.d.close.call(this)};function Dk(a){zk.call(this,a);this.p=new (require("ws").Server)({host:j,port:Number(a)});this.zh=y(this.Ok,this);this.p.addListener("connection",this.zh)}z(Dk,zk);Dk.prototype.Ok=function(a){a=new Ck(a,a);Ak(this,a)};Dk.prototype.close=function(){this.fb&&(this.fb=q,this.p.removeListener("connection",this.zh),this.p.close())};ea("blk.server.start",function(a,b){function c(a,b,d){var e=new (b.shift())(a);O(e.Tb(),function(){d(e)},function(){c(a,b,d)})}for(var d=new N,e={},f=0;f<b.length;f++){var h=b[f];if(0==h.indexOf("--")){var h=h.split("="),k=h[1];e[h[0].substring(2)]=1<h.length?k:m}}if(e.help)return L("BLK game server","(release)"),L("gf:"),L(ik()),L("blk:"),L(mk()),d.a("help query"),d;var i=new lk(a,e),e=new Tg;e.Sa="blk://local-0";e.name=i.Ml||"Server";e.Yc="blk";e.Zc="0.0.1";e.oc=i.bm;f=p;ma(w)?f=new Dk(w):oa(w)&&
(f=new Bk(w,w));e=new uk(f,7,0,e);e=Zc(e);O(e,function(a){c(i.gl,[Qj,Pj,Sj],function(b){var c=new aj(i,a,b);O(c.load(),function(){c.Xg||(c.Xg=m,c.Ie.start());d.e(c)},function(a){d.a(a)})})},function(a){d.a(a)});return d});
