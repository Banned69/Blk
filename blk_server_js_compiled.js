function g(a){throw a;}var i=void 0,l=!0,n=null,p=!1;function aa(){return function(){}}function ba(a){return function(b){this[a]=b}}function s(a){return function(){return this[a]}}function ca(a){return function(){return a}}var t,ea=ea||{},u=this;function fa(a,b){var c=a.split("."),d=u;!(c[0]in d)&&d.execScript&&d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)!c.length&&ga(b)?d[e]=b:d=d[e]?d[e]:d[e]={}}
function ha(a){a=a.split(".");for(var b=u,c;c=a.shift();)if(b[c]!=n)b=b[c];else return n;return b}function v(){}
function ia(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function ga(a){return a!==i}function ka(a){return"array"==ia(a)}function la(a){var b=ia(a);return"array"==b||"object"==b&&"number"==typeof a.length}function ma(a){return"string"==typeof a}function na(a){return"function"==ia(a)}function oa(a){var b=typeof a;return"object"==b&&a!=n||"function"==b}function pa(a){return a[qa]||(a[qa]=++ra)}var qa="closure_uid_"+Math.floor(2147483648*Math.random()).toString(36),ra=0;
function sa(a,b,c){return a.call.apply(a.bind,arguments)}function ta(a,b,c){a||g(Error());if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}function w(a,b,c){w=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?sa:ta;return w.apply(n,arguments)}var ua=Date.now||function(){return+new Date};
function y(a,b){function c(){}c.prototype=b.prototype;a.d=b.prototype;a.prototype=new c;a.prototype.constructor=a};function va(a,b){this.attributes=[new wa(3,0),new wa(2,24)];this.dl=a;this.nl=b}function wa(a,b){this.size=a;this.type=5126;this.xl=p;this.El=32;this.offset=b};function xa(){};function Ga(a){this.length=a.length||a;for(var b=0;b<this.length;b++)this[b]=a[b]||0}Ga.prototype.BYTES_PER_ELEMENT=4;Ga.prototype.set=function(a,b){b=b||0;for(var c=0;c<a.length&&b+c<this.length;c++)this[b+c]=a[c]};Ga.prototype.toString=Array.prototype.join;"undefined"==typeof Float32Array&&(Ga.BYTES_PER_ELEMENT=4,Ga.prototype.BYTES_PER_ELEMENT=Ga.prototype.BYTES_PER_ELEMENT,Ga.prototype.set=Ga.prototype.set,Ga.prototype.toString=Ga.prototype.toString,fa("Float32Array",Ga));function Ha(a){this.length=a.length||a;for(var b=0;b<this.length;b++)this[b]=a[b]||0}Ha.prototype.BYTES_PER_ELEMENT=8;Ha.prototype.set=function(a,b){b=b||0;for(var c=0;c<a.length&&b+c<this.length;c++)this[b+c]=a[c]};Ha.prototype.toString=Array.prototype.join;if("undefined"==typeof Float64Array){try{Ha.BYTES_PER_ELEMENT=8}catch(Ia){}Ha.prototype.BYTES_PER_ELEMENT=Ha.prototype.BYTES_PER_ELEMENT;Ha.prototype.set=Ha.prototype.set;Ha.prototype.toString=Ha.prototype.toString;fa("Float64Array",Ha)};function A(){return new Float32Array(3)}function Ja(a,b,c){var d=A();B(d,a,b,c);return d}function B(a,b,c,d){a[0]=b;a[1]=c;a[2]=d}function Ka(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2]}function La(a,b,c){c[0]=a[0]+b[0];c[1]=a[1]+b[1];c[2]=a[2]+b[2]}function Ma(a,b,c){c[0]=a[0]*b;c[1]=a[1]*b;c[2]=a[2]*b}function Na(a){var b=a[0],c=a[1];a=a[2];return Math.sqrt(b*b+c*c+a*a)}function Oa(a,b){var c=a[0]-b[0],d=a[1]-b[1],e=a[2]-b[2];return c*c+d*d+e*e}
function Pa(a,b,c){var d=b[0]-a[0],e=b[1]-a[1];a=b[2]-a[2];(b=Math.sqrt(d*d+e*e+a*a))?(b=1/b,c[0]=d*b,c[1]=e*b,c[2]=a*b):c[0]=c[1]=c[2]=0}function Qa(a,b){return a.length==b.length&&a[0]==b[0]&&a[1]==b[1]&&a[2]==b[2]};function Ra(){var a=A(),b=A();this.min=a;this.max=b}function Sa(a,b,c,d,e,f){var h=new Ra;h.min[0]=a<d?a:d;h.min[1]=b<e?b:e;h.min[2]=c<f?c:f;h.max[0]=a<d?d:a;h.max[1]=b<e?e:b;h.max[2]=c<f?f:c;return h}
function Ta(a,b,c){var d=a.min;a=a.max;var e=Ua[0];e[0]=Math.abs(b[3]);e[1]=Math.abs(b[4]);e[2]=Math.abs(b[5]);var f=0,h=1,k=2;e[0]<e[2]&&(f=2,k=0);e[1]<e[k]?(h=k,k=1):e[1]>e[f]&&(h=f,f=1);var j=0,m=Number.MAX_VALUE,q=b[3+f],r=(d[f]-b[f])/q,f=(a[f]-b[f])/q;r>f&&(q=r,r=f,f=q);if(!(r>m||f<j)){r>j&&(j=r);f<m&&(m=f);if(1E-6>e[h]){if(b[h]<d[h]||b[h]>a[h]||b[k]<d[k]||b[k]>a[k])return}else{q=b[3+h];r=(d[h]-b[h])/q;f=(a[h]-b[h])/q;r>f&&(q=r,r=f,f=q);if(r>m||f<j)return;r>j&&(j=r);f<m&&(m=f);if(1E-6>e[k]){if(b[k]<
d[k]||b[k]>a[k])return}else{q=b[3+k];r=(d[k]-b[k])/q;f=(a[k]-b[k])/q;r>f&&(q=r,r=f,f=q);if(r>m||f<j)return;r>j&&(j=r)}}c&&(c[0]=b[0]+b[3]*j,c[1]=b[1]+b[4]*j,c[2]=b[2]+b[5]*j)}}var Ua=[A(),A(),A()];function C(){return new Float32Array(4)}function Va(a,b,c,d){var e=C();Wa(e,a,b,c,d);return e}function Wa(a,b,c,d,e){a[0]=b;a[1]=c;a[2]=d;a[3]=e}function Xa(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3]}function Ya(a,b){var c=1/256;b[0]=a[0]*c;b[1]=a[1]*c;b[2]=a[2]*c;b[3]=a[3]*c};function Za(){var a=new Float32Array(16);a[0]=a[5]=a[10]=a[15]=1;return a}function $a(a,b,c,d,e,f,h,k,j){a[0]=b;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=c;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=d;a[11]=e;a[12]=f;a[13]=h;a[14]=k;a[15]=j}
function ab(a,b,c){var d=a[0],e=a[1],f=a[2],h=a[3],k=a[4],j=a[5],m=a[6],q=a[7],r=a[8],z=a[9],x=a[10],G=a[11],I=a[12],E=a[13],F=a[14];a=a[15];var K=b[0],da=b[1],X=b[2],ja=b[3],ya=b[4],za=b[5],Aa=b[6],Ba=b[7],Ca=b[8],Da=b[9],Ea=b[10],Fa=b[11],H=b[12],ud=b[13],vd=b[14];b=b[15];c[0]=d*K+k*da+r*X+I*ja;c[1]=e*K+j*da+z*X+E*ja;c[2]=f*K+m*da+x*X+F*ja;c[3]=h*K+q*da+G*X+a*ja;c[4]=d*ya+k*za+r*Aa+I*Ba;c[5]=e*ya+j*za+z*Aa+E*Ba;c[6]=f*ya+m*za+x*Aa+F*Ba;c[7]=h*ya+q*za+G*Aa+a*Ba;c[8]=d*Ca+k*Da+r*Ea+I*Fa;c[9]=e*Ca+
j*Da+z*Ea+E*Fa;c[10]=f*Ca+m*Da+x*Ea+F*Fa;c[11]=h*Ca+q*Da+G*Ea+a*Fa;c[12]=d*H+k*ud+r*vd+I*b;c[13]=e*H+j*ud+z*vd+E*b;c[14]=f*H+m*ud+x*vd+F*b;c[15]=h*H+q*ud+G*vd+a*b}
function bb(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],h=a[4],k=a[5],j=a[6],m=a[7],q=a[8],r=a[9],z=a[10],x=a[11],G=a[12],I=a[13],E=a[14],F=a[15],K=c*k-d*h,da=c*j-e*h,X=c*m-f*h,ja=d*j-e*k,ya=d*m-f*k,za=e*m-f*j,Aa=q*I-r*G,Ba=q*E-z*G,Ca=q*F-x*G,Da=r*E-z*I,Ea=r*F-x*I,Fa=z*F-x*E,H=K*Fa-da*Ea+X*Da+ja*Ca-ya*Ba+za*Aa;0!=H&&(H=1/H,b[0]=(k*Fa-j*Ea+m*Da)*H,b[1]=(-d*Fa+e*Ea-f*Da)*H,b[2]=(I*za-E*ya+F*ja)*H,b[3]=(-r*za+z*ya-x*ja)*H,b[4]=(-h*Fa+j*Ca-m*Ba)*H,b[5]=(c*Fa-e*Ca+f*Ba)*H,b[6]=(-G*za+E*X-F*da)*H,b[7]=(q*za-z*
X+x*da)*H,b[8]=(h*Ea-k*Ca+m*Aa)*H,b[9]=(-c*Ea+d*Ca-f*Aa)*H,b[10]=(G*ya-I*X+F*K)*H,b[11]=(-q*ya+r*X-x*K)*H,b[12]=(-h*Da+k*Ba-j*Aa)*H,b[13]=(c*Da-d*Ba+e*Aa)*H,b[14]=(-G*ja+I*da-E*K)*H,b[15]=(q*ja-r*da+z*K)*H)}function cb(a,b,c){var d=b[0],e=b[1];b=b[2];var f=1/(d*a[3]+e*a[7]+b*a[11]+a[15]);c[0]=(d*a[0]+e*a[4]+b*a[8]+a[12])*f;c[1]=(d*a[1]+e*a[5]+b*a[9]+a[13])*f;c[2]=(d*a[2]+e*a[6]+b*a[10]+a[14])*f}new Float64Array(3);new Float64Array(3);new Float64Array(4);new Float64Array(4);new Float64Array(4);new Float64Array(16);function db(){this.name=n;this.index=0;this.parent=n;this.children=[];this.transform=Za();this.Va=new Ra;this.pd=C()};function eb(a){this.Gh=a;a=a.nd;this.Ji=new Float32Array(16*a.length);this.$k=new Float32Array(16*a.length);this.Mk=l;this.reset()}eb.prototype.reset=function(){this.Mk=l;for(var a=this.Gh.nd,b=0,c=0;b<a.length;b++,c+=16)for(var d=a[b],e=0;16>e;e++)this.Ji[c+e]=d.transform[e]};function D(){0!=fb&&(this.ll=Error().stack,gb[pa(this)]=this)}var fb=0,gb={};D.prototype.bh=p;D.prototype.xc=function(){if(!this.bh&&(this.bh=l,this.b(),0!=fb)){var a=pa(this);delete gb[a]}};function J(a,b){a.Fd||(a.Fd=[]);a.Fd.push(b)}D.prototype.b=function(){this.Fd&&hb.apply(n,this.Fd);if(this.Nh)for(;this.Nh.length;)this.Nh.shift()()};function L(a){a&&"function"==typeof a.xc&&a.xc()}function hb(a){for(var b=0,c=arguments.length;b<c;++b){var d=arguments[b];la(d)?hb.apply(n,d):L(d)}};function ib(a){Error.captureStackTrace?Error.captureStackTrace(this,ib):this.stack=Error().stack||"";a&&(this.message=String(a))}y(ib,Error);ib.prototype.name="CustomError";function jb(a,b){for(var c=1;c<arguments.length;c++){var d=String(arguments[c]).replace(/\$/g,"$$$$");a=a.replace(/\%s/,d)}return a}function kb(a){return a.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")}function lb(a){if(!mb.test(a))return a;-1!=a.indexOf("&")&&(a=a.replace(nb,"&amp;"));-1!=a.indexOf("<")&&(a=a.replace(ob,"&lt;"));-1!=a.indexOf(">")&&(a=a.replace(pb,"&gt;"));-1!=a.indexOf('"')&&(a=a.replace(qb,"&quot;"));return a}var nb=/&/g,ob=/</g,pb=/>/g,qb=/\"/g,mb=/[&<>\"]/;Math.random();function rb(a){D.call(this);this.id=a;this.Va=new Ra;this.pd=C();this.hj=n;this.jk=[];this.nd=[];this.gl={}}y(rb,D);rb.prototype.Dd=function(){return new eb(this)};function sb(){this.Xj=new xa;this.primitiveType=4;this.ol=this.Yi=0};function tb(){var a=new rb("pumpkin"),b=a.Va,c=[-0.5,-1,0,0.5,1,0.5],d=b.min,b=b.max;if(c.length){var e=0;B(d,c[e],c[e+1],c[e+2]);B(b,c[e],c[e+1],c[e+2]);e++;for(var f=1;f<c.length/3;f++,e++)c[e]<d[0]?d[0]=c[e]:c[e]>b[0]&&(b[0]=c[e]),c[e+1]<d[1]?d[1]=c[e+1]:c[e+1]>b[1]&&(b[1]=c[e+1]),c[e+2]<d[2]?d[2]=c[e+2]:c[e+2]>b[2]&&(b[2]=c[e+2])}else B(d,0,0,0),B(b,0,0,0);Wa(a.pd,0,0,0,1);c=Va(96,112,112,128);d=Va(112,112,128,128);b=Va(96,96,112,112);Ya(c,c);Ya(d,d);Ya(b,b);c=new Float32Array([-0.5,-1,0.5,0,
0,1,c[2],c[3],0.5,-1,0.5,0,0,1,c[0],c[3],0.5,1,0.5,0,0,1,c[0],c[1],-0.5,1,0.5,0,0,1,c[2],c[1],-0.5,-1,-0.5,0,0,-1,d[0],d[3],-0.5,1,-0.5,0,0,-1,d[0],d[1],0.5,1,-0.5,0,0,-1,d[2],d[1],0.5,-1,-0.5,0,0,-1,d[2],d[3],-0.5,1,-0.5,0,1,0,b[2],b[1],-0.5,1,0.5,0,1,0,b[2],b[3],0.5,1,0.5,0,1,0,b[0],b[3],0.5,1,-0.5,0,1,0,b[0],b[1],-0.5,-1,-0.5,0,-1,0,c[0],c[1],0.5,-1,-0.5,0,-1,0,c[2],c[1],0.5,-1,0.5,0,-1,0,c[2],c[3],-0.5,-1,0.5,0,-1,0,c[0],c[3],0.5,-1,-0.5,1,0,0,c[0],c[3],0.5,1,-0.5,1,0,0,c[0],c[1],0.5,1,0.5,1,
0,0,c[2],c[1],0.5,-1,0.5,1,0,0,c[2],c[3],-0.5,-1,-0.5,-1,0,0,c[2],c[3],-0.5,-1,0.5,-1,0,0,c[0],c[3],-0.5,1,0.5,-1,0,0,c[0],c[1],-0.5,1,-0.5,-1,0,0,c[2],c[1]]);d=new Uint16Array(36);for(f=e=b=0;6>b;b++,e+=6,f+=4)d[e+0]=0+f,d[e+1]=1+f,d[e+2]=2+f,d[e+3]=0+f,d[e+4]=2+f,d[e+5]=3+f;a.hj=new va(c.buffer,d);c=new sb;a.jk.push(c);c.primitiveType=4;c.Yi=36;c=new db;c.index=a.nd.length;c.name=n;c.parent=n;a.nd.push(c);d=c.Va;b=a.Va;Ka(d.min,b.min);Ka(d.max,b.max);Xa(c.pd,a.pd);return a};var ub=Array.prototype,vb=ub.indexOf?function(a,b,c){return ub.indexOf.call(a,b,c)}:function(a,b,c){c=c==n?0:0>c?Math.max(0,a.length+c):c;if(ma(a))return!ma(b)||1!=b.length?-1:a.indexOf(b,c);for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},wb=ub.forEach?function(a,b,c){ub.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=ma(a)?a.split(""):a,f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)},xb=ub.filter?function(a,b,c){return ub.filter.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=[],f=
0,h=ma(a)?a.split(""):a,k=0;k<d;k++)if(k in h){var j=h[k];b.call(c,j,k,a)&&(e[f++]=j)}return e},yb=ub.map?function(a,b,c){return ub.map.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=Array(d),f=ma(a)?a.split(""):a,h=0;h<d;h++)h in f&&(e[h]=b.call(c,f[h],h,a));return e},zb=ub.some?function(a,b,c){return ub.some.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=ma(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return l;return p};
function Ab(a){if(!ka(a))for(var b=a.length-1;0<=b;b--)delete a[b];a.length=0}function Bb(a,b){var c=vb(a,b),d;(d=0<=c)&&ub.splice.call(a,c,1);return d}function Cb(a){return ub.concat.apply(ub,arguments)}function Db(a){var b=a.length;if(0<b){for(var c=Array(b),d=0;d<b;d++)c[d]=a[d];return c}return[]}function Eb(a,b){ub.sort.call(a,b||Fb)}function Fb(a,b){return a>b?1:a<b?-1:0};var Gb=u.postMessage?[u]:[];function M(a){for(var b=0;b<Gb.length;b++){for(var c=Array(arguments.length),d=0;d<c.length;d++)c[d]=arguments[d];try{Gb[b].postMessage({type:"gf_log",args:c},n)}catch(e){}}}if(u.console)var Hb=u.console,M=w(Hb.log,Hb);function Ib(){D.call(this);this.Oc={}}y(Ib,D);Ib.prototype.b=function(){for(var a in this.Oc)L(this.Oc[a]);this.Oc={};Ib.d.b.call(this)};Ib.prototype.update=aa();function Jb(a){Ib.call(this);this.oc=a;this.Ih={}}y(Jb,Ib);function Kb(a){Jb.call(this,a);this.Ih.pumpkin={id:"pumpkin",Vi:tb}}y(Kb,Jb);function Lb(){this.bi=0};function Mb(){this.p=Array(256)};function Nb(a,b,c,d,e,f,h){this.yd=a;this.Gg=b;this.Hg=c;this.Ig=d;this.U=e;this.sf=f;this.Sh=h};function Ob(a,b,c,d){this.map=a;this.x=b;this.y=c;this.k=d;this.Va=Sa(b,c,d,b+16,c+128,d+16);this.state=Pb;this.Pb=l;this.version=this.Ba=0;this.U=new Uint16Array(32768);this.zl=n}var Pb=0;Ob.prototype.fill=function(a){for(var b=0;32768>b;b++)this.U[b]=a[b];this.Pb=l;this.state=2;this.map.Zd(this);this.map.Qe(this)};Ob.prototype.Ea=function(a,b,c,d){b=(a&15)+16*(c&15)+256*(b&127);a=this.U[b];this.U[b]=d;a!=d&&!this.Pb&&(d=this.Pb,this.Pb=l,d||this.map.Qe(this));return a};
Ob.prototype.Kf=function(a){var b=Qb[0];Ta(this.Va,a,b);var c=Math.floor(b[0]),d=Math.floor(b[1]),e=Math.floor(b[2]),f=0==a[3]?0:0>a[3]?-1:1,h=0==a[4]?0:0>a[4]?-1:1,k=0==a[5]?0:0>a[5]?-1:1,j=(c+(0<f?1:0)-b[0])/a[3],m=(d+(0<h?1:0)-b[1])/a[4],q=(e+(0<k?1:0)-b[2])/a[5];isNaN(j)&&(j=Number.POSITIVE_INFINITY);isNaN(m)&&(m=Number.POSITIVE_INFINITY);isNaN(q)&&(q=Number.POSITIVE_INFINITY);var r=f/a[3],z=h/a[4],x=k/a[5];isNaN(r)&&(r=Number.POSITIVE_INFINITY);isNaN(z)&&(z=Number.POSITIVE_INFINITY);isNaN(x)&&
(x=Number.POSITIVE_INFINITY);for(var G=this.U,I=b=0;256>I;I++){var E=c-this.x,F=d-this.y,K=e-this.k;if(0<=E&&(16>E&&0<=F&&128>F&&0<=K&&16>K)&&(b=G[E+16*K+256*F],b>>8))break;j<m&&j<q?(j+=r,c+=f):m<q?(m+=z,d+=h):(q+=x,e+=k)}return b?(f=Rb,h=c+1,k=d+1,j=e+1,B(f.min,c,d,e),B(f.max,h,k,j),f=A(),Ta(Rb,a,f),new Nb(this,c,d,e,b,Math.sqrt(Oa(a,f)),f)):n};var Qb=[A(),A()],Rb=new Ra;function Sb(){D.call(this);this.wa={};this.Jb=[];this.Ae=this.vi=0}y(Sb,D);t=Sb.prototype;t.b=function(){this.Jb.length=0;Sb.d.b.call(this)};t.update=function(){for(;this.Jb.length;){var a=this.Jb.shift();Tb(this,a)}};t.get=function(a,b,c){return 0!=b>>7?n:this.wa[(a>>4&65535)<<16|c>>4&65535]||n};t.add=function(a){this.wa[(a.x>>4&65535)<<16|a.k>>4&65535]=a;0<a.Ba||this.Jb.push(a);this.vi++;this.Ae+=65792};t.remove=function(a){Tb(this,a);0<a.Ba||Bb(this.Jb,a)};
function Tb(a,b){delete a.wa[(b.x>>4&65535)<<16|b.k>>4&65535];a.Ae-=65792;a.vi--}t.Xd=function(a){this.Jb.push(a)};t.Yd=function(a){Bb(this.Jb,a)};function Ub(){D.call(this);this.Fk=Ja(0,191/255,1);this.bl=Ja(110/255,110/255,110/255);this.Gl=Ja(1,1,-0.5);this.Fl=Ja(130/255,130/255,130/255);this.dj=Ja(1,1,1);Ka(this.dj,this.Fk)}y(Ub,D);Ub.prototype.update=aa();function Vb(a,b,c,d,e){this.id=a;this.name=b;this.Xj=c;this.t=d;this.Dl=0;this.ql=1;this.Hl=0;this.cl=e};function Wb(a,b,c,d,e){Vb.call(this,a,b,c,d,e)}y(Wb,Vb);function Xb(a,b){var c=Va(0,0,0,0);this.t=a;this.al=b||n;this.Cl=n;this.color=c||C()};var Yb=new Xb(17,"block_gravel"),Zb=new Xb(17,"block_stone"),$b=new Xb(17,"block_wood"),ac=new Xb(97,"block_stone");function bc(){Vb.call(this,3,"Brick",Zb,17,7)}y(bc,Wb);function cc(){Vb.call(this,1,"Dirt",Yb,17,2)}y(cc,Wb);function dc(){Vb.call(this,5,"Glass",ac,17,49)}y(dc,Wb);function ec(){Vb.call(this,2,"Stone",Zb,17,1)}y(ec,Wb);function fc(){Vb.call(this,4,"Wood",$b,17,4)}y(fc,Wb);function gc(){D.call(this);this.N=new Mb;var a=new cc;this.N.p[a.id]=a;a=new ec;this.N.p[a.id]=a;a=new bc;this.N.p[a.id]=a;a=new fc;this.N.p[a.id]=a;a=new dc;this.N.p[a.id]=a;this.hh=new Ub;J(this,this.hh);this.Sa=[];this.mb=new Sb;J(this,this.mb)}y(gc,D);t=gc.prototype;t.b=function(){gc.d.b.call(this)};t.update=function(a){this.hh.update(a);this.mb.update(a)};t.Od=function(a,b,c){var d=this.mb.get(a,b,c);if(d)return d;d=new Ob(this,a&-16,b&-128,c&-16);this.mb.add(d);this.me(d);return d};
t.Zd=function(a){for(var b=0;b<this.Sa.length;b++){var c=this.Sa[b],d=c.Wa,e=a.Va,f=d.min,d=d.max,h=e.min,e=e.max;-1!=(d[0]<h[0]||f[0]>e[0]||d[1]<h[1]||f[1]>e[1]||d[2]<h[2]||f[2]>e[2]?-1:f[0]>h[0]||e[0]>d[0]||f[1]>h[1]||e[1]>d[1]||f[2]>h[2]||e[2]>d[2]?0:1)&&c.Zd(a)}};t.Qe=v;t.Xd=function(a){this.mb.Xd(a)};t.Yd=function(a){this.mb.Yd(a)};t.me=v;
t.Ea=function(a,b,c,d){var e=this.mb.get(a,b,c);if(e){if(2!=e.state)return M("setBlock before chunk fully loaded - inconsistent state!"),0}else return 0;e=e.Ea(a,b,c,d);if(e!=d)for(d=0;d<this.Sa.length;d++)for(var f=this.Sa[d],h=a,k=b,j=c,m=0;m<f.m.length;m++)f.m[m].vh(h,k,j,0);return e};function hc(a,b){this.Ch=a;this.N=b}hc.prototype.mh=v;function ic(a){this.Cb=jc(32);this.Db=jc(32);this.Eb=jc(32);this.Pg=1;a=ga(a)?a:ua();this.Cb-=jc(a);0>this.Cb&&(this.Cb+=1);this.Db-=jc(a);0>this.Db&&(this.Db+=1);this.Eb-=jc(a);0>this.Eb&&(this.Eb+=1);for(a=0;100>a;a++)this.random()}function jc(a){a=a.toString();for(var b=4022871197,c=0;c<a.length;c++)var b=b+a.charCodeAt(c),d=0.02519603282416938*b,b=d>>>0,d=d-b,d=d*b,b=d>>>0,d=d-b,b=b+4294967296*d;return 2.3283064365386963E-10*(b>>>0)}
ic.prototype.random=function(){var a=2091639*this.Cb+2.3283064365386963E-10*this.Pg;this.Cb=this.Db;this.Db=this.Eb;return this.Eb=a-(this.Pg=a|0)};function kc(a){this.yj=new Float32Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1]);this.Xf=new Uint8Array(512);for(var b=0;256>b;b++)this.Xf[b]=this.Xf[256+b]=~~(255*a.random())}function lc(a,b,c,d){a=a.yj;return a[3*b]*c+a[3*b+1]*d}
function mc(a,b,c){var d,e=(b+c)*0.5*(Math.sqrt(3)-1),f=Math.floor(b+e),h=Math.floor(c+e),e=(3-Math.sqrt(3))/6;d=(f+h)*e;b-=f-d;var k=c-(h-d),j,m;b>k?(j=1,m=0):(j=0,m=1);d=b-j+e;var q=k-m+e;c=b-1+2*e;var e=k-1+2*e,r=f&255,z=h&255,x=a.Xf,f=x[r+x[z]]%12,h=x[r+j+x[z+m]]%12;j=x[r+1+x[z+1]]%12;m=0.5-b*b-k*k;0>m?b=0:(m*=m,b=m*m*lc(a,f,b,k));k=0.5-d*d-q*q;0>k?d=0:(k*=k,d=k*k*lc(a,h,d,q));q=0.5-c*c-e*e;0>q?a=0:(q*=q,a=q*q*lc(a,j,c,e));return 70*(b+d+a)};function nc(a,b){hc.call(this,a,b);var c=new ic(a.bi);this.dk=new kc(c)}y(nc,hc);nc.prototype.mh=function(a,b,c,d,e){a=this.dk;for(c=0;16>c;c++)for(var f=b+c,h=0;16>h;h++){var k=d+h,j=0.5*mc(a,0.0010*f,0.0010*k),j=j+0.25*mc(a,0.0020*(f+100),0.0020*k),j=j+0.25*mc(a,0.01*(f+100),0.01*k),m=25.6*j+64|0;1>m&&(m=1);e.Ea(c,m,h,257);var k=e,q=c&15,j=0,m=m-1&127,r=h&15;if(j>m)var z=j,j=m,m=z;for(q=q+16*r+256*j;j<=m;j++,q+=256)k.U[q]=256}};function oc(){this.U=new Uint16Array(32768);this.Zk=new Uint16Array(32768)}oc.prototype.da=function(){this.U.set(this.Zk)};oc.prototype.end=s("U");oc.prototype.Ea=function(a,b,c,d){this.U[(a&15)+16*(c&15)+256*(b&127)]=d};var N=u.performance&&u.performance.webkitNow?function(){return u.performance.webkitNow()}:ua;function pc(a,b){for(var c in a)b.call(i,a[c],c,a)}function qc(a){var b=[],c=0,d;for(d in a)b[c++]=a[d];return b}function rc(a){var b=[],c=0,d;for(d in a)b[c++]=d;return b}function sc(a){var b={},c;for(c in a)b[c]=a[c];return b}var tc="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");
function uc(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var f=0;f<tc.length;f++)c=tc[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}};function vc(a){if("function"==typeof a.ra)return a.ra();if(ma(a))return a.split("");if(la(a)){for(var b=[],c=a.length,d=0;d<c;d++)b.push(a[d]);return b}return qc(a)}function wc(a,b,c){if("function"==typeof a.forEach)a.forEach(b,c);else if(la(a)||ma(a))wb(a,b,c);else{var d;if("function"==typeof a.cb)d=a.cb();else if("function"!=typeof a.ra)if(la(a)||ma(a)){d=[];for(var e=a.length,f=0;f<e;f++)d.push(f)}else d=rc(a);else d=i;for(var e=vc(a),f=e.length,h=0;h<f;h++)b.call(c,e[h],d&&d[h],a)}};function xc(a,b){this.yh=a;this.Cg=b}xc.prototype.getKey=s("yh");xc.prototype.s=function(){return new xc(this.yh,this.Cg)};function yc(a){this.za=[];if(a)a:{var b,c;if(a instanceof yc){if(b=a.cb(),c=a.ra(),0>=a.ya()){a=this.za;for(var d=0;d<b.length;d++)a.push(new xc(b[d],c[d]));break a}}else b=rc(a),c=qc(a);for(d=0;d<b.length;d++)zc(this,b[d],c[d])}}function zc(a,b,c){var d=a.za;d.push(new xc(b,c));b=d.length-1;a=a.za;for(c=a[b];0<b;)if(d=b-1>>1,a[d].getKey()>c.getKey())a[b]=a[d],b=d;else break;a[b]=c}t=yc.prototype;
t.remove=function(){var a=this.za,b=a.length,c=a[0];if(!(0>=b)){if(1==b)Ab(a);else{a[0]=a.pop();for(var a=0,b=this.za,d=b.length,e=b[a];a<d>>1;){var f=2*a+1,h=2*a+2,f=h<d&&b[h].getKey()<b[f].getKey()?h:f;if(b[f].getKey()>e.getKey())break;b[a]=b[f];a=f}b[a]=e}return c.Cg}};t.ra=function(){for(var a=this.za,b=[],c=a.length,d=0;d<c;d++)b.push(a[d].Cg);return b};t.cb=function(){for(var a=this.za,b=[],c=a.length,d=0;d<c;d++)b.push(a[d].getKey());return b};
t.pb=function(a){return zb(this.za,function(b){return b.getKey()==a})};t.s=function(){return new yc(this)};t.ya=function(){return this.za.length};t.clear=function(){Ab(this.za)};function Ac(){yc.call(this)}y(Ac,yc);Ac.prototype.Hd=function(a,b){zc(this,a,b)};function Bc(a,b,c){D.call(this);this.ph=b;this.Wd=c;this.Md=new Ac;this.ac=p;this.Tc=n;this.df=new oc}y(Bc,D);Bc.prototype.b=function(){this.ac&&(this.ac=p,u.clearTimeout(this.Tc),this.Tc=n);Bc.d.b.call(this)};Bc.prototype.update=aa();Bc.prototype.me=function(a,b){var c=ga(b)?b:Number.MAX_VALUE;a.state=1;var d=this.Wd,e=new O,f=new Cc(e,Dc,a.x,a.y,a.k);f.yd=a;f.$b=c;d.ja.push(f);d.Zb||Ec(d);d.Qf=l;P(e,aa(),function(){this.Md.Hd(c,a);this.ac||(this.ac=l,this.Tc=u.setTimeout(w(this.Wh,this),5))},this)};
Bc.prototype.Wh=function(){for(var a=N();this.Md.ya();){var b=this.Md.remove(),c=new ic(this.ph.Ch.bi);this.df.da();this.ph.mh(c,b.x,b.y,b.k,this.df);b.fill(this.df.end());if(16<N()-a)break}this.Md.ya()?(this.ac=l,this.Tc=u.setTimeout(w(this.Wh,this),5)):(this.ac=p,this.Tc=n)};function Fc(){D.call(this)}y(Fc,D);Fc.prototype.update=aa();/*
 Portions of this code are from MochiKit, received by
 The Closure Authors under the MIT license. All other code is Copyright
 2005-2009 The Closure Authors. All Rights Reserved.
*/
function O(a,b){this.pe=[];this.Mh=a;this.Zg=b||n}t=O.prototype;t.tb=p;t.Ec=p;t.Ze=p;t.Ii=p;t.og=p;t.$e=0;t.cancel=function(a){if(this.tb)this.Xc instanceof O&&this.Xc.cancel();else{if(this.K){var b=this.K;delete this.K;a?b.cancel(a):(b.$e--,0>=b.$e&&b.cancel())}this.Mh?this.Mh.call(this.Zg,this):this.og=l;this.tb||this.a(new Gc(this))}};t.Ug=function(a,b){this.Ze=p;Hc(this,a,b)};function Hc(a,b,c){a.tb=l;a.Xc=c;a.Ec=!b;Ic(a)}function Jc(a){a.tb&&(a.og||g(new Kc(a)),a.og=p)}
t.e=function(a){Jc(this);Hc(this,l,a)};t.a=function(a){Jc(this);Hc(this,p,a)};function P(a,b,c,d){a.pe.push([b,c,d]);a.tb&&Ic(a);return a}function Lc(a){return zb(a.pe,function(a){return na(a[1])})}
function Ic(a){a.wg&&(a.tb&&Lc(a))&&(u.clearTimeout(a.wg),delete a.wg);a.K&&(a.K.$e--,delete a.K);for(var b=a.Xc,c=p,d=p;a.pe.length&&!a.Ze;){var e=a.pe.shift(),f=e[0],h=e[1],e=e[2];if(f=a.Ec?h:f)try{var k=f.call(e||a.Zg,b);ga(k)&&(a.Ec=a.Ec&&(k==b||k instanceof Error),a.Xc=b=k);b instanceof O&&(d=l,a.Ze=l)}catch(j){b=j,a.Ec=l,Lc(a)||(c=l)}}a.Xc=b;d&&(P(b,w(a.Ug,a,l),w(a.Ug,a,p)),b.Ii=l);c&&(a.wg=u.setTimeout(function(){g(b)},0))}function Mc(a){var b=new O;b.e(a);return b}
function Nc(a){var b=new O;b.a(a);return b}function Kc(a){ib.call(this);this.ea=a}y(Kc,ib);Kc.prototype.message="Deferred has already fired";Kc.prototype.name="AlreadyCalledError";function Gc(a){ib.call(this);this.ea=a}y(Gc,ib);Gc.prototype.message="Deferred was cancelled";Gc.prototype.name="CancelledError";function Oc(a,b,c,d,e,f){O.call(this,e,f);this.p=a;this.mf=[];this.nh=!!b;this.$i=!!c;this.Ti=!!d;for(b=0;b<a.length;b++)P(a[b],w(this.sh,this,b,l),w(this.sh,this,b,p));0==a.length&&!this.nh&&this.e(this.mf)}y(Oc,O);Oc.prototype.Lh=0;Oc.prototype.sh=function(a,b,c){this.Lh++;this.mf[a]=[b,c];this.tb||(this.nh&&b?this.e([a,c]):this.$i&&!b?this.a(c):this.Lh==this.p.length&&this.e(this.mf));this.Ti&&!b&&(c=n);return c};Oc.prototype.a=function(a){Oc.d.a.call(this,a);wb(this.p,function(a){a.cancel()})};function Pc(a,b){gc.call(this);var c=new nc(a,this.N);this.Ch=a;this.Wd=b;J(this,this.Wd);this.Fb=new Fc;J(this,this.Fb);this.ff=new Bc(0,c,b);J(this,this.ff);this.Gd=[]}y(Pc,gc);Pc.prototype.update=function(a){Pc.d.update.call(this,a);this.Fb.update(a);this.ff.update(a);this.flush()};Pc.prototype.Qe=function(a){this.Gd.push(a);a.Ba||a.map.Yd(a);a.Ba++};
Pc.prototype.flush=function(){for(var a=[],b=0;b<this.Gd.length;b++){var c=this.Gd[b];a.push(Qc(this.Wd,c));c.Pb=p;c.Ba--;c.Ba||c.map.Xd(c)}this.Gd.length=0;return new Oc(a)};Pc.prototype.me=function(a){for(var b=Number.MAX_VALUE,c=0;c<this.Sa.length;c++){var d=this.Sa[c],e=a.x-d.va[0],d=a.k-d.va[2],e=e*e+d*d;e<b&&(b=e)}b==Number.MAX_VALUE&&(b=i);this.ff.me(a,b)};function Rc(a){this.factory=a;this.oa=this.ze=0}Rc.prototype.getTime=s("ze");Rc.prototype.read=function(a){var b=this.factory.t;b&2&&(this.ze=a.Oa()/1E3);b&4||(this.oa=a.Oa())};Rc.prototype.write=function(a){var b=this.factory.t;b&2&&a.v(1E3*this.ze|0);b&4||a.v(this.oa)};Rc.prototype.ge=function(){this.factory.ge(this)};function Sc(a){Rc.call(this,a);this.sg=0;this.Ff=p}y(Sc,Rc);Sc.prototype.read=function(a){Sc.d.read.call(this,a);this.sg=a.Oa()/1E3;this.Ff=p};
Sc.prototype.write=function(a){Sc.d.write.call(this,a);a.v(1E3*this.sg|0)};function Tc(a){Rc.call(this,a);this.Vf=0}y(Tc,Rc);Tc.prototype.read=function(a){Tc.d.read.call(this,a);this.Vf=a.Oa()};Tc.prototype.write=function(a){Tc.d.write.call(this,a);a.v(this.Vf)};function Q(a,b,c,d){D.call(this);this.S=a;this.factory=b;this.ba=n;this.C=c;this.Qb=d;this.K=n;this.O=[];this.fa=0;b.we.length?(a=b.we.pop(),a.reset(this)):a=new b.Gk(this);this.h=a;this.ti=[]}y(Q,D);t=Q.prototype;t.b=function(){var a=this.getParent();a&&(Bb(a.O,this),a.Lb(this));this.factory.we.push(this.h);for(a=0;a<this.ti.length;a++)this.factory.we.push(this.ti[a]);Q.d.b.call(this)};
function Uc(a,b){for(var c="",d=0;d<b;d++)c+="..";M(c+"Entity "+a.C+" / type "+a.factory.Ra+(a.ba?" / owner "+a.ba.c:""));if(a.O.length)for(d=0;d<a.O.length;d++)Uc(a.O[d],b+1)}t.$=s("S");t.getParent=s("K");function Vc(a,b){if(a.K!=b){var c=a.K;a.K=b;if(!(a.Qb&Wc)){var d=a.lf(0);d.Vf=b?b.C:0;Xc(a.S,d)}a.Tf(c,b);c&&(Bb(c.O,a),c.Lb(a));b&&b.Pe(a)}}t.Pe=function(a){this.O.push(a);this.xd(a)};t.Tf=v;t.xd=v;t.Lb=v;t.Bf=ca(n);t.read=function(a){this.h.read(a)};t.write=function(a){this.h.write(a)};t.Eg=function(a){this.h.Eg(a)};
t.lf=function(a){a=Yc(this.S.ob[a]||n);a.oa=this.C;return a};t.ga=aa();function Zc(a,b,c){$c(a.S.Fb,b,c===i?0:c,a.update,a)}t.nk=v;t.gg=function(){this.fa=0;this.h.gg()};var Wc=1;function ad(){this.hd=[];this.f=0}ad.prototype.compact=aa();ad.prototype.ya=s("f");ad.prototype.nc=function(a){this.hd[this.f++]=a};function bd(a){for(var b=0;b<a.f;b++){var c=a.hd[b];c.factory.ge(c)}a.f=0};function cd(){this.buffer=new Uint8Array(512);this.offset=0;this.Q=new Float32Array(16);this.Z=new Uint8Array(this.Q.buffer);this.cj=(this.zc=u.Float64Array?new Float64Array(1):n)?new Uint8Array(this.zc.buffer):n}t=cd.prototype;t.ab=function(){this.offset=0};t.finish=function(){for(var a=new Uint8Array(this.offset),b=0;b<this.offset;b++)a[b]=this.buffer[b];this.offset=0;return a.buffer};
function dd(a,b){if(a.offset+b>a.buffer.length){var c=a.offset+b,d=a.buffer.length;do d+=1024;while(d<c);c=new Uint8Array(d);for(d=0;d<a.offset;d++)c[d]=a.buffer[d];a.buffer=c}}function ed(a,b){dd(a,2);a.buffer[a.offset++]=b>>8;a.buffer[a.offset++]=b}function fd(a,b){dd(a,4);a.buffer[a.offset++]=b>>24;a.buffer[a.offset++]=b>>16;a.buffer[a.offset++]=b>>8;a.buffer[a.offset++]=b}function R(a,b){dd(a,1);a.buffer[a.offset++]=b}function gd(a,b){dd(a,2);a.buffer[a.offset++]=b>>8;a.buffer[a.offset++]=b}
t.H=function(a){dd(this,4);this.buffer[this.offset++]=a>>24;this.buffer[this.offset++]=a>>16;this.buffer[this.offset++]=a>>8;this.buffer[this.offset++]=a};t.v=function(a){dd(this,5);for(a&=4294967295;a&4294967168;)this.buffer[this.offset++]=a&127|128,a>>>=7;this.buffer[this.offset++]=a&127};t.Me=function(a){this.v(a<<1^a>>31)};
t.Bi=function(a){dd(this,4);this.Q[0]=a;this.buffer[this.offset++]=this.Z[0];this.buffer[this.offset++]=this.Z[1];this.buffer[this.offset++]=this.Z[2];this.buffer[this.offset++]=this.Z[3]};t.Xk=function(a){dd(this,12);this.Q[0]=a[0];this.Q[1]=a[1];this.Q[2]=a[2];for(a=0;12>a;a++)this.buffer[this.offset++]=this.Z[a]};t.Yk=function(a){dd(this,16);this.Q[0]=a[0];this.Q[1]=a[1];this.Q[2]=a[2];this.Q[3]=a[3];for(a=0;16>a;a++)this.buffer[this.offset++]=this.Z[a]};
t.n=function(a){65535<=a.length&&(a=a.substr(0,65535));dd(this,4+3*a.length);gd(this,a.length);var b=this.offset;this.offset+=2;for(var c=0,d=0;d<a.length;d++){var e=a.charCodeAt(d);128>e?(this.buffer[this.offset++]=e,c++):2048>e?(this.buffer[this.offset++]=e>>6|192,this.buffer[this.offset++]=e&63|128,c+=2):(this.buffer[this.offset++]=e>>12|224,this.buffer[this.offset++]=e>>6&63|128,this.buffer[this.offset++]=e&63|128,c+=3)}a=this.offset;this.offset=b;gd(this,c);this.offset=a};var hd=n;
function S(){hd||(hd=new cd);return hd};function id(){this.Og=this.rd=this.Ll=this.ml=this.Eh=this.Fh=this.md=0}id.prototype.s=function(){return new id};id.prototype.toString=ca("[stats]");var jd,kd,ld,md,nd;function od(){return u.navigator?u.navigator.userAgent:n}md=ld=kd=jd=p;var pd;if(pd=od()){var qd=u.navigator;jd=0==pd.indexOf("Opera");kd=!jd&&-1!=pd.indexOf("MSIE");ld=!jd&&-1!=pd.indexOf("WebKit");md=!jd&&!ld&&"Gecko"==qd.product}var rd=jd,sd=kd,td=md,wd=ld,xd,yd=u.navigator;xd=yd&&yd.platform||"";nd=-1!=xd.indexOf("Mac");var zd=-1!=xd.indexOf("Win");function Ad(){var a=u.document;return a?a.documentMode:i}var Bd;
a:{var Cd="",Dd;if(rd&&u.opera)var Ed=u.opera.version,Cd="function"==typeof Ed?Ed():Ed;else if(td?Dd=/rv\:([^\);]+)(\)|;)/:sd?Dd=/MSIE\s+([^\);]+)(\)|;)/:wd&&(Dd=/WebKit\/(\S+)/),Dd)var Fd=Dd.exec(od()),Cd=Fd?Fd[1]:"";if(sd){var Gd=Ad();if(Gd>parseFloat(Cd)){Bd=String(Gd);break a}}Bd=Cd}var Hd={};
function Id(a){var b;if(!(b=Hd[a])){b=0;for(var c=kb(String(Bd)).split("."),d=kb(String(a)).split("."),e=Math.max(c.length,d.length),f=0;0==b&&f<e;f++){var h=c[f]||"",k=d[f]||"",j=RegExp("(\\d*)(\\D*)","g"),m=RegExp("(\\d*)(\\D*)","g");do{var q=j.exec(h)||["","",""],r=m.exec(k)||["","",""];if(0==q[0].length&&0==r[0].length)break;b=((0==q[1].length?0:parseInt(q[1],10))<(0==r[1].length?0:parseInt(r[1],10))?-1:(0==q[1].length?0:parseInt(q[1],10))>(0==r[1].length?0:parseInt(r[1],10))?1:0)||((0==q[2].length)<
(0==r[2].length)?-1:(0==q[2].length)>(0==r[2].length)?1:0)||(q[2]<r[2]?-1:q[2]>r[2]?1:0)}while(0==b)}b=Hd[a]=0<=b}return b}var Jd=u.document,Kd=!Jd||!sd?i:Ad()||("CSS1Compat"==Jd.compatMode?parseInt(Bd,10):5);(function(){var a;return zd?(a=/Windows NT ([0-9.]+)/,(a=a.exec(od()))?a[1]:"0"):nd?(a=/10[_.][0-9_.]+/,(a=a.exec(od()))?a[0].replace(/_/g,"."):"10"):""})();function Ld(){this.yi="";this.type=Md;this.platform=Nd;this.Rc="";this.wc=Od}Ld.prototype.s=function(){var a=new Ld;a.yi=this.yi;a.type=this.type;a.platform=this.platform;a.Rc=this.Rc;a.wc=this.wc;return a};Ld.prototype.toString=function(){return[this.type,this.platform+this.Rc,this.wc].join("/")};var Md="unknown",Nd="other",Od="desktop";function Pd(){this.kd="none";this.jd="0";this.qa="User"}Pd.prototype.s=function(){var a=new Pd;a.kd=this.kd;a.jd=this.jd;a.qa=this.qa;return a};Pd.prototype.toString=ca("[user]");function Qd(a,b,c,d,e){this.c=a||"";this.L=b||0;this.t=c||0;this.info=d||new Pd;this.fd=e||new Ld;this.pf=0;this.ma=new id;this.data=this.ca=n}Qd.prototype.toString=function(){return this.info.qa+" ("+this.c+"/"+this.L+")"};function Rd(a){return new Qd(a.c,a.L,a.t,a.info.s(),a.fd.s())};function Sd(a){this.na=a;this.Ya=0;this.zd=[];this.nb=0;this.Cd=[];this.qb=0;this.Be=[];this.Kb=0;this.Ed=[];this.rb=0}Sd.prototype.da=ba("Ya");Sd.prototype.nc=function(a){this.zd[this.nb++]=a};
Sd.prototype.finish=function(a){var b=S();R(b,30);var c=0;b.v(1E3*a|0);b.v(this.Ya);b.v(this.qb);b.v(this.Kb);b.v(this.rb);b.v(this.nb);for(a=0;a<this.qb;a++){var d=this.Cd[a];this.Cd[a]=n;c=b.offset;b.v(d.C>>1);b.v(d.factory.Ra);b.v(d.Qb);var e=d.ba;b.v(e?e.L:0);e=d.getParent();b.v(e?e.C:0);d.write(b);this.na.dh++;this.na.Id+=b.offset-c}for(a=this.qb=0;a<this.Kb;a++)d=this.Be[a],this.Be[a]=n,c=b.offset,b.v(d.C>>1),d.Eg(b),this.na.gh++,this.na.Kd+=b.offset-c;for(a=this.Kb=0;a<this.rb;a++)d=this.Ed[a],
this.Ed[a]=n,c=b.offset,b.v(d.C>>1),this.na.eh++,this.na.Jd+=b.offset-c;for(a=this.rb=0;a<this.nb;a++)d=this.zd[a],this.zd[a]=n,c=b.offset,b.v(d.factory.Ra),d.write(b),this.na.Qh++,this.na.$d+=b.offset-c;this.nb=0;return b.finish()};Sd.prototype.ab=function(){for(var a=this.Ya=0;a<this.qb;a++)this.Cd[a]=n;for(a=this.qb=0;a<this.Kb;a++)this.Be[a]=n;for(a=this.Kb=0;a<this.rb;a++)this.Ed[a]=n;for(a=this.rb=0;a<this.nb;a++)this.zd[a]=n;this.nb=0};function Td(a,b,c){D.call(this);this.Fa=a;this.Pa=b;this.kc=c;this.Ya=this.Bh=0;this.Hc=new ad;this.Qc=new ad;this.ug={};this.De={};this.Ce=[];this.Uj=0;this.M=new Sd(a.ma)}y(Td,D);Td.prototype.yb=s("kc");Td.prototype.compact=function(){this.Hc.compact();this.Qc.compact()};function Ud(a,b){var c=b.Qb;if(!(c&Wc)&&!(c&64&&b.ba!=a.kc)){var c=b.C,d=0;a.ug[c]||(d|=1,a.ug[c]=l);var e=a.De[c]|0,d=e|d|b.fa;e||a.Ce.push(b);e!=d&&(a.De[c]=d)}}
Td.prototype.flush=function(a){this.Uj=a;var b=this.M;b.da(this.Ya);var c=this.Ya!=this.Bh;this.Bh=this.Ya;var d=this.Qc.hd,e=this.Qc.ya();if(e){for(var f=0;f<e;f++){var h=d[f];(0==h.oa||this.ug[h.oa])&&b.nc(h)}this.Qc.f=0}for(f=0;f<this.Ce.length;f++)d=this.Ce[f],e=d.C,h=this.De[e],delete this.De[e],h&&5!=(h&5)&&(h&4?b.Ed[b.rb++]=d:h&1?b.Cd[b.qb++]=d:h&2&&(b.Be[b.Kb++]=d));c||0<b.nb+b.qb+b.Kb+b.rb?this.Pa.send(b.finish(a),this.kc):b.ab();this.Ce.length=0};function Vd(a,b,c){Td.call(this,a,b,c)}y(Vd,Td);var Wd=new function(){this.k=this.y=this.x=0};function Xd(){var a=S();R(a,74);return a.finish()};function Yd(a){D.call(this);this.Al=a}y(Yd,D);function Zd(a){D.call(this);this.zk=a;this.hg=[[],[],[],[],[]];this.wi=[]}y(Zd,D);function $c(a,b,c,d,e){var f=a.wi.pop()||new $d;f.$b=b;f.fg=a.zk.F.vb;f.ye=-1==c?0:0==c?f.fg+0.0010:c;f.e=d;f.bf=e||u;a=a.hg[b];b=0;for(c=a.length;b<c;)d=b+c>>1,0<a[d].ye-f.ye?b=d+1:c=d;a.splice(b,0,f)}var ae=Number.MAX_VALUE;
Zd.prototype.update=function(a){a=a.time;for(var b=N(),c=this.hg.length-1;0<=c;c--){for(var d=this.hg[c];d.length;){var e=d[0];if(e.ye>a)break;d.shift();var f=a-e.fg,h=e.e,k=e.bf;e.e=e.bf=n;this.wi.push(e);h.call(k,a,f)}if(N()-b>=ae)break}};function $d(){this.$b=be;this.ye=this.fg=0;this.bf=this.e=n}var be=0;function ce(){this.Mc=this.Aa=this.Rd=this.ik=this.Oj=this.$d=this.Qh=this.Sd=this.Jf=this.Jd=this.eh=this.Kd=this.gh=this.Id=this.dh=0}ce.prototype.update=function(a){this.Aa+=this.Id;this.Aa+=this.Kd;this.Aa+=this.Jd;this.Rd+=this.Sd;this.Aa+=this.$d;1<=a-this.Mc&&(this.Mc=a,this.Oj=this.Rd,this.ik=this.Aa,this.Aa=this.Rd=0);this.Qh=this.$d=this.Jf=this.Sd=this.eh=this.Jd=this.gh=this.Kd=this.dh=this.Id=0};function de(a,b,c){this.Ra=a;this.Ri=b;this.t=c;this.xg=[]}function Yc(a){return a.xg.length?(a=a.xg.pop(),a.oa=0,a):new a.Ri(a)}de.prototype.ge=function(a){this.xg.push(a)};function ee(a,b){Yd.call(this,a);this.ma=new ce;this.Fb=new Zd(a);J(this,this.Fb);this.Nl=[];this.ob={};this.fh={};this.Sf=b;this.A={};this.ec=n;this.Ob=Array(256);this.Nb=0;var c=new de(0,Tc,0);this.ob[c.Ra]=c}y(ee,Yd);function fe(a,b){a.fh[b.Ra]=b}function ge(a){var b=a.Sf;a.Sf+=2;return b}t=ee.prototype;t.pa=function(a,b){var c=this.fh[a].pa(this,ge(this),b);this.Re(c);return c};t.Re=function(a){this.A[a.C]=a;var b=!!a.fa;a.fa|=1;b||(this.Ob[this.Nb++]=a);a.Qb&128&&(this.ec=a)};
t.Wc=function(a,b){if(!(a.fa&4)){switch(b||he){default:case he:for(var c=a.O.length-1;0<=c;c--){var d=a.O[c];a.Lb(d);a.S.Wc(d)}if(d=a.Bf())for(c=0;c<d.length;c++)a.S.Wc(d[c]);break;case ie:for(c=0;c<a.O.length;c++)Vc(a.O[c],n);if(d=a.Bf())for(c=0;c<d.length;c++)Vc(d[c],n);case je:}delete this.A[a.C];c=!!a.fa;a.fa|=4;c||(this.Ob[this.Nb++]=a);L(a)}};t.lf=function(a){a=Yc(this.ob[a]||n);a.oa=0;return a};t.ga=v;t.Uh=v;
t.ag=function(){for(var a=0;a<this.Nb;a++){var b=this.Ob[a];this.Ob[a]=n;b.gg()}this.Nb=0};var he=0,ie=1,je=2;function ke(a,b,c){ee.call(this,a,2);this.Pa=b;this.Pa.R.push(this);le(this.Pa.Yb,31,this.Gj,this);this.fk=c;this.m=[];this.ad={};this.gf=new ad}y(ke,ee);t=ke.prototype;t.b=function(){hb(this.m);ke.d.b.call(this)};t.yb=function(a){return this.Pa.lc[a]||n};t.Se=function(a){function b(b){Ud(a,b)}this.m.push(a);var c=a.yb();c&&(this.ad[c.c]=a);for(var d in this.A)b.call(this||u,this.A[Number(d)])};t.$h=function(a){var b=a.yb();b&&delete this.ad[b.c];Bb(this.m,a);L(a)};
t.update=function(a){for(var b=0;b<this.m.length;b++){for(var c=this.m[b],d=c.Fa,e=c.Hc.hd,f=c.Hc.ya(),h=0;h<f;h++){var k=e[h],j=k.oa;0==j?d.ga(k):(j=d.A[j]||n)&&j.ga(k);k instanceof Sc&&(k.Ff=l)}bd(c.Hc)}this.Fb.update(a);for(b=0;b<this.Nb;b++)c=this.Ob[b],c.nk(a),this.Uh(a,c);this.ag(a);if(!(15>a.time-this.Tj)){this.Tj=a.time;this.gf.compact();for(a=0;a<this.m.length;a++)this.m[a].compact()}};t.ga=aa();
function Xc(a,b,c){for(var d=0;d<a.m.length;d++){var e=a.m[d];if(!(c&&e.yb()==c))a:{if(0!=b.oa){var f=e.Fa.A[b.oa]||n;if(f.Qb&64&&f.ba!=e.kc)break a}e.Qc.nc(b)}}a.gf.nc(b)}t.Uh=function(a,b){if(!(b.Qb&Wc))for(var c=0;c<this.m.length;c++)Ud(this.m[c],b)};t.ag=function(a){for(var b=0;b<this.m.length;b++)this.m[b].flush(a.time);bd(this.gf);ke.d.ag.call(this,a)};t.Za=v;t.qf=v;t.zg=function(a){var b=this.ad[a.c]||n;b||(b=new this.fk(this,this.Pa,a),this.Se(b))};t.Ag=function(a){(a=this.ad[a.c]||n)&&this.$h(a)};
t.Bg=v;t.Gj=function(a,b,c){if(!a.D)return p;b=this.ad[a.D.c]||n;if(!b)return p;var d=c.Oa(),e=c.Oa();this.ma.Jf+=e;this.ma.Sd+=a.data.length;for(var f=0;f<e;f++){var h=c.Oa(),h=this.ob[h]||n;if(!h)return p;h=Yc(h);h.read(c);var k=0==h.oa;k||(k=this.A[h.oa]||n,k=!k||k.ba!=a.D);if(k)return h.ge(),p;b.Hc.nc(h)}b.Ya=d;return l};function me(a){return ne(a.S.ec.h)};function oe(a,b,c,d){Q.call(this,a,b,c,d);this.oh=n}y(oe,Q);function pe(a){Sc.call(this,a);this.wk=this.Yf=this.Fg=this.jg=this.ig=this.kb=this.vg=0}y(pe,Sc);var qe=360*(1/32767)*Math.PI/180;pe.prototype.read=function(a){pe.d.read.call(this,a);this.vg=re(a);this.kb=re(a);this.kb&1&&(this.ig=se(a),this.jg=se(a));this.Fg=te(a);this.Yf=te(a)};pe.prototype.write=function(a){pe.d.write.call(this,a);R(a,this.vg);R(a,this.kb);this.kb&1&&(gd(a,this.ig),gd(a,this.jg));ed(a,this.Fg);ed(a,this.Yf)};function ue(a){Rc.call(this,a);this.Ve=0}y(ue,Rc);ue.prototype.read=function(a){ue.d.read.call(this,a);this.Ve=a.Zh()};ue.prototype.write=function(a){ue.d.write.call(this,a);a.Bi(this.Ve)};function ve(a){Rc.call(this,a);this.data=this.k=this.y=this.x=0}y(ve,Rc);ve.prototype.read=function(a){ve.d.read.call(this,a);this.x=a.fe();this.y=a.fe();this.k=a.fe();this.data=se(a)};ve.prototype.write=function(a){ve.d.write.call(this,a);a.Me(this.x);a.Me(this.y);a.Me(this.k);gd(a,this.data)};function we(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],h=2*c,k=2*d,j=2*e,m=h*f,q=k*f,f=j*f,h=h*c,r=k*c,c=j*c,k=k*d,d=j*d,e=j*e;b[0]=1-(k+e);b[1]=r+f;b[2]=c-q;b[3]=0;b[4]=r-f;b[5]=1-(h+e);b[6]=d+m;b[7]=0;b[8]=c+q;b[9]=d-m;b[10]=1-(h+k);b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1}
function xe(a,b,c,d){var e=a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3];if(1<e||-1>e)return Xa(d,b),d;var f=1;0>e&&(f=-1,e=-e);var h=Math.acos(e);if(1E-6>=h)return Xa(d,b),d;var k=1/Math.sin(h),e=Math.sin((1-c)*h)*k;c=f*Math.sin(c*h)*k;d[0]=a[0]*e+b[0]*c;d[1]=a[1]*e+b[1]*c;d[2]=a[2]*e+b[2]*c;d[3]=a[3]*e+b[3]*c;return d};function ye(a,b,c,d){Q.call(this,a,b,c,d);this.Ib=l;this.pc=C();this.Lk=new Float32Array(16);this.h.ni(Ja(1,1,1))}y(ye,Q);
function ze(a,b){if(a.Ib&&a.Ib){a.Ib=p;var c=a.h,d=c.Dc(),e=c.Ca,f=c.oe;a.pc[0]=d[0];a.pc[1]=d[1];a.pc[2]=d[2];a.pc[3]=c.od*Math.max(f[0],Math.max(f[1],f[2]));c=a.Lk;we(e,c);var e=f[0],h=f[1],f=f[2],k=c[1],j=c[2],m=c[3],q=c[4],r=c[5],z=c[6],x=c[7],G=c[8],I=c[9],E=c[10],F=c[11],K=c[12],da=c[13],X=c[14],ja=c[15];c[0]*=e;c[1]=k*e;c[2]=j*e;c[3]=m*e;c[4]=q*h;c[5]=r*h;c[6]=z*h;c[7]=x*h;c[8]=G*f;c[9]=I*f;c[10]=E*f;c[11]=F*f;c[12]=K;c[13]=da;c[14]=X;c[15]=ja;e=d[0];h=d[1];d=d[2];f=c[1];k=c[2];j=c[3];m=c[4];
q=c[5];r=c[6];z=c[7];x=c[8];G=c[9];I=c[10];E=c[11];F=c[12];K=c[13];da=c[14];X=c[15];c[0]+=e*j;c[1]=f+h*j;c[2]=k+d*j;c[3]=j;c[4]=m+e*z;c[5]=q+h*z;c[6]=r+d*z;c[7]=z;c[8]=x+e*E;c[9]=G+h*E;c[10]=I+d*E;c[11]=E;c[12]=F+e*X;c[13]=K+h*X;c[14]=da+d*X;c[15]=X;a.getParent()}Xa(b,a.pc)}
ye.prototype.td=function(a){var b=this.h,c=a.Ie,d=b.Dc();we(b.Ca,c);if(c==c){var b=c[1],e=c[2],f=c[3],h=c[6],k=c[7],j=c[11];c[1]=c[4];c[2]=c[8];c[3]=c[12];c[4]=b;c[6]=c[9];c[7]=c[13];c[8]=e;c[9]=h;c[11]=c[14];c[12]=f;c[13]=k;c[14]=j}else c[0]=c[0],c[1]=c[4],c[2]=c[8],c[3]=c[12],c[4]=c[1],c[5]=c[5],c[6]=c[9],c[7]=c[13],c[8]=c[2],c[9]=c[6],c[10]=c[10],c[11]=c[14],c[12]=c[3],c[13]=c[7],c[14]=c[11],c[15]=c[15];b=-d[0];e=-d[1];d=-d[2];f=c[1]*b+c[5]*e+c[9]*d+c[13];h=c[2]*b+c[6]*e+c[10]*d+c[14];k=c[3]*b+
c[7]*e+c[11]*d+c[15];c[12]=c[0]*b+c[4]*e+c[8]*d+c[12];c[13]=f;c[14]=h;c[15]=k;a.ae&&(a.ae=p,c=2/a.width,d=2/-a.height,$a(a.hk,c,d,1,0,-1,1,0,1),c=a.Ua===i?a.width/a.height:a.Ua,d=a.ck,b=a.wf,f=Math.PI/4/2,e=b-d,h=Math.sin(f),0==e||(0==h||0==c)||(f=Math.cos(f)/h,$a(a.cg,f/c,f,-(b+d)/e,-1,0,0,-(2*d*b)/e,0)),ab(a.cg,a.Ie,a.bd),bb(a.bd,a.Vb));ab(a.cg,a.Ie,a.bd);bb(a.Ie,a.wh);bb(a.bd,a.Vb);d=a.bd;c=a.fj;Wa(c[0],d[3]+d[0],d[7]+d[4],d[11]+d[8],d[15]+d[12]);Wa(c[1],d[3]-d[0],d[7]-d[4],d[11]-d[8],d[15]-d[12]);
Wa(c[2],d[3]-d[1],d[7]-d[5],d[11]-d[9],d[15]-d[13]);Wa(c[3],d[3]+d[1],d[7]+d[5],d[11]+d[9],d[15]+d[13]);Wa(c[4],d[3]+d[2],d[7]+d[6],d[11]+d[10],d[15]+d[14]);Wa(c[5],d[3]-d[2],d[7]-d[6],d[11]-d[10],d[15]-d[14]);for(d=0;d<c.length;d++)b=c[d],e=1/Math.sqrt(b[0]*b[0]+b[1]*b[1]+b[2]*b[2]),b[0]*=e,b[1]*=e,b[2]*=e,b[3]*=e;B(a.position,0,0,0);c=a.wh;d=f=a.position;b=f[0];e=f[1];f=f[2];d[0]=b*c[0]+e*c[4]+f*c[8]+c[12];d[1]=b*c[1]+e*c[5]+f*c[9]+c[13];d[2]=b*c[2]+e*c[6]+f*c[10]+c[14];c=2*(0.5/a.width)-1;d=1-
2*(0.5/a.height);b=Ae[0];e=Ae[1];B(b,c,d,-1);B(e,c,d,1);cb(a.Vb,b,b);cb(a.Vb,e,e);Pa(b,e,a.direction);a=c=a.direction;a[0]=-c[0];a[1]=-c[1];a[2]=-c[2]};function Be(a,b,c,d){ye.call(this,a,b,c,d);this.gb=n;this.he=p}y(Be,ye);Be.prototype.b=function(){L(this.gb);this.gb=n;Be.d.b.call(this)};Be.prototype.tk=function(){var a=this.h.Cc();if(this.he){this.gb&&(L(this.gb),this.gb=n);if(a){a:{var b=this.S.ec.oh.Hh,c=b.Oc[a];if(!c){c=b.Ih[a];c=!c?n:c.Vi(b.oc);if(!c){a=n;break a}b.Oc[a]=c}a=c.Dd()}this.gb=a}this.he=p}};Be.prototype.Cc=function(){return this.h.Cc()};
Be.prototype.ue=function(a){this.h.ue(a);a=this.h.Cc();a=a.length?a:n;if(a!=(this.gb?this.gb.Gh.id:n)&&!this.he)this.he=l,$c(this.S.Fb,be,0,this.tk,this)};function Ce(a,b,c,d){Be.call(this,a,b,c,d)}y(Ce,Be);function De(){this.buffer=new Uint8Array(0);this.offset=0;this.Q=new Float32Array(16);this.Z=new Uint8Array(this.Q.buffer);this.cj=(this.zc=u.Float64Array?new Float64Array(1):n)?new Uint8Array(this.zc.buffer):n}t=De.prototype;t.da=function(a,b){this.buffer=a instanceof Uint8Array?a:new Uint8Array(a);this.offset=b};function te(a){var b=a.buffer[a.offset++];a=a.buffer[a.offset++];b=b<<8|a;return 32767<b?b-65536:b}
function Ee(a){var b=a.buffer[a.offset++],c=a.buffer[a.offset++],d=a.buffer[a.offset++];a=a.buffer[a.offset++];b=b<<24|c<<16|d<<8|a;return 2147483647<b?b-4294967296:b}function re(a){return a.buffer[a.offset++]}function se(a){var b=a.buffer[a.offset++];a=a.buffer[a.offset++];return b<<8|a}t.ka=function(){var a=this.buffer[this.offset++],b=this.buffer[this.offset++],c=this.buffer[this.offset++],d=this.buffer[this.offset++];return a<<24|b<<16|c<<8|d};
t.Oa=function(){for(var a=0,b=0,c;(c=this.buffer[this.offset++]&255)&128;)a|=(c&127)<<b,b+=7;return a|c<<b};t.fe=function(){var a=this.Oa();return(a<<31>>31^a)>>1^a&-2147483648};t.Zh=function(){this.Z[0]=this.buffer[this.offset++];this.Z[1]=this.buffer[this.offset++];this.Z[2]=this.buffer[this.offset++];this.Z[3]=this.buffer[this.offset++];return this.Q[0]};t.rk=function(){for(var a=0;12>a;a++)this.Z[a]=this.buffer[this.offset++];return this.Q};
t.sk=function(){for(var a=0;16>a;a++)this.Z[a]=this.buffer[this.offset++];return this.Q};t.B=function(){var a=se(this);se(this);for(var b=Array(a),c=0;c<a;){var d=this.buffer[this.offset++];if(128>d)b[c++]=String.fromCharCode(d);else if(191<d&&224>d){var e=this.buffer[this.offset++];b[c++]=String.fromCharCode((d&31)<<6|e&63)}else{var e=this.buffer[this.offset++],f=this.buffer[this.offset++];b[c++]=String.fromCharCode((d&15)<<12|(e&63)<<6|f&63)}}return b.join("")};var Fe=n;
function Ge(){Fe||(Fe=new De);return Fe};function He(a,b,c){var d=a>>24&255,e=a>>16&255,f=a>>8&255;a&=255;return(d+c*((b>>24&255)-d)&255)<<24|(e+c*((b>>16&255)-e)&255)<<16|(f+c*((b>>8&255)-f)&255)<<8|a+c*((b&255)-a)&255};function T(a,b){this.Qa=a;this.Pc=0;this.t=b}T.prototype.qh=function(a){var b=U(a,this.i);return"target."+U(a,this.j)+"(source."+b+"());"};T.prototype.Sb=function(a){var b=U(a,this.i);return"result."+U(a,this.j)+"(target."+b+"());"};var V=0;function Ie(a,b){return(b.t&Je)-(a.t&Je)||a.Pc-b.Pc}function U(a,b){for(var c in a)if(a[c]===b)return c;return n}var Je=1;function Ke(a,b,c,d){T.call(this,a,b);this.i=c;this.j=d}y(Ke,T);t=Ke.prototype;t.s=function(){return new Ke(this.Qa,this.t,this.i,this.j)};
t.La=function(a){a=U(a,this.j);var b=Ge(),b=U(b,b.fe);return"target."+a+"(reader."+b+"());"};t.Ma=function(a){a=U(a,this.i);var b=S();return"writer."+U(b,b.Me)+"(target."+a+"() | 0);"};t.qh=function(a){var b=U(a,this.i);return"target."+U(a,this.j)+"(source."+b+"() | 0);"};t.Sb=function(a){var b=U(a,this.i);a=U(a,this.j);return"var _s = source."+b+"();var _t = target."+b+"();target."+a+"((_s + t * (_t - _s)) | 0);"};function Le(a,b,c,d){T.call(this,a,b);this.i=c;this.j=d}y(Le,T);
Le.prototype.s=function(){return new Le(this.Qa,this.t,this.i,this.j)};Le.prototype.La=function(a){a=U(a,this.j);var b=Ge(),b=U(b,b.Zh);return"target."+a+"(reader."+b+"());"};Le.prototype.Ma=function(a){a=U(a,this.i);var b=S();return"writer."+U(b,b.Bi)+"(target."+a+"());"};Le.prototype.Sb=function(a){var b=U(a,this.i);a=U(a,this.j);return"var _s = source."+b+"();var _t = target."+b+"();result."+a+"((_s + t * (_t - _s)));"};function Me(a,b,c,d){T.call(this,a,b);this.i=c;this.j=d}y(Me,T);
Me.prototype.s=function(){return new Me(this.Qa,this.t,this.i,this.j)};Me.prototype.La=function(a){a=U(a,this.j);var b=Ge(),b=U(b,b.rk);return"target."+a+"(reader."+b+"());"};Me.prototype.Ma=function(a){a=U(a,this.i);var b=S();return"writer."+U(b,b.Xk)+"(target."+a+"());"};
Me.prototype.Sb=function(a){var b=U(a,this.i),c=U(a,this.j);a=U(a,Ne);return"var _sv3 = source."+b+"();var _tv3 = target."+b+"();var _rv3 = source."+a+";_rv3[0] = (_tv3[0] - _sv3[0]) * t + _sv3[0];_rv3[1] = (_tv3[1] - _sv3[1]) * t + _sv3[1];_rv3[2] = (_tv3[2] - _sv3[2]) * t + _sv3[2];result."+c+"(_rv3);"};function Oe(a,b,c,d,e){T.call(this,a,b);this.i=c;this.j=d;this.ek=e}y(Oe,T);Oe.prototype.s=function(){return new Oe(this.Qa,this.t,this.i,this.j,this.ek)};
Oe.prototype.La=function(a){a=U(a,this.j);var b=Ge(),b=U(b,b.sk);return"target."+a+"(reader."+b+"());"};Oe.prototype.Ma=function(a){a=U(a,this.i);var b=S();return"writer."+U(b,b.Yk)+"(target."+a+"());"};Oe.prototype.Sb=function(a){var b=U(a,this.i),c=U(a,this.j),d=U(a,Pe);a=U(a,xe);return"var _rq = source."+d+";source."+a+"(source."+b+"(), target."+b+"(), t, _rq);result."+c+"(_rq);"};function Qe(a,b,c,d){T.call(this,a,b);this.i=c;this.j=d}y(Qe,T);
Qe.prototype.s=function(){return new Qe(this.Qa,this.t,this.i,this.j)};Qe.prototype.La=function(a){a=U(a,this.j);var b=Ge(),b=U(b,b.ka);return"target."+a+"(reader."+b+"());"};Qe.prototype.Ma=function(a){a=U(a,this.i);var b=S();return"writer."+U(b,b.H)+"(target."+a+"());"};Qe.prototype.Sb=function(a){var b=U(a,this.i),c=U(a,this.j);a=U(a,He);return"result."+c+"(source."+a+"(source."+b+"(), target."+b+"(), t));"};function Re(a,b,c,d){T.call(this,a,b);this.i=c;this.j=d}y(Re,T);
Re.prototype.s=function(){return new Re(this.Qa,this.t,this.i,this.j)};Re.prototype.La=function(a){a=U(a,this.j);var b=Ge(),b=U(b,b.B);return"target."+a+"(reader."+b+"());"};Re.prototype.Ma=function(a){a=U(a,this.i);var b=S();return"writer."+U(b,b.n)+"(target."+a+"());"};function Se(a,b,c,d){T.call(this,a,b);this.i=c;this.j=d}y(Se,T);Se.prototype.s=function(){return new Se(this.Qa,this.t,this.i,this.j)};
Se.prototype.La=function(a){a=U(a,this.j);var b=Ge(),b=U(b,b.B);return"target."+a+"(reader."+b+"());"};Se.prototype.Ma=function(a){a=U(a,this.i);var b=S();return"writer."+U(b,b.n)+"(target."+a+"());"};function Te(a,b,c,d){T.call(this,a,b);this.i=c;this.j=d}y(Te,T);Te.prototype.s=function(){return new Te(this.Qa,this.t,this.i,this.j)};Te.prototype.La=function(a){a=U(a,this.j);var b=Ge(),b=U(b,b.Oa);return"target."+a+"(reader."+b+"());"};
Te.prototype.Ma=function(a){a=U(a,this.i);var b=S();return"writer."+U(b,b.v)+"(target."+a+"());"};var Ne=A(),Pe=C();function Ue(a,b){for(var c=0;c<a.length;c++)a[c].Pc=c;a.sort(Ie);this.Ph={};this.qk=Array(a.length);this.Di=Array(a.length);var d="",e="",f="",h="",k="",j="",m="",q="";this.Ai=Array(a.length);for(c=0;c<a.length;c++){var r=a[c].s();this.Ai[c]=r;this.Ph[r.Qa]=r;r.Pc=c;this.qk[c]=new Function("target","reader",r.La(b));this.Di[c]=new Function("target","writer",r.Ma(b));var d=d+r.La(b),e=e+r.Ma(b),z=r.qh(b),f=f+z;r.t&6||(h+=z);r.t&2&&(j+=z);if(r.t&4){var x=r.Sb(b),m=m+x,k=k+z;r.t&2||(q+=x)}}this.pk=new Function("target",
"reader",d);this.Vk=new Function("target","writer",e);this.kl=new Function("source","target",f);this.Vg=new Function("source","target",h);this.Wg=new Function("source","target",k);this.Xg=new Function("source","target",j);this.tl=new Function("source","target","t","result",m);this.sl=new Function("source","target","t","result",q)}Ue.prototype.ya=function(){return this.Ai.length};function W(a,b){return a.Ph[b].Pc}function Ve(a,b,c,d,e){for(a=a.Di;c;){if(c&1)a[b](d,e);c>>=1;b++}};function Y(a,b){this.J=a;this.time=0;this.ua=b;this.$a=this.sb=0}t=Y.prototype;t.reset=function(a){this.J=a;this.$a=this.sb=this.time=0};function We(a,b){if(!a.ua){var c=[];a(c);a.ua=new Ue(c,b)}return a.ua}function Z(a,b){var c=a.sb||a.$a;31>=b?a.sb|=1<<b:a.$a|=1<<b-32;if(!c){var c=a.J,d=!!c.fa;c.fa|=2;d||(d=c.S,d.Ob[d.Nb++]=c)}}t.gg=function(){this.sb=this.$a=0};t.read=function(a){this.ua.pk(this,a)};t.write=function(a){this.ua.Vk(this,a)};
t.Eg=function(a){a.v(this.sb);Ve(this.ua,0,this.sb,this,a);this.$a&&31<this.ua.ya()&&(a.v(this.$a),Ve(this.ua,32,this.$a,this,a))};t.Vg=function(a){this.ua.Vg(this,a)};t.Xg=function(a){this.ua.Xg(this,a)};t.Wg=function(a){this.ua.Wg(this,a)};t.ui=Ne;t.tg=Pe;t.ok=xe;t.Qi=He;Y.prototype.ui[0]=Y.prototype.ui[1];Y.prototype.ok(Y.prototype.tg,Y.prototype.tg,0,Y.prototype.tg);Y.prototype.Qi(0,0,0);function $(a,b){var c=b||We(Xe,this);Y.call(this,a,c);this.$f=A();this.mk=W(c,Ye);this.Ca=C();this.yk=W(c,Ze);this.oe=A();this.Ak=W(c,$e);this.od=0;this.Ki=W(c,af);this.He=A();this.Rk=W(c,bf)}y($,Y);var Ye=V++,Ze=V++,$e=V++,af=V++,bf=V++;t=$.prototype;t.Dc=s("$f");t.setPosition=function(a){Qa(this.$f,a)||(Ka(this.$f,a),Z(this,this.mk),this.J.Ib=l)};t.sj=s("Ca");
t.mi=function(a){this.Ca.length==a.length&&this.Ca[0]==a[0]&&this.Ca[1]==a[1]&&this.Ca[2]==a[2]&&this.Ca[3]==a[3]||(Xa(this.Ca,a),Z(this,this.yk),this.J.Ib=l)};t.tj=s("oe");t.ni=function(a){Qa(this.oe,a)||(Ka(this.oe,a),Z(this,this.Ak),this.J.Ib=l)};t.kj=s("od");t.Dk=function(a){this.od!=a&&(this.od=a,Z(this,this.Ki),this.J.Ib=l)};t.wj=s("He");t.setVelocity=function(a){Qa(this.He,a)||(Ka(this.He,a),Z(this,this.Rk))};
function Xe(a){a.push(new Me(Ye,Je|6,$.prototype.Dc,$.prototype.setPosition));a.push(new Oe(Ze,Je|6,$.prototype.sj,$.prototype.mi,l));a.push(new Me($e,Je|6,$.prototype.tj,$.prototype.ni));a.push(new Le(af,Je|4,$.prototype.kj,$.prototype.Dk));a.push(new Me(bf,Je|2,$.prototype.wj,$.prototype.setVelocity))};function cf(a,b){var c=b||We(df,this);$.call(this,a,c);this.Pf="";this.$j=W(c,ef);this.Of=0;this.Zj=W(c,ff);this.We=0;this.Gi=W(c,gf)}y(cf,$);var ef=V++,ff=V++,gf=V++;t=cf.prototype;t.Cc=s("Pf");t.ue=function(a){this.Pf!=a&&(this.Pf=a,Z(this,this.$j))};t.qj=s("Of");t.Ek=function(a){this.Of!=a&&(this.Of=a,Z(this,this.Zj))};t.jj=s("We");t.Ck=function(a){this.We!=a&&(this.We=a,Z(this,this.Gi))};
function df(a){Xe(a);a.push(new Re(ef,0,cf.prototype.Cc,cf.prototype.ue));a.push(new Qe(ff,Je|4,cf.prototype.qj,cf.prototype.Ek));a.push(new Ke(gf,0,cf.prototype.jj,cf.prototype.Ck))};function hf(a,b){var c=b||We(jf,this);cf.call(this,a,c);this.Gc=0;this.Pd=i;this.Mj=W(c,kf)}y(hf,cf);var kf=V++;hf.prototype.nj=s("Gc");hf.prototype.ii=function(a){this.Gc!=a&&(this.Gc=a,Z(this,this.Mj),this.Pd=i)};function jf(a){df(a);a.push(new Te(kf,0,hf.prototype.nj,hf.prototype.ii))};A();A();function lf(){this.height=this.width=1;this.Ua=i;this.ck=0.1;this.wf=100;this.ae=l;this.hk=Za();this.cg=Za();this.Ie=Za();this.wh=Za();this.bd=Za();this.Vb=Za();this.position=A();this.direction=A();this.fj=[C(),C(),C(),C(),C(),C()]}var Ae=[A(),A(),A(),A(),A(),A(),A(),A()];function mf(a,b){D.call(this);this.map=a;this.P=Math.min(Math.max(Math.floor(b),1),16);this.Ga=2*this.P+1;this.wa=Array(1*this.Ga*this.Ga);this.va=A();this.I=new Int32Array(3);this.Wa=Sa(this.va[0]-16*this.P,0,this.va[2]-16*this.P,this.va[0]+16*this.P,128,this.va[2]+16*this.P);this.m=[];this.Lj=p}y(mf,D);t=mf.prototype;t.b=function(){hb(this.m);mf.d.b.call(this)};t.Se=function(a){this.m.push(a)};t.$h=function(a){Bb(this.m,a)};
t.update=function(a){Ka(this.va,a);var b=a[0]>>4,c=a[2]>>4;a=b-this.I[0];var d=c-this.I[2];if(a||d){var b=b<<4,c=c<<4,e=this.Wa,f=b+16*this.P,h=c+16*this.P;B(e.min,b-16*this.P,0,c-16*this.P);B(e.max,f,0,h);this.Wa.max[0]+=16;this.Wa.max[1]+=128;this.Wa.max[2]+=16;this.I[0]+=a;this.I[1]+=0;this.I[2]+=d;nf(this)}};
function nf(a){a.I[0]=a.va[0]>>4;a.I[1]=0;a.I[2]=a.va[2]>>4;for(var b=a.I[0]-a.P,c=a.I[2]-a.P,d=a.Ga,e=a.Ga,f=b;f<b+d;f++)for(var h=c;h<c+e;h++){var k=a,j=k.Rb(f,0,h);if(!(0>j||j>k.wa.length)){var m=k.map.Od(f<<4,0,h<<4);if(m!=k.wa[j]){var q=k.wa[j];if(q){for(var r=0;r<k.m.length;r++)k.m[r].Oi(q);q.Ba--;q.Ba||q.map.Xd(q)}m.Ba||m.map.Yd(m);m.Ba++;k.wa[j]=m;for(r=0;r<k.m.length;r++)2==m.state&&k.m[r].Hd(m)}}}}
t.Rb=function(a,b,c){a%=this.Ga;c%=this.Ga;0>a&&(a=this.Ga+a);0>c&&(c=this.Ga+c);return a+c*this.Ga};t.Zd=function(a){for(var b=0;b<this.m.length;b++)this.m[b].Hd(a),this.m[b].Pj(a.x,a.y,a.k,a.x+16-1,a.y+128-1,a.k+16-1,3)};t.Od=function(a,b,c){if(0>b||128<=b)return n;a>>=4;b>>=7;c>>=4;var d=Math.abs(c-this.I[2]);if(Math.abs(a-this.I[0])>this.P||0!=b||d>this.P)return n;a=this.Rb(a,b,c);return 0>a||a>this.wa.length?n:this.wa[a]};
t.Kf=function(a,b){var c=n,d=Math.floor(a[0]),e=Math.floor(a[1]),f=Math.floor(a[2]),h=0==a[3]?0:0>a[3]?-1:1,k=0==a[4]?0:0>a[4]?-1:1,j=0==a[5]?0:0>a[5]?-1:1,m=(d+(0<h?1:0)-a[0])/a[3],q=(e+(0<k?1:0)-a[1])/a[4],r=(f+(0<j?1:0)-a[2])/a[5];isNaN(m)&&(m=Number.POSITIVE_INFINITY);isNaN(q)&&(q=Number.POSITIVE_INFINITY);isNaN(r)&&(r=Number.POSITIVE_INFINITY);var z=h/a[3],x=k/a[4],G=j/a[5];isNaN(z)&&(z=Number.POSITIVE_INFINITY);isNaN(x)&&(x=Number.POSITIVE_INFINITY);isNaN(G)&&(G=Number.POSITIVE_INFINITY);for(var I=
Math.min(b,16*this.Ga),E=0;E<I;E++){var F=this.Od(d,e,f);if(F&&(c=F.Kf(a)))break;m<q&&m<r?(m+=z,d+=h):q<r?(q+=x,e+=k):(r+=G,f+=j)}return c&&c.sf>b?n:c};t.Ea=function(a,b,c,d){var e=this.Od(a,b,c);if(!e||!e.Ea(a,b,c,d))return p;for(d=0;d<this.m.length;d++)this.m[d].vh(a,b,c,0);return l};A();A();function of(a){this.Tg=ga(a)?a:1}of.prototype.qe=function(a){var b=S();if(pf(this,a,b))return b.finish();b.ab();return n};
function pf(a,b,c){switch(1){case 1:R(c,1);a:{fd(c,b.x);fd(c,b.y);fd(c,b.k);R(c,a.Tg);switch(a.Tg){default:case 0:b=new Uint8Array(b.U.buffer);dd(c,4+b.length);c.H(b.length);for(a=0;a<b.length;a++)c.buffer[c.offset++]=b[a];break;case 1:dd(c,65668);a=c.offset+4;b=b.U;a=c.buffer.subarray(a,a+65664);for(var d=0,e=0,f=0,h=0;h<b.length;h++){var k=b[h];h&&k==e?f++:(e=k,f=1);if(h>=b.length-2||b[h+1]!=e)1<f||255==e>>8?(a[d++]=255,a[d++]=f>>8,a[d++]=f&255,a[d++]=e>>8,a[d++]=e&255):(a[d++]=k>>8,a[d++]=k&255)}b=
d;if(0>b){c=p;break a}c.H(b);c.offset+=b;break;case 2:c=p;break a}c=l}return c;default:return p}}var qf=n;function rf(a,b){D.call(this);this.Pa=a;this.kc=b;this.Da=[];this.Mf=-3;this.Ah=0}y(rf,D);rf.prototype.Hd=function(a){0<=vb(this.Da,a)||(this.Da.push(a),this.Mf=0)};rf.prototype.Oi=v;rf.prototype.vh=v;rf.prototype.Pj=v;function sf(a,b,c,d){ye.call(this,a,b,c,d);this.Ua=i;this.Da=this.Ha=this.r=n}y(sf,ye);t=sf.prototype;t.b=function(){this.r&&this.Ha&&(Bb(this.r.Sa,this.Ha),L(this.Ha));sf.d.b.call(this)};t.ng=function(a){this.r=a;this.Ha=new mf(a,16);a.Sa.push(this.Ha);Zc(this,1,0)};
t.update=function(a){var b=tf,c=this.getParent();c instanceof ye?ze(c,b):ze(this,b);this.Ha.update(b);var c=this.Da,d=Math.min(1,c.Da.length);if(3<a-c.Mf){c.Mf=a;var e=Qb[0];Eb(c.Da,function(a,c){B(e,a.x+8,b[1],a.k+8);var d=Oa(b,e);B(e,c.x+8,b[1],c.k+8);return d-Oa(b,e)})}0.01<a-c.Ah?c.Ah=a:d=0;if(d){a=S();var f;qf||(qf=new of(0));f=qf;for(var h=0;h<d;h++){var k=c.Da.shift();Wd.x=k.x;Wd.y=k.y;Wd.k=k.k;var j=a;R(j,73);fd(j,Wd.x);fd(j,Wd.y);fd(j,Wd.k);pf(f,k,a)&&c.Pa.send(a.finish(),c.kc);a.ab()}}Zc(this,
1,0)};t.ga=function(a){sf.d.ga.call(this,a);a instanceof ue&&(this.Ua=a.Ve)};t.Gb=function(a){var b=this.$(),c=me(this).r;this.ng(c);this.Da=new rf(b.Pa,a);J(this,this.Da);this.Ha.Se(this.Da);a=Ja(0,80,0);b=this.Ha;Ka(b.va,a);nf(b);b.Lj=l};t.td=function(a){if(this.Ua){var b=this.Ua;a.Ua!==b&&(a.Ua=b,a.ae=l)}b=this.getParent();b instanceof ye?b.td(a):sf.d.td.call(this,a)};var tf=C();function uf(a,b){var c=b||We(vf,this);$.call(this,a,c)}y(uf,$);function vf(a){Xe(a)};function wf(a,b,c,d){Q.call(this,a,b,c,d)}y(wf,Q);wf.prototype.rh=function(){return this.getParent()};wf.prototype.xd=function(a){wf.d.xd.call(this,a)};wf.prototype.Lb=function(a){wf.d.Lb.call(this,a)};wf.prototype.ga=function(a){wf.d.ga.call(this,a)};function xf(a,b){var c=b||We(yf,this);Y.call(this,a,c)}y(xf,Y);function yf(){};function zf(){this.ej=l}
zf.prototype.ga=function(a,b){var c=a.sg,d=a.Fg*qe,e=a.Yf*qe,f=a.wk*qe,h=Af,k=Math.sin(d/2),d=Math.cos(d/2),j=Math.sin(e/2),e=Math.cos(e/2),m=Math.sin(f/2),f=Math.cos(f/2);h[0]=d*j*f+k*e*m;h[1]=k*e*f-d*j*m;h[2]=d*e*m-k*j*f;h[3]=d*e*f+k*j*m;b.mi(Af);if(this.ej){h=b.Dc();k=Bf[4];j=b.Ca;d=b.He;f=Bf[5];e=Na(d);1E-4<e?(m=Math.max(0,e-40*c),Ma(d,m/e,f)):B(f,0,0,0);d=a.vg;e=Bf[0];e[0]=0;e[0]+=18*!!(d&1);e[0]-=18*!!(d&2);e[1]=0;e[1]+=18*!!(d&4);e[1]-=18*!!(d&8);e[2]=0;e[2]+=18*!!(d&16);e[2]-=18*!!(d&32);
var d=Bf[1],m=j[0]*(j[0]+j[0]),q=j[3]*(j[0]+j[0]),r=j[0]*(j[1]+j[1]),z=j[1]*(j[1]+j[1]),x=j[3]*(j[1]+j[1]),G=j[0]*(j[2]+j[2]),I=j[1]*(j[2]+j[2]),E=j[2]*(j[2]+j[2]),j=j[3]*(j[2]+j[2]),F=e[0],K=e[1],e=e[2];d[0]=F*(1-z-E)+K*(r-j)+e*(G+x);d[1]=F*(r+j)+K*(1-m-E)+e*(I-q);d[2]=F*(G-x)+K*(I+q)+e*(1-m-z);j=Bf[2];(e=Na(d))?Ma(d,1/e,j):B(j,0,0,0);e=Na(d);18<e&&(Ma(d,18/e,d),e=18);d=e-(f[0]*j[0]+f[1]*j[1]+f[2]*j[2]);0<d&&(e=20*e*c,e>d&&(e=d),Ma(j,e,j),La(j,f,f));d=Bf[3];Ma(f,c,d);La(h,d,k);b.setPosition(k);b.setVelocity(f)}};
var Bf=[A(),A(),A(),A(),A(),A()];C();C();C();new Float32Array(16);new Float32Array(6);var Af=C();function Cf(a,b,c,d){Q.call(this,a,b,c,d)}y(Cf,Q);Cf.prototype.rh=function(){return this.getParent()};function Df(a,b,c,d){Be.call(this,a,b,c,d)}y(Df,Be);Df.prototype.Tf=function(a,b){Df.d.Tf.call(this,a,b)};Df.prototype.Wf=v;function Ef(a,b,c,d){Q.call(this,a,b,c,d);this.Sk=new lf;this.ak=new zf}y(Ef,Cf);
Ef.prototype.ga=function(a){Ef.d.ga.call(this,a);var b=this.rh();if(b&&a instanceof pe){this.ak.ga(a,b.h);var c,d=this.h;d.ce===i&&(d.ce=d.Sc?d.J.$().A[d.Sc]||n:n);c=d.ce;var d=Ff(c.h),e=d.Ha,f=this.Sk,h=16*d.Ha.P+16;f.wf!=h&&(f.wf=h,f.ae=l);d.td(f);if(a.kb&&(d=b.h,d.Pd===i&&(d.Pd=d.Gc?d.J.$().A[d.Gc]||n:n),d=d.Pd)){h=Gf;h.time=a.getTime();h.viewport=f;h.Sg=e;h.Zf=c;h.Ei=b;h.screenX=0.5;h.screenY=0.5;a.kb&1&&(h.screenX=a.ig/65535,h.screenY=a.jg/65535);var b=h.dg,k=2*(h.screenX/f.width)-1,j=1-2*(h.screenY/
f.height);c=Ae[0];e=Ae[1];B(c,k,j,-1);B(e,k,j,1);cb(f.Vb,c,c);cb(f.Vb,e,e);Pa(c,e,e);var f=c[1],k=c[2],j=e[0],m=e[1],e=e[2];b[0]=c[0];b[1]=f;b[2]=k;b[3]=j;b[4]=m;b[5]=e;a.Ff||(a=a.kb,a&4&&d.Wf(h,0),a&32&&d.Wf(h,1))}}};var Gf=new function(){this.time=0;this.Ei=this.Zf=this.Sg=this.viewport=n;this.screenY=this.screenX=0;this.dg=new Float32Array(6)};function Hf(a,b,c,d){Be.call(this,a,b,c,d)}y(Hf,Df);Hf.prototype.Nd=function(){var a=this.h.Nd();return me(this).r.N.p[a]};Hf.prototype.te=function(a){this.h.te(a.id)};
Hf.prototype.Wf=function(a,b){var c=a.Sg.Kf(a.dg,100);if(c&&100>=c.sf)if(0==b){var d=c.Gg,e=c.Hg,f=c.Ig,h=0,k=0,j=0,c=c.Sh;c[0]==d?h--:c[0]==d+1&&h++;c[1]==e?k--:c[1]==e+1&&k++;c[2]==f?j--:c[2]==f+1&&j++;c=d+h;e+=k;f+=j;k=this.Nd();j=a.Zf;k=k?k.id<<8:0;me(this).Ea(c,e,f,k,j)}else 1==b&&(f=c.Gg,j=c.Hg,c=c.Ig,e=a.Zf,me(this).Ea(f,j,c,0,e))};function If(a,b,c,d){Be.call(this,a,b,c,d)}y(If,Df);function Jf(a,b,c,d){Q.call(this,a,b,c,d)}y(Jf,Q);Jf.prototype.yb=function(){var a=this.h;a.Ee===i&&(a.Ee=a.$c?a.J.$().yb(a.$c):n);return a.Ee};Jf.prototype.Bf=function(){var a=Kf(this.h),b=this.h;b.Bd===i&&(b.Bd=b.tc?b.J.$().A[b.tc]||n:n);var b=b.Bd,c=Ff(this.h),d=this.h;d.Td===i&&(d.Td=d.Ic?d.J.$().A[d.Ic]||n:n);return[a,b,c,d.Td]};
Jf.prototype.Gb=function(a){var b=this.$(),c=this.h;this.ba=a;c.pi(a.c);var d=this.S.ec,e=ne(d.h).r;Vc(this,d);d=b.pa(69,30);d.ba=a;d.ue("pumpkin");c.fi(d.C);var f=b.pa(68,66);f.ba=a;Vc(f,d);f.h.li(this.C);c.hi(f.C);f=b.pa(66,66);f.ba=a;Vc(f,d);f.Gb(a);c.gi(f.C);f=b.pa(70,0);f.ba=a;Vc(f,d);c.ji(f.C);c=b.pa(71,0);c.ba=a;Vc(c,f);e=[e.N.p[1],e.N.p[2],e.N.p[3],e.N.p[4],e.N.p[5]];for(c=0;c<e.length;c++){var h=b.pa(72,0);h.ba=a;Vc(h,f);h.te(e[c]);0==c&&d.h.ii(h?h.C:0)}};function Lf(a,b){var c=b||We(Mf,this);Y.call(this,a,c);this.$c="";this.Ee=i;this.Qk=W(c,Nf);this.mc=0;this.ed=i;this.Fi=W(c,Of);this.tc=0;this.Bd=i;this.Ui=W(c,Pf);this.qc=0;this.vd=i;this.Li=W(c,Qf);this.Ic=0;this.Td=i;this.Qj=W(c,Rf)}y(Lf,Y);var Nf=V++,Of=V++,Pf=V++,Qf=V++,Rf=V++;t=Lf.prototype;t.vj=s("$c");t.pi=function(a){this.$c!=a&&(this.$c=a,Z(this,this.Qk),this.Ee=i)};t.ij=s("mc");function Kf(a){a.ed===i&&(a.ed=a.mc?a.J.$().A[a.mc]||n:n);return a.ed}
t.fi=function(a){this.mc!=a&&(this.mc=a,Z(this,this.Fi),this.ed=i)};t.mj=s("tc");t.hi=function(a){this.tc!=a&&(this.tc=a,Z(this,this.Ui),this.Bd=i)};t.lj=s("qc");function Ff(a){a.vd===i&&(a.vd=a.qc?a.J.$().A[a.qc]||n:n);return a.vd}t.gi=function(a){this.qc!=a&&(this.qc=a,Z(this,this.Li),this.vd=i)};t.oj=s("Ic");t.ji=function(a){this.Ic!=a&&(this.Ic=a,Z(this,this.Qj),this.Td=i)};
function Mf(a){a.push(new Se(Nf,0,Lf.prototype.vj,Lf.prototype.pi));a.push(new Te(Of,0,Lf.prototype.ij,Lf.prototype.fi));a.push(new Te(Pf,0,Lf.prototype.mj,Lf.prototype.hi));a.push(new Te(Qf,0,Lf.prototype.lj,Lf.prototype.gi));a.push(new Te(Rf,0,Lf.prototype.oj,Lf.prototype.ji))};function Sf(a,b){var c=b||We(Tf,this);Y.call(this,a,c);this.cd=0;this.Je=i;this.Uk=W(c,Uf)}y(Sf,Y);var Uf=V++;Sf.prototype.xj=s("cd");function ne(a){a.Je===i&&(a.Je=a.cd?a.J.$().A[a.cd]||n:n);return a.Je}Sf.prototype.qi=function(a){this.cd!=a&&(this.cd=a,Z(this,this.Uk),this.Je=i)};function Tf(a){a.push(new Te(Uf,0,Sf.prototype.xj,Sf.prototype.qi))};function Vf(a,b,c,d,e){Q.call(this,a,b,c,d);this.si=e}y(Vf,Q);Vf.prototype.xd=function(a){a instanceof ye&&this.si.Re(a)};Vf.prototype.Lb=function(a){a instanceof ye&&this.si.Wc(a)};function Wf(a){this.Il=a||Xf;this.Kl=[]}function Xf(){this.dg=new Float32Array(6);this.end=this.start=this.yl=0;this.J=this.Jl=n;this.Sh=A();this.sf=0};function Yf(){Wf.call(this);this.A=[]}y(Yf,Wf);Yf.prototype.Re=function(a){this.A.push(a)};Yf.prototype.Wc=function(a){Bb(this.A,a)};Yf.prototype.forEach=function(a,b){for(var c=0;c<this.A.length&&a.call(b||u,this.A[c])!==p;c++);};C();function Zf(a,b,c,d){Vf.call(this,a,b,c,d,new Yf);this.r=n}y(Zf,Vf);Zf.prototype.ng=ba("r");Zf.prototype.update=function(a){this.h.oi(a|0);Zc(this,2,a+1)};Zf.prototype.Ea=function(a,b,c,d,e){var f=this.r;d&&!f.N.p[d>>8]?M("unknown block type",d):f.Ea(a,b,c,d)!=d&&(f=this.lf(66),f.x=a,f.y=b,f.k=c,f.data=d,a=e?e.yb():n,Xc(this.S,f,a))};A();function $f(a,b){var c=b||We(ag,this);Y.call(this,a,c)}y($f,Y);function ag(){};function bg(a,b){var c=b||We(cg,this);$f.call(this,a,c);this.pg=0;this.Ik=W(c,dg)}y(bg,$f);var dg=V++;bg.prototype.uj=s("pg");bg.prototype.oi=function(a){this.pg!=a&&(this.pg=a,Z(this,this.Ik))};function cg(a){a.push(new Le(dg,0,bg.prototype.uj,bg.prototype.oi))};function eg(a,b){var c=b||We(fg,this);Y.call(this,a,c)}y(eg,Y);function fg(){};function gg(a,b){var c=b||We(hg,this);eg.call(this,a,c);this.Sc=0;this.ce=i;this.lk=W(c,ig)}y(gg,eg);var ig=V++;gg.prototype.rj=s("Sc");gg.prototype.li=function(a){this.Sc!=a&&(this.Sc=a,Z(this,this.lk),this.ce=i)};function hg(a){a.push(new Te(ig,0,gg.prototype.rj,gg.prototype.li))};function jg(a,b){var c=b||We(kg,this);cf.call(this,a,c)}y(jg,cf);function kg(a){df(a)};function lg(a,b){var c=b||We(mg,this);jg.call(this,a,c);this.Ye=0;this.Hi=W(c,ng)}y(lg,jg);var ng=V++;lg.prototype.Nd=s("Ye");lg.prototype.te=function(a){this.Ye!=a&&(this.Ye=a,Z(this,this.Hi))};function mg(a){df(a);a.push(new Ke(ng,0,lg.prototype.Nd,lg.prototype.te))};function og(a,b){var c=b||We(pg,this);jg.call(this,a,c)}y(og,jg);function pg(a){df(a)};function qg(a,b,c){this.Ra=a;this.Zi=b;this.Gk=c;this.we=[]}qg.prototype.pa=function(a,b,c){return new this.Zi(a,this,b,c)};function rg(a,b,c,d,e,f){this.jl=a;this.type=b;this.Ml=c;this.userName=d;this.timestamp=e;this.value=f||n};function sg(a){D.call(this);this.z=a;this.g=[];this.vf=[]}y(sg,D);sg.prototype.Te=function(a){if(0<=vb(this.g,a))return n;this.g.push(a);a=new rg(this,0,a.c,a.info.qa,ua());this.vf.push(a);return a};sg.prototype.ie=function(a){return Bb(this.g,a)?(a=new rg(this,1,a.c,a.info.qa,ua()),this.vf.push(a),a):n};sg.prototype.postMessage=function(a,b){if(!(0<=vb(this.g,a)))return n;var c=new rg(this,2,a.c,a.info.qa,ua(),b);this.vf.push(c);return c};function tg(a){D.call(this);this.ta=a;this.rc={};this.Rf=[];this.ri(a.Yb)}y(tg,D);t=tg.prototype;t.b=function(){pc(this.rc,L);this.rc={};tg.d.b.call(this)};t.ri=v;function ug(a,b,c){var d=a.rc[b];!d&&c&&(d=new sg(b),a.rc[b]=d);return d}t.Th=function(){if(this.Rf.length){var a=this.Rf;this.Rf=[];return a}return n};t.Za=v;t.qf=v;t.zg=v;t.Ag=function(a){pc(this.rc,function(b){b.ie(a)})};t.Bg=v;function vg(){this.Ja="";this.name="Server";this.location="us";this.Ac="unknown";this.Bc="0";this.Xb=32;this.Ab={}}vg.prototype.s=function(){var a=new vg;a.Ja=this.Ja;a.name=this.name;a.location=this.location;a.Ac=this.Ac;a.Bc=this.Bc;a.Xb=this.Xb;a.Ab=sc(this.Ab);return a};vg.prototype.toString=ca("[server]");function wg(){this.Wb=this.L=0}function xg(a,b){var c=b||new Pd;c.kd=a.B();c.jd=a.B();c.qa=a.B();return c}function yg(a,b){a.n(b.kd);a.n(b.jd);a.n(b.qa);return l}function zg(a,b){a.n(b.c);R(a,b.L);a.H(b.t);var c;if(!(c=!yg(a,b.info)))c=b.fd,a.n(c.type),a.n(c.platform),a.n(c.Rc),a.n(c.wc),c=p;return c?p:l}var Ag=new function(){this.Wb=this.sc=this.se=0},Bg=new function(){this.sc=this.se=0;this.Ge=[]};
function Cg(a,b){var c=Ag.sc,d=S();Bg.se=a;Bg.sc=c;Bg.Ge=b;R(d,2);d.H(Bg.se);d.H(Bg.sc);d.H(Bg.Ge.length);for(c=0;c<Bg.Ge.length;c++){var e=d,f=Bg.Ge[c];R(e,f.L);gd(e,f.Wb)}return d.finish()}var Dg=new function(){this.info=new vg;this.g=[]};
function Eg(a,b){var c=S();Dg.info=a;Dg.g=b;var d;a:{R(c,3);d=Dg.info;c.n(d.Ja);c.n(d.name);c.n(d.location);c.n(d.Ac);c.n(d.Bc);c.H(d.Xb);var e=0,f;for(f in d.Ab)e++;c.H(e);for(var h in d.Ab)e=d.Ab[h],c.n(h),c.n(e);c.H(Dg.g.length);for(d=0;d<Dg.g.length;d++)if(!zg(c,Dg.g[d])){d=p;break a}d=l}return!d?(c.ab(),n):c.finish()}function Fg(){this.gd=this.xe=0;this.D=new Qd}var Gg=new Fg,Hg=new Fg;
function Ig(a,b){var c=S();Hg.xe=3;Hg.gd=a;Hg.D=b;R(c,4);gd(c,Hg.xe);gd(c,Hg.gd);return!zg(c,Hg.D)?(c.ab(),n):c.finish()}function Jg(){this.reason=0}var Kg=new Jg,Lg=new Jg,Mg=new function(){this.D=new Qd};function Ng(a){var b=S();Mg.D=a;R(b,6);return!zg(b,Mg.D)?(b.ab(),n):b.finish()}var Og=new function(){this.c="";this.reason=0};function Pg(a,b){var c=S();Og.c=a;Og.reason=b;R(c,7);c.n(Og.c);c.H(Og.reason);return c.finish()}function Qg(){this.c="";this.info=new Pd}var Rg=new Qg,Sg=new Qg;
function Tg(a,b){var c=S();Sg.c=a;Sg.info=b;R(c,8);c.n(Sg.c);return!yg(c,Sg.info)?(c.ab(),n):c.finish()}function Ug(){this.z=this.c="";this.timestamp=0;this.jc=[]}var Vg=new Ug,Wg=new Ug;function Xg(a,b,c,d){var e=S();Wg.c=a;Wg.z=b;Wg.timestamp=c;Wg.jc=d;R(e,20);e.n(Wg.c);e.n(Wg.z);e.H(Wg.timestamp);e.H(Wg.jc.length);for(a=0;a<Wg.jc.length;a++)e.n(Wg.jc[a]);return e.finish()}function Yg(){this.z=this.c="";this.timestamp=0}var Zg=new Yg,$g=new Yg;
function ah(){this.z=this.c="";this.timestamp=0;this.message=""}var bh=new ah,ch=new ah;function dh(a){tg.call(this,a);this.re=a}y(dh,tg);t=dh.prototype;t.join=function(a,b,c){if(b=ug(this,b,l)){var d=ua();ga(c)&&1E3>d-c&&(d=c);b.Te(a);var e=Array(b.g.length);for(c=0;c<b.g.length;c++){var f=b.g[c];e[c]=f.c}this.re.send(Xg(f.c,b.z,d,e),a);d=Xg(a.c,b.z,d,[]);for(c=0;c<b.g.length;c++)f=b.g[c],f!=a&&this.re.send(d,f)}};t.ri=function(a){le(a,20,this.zj,this);le(a,21,this.Aj,this);le(a,22,this.Bj,this)};
t.zj=function(a,b,c){a=a.D;if(!a)return p;Vg.c=c.B();Vg.z=c.B();Vg.timestamp=c.ka();b=c.ka();Vg.jc.length=b;for(var d=0;d<b;d++)Vg.jc[d]=c.B();if(!Vg)return p;if(Vg.c!=a.c)return M("user info mismatch"),p;this.join(a,Vg.z,Vg.timestamp);return l};
t.Aj=function(a,b,c){a=a.D;if(!a)return p;Zg.c=c.B();Zg.z=c.B();Zg.timestamp=c.ka();if(!Zg)return p;if(Zg.c!=a.c)return M("user info mismatch"),p;b=Zg.timestamp;if(c=ug(this,Zg.z,p)){var d=ua();ga(b)&&1E3>d-b&&(d=b);b=a.c;var e=c.z,f=S();$g.c=b;$g.z=e;$g.timestamp=d;R(f,21);f.n($g.c);f.n($g.z);f.H($g.timestamp);b=f.finish();for(e=0;e<c.g.length;e++)this.re.send(b,c.g[e]);c.ie(a)}return l};
t.Bj=function(a,b,c){a=a.D;if(!a)return p;bh.c=c.B();bh.z=c.B();bh.timestamp=c.ka();bh.message=c.B();if(!bh)return p;if(bh.c!=a.c)return M("user info mismatch"),p;c=ug(this,bh.z,p);if(!c)return l;c.postMessage(a,bh.message);a=a.c;b=c.z;var d=ua(),e=bh.message,f=S();ch.c=a;ch.z=b;ch.timestamp=d;ch.message=e;R(f,22);f.n(ch.c);f.n(ch.z);f.H(ch.timestamp);f.n(ch.message);a=f.finish();for(b=0;b<c.g.length;b++)this.re.send(a,c.g[b]);return l};function eh(a,b,c){D.call(this);a.F=b.F;this.gj=a;this.ta=b;this.ta.R.push(this);this.Rg=new dh(b);this.ta.R.push(this.Rg);this.r=new Pc(new Lb,c);J(this,this.r);this.Fa=new ke(a,this.ta,Vd);J(this,this.Fa);a=this.Fa;b=new de(64,ue,0);a.ob[b.Ra]=b;b=new de(65,pe,2);a.ob[b.Ra]=b;b=new de(66,ve,0);a.ob[b.Ra]=b;a=this.Fa;fe(a,new qg(64,oe,Sf));fe(a,new qg(65,Zf,bg));fe(a,new qg(66,sf,uf));fe(a,new qg(67,Jf,Lf));fe(a,new qg(68,Ef,gg));fe(a,new qg(69,Ce,hf));fe(a,new qg(70,wf,xf));fe(a,new qg(71,If,og));
fe(a,new qg(72,Hf,lg));this.ib=n;this.Rh=[];this.Hh=new Kb(this.gj.oc);J(this,this.Hh)}y(eh,D);t=eh.prototype;t.$=s("Fa");t.Tb=s("ib");t.Ij=v;t.load=function(){var a=new O;this.ib=this.Fa.pa(64,128);this.ib.oh=this;var b=this.Tb();this.Ke=this.Fa.pa(65,0);Vc(this.Ke,b);this.Ke.ng(this.r);b.h.qi(this.Ke.C);b=this.ta;b.eg=l;b.state=1;b.ca.da(w(b.Cf,b));for(var c=0;c<b.R.length;c++)b.R[c].Za();M("Server ready, listening on",b.ca.Ja.toString());a.e(n);return a};
t.zg=function(a){M("client connected",a.c,a.info,a.fd);this.Rg.join(a,"main");var b=this.$().pa(67,0);b.Gb(a);var c=Kf(b.h);Vc(c,me(b));var d=Ja(0,80,0);c.h.setPosition(d);Uc(b.S.ec,0);a.data=b;this.Rh.push(b);this.ta.send(Xd(),a);this.Ij()};t.Ag=function(a){M("client disconnected",a.c);if(a=a.data)this.$().Wc(a),Uc(a.S.ec,0),Bb(this.Rh,a),L(a)};t.Bg=v;t.update=function(a){2!=this.ta.state&&(this.ta.Th(5),2==this.ta.state?M("Server disconnected!?"):(this.r.update(a),this.Fa.update(a)))};t.je=aa();
t.Za=v;t.qf=v;function fh(a,b,c){eh.call(this,a,b,c);this.Ke=n}y(fh,eh);function gh(){this.Jk=this.rg=this.time=this.Af=0}gh.prototype.fb=function(a,b,c,d){this.Af=a;this.time=b;this.rg=c;this.Jk=d};function hh(a){this.le=a}hh.prototype.qe=function(a){var b=[];ih(this,a,b);return b.join("")};
function ih(a,b,c){switch(typeof b){case "string":jh(b,c);break;case "number":c.push(isFinite(b)&&!isNaN(b)?b:"null");break;case "boolean":c.push(b);break;case "undefined":c.push("null");break;case "object":if(b==n){c.push("null");break}if(ka(b)){var d=b.length;c.push("[");for(var e="",f=0;f<d;f++)c.push(e),e=b[f],ih(a,a.le?a.le.call(b,String(f),e):e,c),e=",";c.push("]");break}c.push("{");d="";for(f in b)Object.prototype.hasOwnProperty.call(b,f)&&(e=b[f],"function"!=typeof e&&(c.push(d),jh(f,c),c.push(":"),
ih(a,a.le?a.le.call(b,f,e):e,c),d=","));c.push("}");break;case "function":break;default:g(Error("Unknown type: "+typeof b))}}var kh={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\x0B":"\\u000b"},lh=/\uffff/.test("\uffff")?/[\\\"\x00-\x1f\x7f-\uffff]/g:/[\\\"\x00-\x1f\x7f-\xff]/g;
function jh(a,b){b.push('"',a.replace(lh,function(a){if(a in kh)return kh[a];var b=a.charCodeAt(0),e="\\u";16>b?e+="000":256>b?e+="00":4096>b&&(e+="0");return kh[a]=e+b.toString(16)}),'"')};function mh(){this.Yc=N();this.hf=this.Wb=this.vb=0;this.rl=p};function nh(a,b){D.call(this);this.Vj=a;this.F=b||new mh;this.jf=[];this.hl=n}y(nh,D);nh.prototype.b=function(){hb(this.jf);this.jf.length=0;nh.d.b.call(this)};nh.prototype.getTime=function(){return(N()-this.F.Yc)/1E3+this.F.hf};function oh(){this.rg=this.time=this.Af=0;this.hasFocus=p}oh.prototype.fb=function(a,b,c,d){this.Af=a;this.time=b;this.rg=c;this.hasFocus=d};var ph;if(!(ph=!sd))ph=sd&&9<=Kd;var qh=ph,rh=sd&&!Id("9");!wd||Id("528");td&&Id("1.9b")||sd&&Id("8")||rd&&Id("9.5")||wd&&Id("528");td&&!Id("8")||sd&&Id("9");function sh(a,b){this.type=a;this.currentTarget=this.target=b}t=sh.prototype;t.b=aa();t.xc=aa();t.bc=p;t.defaultPrevented=p;t.ne=l;t.preventDefault=function(){this.defaultPrevented=l;this.ne=p};function th(a){th[" "](a);return a}th[" "]=v;function uh(a,b){a&&this.fb(a,b)}y(uh,sh);t=uh.prototype;t.target=n;t.relatedTarget=n;t.offsetX=0;t.offsetY=0;t.clientX=0;t.clientY=0;t.screenX=0;t.screenY=0;t.button=0;t.keyCode=0;t.charCode=0;t.ctrlKey=p;t.altKey=p;t.shiftKey=p;t.metaKey=p;t.kk=p;t.uf=n;
t.fb=function(a,b){var c=this.type=a.type;sh.call(this,c);this.target=a.target||a.srcElement;this.currentTarget=b;var d=a.relatedTarget;if(d){if(td){var e;a:{try{th(d.nodeName);e=l;break a}catch(f){}e=p}e||(d=n)}}else"mouseover"==c?d=a.fromElement:"mouseout"==c&&(d=a.toElement);this.relatedTarget=d;this.offsetX=wd||a.offsetX!==i?a.offsetX:a.layerX;this.offsetY=wd||a.offsetY!==i?a.offsetY:a.layerY;this.clientX=a.clientX!==i?a.clientX:a.pageX;this.clientY=a.clientY!==i?a.clientY:a.pageY;this.screenX=
a.screenX||0;this.screenY=a.screenY||0;this.button=a.button;this.keyCode=a.keyCode||0;this.charCode=a.charCode||("keypress"==c?a.keyCode:0);this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.kk=nd?a.metaKey:a.ctrlKey;this.state=a.state;this.uf=a;a.defaultPrevented&&this.preventDefault();delete this.bc};
t.preventDefault=function(){uh.d.preventDefault.call(this);var a=this.uf;if(a.preventDefault)a.preventDefault();else if(a.returnValue=p,rh)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};t.b=aa();function vh(){}var wh=0;t=vh.prototype;t.key=0;t.cc=p;t.ud=p;t.fb=function(a,b,c,d,e,f){na(a)?this.xh=l:a&&a.handleEvent&&na(a.handleEvent)?this.xh=p:g(Error("Invalid listener argument"));this.listener=a;this.Yh=b;this.src=c;this.type=d;this.capture=!!e;this.Ef=f;this.ud=p;this.key=++wh;this.cc=p};t.handleEvent=function(a){return this.xh?this.listener.call(this.Ef||this.src,a):this.listener.handleEvent.call(this.listener,a)};var xh={},yh={},zh={},Ah={};
function Bh(a,b,c,d,e){if(ka(b)){for(var f=0;f<b.length;f++)Bh(a,b[f],c,d,e);return n}a:{b||g(Error("Invalid event type"));d=!!d;var h=yh;b in h||(h[b]={f:0,la:0});h=h[b];d in h||(h[d]={f:0,la:0},h.f++);var h=h[d],f=pa(a),k;h.la++;if(h[f]){k=h[f];for(var j=0;j<k.length;j++)if(h=k[j],h.listener==c&&h.Ef==e){if(h.cc)break;k[j].ud=p;a=k[j].key;break a}}else k=h[f]=[],h.f++;var m=Ch,q=qh?function(a){return m.call(q.src,q.key,a)}:function(a){a=m.call(q.src,q.key,a);if(!a)return a},j=q;j.src=a;h=new vh;
h.fb(c,j,a,b,d,e);h.ud=p;c=h.key;j.key=c;k.push(h);xh[c]=h;zh[f]||(zh[f]=[]);zh[f].push(h);a.addEventListener?(a==u||!a.Yg)&&a.addEventListener(b,j,d):a.attachEvent(b in Ah?Ah[b]:Ah[b]="on"+b,j);a=c}return a}function Dh(a,b,c,d,e){if(ka(b))for(var f=0;f<b.length;f++)Dh(a,b[f],c,d,e);else{d=!!d;a:{f=yh;if(b in f&&(f=f[b],d in f&&(f=f[d],a=pa(a),f[a]))){a=f[a];break a}a=n}if(a)for(f=0;f<a.length;f++)if(a[f].listener==c&&a[f].capture==d&&a[f].Ef==e){Eh(a[f].key);break}}}
function Eh(a){if(!xh[a])return p;var b=xh[a];if(b.cc)return p;var c=b.src,d=b.type,e=b.Yh,f=b.capture;c.removeEventListener?(c==u||!c.Yg)&&c.removeEventListener(d,e,f):c.detachEvent&&c.detachEvent(d in Ah?Ah[d]:Ah[d]="on"+d,e);c=pa(c);zh[c]&&(e=zh[c],Bb(e,b),0==e.length&&delete zh[c]);b.cc=l;if(b=yh[d][f][c])b.Kh=l,Fh(d,f,c,b);delete xh[a];return l}
function Fh(a,b,c,d){if(!d.Vd&&d.Kh){for(var e=0,f=0;e<d.length;e++)d[e].cc?d[e].Yh.src=n:(e!=f&&(d[f]=d[e]),f++);d.length=f;d.Kh=p;0==f&&(delete yh[a][b][c],yh[a][b].f--,0==yh[a][b].f&&(delete yh[a][b],yh[a].f--),0==yh[a].f&&delete yh[a])}}function Gh(a,b,c,d,e){var f=1;b=pa(b);if(a[b]){a.la--;a=a[b];a.Vd?a.Vd++:a.Vd=1;try{for(var h=a.length,k=0;k<h;k++){var j=a[k];j&&!j.cc&&(f&=Hh(j,e)!==p)}}finally{a.Vd--,Fh(c,d,b,a)}}return Boolean(f)}function Hh(a,b){a.ud&&Eh(a.key);return a.handleEvent(b)}
function Ch(a,b){if(!xh[a])return l;var c=xh[a],d=c.type,e=yh;if(!(d in e))return l;var e=e[d],f,h;if(!qh){f=b||ha("window.event");var k=l in e,j=p in e;if(k){if(0>f.keyCode||f.returnValue!=i)return l;a:{var m=p;if(0==f.keyCode)try{f.keyCode=-1;break a}catch(q){m=l}if(m||f.returnValue==i)f.returnValue=l}}m=new uh;m.fb(f,this);f=l;try{if(k){for(var r=[],z=m.currentTarget;z;z=z.parentNode)r.push(z);h=e[l];h.la=h.f;for(var x=r.length-1;!m.bc&&0<=x&&h.la;x--)m.currentTarget=r[x],f&=Gh(h,r[x],d,l,m);if(j){h=
e[p];h.la=h.f;for(x=0;!m.bc&&x<r.length&&h.la;x++)m.currentTarget=r[x],f&=Gh(h,r[x],d,p,m)}}else f=Hh(c,m)}finally{r&&(r.length=0)}return f}d=new uh(b,this);return f=Hh(c,d)};function Ih(a){D.call(this);this.Kj=a;this.w=[]}y(Ih,D);var Jh=[];Ih.prototype.listen=function(a,b,c,d,e){ka(b)||(Jh[0]=b,b=Jh);for(var f=0;f<b.length;f++){var h=Bh(a,b[f],c||this,d||p,e||this.Kj||this);this.w.push(h)}return this};Ih.prototype.b=function(){Ih.d.b.call(this);wb(this.w,Eh);this.w.length=0};Ih.prototype.handleEvent=function(){g(Error("EventHandler.handleEvent not implemented"))};function Kh(a,b,c,d){D.call(this);this.bb=new Ih(this);J(this,this.bb);this.yg=a;this.cf=this.dc=this.rf=n;if(!b){if(a=u.requestAnimationFrame||u.webkitRequestAnimationFrame||u.mozRequestAnimationFrame||u.oRequestAnimationFrame||u.msRequestAnimationFrame)this.dc=a;if(a=u.cancelAnimationFrame||u.webkitCancelAnimationFrame||u.mozCancelAnimationFrame||u.oCancelAnimationFrame||u.msCancelAnimationFrame)this.cf=a}this.Bb=0;this.Ub=n;this.Nf=0;this.hc=l;this.zf=d||0;this.ve=n;c&&(this.bb.listen(u,"blur",
function(){this.hc=p}),this.bb.listen(u,"focus",function(){this.hc||(this.hc=l,this.Bb&&this.start(l))}))}y(Kh,D);Kh.prototype.b=function(){this.stop(l);this.rf=n;Kh.d.b.call(this)};Kh.prototype.hasFocus=s("hc");
Kh.prototype.start=function(a){if(!a&&(this.Bb++,1<this.Bb))return;if(this.hc){var b=this;this.Ub=this.dc?this.dc.call(u,function(){Lh(b)},this.rf):u.setTimeout(function(){Lh(b)},62.5)}this.yg(N());this.zf&&(b=this,this.ve=u.setInterval(function(){var a=b;if(N()-a.Nf>=a.zf&&a.Bb){var d=N();a.Nf=d;a.yg(d)}},this.zf))};
Kh.prototype.stop=function(a){if(a||this.Bb)a||this.Bb--,this.Bb||(a=this.Ub,this.cf?this.cf.call(u,a):this.dc||u.clearTimeout(a),this.Ub=n,this.ve!==n&&(u.clearInterval(this.ve),this.ve=n))};function Lh(a){if(a.Ub!==n){a.Ub=n;a.hc&&(a.Ub=a.dc?a.dc.call(u,function(){Lh(a)},a.rf):u.setTimeout(function(){Lh(a)},16));var b=N();a.Nf=b;a.yg(b)}};function Mh(a,b){nh.call(this,a,b);this.Xi=new Ih(this);J(this,this.Xi);this.Mc=(N()-this.F.Yc)/1E3;this.aj=l;this.bj=0.01;this.ic=0;this.Ok=new oh;this.Nk=0;this.vk=new gh;this.uk=0;var c=this;this.ke=new Kh(function(){var a=(N()-c.F.Yc)/1E3,b=a-c.Mc;c.Mc=a;0.25<b&&(b=0.25);c.ic+=b;a=1;if(c.aj){for(a=c.bj;c.ic>=a;){Nh(c,c.F.vb,a);var f=c.F;f.vb+=a;c.ic-=a;if(!c.qg)break}a=c.ic/a}else Nh(c,c.F.vb,b),f=c.F,f.vb+=b;if(c.ke.hasFocus()){var f=(N()-c.F.Yc)/1E3+c.F.hf,h=c.vk;h.fb(c.uk++,f,b,a);c.je(h)}},
i,i,500);J(this,this.ke);this.qg=p}y(Mh,nh);function Nh(a,b,c){var d=a.Ok;d.fb(a.Nk++,b,c,a.ke.hasFocus());a.update(d)}Mh.prototype.update=v;Mh.prototype.je=v;function Oh(a,b){Yd.call(this,a);this.Wi=b||n}y(Oh,Yd);Oh.prototype.load=function(a){var b=new O(function(){a.cancel()},this);a.load(b);return b};function Ph(a,b,c,d){D.call(this);this.method=a;this.url=b;this.content=c||n;this.headers=d?sc(d):{}}y(Ph,D);function Qh(a,b){this.statusCode=a;this.content=b||n};function Rh(){D.call(this)}y(Rh,D);t=Rh.prototype;t.Yg=l;t.Uf=n;t.addEventListener=function(a,b,c,d){Bh(this,a,b,c,d)};t.removeEventListener=function(a,b,c,d){Dh(this,a,b,c,d)};
t.dispatchEvent=function(a){var b=a.type||a,c=yh;if(b in c){if(ma(a))a=new sh(a,this);else if(a instanceof sh)a.target=a.target||this;else{var d=a;a=new sh(b,this);uc(a,d)}var d=1,e,c=c[b],b=l in c,f;if(b){e=[];for(f=this;f;f=f.Uf)e.push(f);f=c[l];f.la=f.f;for(var h=e.length-1;!a.bc&&0<=h&&f.la;h--)a.currentTarget=e[h],d&=Gh(f,e[h],a.type,l,a)&&a.ne!=p}if(p in c)if(f=c[p],f.la=f.f,b)for(h=0;!a.bc&&h<e.length&&f.la;h++)a.currentTarget=e[h],d&=Gh(f,e[h],a.type,p,a)&&a.ne!=p;else for(e=this;!a.bc&&e&&
f.la;e=e.Uf)a.currentTarget=e,d&=Gh(f,e,a.type,p,a)&&a.ne!=p;a=Boolean(d)}else a=l;return a};t.b=function(){Rh.d.b.call(this);var a=0;if(this!=n){var b=pa(this);if(zh[b])for(var b=zh[b],c=b.length-1;0<=c;c--)Eh(b[c].key),a++}else pc(xh,function(b,c){Eh(c);a++});this.Uf=n};var Sh=u.window;function Th(a,b){this.r={};this.w=[];var c=arguments.length;if(1<c){c%2&&g(Error("Uneven number of arguments"));for(var d=0;d<c;d+=2)this.set(arguments[d],arguments[d+1])}else if(a){a instanceof Th?(c=a.cb(),d=a.ra()):(c=rc(a),d=qc(a));for(var e=0;e<c.length;e++)this.set(c[e],d[e])}}t=Th.prototype;t.f=0;t.Dg=0;t.ya=s("f");t.ra=function(){Uh(this);for(var a=[],b=0;b<this.w.length;b++)a.push(this.r[this.w[b]]);return a};t.cb=function(){Uh(this);return this.w.concat()};
t.pb=function(a){return Vh(this.r,a)};t.clear=function(){this.r={};this.Dg=this.f=this.w.length=0};t.remove=function(a){return Vh(this.r,a)?(delete this.r[a],this.f--,this.Dg++,this.w.length>2*this.f&&Uh(this),l):p};function Uh(a){if(a.f!=a.w.length){for(var b=0,c=0;b<a.w.length;){var d=a.w[b];Vh(a.r,d)&&(a.w[c++]=d);b++}a.w.length=c}if(a.f!=a.w.length){for(var e={},c=b=0;b<a.w.length;)d=a.w[b],Vh(e,d)||(a.w[c++]=d,e[d]=1),b++;a.w.length=c}}t.get=function(a,b){return Vh(this.r,a)?this.r[a]:b};
t.set=function(a,b){Vh(this.r,a)||(this.f++,this.w.push(a),this.Dg++);this.r[a]=b};t.s=function(){return new Th(this)};function Vh(a,b){return Object.prototype.hasOwnProperty.call(a,b)};function Wh(a){return Xh(a||arguments.callee.caller,[])}
function Xh(a,b){var c=[];if(0<=vb(b,a))c.push("[...circular reference...]");else if(a&&50>b.length){c.push(Yh(a)+"(");for(var d=a.arguments,e=0;e<d.length;e++){0<e&&c.push(", ");var f;f=d[e];switch(typeof f){case "object":f=f?"object":"null";break;case "string":break;case "number":f=String(f);break;case "boolean":f=f?"true":"false";break;case "function":f=(f=Yh(f))?f:"[fn]";break;default:f=typeof f}40<f.length&&(f=f.substr(0,40)+"...");c.push(f)}b.push(a);c.push(")\n");try{c.push(Xh(a.caller,b))}catch(h){c.push("[exception trying to get caller]\n")}}else a?
c.push("[...long stack...]"):c.push("[end]");return c.join("")}function Yh(a){if(Zh[a])return Zh[a];a=String(a);if(!Zh[a]){var b=/function ([^\(]+)/.exec(a);Zh[a]=b?b[1]:"[Anonymous]"}return Zh[a]}var Zh={};function $h(a,b,c,d,e){this.reset(a,b,c,d,e)}$h.prototype.Bk=0;$h.prototype.jh=n;$h.prototype.ih=n;var ai=0;$h.prototype.reset=function(a,b,c,d,e){this.Bk="number"==typeof e?e:ai++;this.ze=d||ua();this.Nc=a;this.bk=b;this.wl=c;delete this.jh;delete this.ih};$h.prototype.ki=ba("Nc");function bi(a){this.Jh=a}bi.prototype.K=n;bi.prototype.Nc=n;bi.prototype.O=n;bi.prototype.Fc=n;function ci(a,b){this.name=a;this.value=b}ci.prototype.toString=s("name");var di=new ci("SEVERE",1E3),ei=new ci("WARNING",900),fi=new ci("INFO",800),gi=new ci("CONFIG",700),hi=new ci("FINE",500);t=bi.prototype;t.getName=s("Jh");t.getParent=s("K");t.ki=ba("Nc");function ii(a){return a.Nc?a.Nc:a.K?ii(a.K):n}
t.log=function(a,b,c){if(a.value>=ii(this).value){a=this.pj(a,b,c);b="log:"+a.bk;u.console&&(u.console.timeStamp?u.console.timeStamp(b):u.console.markTimeline&&u.console.markTimeline(b));u.msWriteProfilerMark&&u.msWriteProfilerMark(b);for(b=this;b;){c=b;var d=a;if(c.Fc)for(var e=0,f=i;f=c.Fc[e];e++)f(d);b=b.getParent()}}};
t.pj=function(a,b,c){var d=new $h(a,String(b),this.Jh);if(c){d.jh=c;var e;var f=arguments.callee.caller;try{var h;var k=ha("window.location.href");if(ma(c))h={message:c,name:"Unknown error",lineNumber:"Not available",fileName:k,stack:"Not available"};else{var j,m,q=p;try{j=c.lineNumber||c.ul||"Not available"}catch(r){j="Not available",q=l}try{m=c.fileName||c.filename||c.sourceURL||k}catch(z){m="Not available",q=l}h=q||!c.lineNumber||!c.fileName||!c.stack?{message:c.message,name:c.name,lineNumber:j,
fileName:m,stack:c.stack||"Not available"}:c}e="Message: "+lb(h.message)+'\nUrl: <a href="view-source:'+h.fileName+'" target="_new">'+h.fileName+"</a>\nLine: "+h.lineNumber+"\n\nBrowser stack:\n"+lb(h.stack+"-> ")+"[end]\n\nJS stack traversal:\n"+lb(Wh(f)+"-> ")}catch(x){e="Exception trying to expose exception! You win, we lose. "+x}d.ih=e}return d};t.info=function(a,b){this.log(fi,a,b)};function ji(a,b){a.log(hi,b,i)}t.Pe=function(a,b){this.O||(this.O={});this.O[a]=b};var ki={},li=n;
function mi(a){li||(li=new bi(""),ki[""]=li,li.ki(gi));var b;if(!(b=ki[a])){b=new bi(a);var c=a.lastIndexOf("."),d=a.substr(c+1),c=mi(a.substr(0,c));c.Pe(d,b);b.K=c;ki[a]=b}return b};function ni(){}ni.prototype.Qg=n;function oi(a){var b;if(!(b=a.Qg))b={},pi(a)&&(b[0]=l,b[1]=l),b=a.Qg=b;return b};var qi;function ri(){}y(ri,ni);ri.prototype.Dd=function(){var a=pi(this);return a?new ActiveXObject(a):new XMLHttpRequest};
function pi(a){if(!a.th&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var b=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],c=0;c<b.length;c++){var d=b[c];try{return new ActiveXObject(d),a.th=d}catch(e){}}g(Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed"))}return a.th}qi=new ri;var si=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#(.*))?$");function ti(a){D.call(this);this.headers=new Th;this.Oe=a||n}y(ti,Rh);ti.prototype.aa=mi("goog.net.XhrIo");var ui=/^https?$/i;t=ti.prototype;t.Ta=p;t.q=n;t.Ne=n;t.Ud="";t.zh="";t.Kc=0;t.Lc="";t.tf=p;t.Qd=p;t.Hf=p;t.zb=p;t.Zc=0;t.Hb=n;t.ai="";t.Tk=p;
t.send=function(a,b,c,d){this.q&&g(Error("[goog.net.XhrIo] Object is active with another request="+this.Ud+"; newUri="+a));b=b?b.toUpperCase():"GET";this.Ud=a;this.Lc="";this.Kc=0;this.zh=b;this.tf=p;this.Ta=l;this.q=this.Oe?this.Oe.Dd():qi.Dd();this.Ne=this.Oe?oi(this.Oe):oi(qi);this.q.onreadystatechange=w(this.Oh,this);try{ji(this.aa,vi(this,"Opening Xhr")),this.Hf=l,this.q.open(b,a,l),this.Hf=p}catch(e){ji(this.aa,vi(this,"Error opening Xhr: "+e.message));wi(this,e);return}a=c||"";var f=this.headers.s();
d&&wc(d,function(a,b){f.set(b,a)});d=u.FormData&&a instanceof u.FormData;"POST"==b&&(!f.pb("Content-Type")&&!d)&&f.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");wc(f,function(a,b){this.q.setRequestHeader(b,a)},this);this.ai&&(this.q.responseType=this.ai);"withCredentials"in this.q&&(this.q.withCredentials=this.Tk);try{this.Hb&&(Sh.clearTimeout(this.Hb),this.Hb=n),0<this.Zc&&(ji(this.aa,vi(this,"Will abort after "+this.Zc+"ms if incomplete")),this.Hb=Sh.setTimeout(w(this.Kk,
this),this.Zc)),ji(this.aa,vi(this,"Sending request")),this.Qd=l,this.q.send(a),this.Qd=p}catch(h){ji(this.aa,vi(this,"Send error: "+h.message)),wi(this,h)}};t.Kk=function(){"undefined"!=typeof ea&&this.q&&(this.Lc="Timed out after "+this.Zc+"ms, aborting",this.Kc=8,ji(this.aa,vi(this,this.Lc)),this.dispatchEvent("timeout"),this.abort(8))};function wi(a,b){a.Ta=p;a.q&&(a.zb=l,a.q.abort(),a.zb=p);a.Lc=b;a.Kc=5;xi(a);yi(a)}
function xi(a){a.tf||(a.tf=l,a.dispatchEvent("complete"),a.dispatchEvent("error"))}t.abort=function(a){this.q&&this.Ta&&(ji(this.aa,vi(this,"Aborting")),this.Ta=p,this.zb=l,this.q.abort(),this.zb=p,this.Kc=a||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),yi(this))};t.b=function(){this.q&&(this.Ta&&(this.Ta=p,this.zb=l,this.q.abort(),this.zb=p),yi(this,l));ti.d.b.call(this)};t.Oh=function(){!this.Hf&&!this.Qd&&!this.zb?this.gk():zi(this)};t.gk=function(){zi(this)};
function zi(a){if(a.Ta&&"undefined"!=typeof ea)if(a.Ne[1]&&4==a.xb()&&2==Ai(a))ji(a.aa,vi(a,"Local request error detected and ignored"));else if(a.Qd&&4==a.xb())Sh.setTimeout(w(a.Oh,a),0);else if(a.dispatchEvent("readystatechange"),4==a.xb()){ji(a.aa,vi(a,"Request complete"));a.Ta=p;try{if(Bi(a))a.dispatchEvent("complete"),a.dispatchEvent("success");else{a.Kc=6;var b;try{b=2<a.xb()?a.q.statusText:""}catch(c){ji(a.aa,"Can not get status: "+c.message),b=""}a.Lc=b+" ["+Ai(a)+"]";xi(a)}}finally{yi(a)}}}
function yi(a,b){if(a.q){var c=a.q,d=a.Ne[0]?v:n;a.q=n;a.Ne=n;a.Hb&&(Sh.clearTimeout(a.Hb),a.Hb=n);b||a.dispatchEvent("ready");try{c.onreadystatechange=d}catch(e){a.aa.log(di,"Problem encountered resetting onreadystatechange: "+e.message,i)}}}
function Bi(a){var b=Ai(a),c;a:switch(b){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:c=l;break a;default:c=p}if(!c){if(b=0===b)a=String(a.Ud).match(si)[1]||n,!a&&self.location&&(a=self.location.protocol,a=a.substr(0,a.length-1)),b=!ui.test(a?a.toLowerCase():"");c=b}return c}t.xb=function(){return this.q?this.q.readyState:0};function Ai(a){try{return 2<a.xb()?a.q.status:-1}catch(b){return a.aa.log(ei,"Can not get status: "+b.message,i),-1}}
function vi(a,b){return b+" ["+a.zh+" "+a.Ud+" "+Ai(a)+"]"};function Ci(a,b,c,d){Ph.call(this,a,b,c,d)}y(Ci,Ph);function Di(a,b,c,d){a=new Ci(a,b,c,d);var e=new O,f=new ti;f.Zc=Math.max(0,2E4);var h=Bh(f,"complete",function(){var a=Ai(f),b;try{b=f.q?f.q.responseText:""}catch(c){ji(f.aa,"Can not get responseText: "+c.message),b=""}a=new Qh(a,b);Eh(h);L(f);Bi(f)?e.e(a):e.a(a)});f.send(a.url,a.method,a.content,a.headers);return e};function Ei(a,b,c){D.call(this);this.fl=a;this.kg=a+"api/server/"+b;this.Gf={"X-GF-Version":"1","X-GF-Server-ID":b,"X-GF-Server-Key":c}}y(Ei,D);function Fi(a,b,c){Mh.call(this,a,b.F);this.oc=new Oh(this,this.Wi);J(this,this.oc);this.jf.push(this.oc);this.Mb=new fh(this,b,c);J(this,this.Mb);this.Xa=n;1==b.type&&(a.af&&a.ci&&a.ei)&&(this.Xa=new Ei(a.af,a.ci,a.ei),J(this,this.Xa));this.qd=n}y(Fi,Mh);t=Fi.prototype;t.b=function(){this.qd&&(u.clearTimeout(this.qd),this.qd=n);if(this.Xa){var a=this.Xa;Di("DELETE",a.kg,i,a.Gf)}Fi.d.b.call(this)};
t.xi=function(){if(this.Xa){for(var a=this.Mb.ta,b=[],c=0;c<a.g.length;c++)b.push(a.g[c].info);for(var a=this.Xa,c=[],d=0;d<b.length;d++)c.push({display_name:b[d].qa});b=(new hh(i)).qe({user_count:c.length,users:c});b=Di("POST",a.kg,b,a.Gf);a=function(){this.qd=u.setTimeout(w(this.xi,this),5E3)};P(b,a,a,this)}};
t.load=function(){if(this.Xa){var a=this.Vj,b;b=this.Xa;var c=this.Mb.ta.di,d=[],e;for(e in c.Ab)d.push(e+"="+c.Ab[e]);c=(new hh(i)).qe({endpoint:c.Ja,server_name:c.name,server_location:c.location,game_type:c.Ac,game_version:c.Bc,game_properties:d,user_max:c.Xb});b=Di("PUT",b.kg,c,b.Gf);P(b,function(){M("Registered with server browser at "+a.af);this.xi()},function(a){M("Unable to register with server browser: ",a)},this)}return this.Mb.load()};t.update=function(a){this.Mb.update(a)};t.je=function(a){this.Mb.je(a)};function Gi(){this.version=0};function Hi(){D.call(this);this.ja=[];this.Qf=p;this.If=0;this.Zb=l;this.Pi=new of}y(Hi,D);function Ii(a,b,c,d){Ji(a,b);a=new Gi;!c&&d?b.ea.e(a):b.ea.a(c)}function Ki(a,b,c){Ji(a,b);c?b.ea.a(c):b.ea.e(n)}
function Li(a,b,c,d){Ji(a,b);if(a=!c)if(a=d)if(a=b.yd){a=b.yd;var e=Ge();e.da(d,0);a:switch(re(e)){case 1:b:{d=Ee(e);var f=Ee(e),h=Ee(e);a.x=d;a.y=f;a.k=h;var k=a.Va,j=d+16,m=f+128,q=h+16;B(k.min,d,f,h);B(k.max,j,m,q);f=re(e);d=a.U;switch(f){default:case 0:e.ka();f=0;for(h=e.offset;32768>f;f++,h+=2)d[f]=e.buffer[h+1]<<8|e.buffer[h];break;case 1:k=e.ka();f=e.buffer;h=e.offset;e=0;h=h?h:0;k=k?k:f.length;for(j=h;j<h+k;)if(m=f[j++],255==m)for(var m=f[j++]<<8|f[j++],q=f[j++]<<8|f[j++],r=0;r<m;r++)d[e++]=
q;else d[e++]=m<<8|f[j++];break;case 2:a=p;break b}a.Pb=p;a.state=2;a.map.Zd(a);a=l}break a;default:a=p}}a?b.ea.e(n):b.ea.a(c)}function Qc(a,b){var c=new O,d=new Cc(c,Mi,b.x,b.y,b.k);d.version=b.version;d.data=a.Pi.qe(b);d.data?(a.ja.push(d),a.Zb||Ec(a)):c.a(n);return c}function Ni(a,b,c){Ji(a,b);c?b.ea.a(c):b.ea.e(n)}function Oi(a,b,c){Ji(a,b);c?b.ea.a(c):b.ea.e(n)}
function Ec(a){if(!a.If&&a.ja.length){if(a.Qf){a.Qf=p;for(var b=a.ja.length-1,c=0;c<a.ja.length;c++)if(a.ja[c].$b==Number.MAX_VALUE){b=c-1;break}if(b)if(b==a.ja.length-1)Eb(a.ja,Pi);else{b=a.ja.slice(0,b);Eb(b,Pi);for(c=0;c<b.length;c++)a.ja[c]=b[c]}}c=a.ja[0];a.If++;a.bg(c)}}function Ji(a,b){a.If--;Bb(a.ja,b);a.Zb||Ec(a)}var Dc=2,Mi=3;function Cc(a,b,c,d,e){this.ea=a;this.action=b;this.x=c;this.y=d;this.k=e;this.yd=n;this.$b=Number.MAX_VALUE;this.version=0;this.data=n}
function Pi(a,b){return a.$b-b.$b};function Qi(a,b,c,d,e,f){D.call(this);this.x=a;this.y=b;this.k=c;this.key=d;this.xf=e;this.pl=f;this.Lf=ua();this.Vh=p;this.V=new Uint32Array(1024);this.G=[l];this.M=this.l=n}y(Qi,D);function Ri(a,b){return b.Lf-a.Lf}Qi.prototype.b=function(){L(this.l);L(this.M);Qi.d.b.call(this)};Qi.prototype.Rb=function(a,b,c){return 32*(c>>4&31)+(a>>4&31)};Qi.prototype.dd=function(a,b){var c=Array.prototype.slice.call(arguments,1);c.unshift(4096*a);return this.M.write.apply(this.M,c)};function Si(a,b){D.call(this);this.Yj=a;this.sd={};this.p=[];this.xk=b}y(Si,D);Si.prototype.b=function(){this.clear();Si.d.b.call(this)};
Si.prototype.get=function(a,b,c){var d=a>>9,e=c>>9,f=[d,0,e,"blkregion"].join("."),h=new O;(a=this.sd[f])?(a.Lf=ua(),h.e(a)):P(this.xk.getFile(f,2),function(a){if(this.p.length>=this.Yj&&this.p.length){Eb(this.p,Ri);var b=this.p[this.p.length-1];delete this.sd[b.key];L(b);this.p.length--}var c=new Qi(d<<9,0,e<<9,f,a,0);this.sd[f]=c;this.p.push(c);var q=new O;a=[c.xf.createReader(),c.xf.createWriter()];a=new Oc(a,p,l);P(a,function(a){return yb(a,function(a){return a[1]})},n,i);P(a,function(a){this.l=
a[0];this.M=a[1];this.l.eb()?P(this.l.read(0,4096,this.V.buffer),function(a){a!=this.V.buffer&&(this.V=new Uint32Array(a));a=this.M.eb()/4096;this.G.length=a;this.G[0]=l;for(a=1;a<this.G.length;a++)this.G[a]=p;for(a=0;a<this.V.length;a++){var b=this.V[a],c=b>>8,b=b&255;if(c)for(var d=0;d<b;d++)this.G[c+d]=l}this.Vh=l;q.e(n)},function(a){q.a(a)},this):P(this.dd(0,this.V.buffer),function(){this.Vh=l;q.e(n)},function(a){q.a(a)},this)},function(a){q.a(a)},c);P(q,function(){h.e(c)},function(a){h.a(a)},
this)},function(a){h.a(a)},this);return h};Si.prototype.clear=function(){wb(this.p,L);this.p.length=0;this.sd={}};function Ti(a,b){D.call(this);this.type=a;this.size=b}y(Ti,D);function Ui(a,b){ib.call(this,b+": "+Vi(a));this.code=a;this.action=b}y(Ui,ib);
function Vi(a){switch(a){case 1:return"File or directory not found";case 2:return"Insecure or disallowed operation";case 3:return"Operation aborted";case 4:return"File or directory not readable";case 5:return"Invalid encoding";case 6:return"Cannot modify file or directory";case 7:return"Invalid state";case 8:return"Invalid line-ending specifier";case 9:return"Invalid modification";case 10:return"Quota exceeded";case 11:return"Invalid filetype";case 12:return"File or directory already exists at specified path";
default:return"Unknown error"}};function Wi(a,b){return new Ui(a?a.code:0,b)};function Xi(a,b){ib.call(this,jb("Error %s: %s",b,Yi(a)));this.code=a}y(Xi,ib);
function Yi(a){switch(a){case 1:return"File or directory not found";case 2:return"Insecure or disallowed operation";case 3:return"Operation aborted";case 4:return"File or directory not readable";case 5:return"Invalid encoding";case 6:return"Cannot modify file or directory";case 7:return"Invalid state";case 8:return"Invalid line-ending specifier";case 9:return"Invalid modification";case 10:return"Quota exceeded";case 11:return"Invalid filetype";case 12:return"File or directory already exists at specified path";
default:return"Unrecognized error"}};function Zi(a,b){sh.call(this,a.type,b);this.uf=a}y(Zi,sh);function $i(){D.call(this);this.l=new FileReader;this.l.onloadstart=w(this.W,this);this.l.onprogress=w(this.W,this);this.l.onload=w(this.W,this);this.l.onabort=w(this.W,this);this.l.onerror=w(this.W,this);this.l.onloadend=w(this.W,this)}y($i,Rh);t=$i.prototype;t.abort=function(){try{this.l.abort()}catch(a){g(new Xi(a.code,"aborting read"))}};t.xb=function(){return this.l.readyState};t.getError=function(){return this.l.error&&new Xi(this.l.error.code,"reading file")};
t.W=function(a){this.dispatchEvent(new Zi(a,this))};t.b=function(){$i.d.b.call(this);delete this.l};t.readAsArrayBuffer=function(a){this.l.readAsArrayBuffer(a)};function aj(a,b){D.call(this);this.Dh=b;this.ub=[];a>this.Dh&&g(Error("[goog.structs.SimplePool] Initial cannot be greater than max"));for(var c=0;c<a;c++)this.ub.push(this.uc?this.uc():{})}y(aj,D);aj.prototype.uc=n;aj.prototype.ah=n;function bj(a,b){if(a.ah)a.ah(b);else if(oa(b))if(na(b.xc))b.xc();else for(var c in b)delete b[c]}aj.prototype.b=function(){aj.d.b.call(this);for(var a=this.ub;a.length;)bj(this,a.pop());delete this.ub};function cj(a){D.call(this);this.lb=a;this.Na=new aj(0,5);J(this,this.Na);a=w(function(){return new dj(this.Na)},this);this.Na.uc=a}y(cj,D);cj.prototype.eb=function(){return this.lb.size};
cj.prototype.read=function(a,b){var c=this.lb.size,d=a||0;if(d>=c)return c=new O,c.a(new Ui(7,"read file")),c;var e=d+(ga(b)?b:c);e>c&&(e=c);var e=e||0,f=n;0==d&&e==c?f=this.lb:this.lb.slice?f=this.lb.slice(d,e):this.lb.webkitSlice&&(f=this.lb.webkitSlice(d,e));return(this.Na.ub.length?this.Na.ub.pop():this.Na.uc?this.Na.uc():{}).da(f)};function dj(a){Ih.call(this,this);this.Na=a;this.nf=n;this.l=new $i;J(this,this.l);this.listen(this.l,"loadend",this.Si)}y(dj,Ih);
dj.prototype.da=function(a){var b=new O(this.Ni,this);this.nf=b;this.l.readAsArrayBuffer(a);return b};dj.prototype.Ni=function(){this.l.abort()};dj.prototype.Si=function(){var a=this.nf;if(a){this.nf=n;var b=this.l.l.result,c=this.l.getError(),d=this.Na;d.ub.length<d.Dh?d.ub.push(this):bj(d,this);b?a.e(b):a.a(Wi(c,"read"))}};function ej(a){D.call(this);this.sa=a;this.sa.onwritestart=w(this.W,this);this.sa.onprogress=w(this.W,this);this.sa.onwrite=w(this.W,this);this.sa.onabort=w(this.W,this);this.sa.onerror=w(this.W,this);this.sa.onwriteend=w(this.W,this)}y(ej,Rh);t=ej.prototype;t.abort=function(){try{this.sa.abort()}catch(a){g(new Xi(a.code,"aborting save"))}};t.xb=function(){return this.sa.readyState};t.getError=function(){return this.sa.error&&new Xi(this.sa.error.code,"saving file")};
t.W=function(a){this.dispatchEvent(new Zi(a,this))};t.b=function(){delete this.sa;ej.d.b.call(this)};function fj(a){D.call(this);this.ia=a;J(this,this.ia);this.Ia=this.T=n;this.bb=new Ih(this);J(this,this.bb);this.bb.listen(this.ia,"writeend",function(){if(this.T){var a=this.T;this.Ia=this.T=n;a.e(n)}});this.bb.listen(this.ia,"error",function(){if(this.T&&this.Ia){var a=this.T,c=new Ui(2,this.Ia);this.Ia=this.T=n;a.a(c)}});this.bb.listen(this.ia,"abort",function(){if(this.T&&this.Ia){var a=this.T,c=new Ui(3,this.Ia);this.Ia=this.T=n;a.a(c)}})}y(fj,D);fj.prototype.eb=function(){return this.ia.eb()};
fj.prototype.mg=function(a){var b=new O;this.T?b.a(new Ui(7,"overlapped set length")):a==this.eb()?b.e(n):(this.T=b,this.Ia="set length",this.ia.truncate(a));return b};
fj.prototype.write=function(a,b){var c=new O;if(this.T)return c.a(new Ui(7,"overlapped write")),c;for(var d=Array.prototype.slice.call(arguments,1),e=0;e<d.length;e++)d[e]instanceof ArrayBuffer&&(d[e]=new Uint8Array(d[e]));var f=new Blob(d);a>this.eb()?P(this.mg(a+f.size),function(){this.T=c;this.Ia="write";this.ia.seek(a);this.ia.write(f)},function(a){c.a(a)},this):(this.T=c,this.Ia="write",this.ia.seek(a),this.ia.write(f));return c};function gj(a,b){this.yf=a;this.fullPath=b.Y.fullPath;this.name=b.getName();this.type=b.isFile()?0:1;this.ia=b}gj.prototype.isFile=function(){return 0==this.type};gj.prototype.remove=function(){var a=new O;P(this.ia.remove(),function(){a.e(n)},function(b){a.a(Wi(b,"remove "+this.fullPath))},this);return a};function hj(a,b){return b.isFile()?new ij(a.yf,b):new jj(a.yf,b)}function ij(a,b){gj.call(this,a,b);this.kh=b}y(ij,gj);
ij.prototype.createReader=function(){var a=new O;P(this.kh.file(),function(b){a.e(new cj(b))},function(b){a.a(Wi(b,"create reader "+this.fullPath))},this);return a};ij.prototype.createWriter=function(){var a=new O;P(this.kh.createWriter(),function(b){a.e(new fj(b))},function(b){a.a(Wi(b,"create writer "+this.fullPath))},this);return a};ij.prototype.read=function(){var a=new O;P(this.createReader(),function(b){P(b.read(),function(c){L(b);a.e(c)},function(c){L(b);a.a(c)})},function(b){a.a(b)});return a};
ij.prototype.write=function(a){var b=new O;P(this.createWriter(),function(c){P(c.mg(0),function(){P(c.write(a),function(){L(c);b.e(n)},function(a){L(c);b.a(a)})},function(a){L(c);b.a(a)})},function(a){b.a(a)});return b};function jj(a,b){gj.call(this,a,b);this.of=b}y(jj,gj);jj.prototype.getFile=function(a,b){var c=new O;P(this.of.getFile(a,b),function(a){c.e(hj(this,a))},function(b){c.a(Wi(b,"get file "+a+" in "+this.fullPath))},this);return c};
jj.prototype.getDirectory=function(a,b){var c=new O;P(this.of.getDirectory(a,b),function(a){c.e(hj(this,a))},function(b){c.a(Wi(b,"get directory "+a+" in "+this.fullPath))},this);return c};jj.prototype.vc=function(a){var b=new O;P(this.of.vc(a),function(a){b.e(hj(this,a))},function(c){b.a(Wi(c,"create path "+a+" in "+this.fullPath))},this);return b};function kj(a){ej.call(this,a);this.M=a}y(kj,ej);t=kj.prototype;t.Dc=function(){return this.M.position};t.eb=function(){return this.M.length};t.write=function(a){try{this.M.write(a)}catch(b){g(new Xi(b.code,"writing file"))}};t.seek=function(a){try{this.M.seek(a)}catch(b){g(new Xi(b.code,"seeking in file"))}};t.truncate=function(a){try{this.M.truncate(a)}catch(b){g(new Xi(b.code,"truncating file"))}};function lj(a){return a};function mj(a,b){this.Ka=a;this.Y=b}mj.prototype.isFile=function(){return this.Y.isFile};mj.prototype.getName=function(){return this.Y.name};mj.prototype.remove=function(){var a=new O;this.Y.remove(w(a.e,a,l),w(function(b){a.a(new Xi(b.code,"removing "+this.Y.fullPath))},this));return a};mj.prototype.getParent=function(){var a=new O;this.Y.getParent(w(function(b){a.e(new nj(this.Ka,b))},this),w(function(b){a.a(new Xi(b.code,"getting parent of "+this.Y.fullPath))},this));return a};
function nj(a,b){mj.call(this,a,b);this.$g=b}y(nj,mj);var oj=2;nj.prototype.getFile=function(a,b){var c=new O;this.$g.getFile(a,pj(b),w(function(a){c.e(new qj(this.Ka,a))},this),w(function(b){c.a(new Xi(b.code,"loading file "+a+" from "+this.Y.fullPath))},this));return c};nj.prototype.getDirectory=function(a,b){var c=new O;this.$g.getDirectory(a,pj(b),w(function(a){c.e(new nj(this.Ka,a))},this),w(function(b){c.a(new Xi(b.code,"loading directory "+a+" from "+this.Y.fullPath))},this));return c};
nj.prototype.vc=function(a){function b(a){if(!d.length)return Mc(a);var c=d.shift();a=".."==c?a.getParent():"."==c?Mc(a):a.getDirectory(c,oj);return P(a,b,n,i)}if(0==a.lastIndexOf("/",0)){var c=this.Ka.Tb();if(this.Y.fullPath!=c.Y.fullPath)return c.vc(a)}var d=xb(a.split("/"),lj);return b(this)};function pj(a){return a==oj?{create:l}:3==a?{create:l,exclusive:l}:{}}function qj(a,b){mj.call(this,a,b);this.lh=b}y(qj,mj);
qj.prototype.createWriter=function(){var a=new O;this.lh.createWriter(function(b){a.e(new kj(b))},w(function(b){a.a(new Xi(b.code,"creating writer for "+this.Y.fullPath))},this));return a};qj.prototype.file=function(){var a=new O;this.lh.file(function(b){a.e(b)},w(function(b){a.a(new Xi(b.code,"getting file for "+this.Y.fullPath))},this));return a};function rj(a){this.Ka=a}rj.prototype.getName=function(){return this.Ka.name};rj.prototype.Tb=function(){return new nj(this,this.Ka.root)};function sj(a,b,c){Ti.call(this,a,b);this.Nj=c}y(sj,Ti);sj.prototype.Tb=function(){return new jj(this,this.Nj.Tb())};function tj(a){var b=new Buffer(a.byteLength);a=new Uint8Array(a);for(var c=0;c<a.length;c++)b[c]=a[c];return b};function uj(a){Hi.call(this);this.Xe=a;this.Vc=this.ib=this.Ka=n}y(uj,Hi);
uj.prototype.Gb=function(){var a=new O,b=new O,c=n;if(c=u.requestFileSystem||u.webkitRequestFileSystem,na(c)){var d=new O;c(1,1073741824,function(a){d.e(new rj(a))},function(a){d.a(new Xi(a.code,"requesting filesystem"))});c=d}else c=Nc(Error("File API unsupported"));c?P(c,function(a){b.e(new sj(1,1073741824,a))},function(a){b.a(Wi(a,"requesting filesystem"))}):b.a(n);P(b,function(b){this.Ka=b;P(b.Tb().vc(this.Xe),function(b){this.ib=b;P(this.ib.vc("regions"),function(b){this.Vc=new Si(256,b);J(this,
this.Vc);this.Zb=p;Ec(this);a.e(n)},function(b){a.a(b)},this)},function(b){a.a(b)},this)},function(b){a.a(b)},this);return a};
uj.prototype.bg=function(a){switch(a.action){case 0:P(this.ib.getFile("info.bin"),function(b){P(b.read(),function(b){Ii(this,a,n,b)},function(b){Ii(this,a,b,n)},this)},function(b){Ii(this,a,b,n)},this);break;case 1:P(this.ib.getFile("info.bin"),function(b){P(b.write(a.data),function(){Ki(this,a,n)},function(b){Ki(this,a,b)},this)},function(b){Ki(this,a,b)},this);break;case Dc:P(this.Vc.get(a.x,a.y,a.k),function(b){var c=new O,d=b.V[b.Rb(a.x,a.y,a.k)],e=4096*(d&255);e?P(b.l.read(4096*(d>>8),e),function(a){c.e(a)},
function(a){c.a(a)},b):c.e(n);P(c,function(b){Li(this,a,n,b)},function(b){Li(this,a,b,n)},this)},function(b){Li(this,a,b,n)},this);break;case Mi:P(this.Vc.get(a.x,a.y,a.k),function(b){var c=a.data,d=new O,e=b.Rb(a.x,a.y,a.k),f=b.V[e],h=f>>8,k=f&255,j=Math.ceil(c.byteLength/4096);if(255<j)d.a(n);else if(h&&k==j)P(b.dd(h,c),function(){d.e()},function(a){d.a(a)});else{if(h)for(var m=0;m<k;m++)b.G[h+m]=p;var q=new O,k=b.G.indexOf(p),m=0;if(1<j&&-1!=k)for(h=k;h<b.G.length&&!(m?b.G[h]?m=0:m++:b.G[h]||(k=
h,m=1),m>=j);h++);if(m>=j){for(h=0;h<j;h++)b.G[k+h]=l;q.e(k)}else{var r=Math.max(j,32),h=b.M.eb()+4096*r;P(b.M.mg(h),function(){var a=this.G.length;this.G.length+=r;for(var b=0;b<r;b++)this.G[a+b]=p;for(b=0;b<j;b++)this.G[a+b]=l;L(this.l);this.l=n;P(this.xf.createReader(),function(b){this.l=b;q.e(a)},function(a){q.a(a)},this)},function(a){q.a(a)},b)}P(q,function(a){f=a<<8|j;this.V[e]=f;P(this.dd(a,c),function(){P(this.dd(0,this.V.buffer),function(){d.e()},function(a){d.a(a)})},function(a){d.a(a)},
this)},function(a){d.a(a)},b)}P(d,function(){Ni(this,a,n)},function(b){Ni(this,a,b)},this)},function(b){Ni(this,a,b)},this);break;case 4:P(this.Vc.get(a.x,a.y,a.k),function(b){var c=b.Rb(a.x,a.y,a.k),d=b.V[c],e=d>>8,d=d&255;if(e){for(var f=0;f<d;f++)b.G[e+f]=p;b.V[c]=0;b=b.dd(0,b.V.buffer)}else b=Mc(n);P(b,function(){Oi(this,a,n)},function(b){Oi(this,a,b)},this)},function(b){Oi(this,a,b)},this)}};function vj(a){Hi.call(this);this.Xe=a;this.xa=n}y(vj,Hi);var wj=u.indexedDB||u.mozIndexedDB||u.webkitIndexedDB||u.msIndexedDB;vj.prototype.Gb=function(){if(!wj)return Nc(n);var a=new O,b=wj.open(this.Xe,2);b.onerror=function(){a.a(n)};b.onsuccess=w(function(){this.xa=b.result;this.xa.onerror=function(a){M("idb error: "+a)};this.Zb=p;Ec(this);a.e(n)},this);b.onupgradeneeded=function(a){a=a.target.result;a.createObjectStore("info");a.createObjectStore("chunks")};return a};
vj.prototype.b=function(){this.xa&&(this.xa.close(),this.xa=n);vj.d.b.call(this)};vj.prototype.wb=function(a){return[a.x,a.y,a.k].join(".")};
vj.prototype.bg=function(a){switch(a.action){case 0:var b=this.xa.transaction(["info"],"readonly").objectStore("info").get("info");b.onsuccess=w(function(){Ii(this,a,n,b.result)},this);b.onerror=w(function(b){b.preventDefault();Ii(this,a,b,n)},this);break;case 1:var c=this.xa.transaction(["info"],"readwrite").objectStore("info").put(a.data,"info");c.onsuccess=w(function(){Ki(this,a,n)},this);c.onerror=w(function(b){b.preventDefault();Ki(this,a,b)},this);break;case Dc:var d=this.xa.transaction(["chunks"],
"readonly").objectStore("chunks").get(this.wb(a));d.onsuccess=w(function(){Li(this,a,n,d.result)},this);d.onerror=w(function(b){b.preventDefault();Li(this,a,b,n)},this);break;case Mi:c=this.xa.transaction(["chunks"],"readwrite").objectStore("chunks").put(a.data,this.wb(a));c.onsuccess=w(function(){Ni(this,a,n)},this);c.onerror=w(function(b){b.preventDefault();Ni(this,a,b)},this);break;case 4:c=this.xa.transaction(["chunks"],"readwrite").objectStore("chunks")["delete"](this.wb(a)),c.onsuccess=w(function(){Oi(this,
a,n)},this),c.onerror=w(function(b){b.preventDefault();Oi(this,a,b)},this)}};function xj(){Hi.call(this);this.uh=n;this.ef={}}y(xj,Hi);xj.prototype.Gb=function(){this.Zb=p;Ec(this);return Mc(n)};xj.prototype.wb=function(a){return[a.x,a.y,a.k].join(".")};xj.prototype.bg=function(a){switch(a.action){case 0:Ii(this,a,n,this.uh);break;case 1:this.uh=a.data;Ki(this,a,n);break;case Dc:var b=this.ef[this.wb(a)];Li(this,a,n,b);break;case Mi:this.ef[this.wb(a)]=a.data;Ni(this,a,n);break;case 4:delete this.ef[this.wb(a)],Oi(this,a,n)}};function yj(a,b){var c;if(a instanceof yj)this.ha=ga(b)?b:a.ha,zj(this,a.fc),c=a.Fe,Aj(this),this.Fe=c,c=a.yc,Aj(this),this.yc=c,Bj(this,a.de),c=a.be,Aj(this),this.be=c,Cj(this,a.hb.s()),c=a.Ld,Aj(this),this.Ld=c;else if(a&&(c=String(a).match(si))){this.ha=!!b;zj(this,c[1]||"",l);var d=c[2]||"";Aj(this);this.Fe=d?decodeURIComponent(d):"";d=c[3]||"";Aj(this);this.yc=d?decodeURIComponent(d):"";Bj(this,c[4]);d=c[5]||"";Aj(this);this.be=d?decodeURIComponent(d):"";Cj(this,c[6]||"",l);c=c[7]||"";Aj(this);
this.Ld=c?decodeURIComponent(c):""}else this.ha=!!b,this.hb=new Dj(n,0,this.ha)}t=yj.prototype;t.fc="";t.Fe="";t.yc="";t.de=n;t.be="";t.Ld="";t.Sj=p;t.ha=p;
t.toString=function(){var a=[],b=this.fc;b&&a.push(Ej(b,Fj),":");if(b=this.yc){a.push("//");var c=this.Fe;c&&a.push(Ej(c,Fj),"@");a.push(encodeURIComponent(String(b)));b=this.de;b!=n&&a.push(":",String(b))}if(b=this.be)this.yc&&"/"!=b.charAt(0)&&a.push("/"),a.push(Ej(b,"/"==b.charAt(0)?Gj:Hj));(b=this.hb.toString())&&a.push("?",b);(b=this.Ld)&&a.push("#",Ej(b,Ij));return a.join("")};t.s=function(){return new yj(this)};
function zj(a,b,c){Aj(a);a.fc=c?b?decodeURIComponent(b):"":b;a.fc&&(a.fc=a.fc.replace(/:$/,""))}function Bj(a,b){Aj(a);b?(b=Number(b),(isNaN(b)||0>b)&&g(Error("Bad port number "+b)),a.de=b):a.de=n}function Cj(a,b,c){Aj(a);b instanceof Dj?(a.hb=b,a.hb.lg(a.ha)):(c||(b=Ej(b,Jj)),a.hb=new Dj(b,0,a.ha))}function Aj(a){a.Sj&&g(Error("Tried to modify a read-only Uri"))}t.lg=function(a){this.ha=a;this.hb&&this.hb.lg(a);return this};function Ej(a,b){return ma(a)?encodeURI(a).replace(b,Kj):n}
function Kj(a){a=a.charCodeAt(0);return"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var Fj=/[#\/\?@]/g,Hj=/[\#\?:]/g,Gj=/[\#\?]/g,Jj=/[\#\?@]/g,Ij=/#/g;function Dj(a,b,c){this.X=a||n;this.ha=!!c}function Lj(a){if(!a.u&&(a.u=new Th,a.f=0,a.X))for(var b=a.X.split("&"),c=0;c<b.length;c++){var d=b[c].indexOf("="),e=n,f=n;0<=d?(e=b[c].substring(0,d),f=b[c].substring(d+1)):e=b[c];e=decodeURIComponent(e.replace(/\+/g," "));e=Mj(a,e);a.add(e,f?decodeURIComponent(f.replace(/\+/g," ")):"")}}t=Dj.prototype;
t.u=n;t.f=n;t.ya=function(){Lj(this);return this.f};t.add=function(a,b){Lj(this);this.X=n;a=Mj(this,a);var c=this.u.get(a);c||this.u.set(a,c=[]);c.push(b);this.f++;return this};t.remove=function(a){Lj(this);a=Mj(this,a);return this.u.pb(a)?(this.X=n,this.f-=this.u.get(a).length,this.u.remove(a)):p};t.clear=function(){this.u=this.X=n;this.f=0};t.pb=function(a){Lj(this);a=Mj(this,a);return this.u.pb(a)};
t.cb=function(){Lj(this);for(var a=this.u.ra(),b=this.u.cb(),c=[],d=0;d<b.length;d++)for(var e=a[d],f=0;f<e.length;f++)c.push(b[d]);return c};t.ra=function(a){Lj(this);var b=[];if(a)this.pb(a)&&(b=Cb(b,this.u.get(Mj(this,a))));else{a=this.u.ra();for(var c=0;c<a.length;c++)b=Cb(b,a[c])}return b};t.set=function(a,b){Lj(this);this.X=n;a=Mj(this,a);this.pb(a)&&(this.f-=this.u.get(a).length);this.u.set(a,[b]);this.f++;return this};
t.get=function(a,b){var c=a?this.ra(a):[];return 0<c.length?String(c[0]):b};t.toString=function(){if(this.X)return this.X;if(!this.u)return"";for(var a=[],b=this.u.cb(),c=0;c<b.length;c++)for(var d=b[c],e=encodeURIComponent(String(d)),d=this.ra(d),f=0;f<d.length;f++){var h=e;""!==d[f]&&(h+="="+encodeURIComponent(String(d[f])));a.push(h)}return this.X=a.join("&")};t.s=function(){var a=new Dj;a.X=this.X;this.u&&(a.u=this.u.s(),a.f=this.f);return a};
function Mj(a,b){var c=String(b);a.ha&&(c=c.toLowerCase());return c}t.lg=function(a){a&&!this.ha&&(Lj(this),this.X=n,wc(this.u,function(a,c){var d=c.toLowerCase();c!=d&&(this.remove(c),this.remove(d),0<a.length&&(this.X=n,this.u.set(Mj(this,d),Db(a)),this.f+=a.length))},this));this.ha=a};t.extend=function(a){for(var b=0;b<arguments.length;b++)wc(arguments[b],function(a,b){this.add(b,a)},this)};function Nj(a,b,c){this.Ue=a;uc(this.Ue,Oj());this.uri=new yj(b);this.ee=new Dj(i,0,l);(a=this.uri.hb)&&this.ee.extend(a);this.ee.extend(c);this.il=Pj(this,"buildServer")}function Oj(){return{buildServer:{help:"Build server daemon address.",type:String,defaultValue:n}}}function Qj(a,b){var c=a.Ue[b].defaultValue,d=a.ee.get(b,c);return!ga(d)||!d||!d.length?c:Number(d)}
function Pj(a,b){var c=a.Ue[b].defaultValue,d=a.ee.get(b,c);return!ga(d)||!d||!d.length||/^[\s\xa0]*$/.test(String(d))?c:String(d)};function Rj(a,b){Nj.call(this,Sj(),a,b);this.vl=Qj(this,"listenPort");this.yf=Pj(this,"fileSystem");this.Wj=Pj(this,"mapPath");this.af=Pj(this,"browserUrl");this.ci=Pj(this,"serverId");this.ei=Pj(this,"serverKey");this.Bl=Pj(this,"serverName");this.Pk=Qj(this,"userCount")}y(Rj,Nj);
function Sj(){return{listenPort:{help:"Port to use for game connections.",type:Number,defaultValue:1337},fileSystem:{help:"File system root path.",type:String,defaultValue:"/tmp/blk/"},mapPath:{help:"Map path.",type:String,defaultValue:"/maps/map01/"},browserUrl:{help:"Server browser base API URL.",type:String,defaultValue:"http://localhost:8081/"},serverId:{help:"Server registration UUID.",type:String,defaultValue:n},serverKey:{help:"Server private key.",type:String,defaultValue:n},serverName:{help:"Human-readable server name.",
type:String,defaultValue:n},userCount:{help:"Maximum simultaneous user count.",type:Number,defaultValue:8}}};function Tj(){D.call(this);this.type="none"}y(Tj,D);function Uj(){this.Fc=Array(256)}function le(a,b,c,d){c=d?w(c,d):c;a.Fc[b]=c};function Vj(a,b,c){D.call(this);this.Yb=new Uj;this.F=new mh;this.id=a;this.type=b;this.Xh=c;this.info=new vg;this.el=new Tj;this.state=0;this.g=[];this.lc={};this.zi=Array(256);this.R=[]}y(Vj,D);Vj.prototype.b=function(){this.R.length=0;Vj.d.b.call(this)};Vj.prototype.Te=function(a){this.g.push(a);this.lc[a.c]=a;this.zi[a.L]=a;for(var b=0;b<this.R.length;b++)this.R[b].zg(a)};Vj.prototype.ie=function(a){var b=this.lc,c=a.c,d;(d=c in b)&&delete b[c];if(d){this.zi[a.L]=n;Bb(this.g,a);for(b=0;b<this.R.length;b++)this.R[b].Ag(a)}};function Wj(a){this.timestamp=ua();this.D=n;this.data=a};function Xj(a){D.call(this);this.Ja=a;this.Rj=p;this.state=Yj;this.wd=p;this.gc=0;this.jb=n;this.Uc=[];this.Le=[]}y(Xj,D);Xj.prototype.b=function(){this.close();Xj.d.b.call(this)};var Yj=0;Xj.prototype.read=function(){if(!this.Uc.length)return n;var a=this.Uc[0];a.timestamp<=ua()?this.Uc.shift():a=n;this.Uc.length||(this.wd=p);return a};
Xj.prototype.write=function(a){a=new Wj(a);if(this.gc){var b=this.gc+(Math.random()-0.5)*this.gc/2;a.timestamp+=b;this.jb===n&&(this.jb=u.setInterval(w(function(){1==this.state&&this.flush()},this),5))}else this.jb!==n&&(u.clearInterval(this.jb),this.jb=n);this.Le.push(a);1==this.state&&this.flush()};function Zj(a,b){if(a.gc){var c=a.gc+(Math.random()-0.5)*a.gc/2;b.timestamp+=c}a.Uc.push(b);a.wd=l}
Xj.prototype.flush=function(a){for(var b=ua();this.Le.length;){var c=this.Le[0];if(c.timestamp>b&&!a)break;this.Le.shift();this.Ci(c.data)}};Xj.prototype.close=function(){2!=this.state&&(this.jb!==n&&(u.clearInterval(this.jb),this.jb=n),this.state=2)};function $j(a,b,c,d){Vj.call(this,"0",0,b);le(this.Yb,1,this.Hj,this);le(this.Yb,8,this.Jj,this);le(this.Yb,5,this.Ej,this);this.ca=a;this.di=d;this.eg=p;this.Jc=[];this.ld=Array(255);for(a=1;a<this.ld.length;a++)this.ld[a-1]=a}y($j,Vj);t=$j.prototype;t.b=function(){if(this.eg){this.eg=p;this.state=0;this.ca.da(n);for(var a=0;a<this.R.length;a++)this.R[a].qf()}$j.d.b.call(this)};t.Cf=function(a){var b=a.Ja;0<=vb(Gb,b)||Gb.push(b);this.Jc.push(a)};
function ak(a,b){if(b.ca&&(a.lc[b.c]||n)==b)b.ca.close(),a.ie(b),a.send(Pg(b.c,b.pf)),0!=b.L&&(a.ld.push(b.L),b.L=0)}
t.Th=function(a){if(this.Jc.length)for(var b=Ge(),c=0;c<this.Jc.length;c++){var d=this.Jc[c],e=p,f=p,h=1;if(2!=d.state)for(;d.wd;){var k=d.read();if(!k)break;b.da(k.data,0);if(4==re(b)){var j=b,e=Gg;e.xe=se(j);e.gd=se(j);k=e.D||new Qd;k.c=j.B();k.L=re(j);k.t=j.ka();var m;if(!(m=!xg(j,k.info)))m=k.fd||new Ld,m.type=j.B(),m.platform=j.B(),m.Rc=j.B(),m.wc=j.B(),m=!m;e=!(m?0:k)?n:e;this.g.length+1>this.di.Xb&&(f=l,h=7);if(!f&&(3!=e.xe||e.gd!=this.Xh))f=l,h=2;if(!f){e=Rd(e.D);for(e.ca=d;!(e.c=Math.floor(2147483648*
Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^ua()).toString(36),!this.lc[e.c]););e.L=this.ld.shift();this.send(Ng(Rd(e)));this.send(Ig(this.Xh,e),e);k=yb(this.g,Rd);k.push(Rd(e));this.send(Eg(this.info.s(),k),e);this.Te(e)}e=l}else f=e=l,h=3}else f=e=l,h=1;e&&(f&&(f=h,h=S(),Lg.reason=f,R(h,5),h.H(Lg.reason),(f=h.finish())&&d.write(f),L(d)),this.Jc.splice(c,1),c--)}b=N();for(c=0;c<this.g.length;c++){for(d=this.g[c];d.ca.wd;){h=d.ca.read();if(!h)break;h.D=d;d.Og+=h.data.byteLength;
f=this.Yb;e=Ge();e.da(h.data,0);e.offset+1<=e.buffer.length&&(k=re(e),(f=f.Fc[k])&&f(h,k,e))}if(!d.ca||2==d.ca.state)d.pf=1,ak(this,d);else if(a&&N()-b>=a)break}};
t.Hj=function(a,b,c){a=a.D;Ag.se=c.ka();Ag.sc=c.ka();Ag.Wb=c.ka();if(!Ag)return p;c=a.ma;b=Math.abs(Ag.Wb);c.md=c.md?(c.md+b)/2:b;c.Fh=Math.min(c.Fh,b);c.Eh=Math.max(c.Eh,b);c=(N()-this.F.Yc)/1E3+this.F.hf;b=Array(this.g.length);for(var d=0;d<this.g.length;d++)b[d]=new wg,b[d].L=this.g[d].L,b[d].Wb=this.g[d].ma.md;this.send(Cg(1E3*c|0,b),a);return l};
t.Jj=function(a,b,c){Rg.c=c.B();c=!xg(c,Rg.info)?n:Rg;if(!c)return p;b=this.lc[c.c]||n;if(!b)return l;if(b!=a.D)return p;a=c.info.qa;a=kb(a).replace(/\xa0|\s/g," ").replace(/\xa0|[ \t]+/g," ");a=!a.length?"User":a;b.info.qa=a;for(a=0;a<this.R.length;a++)this.R[a].Bg(b);this.send(Tg(b.c,b.info));return l};t.Ej=function(a,b,c){a=a.D;Kg.reason=c.ka();if(!Kg)return p;M("["+a.c+"] disconnect req",Kg.reason);return l};
t.send=function(a,b){if(a)if(b){var c=b.ca;2!=c.state?(c.write(a),b.ma.rd+=a.byteLength):ak(this,b)}else for(var d=0;d<this.g.length;d++){var e=this.g[d],c=e.ca;2!=c.state?(e.ma.rd+=a.byteLength,c.write(a)):(e.pf=1,ak(this,e))}};function bk(a,b){if(!a)return p;for(var c=a.constructor,d=0;d<b.length;d++){var e=b[d];if(c==e||c.name==e)return l;ma(e)&&(e=u[e]);if(e&&(c==e||c.name==e.name))return l}return p}function ck(a){a=new Uint8Array(a);for(var b=Array(a.length),c=0;c<b.length;c++)b[c]=a[c];return String.fromCharCode.apply(n,b)};function dk(a,b){Xj.call(this,a);this.Rj=l;this.state=1;this.o=b;this.Hk=!!b.webkitPostMessage&&!bk(b,["MessagePort"]);this.Mi=!rd;var c=this;this.o.onmessage=function(a){c.Df(a)};this.o.onerror=function(a){M("port error",a)}}y(dk,Xj);
dk.prototype.Df=function(a){a=a.data;var b=n;if(a instanceof ArrayBuffer)b=new Wj(a);else if(ma(a)){for(var b=new Uint8Array(2*a.length),c=0,d=0;d<a.length;d++){for(var e=a.charCodeAt(d);255<e;)b[c++]=e,e>>=8;b[c++]=e}b=new Wj(b.subarray(0,c).buffer)}else a&&a.close&&this.close();b&&Zj(this,b)};dk.prototype.Ci=function(a){this.Hk?this.o.webkitPostMessage(a,[a]):this.Mi?this.o.postMessage(a):this.o.postMessage(ck(a))};
dk.prototype.close=function(){this.o.onmessage=n;try{this.o.postMessage({close:l}),this.o.close&&this.o.close()}catch(a){}dk.d.close.call(this)};function ek(a){D.call(this);this.Ja=a;this.Za=l;this.kf=[];this.Ad=n}y(ek,D);ek.prototype.b=function(){this.close();this.Ad=n;ek.d.b.call(this)};ek.prototype.da=function(a){if(this.Ad=a)for(;this.kf.length;){var b=this.kf.shift();a.call(n,b)}};function fk(a,b){a.Ad?a.Ad.call(n,b):a.kf.push(b)};function gk(a,b){ek.call(this,a);this.o=b;this.Kg=w(this.Cf,this);this.o.addEventListener("connect",this.Kg,p);if(bk(b,["DedicatedWorkerContext","DedicatedWorkerGlobalScope"])){var c=new dk(b,b);fk(this,c)}}y(gk,ek);gk.prototype.Cf=function(a){a=a.ports[0];a=new dk(a,a);fk(this,a)};gk.prototype.close=function(){this.Za&&(this.Za=p,this.o.removeEventListener("connect",this.Kg,p))};function hk(a,b){Xj.call(this,a);this.state=1;this.o=b;this.Mg=w(this.Fj,this);this.Jg=w(this.Cj,this);this.Ng=w(this.Df,this);this.Wk={binary:l,mask:p};this.o.addListener("error",this.Mg);this.o.addListener("close",this.Jg);this.o.addListener("message",this.Ng)}y(hk,Xj);t=hk.prototype;t.Fj=function(a){M("socket error",a)};t.Cj=function(a){M("socket closed",a.code);this.close()};t.Df=function(a){for(var b=new Uint8Array(a.length),c=0;c<a.length;c++)b[c]=a[c];a=new Wj(b.buffer);Zj(this,a)};
t.Ci=function(a){this.o.send(tj(a),this.Wk)};t.close=function(){this.o.removeListener("error",this.Mg);this.o.removeListener("close",this.Jg);this.o.removeListener("message",this.Ng);this.o.close(1E3,"");hk.d.close.call(this)};function ik(a){ek.call(this,a);this.o=new (require("ws").Server)({host:i,port:Number(a)});this.Lg=w(this.Dj,this);this.o.addListener("connection",this.Lg)}y(ik,ek);ik.prototype.Dj=function(a){a=new hk(a,a);fk(this,a)};ik.prototype.close=function(){this.Za&&(this.Za=p,this.o.removeListener("connection",this.Lg),this.o.close())};fa("blk.server.start",function(a,b){function c(a,b,d){var e=new (b.shift())(a);P(e.Gb(),function(){d(e)},function(){c(a,b,d)})}for(var d=new O,e={},f=0;f<b.length;f++){var h=b[f];if(0==h.indexOf("--")){var h=h.split("="),k=h[1];e[h[0].substring(2)]=1<h.length?k:l}}if(e.help)return M("BLK game server","(release)"),M("gf:"),M(Oj()),M("blk:"),M(Sj()),d.a("help query"),d;var j=new Rj(a,e),e=new vg;e.Ja="blk://local-0";e.name="Server";e.Ac="blk";e.Bc="0.0.1";e.Xb=j.Pk;f=n;ma(u)?f=new ik(u):oa(u)&&(f=new gk(u,
u));e=new $j(f,7,0,e);e=Mc(e);P(e,function(a){c(j.Wj,[vj,uj,xj],function(b){var c=new Fi(j,a,b);P(c.load(),function(){c.qg||(c.qg=l,c.ke.start());d.e(c)},function(a){d.a(a)})})},function(a){d.a(a)});return d});
