function g(a){throw a;}var j=void 0,m=!0,p=null,r=!1;function aa(){return function(){}}function ba(a){return function(b){this[a]=b}}function s(a){return function(){return this[a]}}function ca(a){return function(){return a}}var t,da=da||{},v=this;function ea(a,b){var c=a.split("."),d=v;!(c[0]in d)&&d.execScript&&d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)!c.length&&fa(b)?d[e]=b:d=d[e]?d[e]:d[e]={}}
function ha(a){a=a.split(".");for(var b=v,c;c=a.shift();)if(b[c]!=p)b=b[c];else return p;return b}function x(){}function ia(a){return a}
function ja(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function fa(a){return a!==j}function ka(a){return"array"==ja(a)}function la(a){var b=ja(a);return"array"==b||"object"==b&&"number"==typeof a.length}function ma(a){return"string"==typeof a}function na(a){return"function"==ja(a)}function oa(a){var b=typeof a;return"object"==b&&a!=p||"function"==b}function qa(a){return a[ra]||(a[ra]=++sa)}var ra="closure_uid_"+Math.floor(2147483648*Math.random()).toString(36),sa=0;
function ta(a,b,c){return a.call.apply(a.bind,arguments)}function ua(a,b,c){a||g(Error());if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}function y(a,b,c){y=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ta:ua;return y.apply(p,arguments)}var z=Date.now||function(){return+new Date};
function A(a,b){function c(){}c.prototype=b.prototype;a.d=b.prototype;a.prototype=new c};function va(a,b){this.attributes=[new wa(3,0),new wa(2,24)];this.Nm=a;this.Ym=b}function wa(a,b){this.size=a;this.type=5126;this.jn=r;this.qn=32;this.offset=b};function xa(){};function ya(a){this.length=a.length||a;for(var b=0;b<this.length;b++)this[b]=a[b]||0}ya.prototype.BYTES_PER_ELEMENT=4;ya.prototype.set=function(a,b){b=b||0;for(var c=0;c<a.length&&b+c<this.length;c++)this[b+c]=a[c]};ya.prototype.toString=Array.prototype.join;"undefined"==typeof Float32Array&&(ya.BYTES_PER_ELEMENT=4,ya.prototype.BYTES_PER_ELEMENT=ya.prototype.BYTES_PER_ELEMENT,ya.prototype.set=ya.prototype.set,ya.prototype.toString=ya.prototype.toString,ea("Float32Array",ya));function za(a){this.length=a.length||a;for(var b=0;b<this.length;b++)this[b]=a[b]||0}za.prototype.BYTES_PER_ELEMENT=8;za.prototype.set=function(a,b){b=b||0;for(var c=0;c<a.length&&b+c<this.length;c++)this[b+c]=a[c]};za.prototype.toString=Array.prototype.join;if("undefined"==typeof Float64Array){try{za.BYTES_PER_ELEMENT=8}catch(Aa){}za.prototype.BYTES_PER_ELEMENT=za.prototype.BYTES_PER_ELEMENT;za.prototype.set=za.prototype.set;za.prototype.toString=za.prototype.toString;ea("Float64Array",za)};function B(){return new Float32Array(3)}function Ba(a,b,c){var d=B();C(d,a,b,c);return d}function C(a,b,c,d){a[0]=b;a[1]=c;a[2]=d}function Ca(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2]}function Da(a,b,c){c[0]=a[0]+b[0];c[1]=a[1]+b[1];c[2]=a[2]+b[2]}function Ea(a,b,c){c[0]=a[0]*b;c[1]=a[1]*b;c[2]=a[2]*b}function Fa(a){var b=a[0],c=a[1];a=a[2];return Math.sqrt(b*b+c*c+a*a)}function Ga(a,b){var c=a[0]-b[0],d=a[1]-b[1],e=a[2]-b[2];return c*c+d*d+e*e}
function Ha(a,b,c){var d=b[0]-a[0],e=b[1]-a[1];a=b[2]-a[2];(b=Math.sqrt(d*d+e*e+a*a))?(b=1/b,c[0]=d*b,c[1]=e*b,c[2]=a*b):c[0]=c[1]=c[2]=0}function Ia(a,b){return a.length==b.length&&a[0]==b[0]&&a[1]==b[1]&&a[2]==b[2]};function Ja(){var a=B(),b=B();this.min=a;this.max=b}function Ka(a,b,c,d,e,f){var h=new Ja;h.min[0]=a<d?a:d;h.min[1]=b<e?b:e;h.min[2]=c<f?c:f;h.max[0]=a<d?d:a;h.max[1]=b<e?e:b;h.max[2]=c<f?f:c;return h}
function La(a,b,c){var d=a.min;a=a.max;var e=Ua[0];e[0]=Math.abs(b[3]);e[1]=Math.abs(b[4]);e[2]=Math.abs(b[5]);var f=0,h=1,k=2;e[0]<e[2]&&(f=2,k=0);e[1]<e[k]?(h=k,k=1):e[1]>e[f]&&(h=f,f=1);var i=0,l=Number.MAX_VALUE,n=b[3+f],q=(d[f]-b[f])/n,f=(a[f]-b[f])/n;q>f&&(n=q,q=f,f=n);if(!(q>l||f<i)){q>i&&(i=q);f<l&&(l=f);if(1E-6>e[h]){if(b[h]<d[h]||b[h]>a[h]||b[k]<d[k]||b[k]>a[k])return}else{n=b[3+h];q=(d[h]-b[h])/n;f=(a[h]-b[h])/n;q>f&&(n=q,q=f,f=n);if(q>l||f<i)return;q>i&&(i=q);f<l&&(l=f);if(1E-6>e[k]){if(b[k]<
d[k]||b[k]>a[k])return}else{n=b[3+k];q=(d[k]-b[k])/n;f=(a[k]-b[k])/n;q>f&&(n=q,q=f,f=n);if(q>l||f<i)return;q>i&&(i=q)}}c&&(c[0]=b[0]+b[3]*i,c[1]=b[1]+b[4]*i,c[2]=b[2]+b[5]*i)}}var Ua=[B(),B(),B()];function D(){return new Float32Array(4)}function Va(a,b,c,d){var e=D();Wa(e,a,b,c,d);return e}function Wa(a,b,c,d,e){a[0]=b;a[1]=c;a[2]=d;a[3]=e}function Xa(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3]}function Ya(a,b){var c=1/256;b[0]=a[0]*c;b[1]=a[1]*c;b[2]=a[2]*c;b[3]=a[3]*c};function Za(){var a=new Float32Array(16);a[0]=a[5]=a[10]=a[15]=1;return a}function $a(a,b,c,d,e,f,h,k,i){a[0]=b;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=c;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=d;a[11]=e;a[12]=f;a[13]=h;a[14]=k;a[15]=i}
function ab(a,b,c){var d=a[0],e=a[1],f=a[2],h=a[3],k=a[4],i=a[5],l=a[6],n=a[7],q=a[8],u=a[9],w=a[10],F=a[11],H=a[12],G=a[13],I=a[14];a=a[15];var N=b[0],ga=b[1],Z=b[2],pa=b[3],Ma=b[4],Na=b[5],Oa=b[6],Pa=b[7],Qa=b[8],Ra=b[9],Sa=b[10],Ta=b[11],L=b[12],Md=b[13],Nd=b[14];b=b[15];c[0]=d*N+k*ga+q*Z+H*pa;c[1]=e*N+i*ga+u*Z+G*pa;c[2]=f*N+l*ga+w*Z+I*pa;c[3]=h*N+n*ga+F*Z+a*pa;c[4]=d*Ma+k*Na+q*Oa+H*Pa;c[5]=e*Ma+i*Na+u*Oa+G*Pa;c[6]=f*Ma+l*Na+w*Oa+I*Pa;c[7]=h*Ma+n*Na+F*Oa+a*Pa;c[8]=d*Qa+k*Ra+q*Sa+H*Ta;c[9]=e*Qa+
i*Ra+u*Sa+G*Ta;c[10]=f*Qa+l*Ra+w*Sa+I*Ta;c[11]=h*Qa+n*Ra+F*Sa+a*Ta;c[12]=d*L+k*Md+q*Nd+H*b;c[13]=e*L+i*Md+u*Nd+G*b;c[14]=f*L+l*Md+w*Nd+I*b;c[15]=h*L+n*Md+F*Nd+a*b}
function bb(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],h=a[4],k=a[5],i=a[6],l=a[7],n=a[8],q=a[9],u=a[10],w=a[11],F=a[12],H=a[13],G=a[14],I=a[15],N=c*k-d*h,ga=c*i-e*h,Z=c*l-f*h,pa=d*i-e*k,Ma=d*l-f*k,Na=e*l-f*i,Oa=n*H-q*F,Pa=n*G-u*F,Qa=n*I-w*F,Ra=q*G-u*H,Sa=q*I-w*H,Ta=u*I-w*G,L=N*Ta-ga*Sa+Z*Ra+pa*Qa-Ma*Pa+Na*Oa;0!=L&&(L=1/L,b[0]=(k*Ta-i*Sa+l*Ra)*L,b[1]=(-d*Ta+e*Sa-f*Ra)*L,b[2]=(H*Na-G*Ma+I*pa)*L,b[3]=(-q*Na+u*Ma-w*pa)*L,b[4]=(-h*Ta+i*Qa-l*Pa)*L,b[5]=(c*Ta-e*Qa+f*Pa)*L,b[6]=(-F*Na+G*Z-I*ga)*L,b[7]=(n*Na-u*
Z+w*ga)*L,b[8]=(h*Sa-k*Qa+l*Oa)*L,b[9]=(-c*Sa+d*Qa-f*Oa)*L,b[10]=(F*Ma-H*Z+I*N)*L,b[11]=(-n*Ma+q*Z-w*N)*L,b[12]=(-h*Ra+k*Pa-i*Oa)*L,b[13]=(c*Ra-d*Pa+e*Oa)*L,b[14]=(-F*pa+H*ga-G*N)*L,b[15]=(n*pa-q*ga+u*N)*L)}function cb(a,b,c){var d=b[0],e=b[1];b=b[2];var f=1/(d*a[3]+e*a[7]+b*a[11]+a[15]);c[0]=(d*a[0]+e*a[4]+b*a[8]+a[12])*f;c[1]=(d*a[1]+e*a[5]+b*a[9]+a[13])*f;c[2]=(d*a[2]+e*a[6]+b*a[10]+a[14])*f}new Float64Array(3);new Float64Array(3);new Float64Array(4);new Float64Array(4);new Float64Array(4);new Float64Array(16);function db(){this.name=p;this.index=0;this.parent=p;this.children=[];this.transform=Za();this.ab=new Ja;this.Rd=D()};function eb(a){this.Ki=a;a=a.Pd;this.lk=new Float32Array(16*a.length);this.Jm=new Float32Array(16*a.length);this.tm=m;this.reset()}eb.prototype.reset=function(){this.tm=m;for(var a=this.Ki.Pd,b=0,c=0;b<a.length;b++,c+=16)for(var d=a[b],e=0;16>e;e++)this.lk[c+e]=d.transform[e]};function E(){0!=fb&&(this.Vm=Error().stack,gb[qa(this)]=this)}var fb=0,gb={};E.prototype.Xf=r;E.prototype.Uc=function(){if(!this.Xf&&(this.Xf=m,this.b(),0!=fb)){var a=qa(this);delete gb[a]}};function J(a,b){a.ge||(a.ge=[]);a.ge.push(b)}E.prototype.b=function(){this.ge&&hb.apply(p,this.ge);if(this.Si)for(;this.Si.length;)this.Si.shift()()};function K(a){a&&"function"==typeof a.Uc&&a.Uc()}function hb(a){for(var b=0,c=arguments.length;b<c;++b){var d=arguments[b];la(d)?hb.apply(p,d):K(d)}};function ib(a){Error.captureStackTrace?Error.captureStackTrace(this,ib):this.stack=Error().stack||"";a&&(this.message=String(a))}A(ib,Error);ib.prototype.name="CustomError";function jb(a,b){for(var c=1;c<arguments.length;c++){var d=String(arguments[c]).replace(/\$/g,"$$$$");a=a.replace(/\%s/,d)}return a}function kb(a){return a.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")}function lb(a){if(!mb.test(a))return a;-1!=a.indexOf("&")&&(a=a.replace(nb,"&amp;"));-1!=a.indexOf("<")&&(a=a.replace(ob,"&lt;"));-1!=a.indexOf(">")&&(a=a.replace(pb,"&gt;"));-1!=a.indexOf('"')&&(a=a.replace(qb,"&quot;"));return a}var nb=/&/g,ob=/</g,pb=/>/g,qb=/\"/g,mb=/[&<>\"]/;Math.random();function rb(a){E.call(this);this.id=a;this.ab=new Ja;this.Rd=D();this.Lk=p;this.Ol=[];this.Pd=[];this.Qm={}}A(rb,E);rb.prototype.ee=function(){return new eb(this)};function sb(){this.Bl=new xa;this.primitiveType=4;this.Zm=this.Ak=0};function tb(){var a=new rb("pumpkin"),b=a.ab,c=[-0.5,-1,0,0.5,1,0.5],d=b.min,b=b.max;if(c.length){var e=0;C(d,c[e],c[e+1],c[e+2]);C(b,c[e],c[e+1],c[e+2]);e++;for(var f=1;f<c.length/3;f++,e++)c[e]<d[0]?d[0]=c[e]:c[e]>b[0]&&(b[0]=c[e]),c[e+1]<d[1]?d[1]=c[e+1]:c[e+1]>b[1]&&(b[1]=c[e+1]),c[e+2]<d[2]?d[2]=c[e+2]:c[e+2]>b[2]&&(b[2]=c[e+2])}else C(d,0,0,0),C(b,0,0,0);Wa(a.Rd,0,0,0,1);c=Va(96,112,112,128);d=Va(112,112,128,128);b=Va(96,96,112,112);Ya(c,c);Ya(d,d);Ya(b,b);c=new Float32Array([-0.5,-1,0.5,0,
0,1,c[2],c[3],0.5,-1,0.5,0,0,1,c[0],c[3],0.5,1,0.5,0,0,1,c[0],c[1],-0.5,1,0.5,0,0,1,c[2],c[1],-0.5,-1,-0.5,0,0,-1,d[0],d[3],-0.5,1,-0.5,0,0,-1,d[0],d[1],0.5,1,-0.5,0,0,-1,d[2],d[1],0.5,-1,-0.5,0,0,-1,d[2],d[3],-0.5,1,-0.5,0,1,0,b[2],b[1],-0.5,1,0.5,0,1,0,b[2],b[3],0.5,1,0.5,0,1,0,b[0],b[3],0.5,1,-0.5,0,1,0,b[0],b[1],-0.5,-1,-0.5,0,-1,0,c[0],c[1],0.5,-1,-0.5,0,-1,0,c[2],c[1],0.5,-1,0.5,0,-1,0,c[2],c[3],-0.5,-1,0.5,0,-1,0,c[0],c[3],0.5,-1,-0.5,1,0,0,c[0],c[3],0.5,1,-0.5,1,0,0,c[0],c[1],0.5,1,0.5,1,
0,0,c[2],c[1],0.5,-1,0.5,1,0,0,c[2],c[3],-0.5,-1,-0.5,-1,0,0,c[2],c[3],-0.5,-1,0.5,-1,0,0,c[0],c[3],-0.5,1,0.5,-1,0,0,c[0],c[1],-0.5,1,-0.5,-1,0,0,c[2],c[1]]);d=new Uint16Array(36);for(f=e=b=0;6>b;b++,e+=6,f+=4)d[e+0]=0+f,d[e+1]=1+f,d[e+2]=2+f,d[e+3]=0+f,d[e+4]=2+f,d[e+5]=3+f;a.Lk=new va(c.buffer,d);c=new sb;a.Ol.push(c);c.primitiveType=4;c.Ak=36;c=new db;c.index=a.Pd.length;c.name=p;c.parent=p;a.Pd.push(c);d=c.ab;b=a.ab;Ca(d.min,b.min);Ca(d.max,b.max);Xa(c.Rd,a.Rd);return a};var ub=Array.prototype,vb=ub.indexOf?function(a,b,c){return ub.indexOf.call(a,b,c)}:function(a,b,c){c=c==p?0:0>c?Math.max(0,a.length+c):c;if(ma(a))return!ma(b)||1!=b.length?-1:a.indexOf(b,c);for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},wb=ub.forEach?function(a,b,c){ub.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=ma(a)?a.split(""):a,f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)},xb=ub.filter?function(a,b,c){return ub.filter.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=[],f=
0,h=ma(a)?a.split(""):a,k=0;k<d;k++)if(k in h){var i=h[k];b.call(c,i,k,a)&&(e[f++]=i)}return e},yb=ub.map?function(a,b,c){return ub.map.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=Array(d),f=ma(a)?a.split(""):a,h=0;h<d;h++)h in f&&(e[h]=b.call(c,f[h],h,a));return e},zb=ub.some?function(a,b,c){return ub.some.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=ma(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return m;return r};
function Ab(a){if(!ka(a))for(var b=a.length-1;0<=b;b--)delete a[b];a.length=0}function Bb(a,b){var c=vb(a,b),d;(d=0<=c)&&ub.splice.call(a,c,1);return d}function Cb(a){return ub.concat.apply(ub,arguments)}function Db(a){var b=a.length;if(0<b){for(var c=Array(b),d=0;d<b;d++)c[d]=a[d];return c}return[]}function Eb(a,b){ub.sort.call(a,b||Fb)}function Fb(a,b){return a>b?1:a<b?-1:0};var Gb=v.postMessage?[v]:[];function M(a){for(var b=0;b<Gb.length;b++){for(var c=Array(arguments.length),d=0;d<c.length;d++)c[d]=arguments[d];try{Gb[b].postMessage({type:"gf_log",args:c},p)}catch(e){}}}if(v.console)var Hb=v.console,M=y(Hb.log,Hb);function Ib(){E.call(this);this.pd={}}A(Ib,E);Ib.prototype.b=function(){for(var a in this.pd)K(this.pd[a]);this.pd={};Ib.d.b.call(this)};Ib.prototype.update=aa();function Jb(a){Ib.call(this);this.Jc=a;this.Mi={}}A(Jb,Ib);function Kb(a){Jb.call(this,a);this.Mi.pumpkin={id:"pumpkin",xk:tb}}A(Kb,Jb);function Lb(){this.ni="improved";this.Qe=0};function Mb(){this.q=Array(256)}function Nb(a,b){a.q[b.id]=b};function Ob(a,b,c,d,e,f,h){this.Nc=a;this.Eh=b;this.Fh=c;this.Gh=d;this.$=e;this.Yf=f;this.Xi=h};function Pb(a,b,c,d){this.map=a;this.x=b;this.y=c;this.l=d;this.ab=Ka(b,c,d,b+16,c+128,d+16);this.state=Qb;this.bc=m;this.version=this.Na=0;this.$=new Uint16Array(32768);this.ln=this.ub=p}var Qb=0;Pb.prototype.fill=function(a){for(var b=0;32768>b;b++)this.$[b]=a[b];this.bc=m;this.state=2;this.map.Be(this);this.map.uf(this)};Pb.prototype.ra=function(a,b,c,d){b=(a&15)+16*(c&15)+256*(b&127);a=this.$[b];this.$[b]=d;a!=d&&!this.bc&&(d=this.bc,this.bc=m,this.ub=p,d||this.map.uf(this));return a};
Pb.prototype.rg=function(a){var b=Rb[0];La(this.ab,a,b);var c=Math.floor(b[0]),d=Math.floor(b[1]),e=Math.floor(b[2]),f=0==a[3]?0:0>a[3]?-1:1,h=0==a[4]?0:0>a[4]?-1:1,k=0==a[5]?0:0>a[5]?-1:1,i=(c+(0<f?1:0)-b[0])/a[3],l=(d+(0<h?1:0)-b[1])/a[4],n=(e+(0<k?1:0)-b[2])/a[5];isNaN(i)&&(i=Number.POSITIVE_INFINITY);isNaN(l)&&(l=Number.POSITIVE_INFINITY);isNaN(n)&&(n=Number.POSITIVE_INFINITY);var q=f/a[3],u=h/a[4],w=k/a[5];isNaN(q)&&(q=Number.POSITIVE_INFINITY);isNaN(u)&&(u=Number.POSITIVE_INFINITY);isNaN(w)&&
(w=Number.POSITIVE_INFINITY);for(var F=this.$,H=b=0;256>H;H++){var G=c-this.x,I=d-this.y,N=e-this.l;if(0<=G&&(16>G&&0<=I&&128>I&&0<=N&&16>N)&&(b=F[G+16*N+256*I],b>>8))break;i<l&&i<n?(i+=q,c+=f):l<n?(l+=u,d+=h):(n+=w,e+=k)}return b?(f=Sb,h=c+1,k=d+1,i=e+1,C(f.min,c,d,e),C(f.max,h,k,i),f=B(),La(Sb,a,f),new Ob(this,c,d,e,b,Math.sqrt(Ga(a,f)),f)):p};var Rb=[B(),B()],Sb=new Ja;function Tb(){E.call(this);this.ua={};this.Wb=[];this.af=this.Lj=0}A(Tb,E);t=Tb.prototype;t.b=function(){this.Wb.length=0;Tb.d.b.call(this)};t.update=function(){for(;this.Wb.length;){var a=this.Wb.shift();Ub(this,a)}};t.get=function(a,b,c){return 0!=b>>7?p:this.ua[(a>>4&65535)<<16|c>>4&65535]||p};t.add=function(a){this.ua[(a.x>>4&65535)<<16|a.l>>4&65535]=a;0<a.Na||this.Wb.push(a);this.Lj++;this.af+=65792};t.remove=function(a){Ub(this,a);0<a.Na||Bb(this.Wb,a)};
function Ub(a,b){delete a.ua[(b.x>>4&65535)<<16|b.l>>4&65535];a.af-=65792;a.Lj--}t.ze=function(a){this.Wb.push(a)};t.Ae=function(a){Bb(this.Wb,a)};function Vb(){E.call(this);this.jm=Ba(0,191/255,1);this.Lm=Ba(110/255,110/255,110/255);this.sn=Ba(1,1,-0.5);this.rn=Ba(130/255,130/255,130/255);this.Hk=Ba(1,1,1);Ca(this.Hk,this.jm)}A(Vb,E);Vb.prototype.update=aa();function Wb(a,b,c,d,e){this.id=a;this.name=b;this.Bl=c;this.z=d;this.pn=0;this.cn=1;this.tn=0;this.Mm=e};function Xb(a,b,c,d,e){Wb.call(this,a,b,c,d,e)}A(Xb,Wb);function Yb(a,b){var c=Va(0,0,0,0);this.z=a;this.Km=b||p;this.mn=p;this.color=c||D()};var Zb=new Yb(17,"block_gravel"),$b=new Yb(17,"block_stone"),ac=new Yb(17,"block_wood"),bc=new Yb(97,"block_stone"),cc=new Yb(17,"block_cloth");function dc(){Wb.call(this,6,"Red Cloth",cc,17,129)}A(dc,Xb);function ec(){Wb.call(this,7,"Green Cloth",cc,17,145)}A(ec,Xb);function fc(){Wb.call(this,8,"Yellow Cloth",cc,17,162)}A(fc,Xb);function gc(){Wb.call(this,9,"Blue Cloth",cc,17,177)}A(gc,Xb);function hc(){Wb.call(this,3,"Brick",$b,17,7)}A(hc,Xb);function ic(){Wb.call(this,1,"Dirt",Zb,17,2)}A(ic,Xb);function jc(){Wb.call(this,5,"Glass",bc,17,49)}A(jc,Xb);function kc(){Wb.call(this,2,"Stone",$b,17,1)}A(kc,Xb);function lc(){Wb.call(this,4,"Wood",ac,17,4)}A(lc,Xb);function mc(){E.call(this);this.A=new Mb;Nb(this.A,new ic);Nb(this.A,new kc);Nb(this.A,new hc);Nb(this.A,new lc);Nb(this.A,new jc);Nb(this.A,new dc);Nb(this.A,new ec);Nb(this.A,new fc);Nb(this.A,new gc);this.ci=new Vb;J(this,this.ci);this.Ya=[];this.Ab=new Tb;J(this,this.Ab)}A(mc,E);t=mc.prototype;t.b=function(){mc.d.b.call(this)};t.update=function(a){this.ci.update(a);this.Ab.update(a)};
t.fc=function(a,b,c){var d=this.Ab.get(a,b,c);if(d)return d;d=new Pb(this,a&-16,b&-128,c&-16);this.Ab.add(d);this.Ne(d);return d};t.Be=function(a){for(var b=0;b<this.Ya.length;b++){var c=this.Ya[b],d=c.bb,e=a.ab,f=d.min,d=d.max,h=e.min,e=e.max;-1!=(d[0]<h[0]||f[0]>e[0]||d[1]<h[1]||f[1]>e[1]||d[2]<h[2]||f[2]>e[2]?-1:f[0]>h[0]||e[0]>d[0]||f[1]>h[1]||e[1]>d[1]||f[2]>h[2]||e[2]>d[2]?0:1)&&c.Be(a)}};t.uf=x;t.ze=function(a){this.Ab.ze(a)};t.Ae=function(a){this.Ab.Ae(a)};t.Ne=x;
t.ra=function(a,b,c,d){var e=this.Ab.get(a,b,c);if(e){if(2!=e.state)return M("setBlock before chunk fully loaded - inconsistent state!"),0}else return 0;e=e.ra(a,b,c,d);if(e!=d)for(d=0;d<this.Ya.length;d++)for(var f=this.Ya[d],h=a,k=b,i=c,l=0;l<f.n.length;l++)f.n[l].zi(h,k,i,0);return e};function nc(a,b){this.Gi=a;this.A=b}nc.prototype.me=x;function oc(a,b){nc.call(this,a,b)}A(oc,nc);oc.prototype.me=function(a,b,c,d,e){if(0>=c&&0<=c){a=b+16;for(c=d+16;b<a;b++)for(var f=d;f<c;f++)e.ra(b,0,f,256)}};function pc(a){this.Qb=qc(32);this.Rb=qc(32);this.Sb=qc(32);this.Nh=1;a=fa(a)?a:z();this.Qb-=qc(a);0>this.Qb&&(this.Qb+=1);this.Rb-=qc(a);0>this.Rb&&(this.Rb+=1);this.Sb-=qc(a);0>this.Sb&&(this.Sb+=1);for(a=0;100>a;a++)this.random()}function qc(a){a=a.toString();for(var b=4022871197,c=0;c<a.length;c++)var b=b+a.charCodeAt(c),d=0.02519603282416938*b,b=d>>>0,d=d-b,d=d*b,b=d>>>0,d=d-b,b=b+4294967296*d;return 2.3283064365386963E-10*(b>>>0)}
pc.prototype.random=function(){var a=2091639*this.Qb+2.3283064365386963E-10*this.Nh;this.Qb=this.Rb;this.Rb=this.Sb;return this.Sb=a-(this.Nh=a|0)};function rc(a){this.jc=new Float32Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1]);this.sc=new Uint8Array(512);for(var b=0;256>b;b++)this.sc[b]=this.sc[256+b]=~~(255*a.random())}function sc(a,b,c,d){a=a.jc;return a[3*b]*c+a[3*b+1]*d}
rc.prototype.sb=function(a,b){var c,d,e;e=(a+b)*0.5*(Math.sqrt(3)-1);var f=Math.floor(a+e),h=Math.floor(b+e),k=(3-Math.sqrt(3))/6;e=(f+h)*k;c=a-(f-e);var i=b-(h-e),l,n;c>i?(l=1,n=0):(l=0,n=1);d=c-l+k;var q=i-n+k;e=c-1+2*k;var k=i-1+2*k,u=f&255,h=h&255,w=this.sc,f=w[u+w[h]]%12;l=w[u+l+w[h+n]]%12;n=w[u+1+w[h+1]]%12;u=0.5-c*c-i*i;0>u?c=0:(u*=u,c=u*u*sc(this,f,c,i));i=0.5-d*d-q*q;0>i?d=0:(i*=i,d=i*i*sc(this,l,d,q));q=0.5-e*e-k*k;0>q?e=0:(q*=q,e=q*q*sc(this,n,e,k));return 70*(c+d+e)};function tc(a,b){nc.call(this,a,b);var c=new pc(a.Qe);this.Bg=new rc(c)}A(tc,nc);tc.prototype.me=function(a,b,c,d,e){a=this.Bg;for(c=0;16>c;c++)for(var f=b+c,h=0;16>h;h++){var k=d+h,i=0.5*a.sb(0.001*f,0.001*k),i=i+0.25*a.sb(0.002*(f+100),0.002*k),i=i+0.25*a.sb(0.01*(f+100),0.01*k),l=25.6*i+64|0;1>l&&(l=1);e.ra(c,l,h,257);var k=e,n=c&15,i=0,l=l-1&127,q=h&15;if(i>l)var u=i,i=l,l=u;for(n=n+16*q+256*i;i<=l;i++,n+=256)k.$[n]=256}};function uc(a,b){this.qi=b||15;this.jc=new Float32Array(512);this.sc=new Uint8Array(256);for(var c=0;256>c;c++){var d=2*Math.PI*a.random();this.jc[c]=Math.cos(d);this.jc[256+c]=Math.sin(d);this.sc[c]=~~(255*a.random())}}
uc.prototype.sb=function(a,b){for(var c=a/this.qi,d=b/this.qi,e=~~c,f=~~d,h=0;4>h;h++){var k=e+h%2,i=f+~~(h/2),l=i+this.sc[k]&255;vc[h]=this.jc[l]*(c-k)+this.jc[256+l]*(d-i)}c-=~~c;d-=~~d;c=3*Math.pow(c,2)-2*Math.pow(c,3);e=vc[0]+c*(vc[1]-vc[0]);return e+(3*Math.pow(d,2)-2*Math.pow(d,3))*(vc[2]+c*(vc[3]-vc[2])-e)};var vc=new Float32Array(4);function wc(a,b){nc.call(this,a,b);var c=new pc(a.Qe);this.Bg=new uc(c,15)}A(wc,nc);wc.prototype.me=function(a,b,c,d,e){a=this.Bg;c=b+16;for(var f=d+16;b<c;b++)for(var h=d;h<f;h++){var k;k=a;var i=b+1E3,l=h+1E3;k=(k.sb(i+16,l+16)*(16-i)*(16-l)+k.sb(i,l+16)*i*(16-l)+k.sb(i,l)*i*l+k.sb(i+16,l)*(16-i)*l)/256;k=Math.max(0,Math.min(15,k/1E3|0));for(i=0;i<=64+k;i++)l=256,i>=64+k&&(l|=1),e.ra(b,i,h,l)}};var xc={flat:oc,noise:wc,improved:tc};function yc(){this.$=new Uint16Array(32768);this.Gm=new Uint16Array(32768)}yc.prototype.ka=function(){this.$.set(this.Gm)};yc.prototype.end=s("$");yc.prototype.ra=function(a,b,c,d){this.$[(a&15)+16*(c&15)+256*(b&127)]=d};var zc;var Ac=v.performance;zc=Ac&&Ac.now?function(){return Ac.now()}:Ac&&Ac.webkitNow?function(){return Ac.webkitNow()}:j;var Bc=zc?zc:Date.now;function Cc(a,b){for(var c in a)b.call(j,a[c],c,a)}function Dc(a){var b=[],c=0,d;for(d in a)b[c++]=a[d];return b}function Ec(a){var b=[],c=0,d;for(d in a)b[c++]=d;return b}function Fc(a){var b={},c;for(c in a)b[c]=a[c];return b}var Gc="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");
function Hc(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var f=0;f<Gc.length;f++)c=Gc[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}};function Ic(a){if("function"==typeof a.za)return a.za();if(ma(a))return a.split("");if(la(a)){for(var b=[],c=a.length,d=0;d<c;d++)b.push(a[d]);return b}return Dc(a)}function Jc(a,b,c){if("function"==typeof a.forEach)a.forEach(b,c);else if(la(a)||ma(a))wb(a,b,c);else{var d;if("function"==typeof a.Ka)d=a.Ka();else if("function"!=typeof a.za)if(la(a)||ma(a)){d=[];for(var e=a.length,f=0;f<e;f++)d.push(f)}else d=Ec(a);else d=j;for(var e=Ic(a),f=e.length,h=0;h<f;h++)b.call(c,e[h],d&&d[h],a)}};function Kc(a,b){this.Ci=a;this.xh=b}Kc.prototype.getKey=s("Ci");Kc.prototype.w=function(){return new Kc(this.Ci,this.xh)};function Lc(a){this.La=[];if(a)a:{var b,c;if(a instanceof Lc){if(b=a.Ka(),c=a.za(),0>=a.fa()){a=this.La;for(var d=0;d<b.length;d++)a.push(new Kc(b[d],c[d]));break a}}else b=Ec(a),c=Dc(a);for(d=0;d<b.length;d++)Mc(this,b[d],c[d])}}function Mc(a,b,c){var d=a.La;d.push(new Kc(b,c));b=d.length-1;a=a.La;for(c=a[b];0<b;)if(d=b-1>>1,a[d].getKey()>c.getKey())a[b]=a[d],b=d;else break;a[b]=c}t=Lc.prototype;
t.remove=function(){var a=this.La,b=a.length,c=a[0];if(!(0>=b)){if(1==b)Ab(a);else{a[0]=a.pop();for(var a=0,b=this.La,d=b.length,e=b[a];a<d>>1;){var f=2*a+1,h=2*a+2,f=h<d&&b[h].getKey()<b[f].getKey()?h:f;if(b[f].getKey()>e.getKey())break;b[a]=b[f];a=f}b[a]=e}return c.xh}};t.za=function(){for(var a=this.La,b=[],c=a.length,d=0;d<c;d++)b.push(a[d].xh);return b};t.Ka=function(){for(var a=this.La,b=[],c=a.length,d=0;d<c;d++)b.push(a[d].getKey());return b};
t.Cb=function(a){return zb(this.La,function(b){return b.getKey()==a})};t.w=function(){return new Lc(this)};t.fa=function(){return this.La.length};t.clear=function(){Ab(this.La)};function Nc(){Lc.call(this)}A(Nc,Lc);Nc.prototype.ie=function(a,b){Mc(this,a,b)};function Oc(a,b,c){E.call(this);this.oi=b;this.od=c;this.oe=new Nc;this.vc=r;this.td=p;this.Hf=new yc}A(Oc,E);Oc.prototype.b=function(){this.vc&&(this.vc=r,v.clearTimeout(this.td),this.td=p);Oc.d.b.call(this)};Oc.prototype.update=aa();Oc.prototype.Ne=function(a,b){var c=fa(b)?b:Number.MAX_VALUE;a.state=1;var d=this.od,e=new O,f=new Pc(e,Qc,a.x,a.y,a.l);f.Nc=a;f.uc=c;d.pa.push(f);d.rc||d.ob();d.yg=m;P(e,aa(),function(){this.oe.ie(c,a);this.vc||(this.vc=m,this.td=v.setTimeout(y(this.cj,this),5))},this)};
Oc.prototype.cj=function(){for(var a=Bc();this.oe.fa();){var b=this.oe.remove(),c=new pc(this.oi.Gi.Qe);this.Hf.ka();this.oi.me(c,b.x,b.y,b.l,this.Hf);b.fill(this.Hf.end());if(16<Bc()-a)break}this.oe.fa()?(this.vc=m,this.td=v.setTimeout(y(this.cj,this),5)):(this.vc=r,this.td=p)};function Rc(){E.call(this)}A(Rc,E);Rc.prototype.update=aa();/*
 Portions of this code are from MochiKit, received by
 The Closure Authors under the MIT license. All other code is Copyright
 2005-2009 The Closure Authors. All Rights Reserved.
*/
function O(a,b){this.Re=[];this.Ri=a;this.Zh=b||p}t=O.prototype;t.Gb=r;t.cd=r;t.Cf=r;t.kk=r;t.fh=r;t.Df=0;t.cancel=function(a){if(this.Gb)this.xd instanceof O&&this.xd.cancel();else{if(this.P){var b=this.P;delete this.P;a?b.cancel(a):(b.Df--,0>=b.Df&&b.cancel())}this.Ri?this.Ri.call(this.Zh,this):this.fh=m;this.Gb||this.a(new Sc(this))}};t.Uh=function(a,b){this.Cf=r;Tc(this,a,b)};function Tc(a,b,c){a.Gb=m;a.xd=c;a.cd=!b;Uc(a)}function Vc(a){a.Gb&&(a.fh||g(new Wc(a)),a.fh=r)}
t.e=function(a){Vc(this);Tc(this,m,a)};t.a=function(a){Vc(this);Tc(this,r,a)};function P(a,b,c,d){a.Re.push([b,c,d]);a.Gb&&Uc(a);return a}function Xc(a){return zb(a.Re,function(a){return na(a[1])})}
function Uc(a){a.ph&&(a.Gb&&Xc(a))&&(v.clearTimeout(a.ph),delete a.ph);a.P&&(a.P.Df--,delete a.P);for(var b=a.xd,c=r,d=r;a.Re.length&&!a.Cf;){var e=a.Re.shift(),f=e[0],h=e[1],e=e[2];if(f=a.cd?h:f)try{var k=f.call(e||a.Zh,b);fa(k)&&(a.cd=a.cd&&(k==b||k instanceof Error),a.xd=b=k);b instanceof O&&(d=m,a.Cf=m)}catch(i){b=i,a.cd=m,Xc(a)||(c=m)}}a.xd=b;d&&(P(b,y(a.Uh,a,m),y(a.Uh,a,r)),b.kk=m);c&&(a.ph=v.setTimeout(function(){g(b)},0))}function Yc(a){var b=new O;b.e(a);return b}
function Zc(a){var b=new O;b.a(a);return b}function Wc(a){ib.call(this);this.la=a}A(Wc,ib);Wc.prototype.message="Deferred has already fired";Wc.prototype.name="AlreadyCalledError";function Sc(a){ib.call(this);this.la=a}A(Sc,ib);Sc.prototype.message="Deferred was cancelled";Sc.prototype.name="CancelledError";function $c(a,b,c,d,e,f){O.call(this,e,f);this.q=a;this.Qf=[];this.ii=!!b;this.Dk=!!c;this.vk=!!d;for(b=0;b<a.length;b++)P(a[b],y(this.ri,this,b,m),y(this.ri,this,b,r));0==a.length&&!this.ii&&this.e(this.Qf)}A($c,O);$c.prototype.Qi=0;$c.prototype.ri=function(a,b,c){this.Qi++;this.Qf[a]=[b,c];this.Gb||(this.ii&&b?this.e([a,c]):this.Dk&&!b?this.a(c):this.Qi==this.q.length&&this.e(this.Qf));this.vk&&!b&&(c=p);return c};$c.prototype.a=function(a){$c.d.a.call(this,a);wb(this.q,function(a){a.cancel()})};function ad(a,b){mc.call(this);var c;(c=xc[a.ni])||(c=xc.flat);c=new c(a,this.A);this.Gi=a;this.od=b;J(this,this.od);this.tb=new Rc;J(this,this.tb);this.Jf=new Oc(0,c,b);J(this,this.Jf);this.he=[]}A(ad,mc);ad.prototype.update=function(a){ad.d.update.call(this,a);this.tb.update(a);this.Jf.update(a);this.flush();this.od.update(a)};ad.prototype.uf=function(a){this.he.push(a);a.Na||a.map.Ae(a);a.Na++};
ad.prototype.flush=function(){for(var a=[],b=0;b<this.he.length;b++){var c=this.he[b];a.push(bd(this.od,c));c.bc=r;c.Na--;c.Na||c.map.ze(c)}this.he.length=0;return new $c(a)};ad.prototype.Ne=function(a){for(var b=Number.MAX_VALUE,c=0;c<this.Ya.length;c++){var d=this.Ya[c],e=a.x-d.Ha[0],d=a.l-d.Ha[2],e=e*e+d*d;e<b&&(b=e)}b==Number.MAX_VALUE&&(b=j);this.Jf.Ne(a,b)};function cd(a){this.factory=a;this.ta=this.$e=0}cd.prototype.getTime=s("$e");cd.prototype.read=function(a){var b=this.factory.z;b&2&&(this.$e=a.s()/1E3);b&4||(this.ta=a.s())};cd.prototype.write=function(a){var b=this.factory.z;b&2&&a.t(1E3*this.$e|0);b&4||a.t(this.ta)};cd.prototype.Ob=function(){this.factory.Ob(this)};function dd(a){cd.call(this,a);this.jh=0;this.qe=r}A(dd,cd);dd.prototype.read=function(a){dd.d.read.call(this,a);this.jh=a.s()/1E3;this.qe=r};
dd.prototype.write=function(a){dd.d.write.call(this,a);a.t(1E3*this.jh|0)};function ed(a){cd.call(this,a);this.Hg=0}A(ed,cd);ed.prototype.read=function(a){ed.d.read.call(this,a);this.Hg=a.s()};ed.prototype.write=function(a){ed.d.write.call(this,a);a.t(this.Hg)};function fd(a,b,c,d){E.call(this);this.Y=a;this.factory=b;this.ha=p;this.D=c;this.Ja=d;this.P=p;this.J=[];this.T=0;this.g=gd(b,this);this.zd=[]}A(fd,E);t=fd.prototype;t.b=function(){var a=this.getParent();a&&(Bb(a.J,this),a.$b(this));this.factory.Xe.push(this.g);for(a=0;a<this.zd.length;a++)this.factory.Xe.push(this.zd[a]);fd.d.b.call(this)};
function hd(a,b){for(var c="",d=0;d<b;d++)c+="..";M(c+"Entity "+a.D+" / type "+a.factory.Ga+(a.ha?" / owner "+a.ha.c:""));if(a.J.length)for(d=0;d<a.J.length;d++)hd(a.J[d],b+1)}t.ga=s("Y");t.getParent=s("P");function id(a,b){if(a.P!=b){var c=a.P;a.P=b;if(!(a.Ja&jd)){var d=a.Of(0);d.Hg=b?b.D:0;kd(a.Y,d)}a.Fg(c,b);c&&(Bb(c.J,a),c.$b(a));b&&b.tf(a)}}t.tf=function(a){this.J.push(a);this.Zd(a)};t.Fg=x;t.Zd=x;t.$b=x;t.jg=ca(p);t.read=function(a){this.g.read(a)};t.Sg=function(a){this.g.Sg(a)};t.write=function(a){this.g.write(a)};
t.zh=function(a){this.g.zh(a)};function ld(a,b){if(a.Ja&md){1==a.zd.length&&(a.zd[0].time=b);var c=gd(a.factory,a);c.time=b;a.g.Nf(c);a.zd.push(c)}}t.xi=x;t.Of=function(a){a=nd(this.Y.Sa[a]||p);a.ta=this.D;return a};t.ma=aa();function od(a,b,c){a.Xf||pd(a.Y.tb,b,c===j?0:c,a.update,a)}t.Mg=aa();t.Sl=x;t.wd=function(){this.T=0;this.g.wd()};var jd=1,md=8;function qd(){this.Ic=[];this.f=0}qd.prototype.compact=aa();qd.prototype.fa=s("f");qd.prototype.yb=function(a){this.Ic[this.f++]=a};function rd(a){for(var b=0;b<a.f;b++){var c=a.Ic[b];c.factory.Ob(c)}a.f=0};function sd(){this.buffer=new Uint8Array(512);this.offset=0;this.U=new Float32Array(16);this.ea=new Uint8Array(this.U.buffer);this.Gk=(this.Yc=v.Float64Array?new Float64Array(1):p)?new Uint8Array(this.Yc.buffer):p}t=sd.prototype;t.hb=function(){this.offset=0};t.finish=function(){for(var a=new Uint8Array(this.offset),b=0;b<this.offset;b++)a[b]=this.buffer[b];this.offset=0;return a.buffer};
function td(a,b){if(a.offset+b>a.buffer.length){var c=a.offset+b,d=a.buffer.length;do d+=1024;while(d<c);c=new Uint8Array(d);for(d=0;d<a.offset;d++)c[d]=a.buffer[d];a.buffer=c}}function ud(a,b){td(a,2);a.buffer[a.offset++]=b>>8;a.buffer[a.offset++]=b}function vd(a,b){td(a,4);a.buffer[a.offset++]=b>>24;a.buffer[a.offset++]=b>>16;a.buffer[a.offset++]=b>>8;a.buffer[a.offset++]=b}function Q(a,b){td(a,1);a.buffer[a.offset++]=b}function wd(a,b){td(a,2);a.buffer[a.offset++]=b>>8;a.buffer[a.offset++]=b}
t.M=function(a){td(this,4);this.buffer[this.offset++]=a>>24;this.buffer[this.offset++]=a>>16;this.buffer[this.offset++]=a>>8;this.buffer[this.offset++]=a};t.t=function(a){td(this,5);for(a&=4294967295;a&4294967168;)this.buffer[this.offset++]=a&127|128,a>>>=7;this.buffer[this.offset++]=a&127};t.of=function(a){this.t(a<<1^a>>31)};
t.Uj=function(a){td(this,4);this.U[0]=a;this.buffer[this.offset++]=this.ea[0];this.buffer[this.offset++]=this.ea[1];this.buffer[this.offset++]=this.ea[2];this.buffer[this.offset++]=this.ea[3]};t.Em=function(a){td(this,12);this.U[0]=a[0];this.U[1]=a[1];this.U[2]=a[2];for(a=0;12>a;a++)this.buffer[this.offset++]=this.ea[a]};t.Fm=function(a){td(this,16);this.U[0]=a[0];this.U[1]=a[1];this.U[2]=a[2];this.U[3]=a[3];for(a=0;16>a;a++)this.buffer[this.offset++]=this.ea[a]};
t.o=function(a){65535<=a.length&&(a=a.substr(0,65535));td(this,4+3*a.length);wd(this,a.length);var b=this.offset;this.offset+=2;for(var c=0,d=0;d<a.length;d++){var e=a.charCodeAt(d);128>e?(this.buffer[this.offset++]=e,c++):2048>e?(this.buffer[this.offset++]=e>>6|192,this.buffer[this.offset++]=e&63|128,c+=2):(this.buffer[this.offset++]=e>>12|224,this.buffer[this.offset++]=e>>6&63|128,this.buffer[this.offset++]=e&63|128,c+=3)}a=this.offset;this.offset=b;wd(this,c);this.offset=a};var xd=p;
function R(){xd||(xd=new sd);return xd};function yd(){this.Mh=this.Td=this.yn=this.Xm=this.Ii=this.Ji=this.Od=0}yd.prototype.w=function(){return new yd};yd.prototype.toString=ca("[stats]");var zd,Ad,Bd,Cd,Dd;function Ed(){return v.navigator?v.navigator.userAgent:p}Cd=Bd=Ad=zd=r;var Fd;if(Fd=Ed()){var Gd=v.navigator;zd=0==Fd.indexOf("Opera");Ad=!zd&&-1!=Fd.indexOf("MSIE");Bd=!zd&&-1!=Fd.indexOf("WebKit");Cd=!zd&&!Bd&&"Gecko"==Gd.product}var Hd=zd,Id=Ad,Jd=Cd,Kd=Bd,Ld,Od=v.navigator;Ld=Od&&Od.platform||"";Dd=-1!=Ld.indexOf("Mac");var Pd=-1!=Ld.indexOf("Win");function Qd(){var a=v.document;return a?a.documentMode:j}var Rd;
a:{var Sd="",Td;if(Hd&&v.opera)var Ud=v.opera.version,Sd="function"==typeof Ud?Ud():Ud;else if(Jd?Td=/rv\:([^\);]+)(\)|;)/:Id?Td=/MSIE\s+([^\);]+)(\)|;)/:Kd&&(Td=/WebKit\/(\S+)/),Td)var Vd=Td.exec(Ed()),Sd=Vd?Vd[1]:"";if(Id){var Wd=Qd();if(Wd>parseFloat(Sd)){Rd=String(Wd);break a}}Rd=Sd}var Xd={};
function Yd(a){var b;if(!(b=Xd[a])){b=0;for(var c=kb(String(Rd)).split("."),d=kb(String(a)).split("."),e=Math.max(c.length,d.length),f=0;0==b&&f<e;f++){var h=c[f]||"",k=d[f]||"",i=RegExp("(\\d*)(\\D*)","g"),l=RegExp("(\\d*)(\\D*)","g");do{var n=i.exec(h)||["","",""],q=l.exec(k)||["","",""];if(0==n[0].length&&0==q[0].length)break;b=((0==n[1].length?0:parseInt(n[1],10))<(0==q[1].length?0:parseInt(q[1],10))?-1:(0==n[1].length?0:parseInt(n[1],10))>(0==q[1].length?0:parseInt(q[1],10))?1:0)||((0==n[2].length)<
(0==q[2].length)?-1:(0==n[2].length)>(0==q[2].length)?1:0)||(n[2]<q[2]?-1:n[2]>q[2]?1:0)}while(0==b)}b=Xd[a]=0<=b}return b}var Zd=v.document,$d=!Zd||!Id?j:Qd()||("CSS1Compat"==Zd.compatMode?parseInt(Rd,10):5);(function(){var a;return Pd?(a=/Windows NT ([0-9.]+)/,(a=a.exec(Ed()))?a[1]:"0"):Dd?(a=/10[_.][0-9_.]+/,(a=a.exec(Ed()))?a[0].replace(/_/g,"."):"10"):""})();function ae(){this.Sj="";this.type=be;this.platform=ce;this.rd="";this.Tc=de}ae.prototype.w=function(){var a=new ae;a.Sj=this.Sj;a.type=this.type;a.platform=this.platform;a.rd=this.rd;a.Tc=this.Tc;return a};ae.prototype.toString=function(){return[this.type,this.platform+this.rd,this.Tc].join("/")};var be="unknown",ce="other",de="desktop";function ee(){this.Md="none";this.Ld="0";this.ya="User"}ee.prototype.w=function(){var a=new ee;a.Md=this.Md;a.Ld=this.Ld;a.ya=this.ya;return a};ee.prototype.toString=ca("[user]");function fe(a,b,c,d,e){this.c=a||"";this.R=b||0;this.z=c||0;this.info=d||new ee;this.Jd=e||new ae;this.Tf=0;this.i=new yd;this.data=this.ja=p}fe.prototype.toString=function(){return this.info.ya+" ("+this.c+"/"+this.R+")"};function ge(a){return new fe(a.c,a.R,a.z,a.info.w(),a.Jd.w())};function he(a){this.sa=a;this.eb=0;this.ae=[];this.Bb=0;this.de=[];this.Db=0;this.bf=[];this.Xb=0;this.fe=[];this.Eb=0}he.prototype.ka=ba("eb");he.prototype.yb=function(a){this.ae[this.Bb++]=a};
he.prototype.finish=function(a){var b=R();Q(b,30);var c=0;b.t(1E3*a|0);b.t(this.eb);b.t(this.Db);b.t(this.Xb);b.t(this.Eb);b.t(this.Bb);for(a=0;a<this.Db;a++){var d=this.de[a];this.de[a]=p;c=b.offset;b.t(d.D>>1);b.t(d.factory.Ga);b.t(d.Ja);var e=d.ha;b.t(e?e.R:0);e=d.getParent();b.t(e?e.D:0);d.write(b);this.sa.je++;this.sa.cc+=b.offset-c}for(a=this.Db=0;a<this.Xb;a++)d=this.bf[a],this.bf[a]=p,c=b.offset,b.t(d.D>>1),d.zh(b),this.sa.le++,this.sa.ec+=b.offset-c;for(a=this.Xb=0;a<this.Eb;a++)d=this.fe[a],
this.fe[a]=p,c=b.offset,b.t(d.D>>1),this.sa.ke++,this.sa.dc+=b.offset-c;for(a=this.Eb=0;a<this.Bb;a++)d=this.ae[a],this.ae[a]=p,c=b.offset,b.t(d.factory.Ga),d.write(b),this.sa.Ce++,this.sa.pc+=b.offset-c;this.Bb=0;return b.finish()};he.prototype.hb=function(){for(var a=this.eb=0;a<this.Db;a++)this.de[a]=p;for(a=this.Db=0;a<this.Xb;a++)this.bf[a]=p;for(a=this.Xb=0;a<this.Eb;a++)this.fe[a]=p;for(a=this.Eb=0;a<this.Bb;a++)this.ae[a]=p;this.Bb=0};function ie(a,b,c){E.call(this);this.Pa=a;this.X=b;this.Gc=c;this.eb=this.Ei=0;this.Aa=new qd;this.Ba=new qd;this.mh={};this.df={};this.cf=[];this.xl=0;this.S=new he(a.i)}A(ie,E);ie.prototype.kb=s("Gc");ie.prototype.compact=function(){this.Aa.compact();this.Ba.compact()};function je(a,b){var c=b.Ja;if(!(c&jd)&&!(c&64&&b.ha!=a.Gc)){var c=b.D,d=0;a.mh[c]||(d|=1,a.mh[c]=m);var e=a.df[c]|0,d=e|d|b.T;e||a.cf.push(b);e!=d&&(a.df[c]=d)}}
ie.prototype.flush=function(a){this.xl=a;var b=this.S;b.ka(this.eb);var c=this.eb!=this.Ei;this.Ei=this.eb;var d=this.Ba.Ic,e=this.Ba.fa();if(e){for(var f=0;f<e;f++){var h=d[f];(0==h.ta||this.mh[h.ta])&&b.yb(h)}this.Ba.f=0}for(f=0;f<this.cf.length;f++)d=this.cf[f],e=d.D,h=this.df[e],delete this.df[e],h&&5!=(h&5)&&(h&4?b.fe[b.Eb++]=d:h&1?b.de[b.Db++]=d:h&2&&(b.bf[b.Xb++]=d));c||0<b.Bb+b.Db+b.Xb+b.Eb?this.X.send(b.finish(a),this.Gc):b.hb();this.cf.length=0};function ke(a,b,c){ie.call(this,a,b,c)}A(ke,ie);var le=new function(){this.l=this.y=this.x=0};function me(){var a=R();Q(a,74);return a.finish()};function ne(a){E.call(this);this.nj=a}A(ne,E);function oe(a){E.call(this);this.cm=a;this.Wg=[[],[],[],[],[]];this.Qj=[]}A(oe,E);function pd(a,b,c,d,e){var f=a.Qj.pop()||new pe;f.uc=b;f.Vg=a.cm.G.Ib;f.Ze=-1==c?0:0==c?f.Vg+0.001:c;f.e=d;f.Ff=e||v;a=a.Wg[b];b=0;for(c=a.length;b<c;)d=b+c>>1,0<f.Ze-a[d].Ze?b=d+1:c=d;a.splice(b,0,f)}var qe=Number.MAX_VALUE;
oe.prototype.update=function(a){a=a.time;for(var b=Bc(),c=this.Wg.length-1;0<=c;c--){for(var d=this.Wg[c];d.length;){var e=d[0];if(e.Ze>a)break;d.shift();var f=a-e.Vg,h=e.e,k=e.Ff;e.e=e.Ff=p;this.Qj.push(e);h.call(k,a,f)}if(Bc()-b>=qe)break}};function pe(){this.uc=re;this.Ze=this.Vg=0;this.Ff=this.e=p}var re=0;function se(){this.md=this.Ma=this.ue=this.Nl=this.ql=this.pc=this.Ce=this.kc=this.fd=this.dc=this.ke=this.ec=this.le=this.cc=this.je=0}se.prototype.update=function(a){this.Ma+=this.cc;this.Ma+=this.ec;this.Ma+=this.dc;this.ue+=this.kc;this.Ma+=this.pc;1<=a-this.md&&(this.md=a,this.ql=this.ue,this.Nl=this.Ma,this.Ma=this.ue=0);this.Ce=this.pc=this.fd=this.kc=this.ke=this.dc=this.le=this.ec=this.je=this.cc=0};function te(a,b,c){this.Ga=a;this.sk=b;this.z=c;this.qh=[]}function nd(a){return a.qh.length?(a=a.qh.pop(),a.ta=0,a):new a.sk(a)}te.prototype.Ob=function(a){this.qh.push(a)};function ue(a){ue[" "](a);return a}ue[" "]=x;var ve=!!v.wtf&&2==v.wtf.trace.API_VERSION,we=ve?v.wtf.trace.appendScopeData:x,xe=ve?v.wtf.trace.instrument:ia,ye=ve?v.wtf.trace.instrumentType:ia;function ze(a,b){ne.call(this,a);this.i=new se;this.tb=new oe(a);J(this,this.tb);this.kf=[];this.Sa={};this.Zf={};this.Ag=b;this.v={};this.Ac=p;this.xa=Array(256);this.wa=0;var c=new te(0,ed,0);this.Sa[c.Ga]=c}A(ze,ne);function Ae(a,b){a.Zf[b.Ga]=b}function Be(a){var b=a.Ag;a.Ag+=2;return b}t=ze.prototype;t.va=function(a,b){var c=this.Zf[a].va(this,Be(this),b);this.Zb(c);return c};t.Zb=function(a){this.v[a.D]=a;var b=!!a.T;a.T|=1;b||(this.xa[this.wa++]=a);a.Ja&128&&(this.Ac=a)};
t.ji=function(a,b){for(var c in this.v)a.call(b||v,this.v[Number(c)])};t.qb=function(a,b){if(!(a.T&4)){switch(b||Ce){default:case Ce:for(var c=a.J.length-1;0<=c;c--){var d=a.J[c];a.$b(d);a.Y.qb(d)}if(d=a.jg())for(c=0;c<d.length;c++)a.Y.qb(d[c]);break;case De:for(c=0;c<a.J.length;c++)id(a.J[c],p);if(d=a.jg())for(c=0;c<d.length;c++)id(d[c],p);case Ee:}delete this.v[a.D];c=!!a.T;a.T|=4;c||(this.xa[this.wa++]=a);K(a)}};t.Of=function(a){a=nd(this.Sa[a]||p);a.ta=0;return a};
t.Xc=function(a,b){for(var c=0;c<b;c++){var d=a[c],e=d.ta;0==e?this.ma(d):(e=this.v[e]||p)&&e.ma(d);d instanceof dd&&(d.qe=m)}};t.ma=x;t.Zi=function(){for(var a=0;a<this.wa;a++){var b=this.xa[a];b.Mg()}for(a=0;a<this.wa;a++){b=this.xa[a];this.xa[a]=p;if(b.T&1)for(var c=0;c<this.kf.length;c++)this.kf[c].$m(b);if(b.T&4)for(c=0;c<this.kf.length;c++)this.kf[c].an(b);b.wd()}this.wa=0};t.Og=function(a){for(var b=0;b<this.wa;b++){var c=this.xa[b];c.Sl(a);this.$i(a,c)}};t.$i=x;
t.tc=function(){for(var a=0;a<this.wa;a++){var b=this.xa[a];this.xa[a]=p;b.wd()}this.wa=0};var Ce=0,De=1,Ee=2,ze=ye(ze,"gf.sim.Simulator",{ji:"forEachEntity",Xc:"executeCommands",Zi:"postNetworkUpdateEntities",Og:"postTickUpdateEntities",tc:"postUpdate"});function Fe(){this.Pi=1;this.oh=[];this.Vb=0;this.Cg=[];this.qc=0;this.Vi=[];this.Dg=0}Fe.prototype.compact=aa();Fe.prototype.yb=function(a){this.Cg[this.qc++]=a;a instanceof dd&&(a.pj=this.Pi++,a.qe=r,this.Vi[this.Dg++]=a)};
Fe.prototype.write=function(a){a.t(this.Pi-1);var b=this.qc;a.t(this.qc);for(var c=0;c<this.qc;c++){var d=this.Cg[c];this.Cg[c]=p;a.t(d.factory.Ga);d.write(a);d instanceof dd?this.oh[this.Vb++]=d:d.factory.Ob(d)}this.Dg=this.qc=0;1500<this.Vb&&M("massive backup of commands, dying");return b};function S(a,b){ze.call(this,a,1);this.X=b;Ge(b.Mb,30,this.ti,this);this.ve=[];this.Aa=new qd;this.Ba=new Fe;this.ld=0}A(S,ze);S.prototype.b=function(){S.d.b.call(this)};S.prototype.kb=function(a){return this.X.Yb[a]||p};S.prototype.Zb=function(a){S.d.Zb.call(this,a);a.Ja&(4|md)&&this.ve.push(a)};S.prototype.qb=function(a,b){S.d.qb.call(this,a,b);a.Ja&(4|md)&&Bb(this.ve,a)};S.Yj=20;
S.prototype.update=function(a){var b=He(this.nj.G)+this.nj.G.$d;this.yi(b-0.5);this.Xc(this.Aa.Ic,this.Aa.fa());rd(this.Aa);this.tb.update(a);this.Og(a);this.oj(a);this.tc(a);this.Pc(a)};S.prototype.yi=function(a){for(var b=0;b<this.ve.length;b++)this.ve[b].xi(a);a=this.Ba;this.Xc(a.oh,a.Vb);this.Xc(a.Vi,a.Dg)};S.prototype.oj=function(a){if(this.Ba.qc&&a.time-this.ld>=1/S.Yj){this.ld=a.time;a=R();Q(a,31);var b=this.Ba.write(a);this.i.Ce+=b;this.i.pc+=a.offset;this.X.send(a.finish())}};S.rf=15;
S.prototype.Pc=function(a){a.time-this.tg<S.rf||(this.tg=a.time,this.Aa.compact(),this.Ba.compact())};
S.prototype.ti=function(a,b,c){b=c.s()/1E3;var d=c.s(),e=c.s(),f=c.s(),h=c.s();a=c.s();this.i.je+=e;this.i.le+=f;this.i.ke+=h;this.i.fd+=a;var k=this.Ba,i=k.oh,l=k.Vb;if(l)if(i[l-1].pj<=d){for(var n=0;n<l;n++){var q=i[n];q.factory.Ob(q)}k.Vb=0}else{for(var u=l,n=0;n<l;n++){q=i[n];if(q.pj>d){u=n;break}q.factory.Ob(q)}i.splice(0,u);k.Vb-=u}for(d=0;d<this.wa;d++)k=this.xa[d],this.xa[d]=p,k.wd();this.wa=0;i=p;for(d=k=0;d<e;d++){var k=c.offset,n=c.s()<<1,w=c.s(),q=c.s(),u=c.s(),l=c.s(),w=this.Zf[w]||p;
if(!w)return r;(u=u?this.X.wh[u]||p:p)&&(u!=this.X.dn()&&q&4)&&(q&=-5);n=w.va(this,n,q);n.ha=u;n.read(c);this.i.cc+=c.offset-k;ld(n,b);this.Zb(n);l&&(i||(i=[]),i.push([n,l]))}for(d=0;d<f;d++){k=c.offset;n=c.s()<<1;n=this.v[n]||p;if(!n)return r;n.Sg(c);this.i.ec+=c.offset-k;ld(n,b)}for(d=0;d<h;d++){k=c.offset;n=c.s()<<1;this.i.dc+=c.offset-k;n=this.v[n]||p;if(!n)return r;this.qb(n,Ee)}if(i)for(d=0;d<i.length;d++){n=i[d][0];b=this.v[i[d][1]]||p;if(!b)return r;id(n,b)}this.Zi();for(d=0;d<a;d++){k=c.offset;
b=c.s();b=this.Sa[b]||p;if(!b)return r;b=nd(b);b.read(c);this.i.kc+=c.offset-k;this.Aa.yb(b)}return m};S=ye(S,"gf.sim.ClientSimulator",{update:"update",yi:"interpolateEntities",oj:"sendPendingCommands_",Pc:"compact_",ti:"handleSyncSimulation_"});function Ie(a,b,c){ze.call(this,a,2);this.X=b;this.X.W.push(this);Ge(this.X.Mb,31,this.si,this);this.Kl=c;this.n=[];this.Dd={};this.Kf=new qd}A(Ie,ze);t=Ie.prototype;t.b=function(){hb(this.n);Ie.d.b.call(this)};t.kb=function(a){return this.X.Yb[a]||p};t.vf=function(a){this.n.push(a);var b=a.kb();b&&(this.Dd[b.c]=a);this.ji(function(b){je(a,b)},this)};t.ij=function(a){var b=a.kb();b&&delete this.Dd[b.c];Bb(this.n,a);K(a)};
t.update=function(a){for(var b=0;b<this.n.length;b++){var c=this.n[b];c.Pa.Xc(c.Aa.Ic,c.Aa.fa());rd(c.Aa)}this.tb.update(a);this.Og(a);this.tc(a);this.Pc(a)};t.ma=aa();function kd(a,b,c){for(var d=0;d<a.n.length;d++){var e=a.n[d];if(!(c&&e.kb()==c))a:{if(0!=b.ta){var f=e.Pa.v[b.ta]||p;if(f.Ja&64&&f.ha!=e.Gc)break a}e.Ba.yb(b)}}a.Kf.yb(b)}t.$i=function(a,b){if(!(b.Ja&jd))for(var c=0;c<this.n.length;c++)je(this.n[c],b)};
t.tc=function(a){for(var b=0;b<this.n.length;b++)this.n[b].flush(a.time);rd(this.Kf);Ie.d.tc.call(this,a)};Ie.rf=15;t=Ie.prototype;t.Pc=function(a){if(!(a.time-this.tg<Ie.rf)){this.tg=a.time;this.Kf.compact();for(a=0;a<this.n.length;a++)this.n[a].compact()}};t.fb=x;t.Uf=x;t.th=function(a){var b=this.Dd[a.c]||p;b||(b=new this.Kl(this,this.X,a),this.vf(b))};t.uh=function(a){(a=this.Dd[a.c]||p)&&this.ij(a)};t.vh=x;
t.si=function(a,b,c){if(!a.I)return r;b=this.Dd[a.I.c]||p;if(!b)return r;var d=c.s(),e=c.s();this.i.fd+=e;this.i.kc+=a.data.byteLength;for(var f=0;f<e;f++){var h=c.s(),h=this.Sa[h]||p;if(!h)return r;h=nd(h);h.read(c);var k=0==h.ta;k||(k=this.v[h.ta]||p,k=!k||k.ha!=a.I);if(k)return h.Ob(),r;b.Aa.yb(h)}b.eb=d;return m};Ie=ye(Ie,"gf.sim.ServerSimulator",{update:"update",tc:"postUpdate",Pc:"compact_",si:"handleExecCommands_"});function Je(a){return Ke(a.Y.Ac.g)};function Le(a,b,c,d){fd.call(this,a,b,c,d);this.mi=p}A(Le,fd);function Me(a){dd.call(this,a);this.$l=this.Jg=this.Ah=this.Yg=this.Xg=this.xb=this.nh=0}A(Me,dd);var Ne=360*(1/32767)*Math.PI/180;Me.prototype.read=function(a){Me.d.read.call(this,a);this.nh=Oe(a);this.xb=Oe(a);this.xb&1&&(this.Xg=Pe(a),this.Yg=Pe(a));this.Ah=Qe(a);this.Jg=Qe(a)};Me.prototype.write=function(a){Me.d.write.call(this,a);Q(a,this.nh);Q(a,this.xb);this.xb&1&&(wd(a,this.Xg),wd(a,this.Yg));ud(a,this.Ah);ud(a,this.Jg)};function Re(a){cd.call(this,a);this.yf=0}A(Re,cd);Re.prototype.read=function(a){Re.d.read.call(this,a);this.yf=a.gj()};Re.prototype.write=function(a){Re.d.write.call(this,a);a.Uj(this.yf)};function Se(a){cd.call(this,a);this.data=this.l=this.y=this.x=0}A(Se,cd);Se.prototype.read=function(a){Se.d.read.call(this,a);this.x=a.Ie();this.y=a.Ie();this.l=a.Ie();this.data=Pe(a)};Se.prototype.write=function(a){Se.d.write.call(this,a);a.of(this.x);a.of(this.y);a.of(this.l);wd(a,this.data)};function Te(a){dd.call(this,a);this.lh=0}A(Te,dd);Te.prototype.read=function(a){Te.d.read.call(this,a);this.lh=a.ia()};Te.prototype.write=function(a){Te.d.write.call(this,a);a.M(this.lh)};function Ue(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],h=2*c,k=2*d,i=2*e,l=h*f,n=k*f,f=i*f,h=h*c,q=k*c,c=i*c,k=k*d,d=i*d,e=i*e;b[0]=1-(k+e);b[1]=q+f;b[2]=c-n;b[3]=0;b[4]=q-f;b[5]=1-(h+e);b[6]=d+l;b[7]=0;b[8]=c+n;b[9]=d-l;b[10]=1-(h+k);b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1}
function Ve(a,b,c,d){var e=a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3];if(1<e||-1>e)return Xa(d,b),d;var f=1;0>e&&(f=-1,e=-e);var h=Math.acos(e);if(1E-6>=h)return Xa(d,b),d;var k=1/Math.sin(h),e=Math.sin((1-c)*h)*k;c=f*Math.sin(c*h)*k;d[0]=a[0]*e+b[0]*c;d[1]=a[1]*e+b[1]*c;d[2]=a[2]*e+b[2]*c;d[3]=a[3]*e+b[3]*c;return d};function We(a,b,c,d){fd.call(this,a,b,c,d);this.wb=m;this.Kc=D();this.sm=new Float32Array(16);this.g.Bj(Ba(1,1,1))}A(We,fd);We.prototype.Mg=function(){We.d.Mg.call(this);this.wb=m};
function Xe(a,b){if(a.wb&&a.wb){a.wb=r;var c=a.g,d=c.bd(),e=c.Oa,f=c.Pe;a.Kc[0]=d[0];a.Kc[1]=d[1];a.Kc[2]=d[2];a.Kc[3]=c.Qd*Math.max(f[0],Math.max(f[1],f[2]));c=a.sm;Ue(e,c);var e=f[0],h=f[1],f=f[2],k=c[1],i=c[2],l=c[3],n=c[4],q=c[5],u=c[6],w=c[7],F=c[8],H=c[9],G=c[10],I=c[11],N=c[12],ga=c[13],Z=c[14],pa=c[15];c[0]*=e;c[1]=k*e;c[2]=i*e;c[3]=l*e;c[4]=n*h;c[5]=q*h;c[6]=u*h;c[7]=w*h;c[8]=F*f;c[9]=H*f;c[10]=G*f;c[11]=I*f;c[12]=N;c[13]=ga;c[14]=Z;c[15]=pa;e=d[0];h=d[1];d=d[2];f=c[1];k=c[2];i=c[3];l=c[4];
n=c[5];q=c[6];u=c[7];w=c[8];F=c[9];H=c[10];G=c[11];I=c[12];N=c[13];ga=c[14];Z=c[15];c[0]+=e*i;c[1]=f+h*i;c[2]=k+d*i;c[3]=i;c[4]=l+e*u;c[5]=n+h*u;c[6]=q+d*u;c[7]=u;c[8]=w+e*G;c[9]=F+h*G;c[10]=H+d*G;c[11]=G;c[12]=I+e*Z;c[13]=N+h*Z;c[14]=ga+d*Z;c[15]=Z;a.getParent()}Xa(b,a.Kc)}
We.prototype.Vd=function(a){var b=this.g,c=a.jf,d=b.bd();Ue(b.Oa,c);if(c==c){var b=c[1],e=c[2],f=c[3],h=c[6],k=c[7],i=c[11];c[1]=c[4];c[2]=c[8];c[3]=c[12];c[4]=b;c[6]=c[9];c[7]=c[13];c[8]=e;c[9]=h;c[11]=c[14];c[12]=f;c[13]=k;c[14]=i}else c[0]=c[0],c[1]=c[4],c[2]=c[8],c[3]=c[12],c[4]=c[1],c[5]=c[5],c[6]=c[9],c[7]=c[13],c[8]=c[2],c[9]=c[6],c[10]=c[10],c[11]=c[14],c[12]=c[3],c[13]=c[7],c[14]=c[11],c[15]=c[15];b=-d[0];e=-d[1];d=-d[2];f=c[1]*b+c[5]*e+c[9]*d+c[13];h=c[2]*b+c[6]*e+c[10]*d+c[14];k=c[3]*b+
c[7]*e+c[11]*d+c[15];c[12]=c[0]*b+c[4]*e+c[8]*d+c[12];c[13]=f;c[14]=h;c[15]=k;a.De&&(a.De=r,c=2/a.width,d=2/-a.height,$a(a.Ml,c,d,1,0,-1,1,0,1),c=a.$a===j?a.width/a.height:a.$a,d=a.Hl,b=a.eg,f=Math.PI/4/2,e=b-d,h=Math.sin(f),0==e||(0==h||0==c)||(f=Math.cos(f)/h,$a(a.Qg,f/c,f,-(b+d)/e,-1,0,0,-(2*d*b)/e,0)),ab(a.Qg,a.jf,a.Fd),bb(a.Fd,a.mc));ab(a.Qg,a.jf,a.Fd);bb(a.jf,a.Ai);bb(a.Fd,a.mc);d=a.Fd;c=a.li;Wa(c[0],d[3]+d[0],d[7]+d[4],d[11]+d[8],d[15]+d[12]);Wa(c[1],d[3]-d[0],d[7]-d[4],d[11]-d[8],d[15]-d[12]);
Wa(c[2],d[3]-d[1],d[7]-d[5],d[11]-d[9],d[15]-d[13]);Wa(c[3],d[3]+d[1],d[7]+d[5],d[11]+d[9],d[15]+d[13]);Wa(c[4],d[3]+d[2],d[7]+d[6],d[11]+d[10],d[15]+d[14]);Wa(c[5],d[3]-d[2],d[7]-d[6],d[11]-d[10],d[15]-d[14]);for(d=0;d<c.length;d++)b=c[d],e=1/Math.sqrt(b[0]*b[0]+b[1]*b[1]+b[2]*b[2]),b[0]*=e,b[1]*=e,b[2]*=e,b[3]*=e;C(a.position,0,0,0);c=a.Ai;d=f=a.position;b=f[0];e=f[1];f=f[2];d[0]=b*c[0]+e*c[4]+f*c[8]+c[12];d[1]=b*c[1]+e*c[5]+f*c[9]+c[13];d[2]=b*c[2]+e*c[6]+f*c[10]+c[14];c=2*(0.5/a.width)-1;d=1-
2*(0.5/a.height);b=Ye[0];e=Ye[1];C(b,c,d,-1);C(e,c,d,1);cb(a.mc,b,b);cb(a.mc,e,e);Ha(b,e,a.direction);a=c=a.direction;a[0]=-c[0];a[1]=-c[1];a[2]=-c[2]};function Ze(a,b,c,d){We.call(this,a,b,c,d);this.mb=p;this.Je=r}A(Ze,We);Ze.prototype.b=function(){K(this.mb);this.mb=p;Ze.d.b.call(this)};Ze.prototype.Xl=function(){var a=this.g.ad();if(this.Je){this.mb&&(K(this.mb),this.mb=p);if(a){a:{var b=this.Y.Ac.mi.Li,c=b.pd[a];if(!c){c=b.Mi[a];c=!c?p:c.xk(b.Jc);if(!c){a=p;break a}b.pd[a]=c}a=c.ee()}this.mb=a}this.Je=r}};Ze.prototype.ad=function(){return this.g.ad()};
Ze.prototype.Ve=function(a){this.g.Ve(a);a=this.g.ad();a=a.length?a:p;if(a!=(this.mb?this.mb.Ki.id:p)&&!this.Je)this.Je=m,pd(this.Y.tb,re,0,this.Xl,this)};function $e(a,b,c,d){Ze.call(this,a,b,c,d)}A($e,Ze);function af(){this.buffer=new Uint8Array(0);this.offset=0;this.U=new Float32Array(16);this.ea=new Uint8Array(this.U.buffer);this.Gk=(this.Yc=v.Float64Array?new Float64Array(1):p)?new Uint8Array(this.Yc.buffer):p}t=af.prototype;t.ka=function(a,b){this.buffer=a instanceof Uint8Array?a:new Uint8Array(a);this.offset=b};function Qe(a){var b=a.buffer[a.offset++];a=a.buffer[a.offset++];b=b<<8|a;return 32767<b?b-65536:b}
function bf(a){var b=a.buffer[a.offset++],c=a.buffer[a.offset++],d=a.buffer[a.offset++];a=a.buffer[a.offset++];b=b<<24|c<<16|d<<8|a;return 2147483647<b?b-4294967296:b}function Oe(a){return a.buffer[a.offset++]}function Pe(a){var b=a.buffer[a.offset++];a=a.buffer[a.offset++];return b<<8|a}t.ia=function(){var a=this.buffer[this.offset++],b=this.buffer[this.offset++],c=this.buffer[this.offset++],d=this.buffer[this.offset++];return a<<24|b<<16|c<<8|d};
t.s=function(){for(var a=0,b=0,c;(c=this.buffer[this.offset++]&255)&128;)a|=(c&127)<<b,b+=7;return a|c<<b};t.Ie=function(){var a=this.s();return(a<<31>>31^a)>>1^a&-2147483648};t.gj=function(){this.ea[0]=this.buffer[this.offset++];this.ea[1]=this.buffer[this.offset++];this.ea[2]=this.buffer[this.offset++];this.ea[3]=this.buffer[this.offset++];return this.U[0]};t.Vl=function(){for(var a=0;12>a;a++)this.ea[a]=this.buffer[this.offset++];return this.U};
t.Wl=function(){for(var a=0;16>a;a++)this.ea[a]=this.buffer[this.offset++];return this.U};t.H=function(){var a=Pe(this);Pe(this);for(var b=Array(a),c=0;c<a;){var d=this.buffer[this.offset++];if(128>d)b[c++]=String.fromCharCode(d);else if(191<d&&224>d){var e=this.buffer[this.offset++];b[c++]=String.fromCharCode((d&31)<<6|e&63)}else{var e=this.buffer[this.offset++],f=this.buffer[this.offset++];b[c++]=String.fromCharCode((d&15)<<12|(e&63)<<6|f&63)}}return b.join("")};var cf=p;
function df(){cf||(cf=new af);return cf};function ef(a,b,c){var d=a>>24&255,e=a>>16&255,f=a>>8&255;a&=255;return(d+c*((b>>24&255)-d)&255)<<24|(e+c*((b>>16&255)-e)&255)<<16|(f+c*((b>>8&255)-f)&255)<<8|a+c*((b&255)-a)&255};function T(a,b){this.Xa=a;this.qd=0;this.z=b}T.prototype.pi=function(a){var b=U(a,this.j);return"target."+U(a,this.k)+"(source."+b+"());"};T.prototype.hc=function(a){var b=U(a,this.j);return"result."+U(a,this.k)+"(target."+b+"());"};var V=0;function ff(a,b){return(b.z&gf)-(a.z&gf)||a.qd-b.qd}function U(a,b){for(var c in a)if(a[c]===b)return c;return p}var gf=1;function hf(a,b,c,d){T.call(this,a,b);this.j=c;this.k=d}A(hf,T);t=hf.prototype;t.w=function(){return new hf(this.Xa,this.z,this.j,this.k)};
t.Va=function(a){a=U(a,this.k);var b=df(),b=U(b,b.Ie);return"target."+a+"(reader."+b+"());"};t.Wa=function(a){a=U(a,this.j);var b=R();return"writer."+U(b,b.of)+"(target."+a+"() | 0);"};t.pi=function(a){var b=U(a,this.j);return"target."+U(a,this.k)+"(source."+b+"() | 0);"};t.hc=function(a){var b=U(a,this.j);a=U(a,this.k);return"var _s = source."+b+"();var _t = target."+b+"();target."+a+"((_s + t * (_t - _s)) | 0);"};function jf(a,b,c,d){T.call(this,a,b);this.j=c;this.k=d}A(jf,T);
jf.prototype.w=function(){return new jf(this.Xa,this.z,this.j,this.k)};jf.prototype.Va=function(a){a=U(a,this.k);var b=df(),b=U(b,b.gj);return"target."+a+"(reader."+b+"());"};jf.prototype.Wa=function(a){a=U(a,this.j);var b=R();return"writer."+U(b,b.Uj)+"(target."+a+"());"};jf.prototype.hc=function(a){var b=U(a,this.j);a=U(a,this.k);return"var _s = source."+b+"();var _t = target."+b+"();result."+a+"((_s + t * (_t - _s)));"};function kf(a,b,c,d){T.call(this,a,b);this.j=c;this.k=d}A(kf,T);
kf.prototype.w=function(){return new kf(this.Xa,this.z,this.j,this.k)};kf.prototype.Va=function(a){a=U(a,this.k);var b=df(),b=U(b,b.Vl);return"target."+a+"(reader."+b+"());"};kf.prototype.Wa=function(a){a=U(a,this.j);var b=R();return"writer."+U(b,b.Em)+"(target."+a+"());"};
kf.prototype.hc=function(a){var b=U(a,this.j),c=U(a,this.k);a=U(a,lf);return"var _sv3 = source."+b+"();var _tv3 = target."+b+"();var _rv3 = source."+a+";_rv3[0] = (_tv3[0] - _sv3[0]) * t + _sv3[0];_rv3[1] = (_tv3[1] - _sv3[1]) * t + _sv3[1];_rv3[2] = (_tv3[2] - _sv3[2]) * t + _sv3[2];result."+c+"(_rv3);"};function mf(a,b,c,d,e){T.call(this,a,b);this.j=c;this.k=d;this.Jl=e}A(mf,T);mf.prototype.w=function(){return new mf(this.Xa,this.z,this.j,this.k,this.Jl)};
mf.prototype.Va=function(a){a=U(a,this.k);var b=df(),b=U(b,b.Wl);return"target."+a+"(reader."+b+"());"};mf.prototype.Wa=function(a){a=U(a,this.j);var b=R();return"writer."+U(b,b.Fm)+"(target."+a+"());"};mf.prototype.hc=function(a){var b=U(a,this.j),c=U(a,this.k),d=U(a,nf);a=U(a,Ve);return"var _rq = source."+d+";source."+a+"(source."+b+"(), target."+b+"(), t, _rq);result."+c+"(_rq);"};function of(a,b,c,d){T.call(this,a,b);this.j=c;this.k=d}A(of,T);
of.prototype.w=function(){return new of(this.Xa,this.z,this.j,this.k)};of.prototype.Va=function(a){a=U(a,this.k);var b=df(),b=U(b,b.ia);return"target."+a+"(reader."+b+"());"};of.prototype.Wa=function(a){a=U(a,this.j);var b=R();return"writer."+U(b,b.M)+"(target."+a+"());"};of.prototype.hc=function(a){var b=U(a,this.j),c=U(a,this.k);a=U(a,ef);return"result."+c+"(source."+a+"(source."+b+"(), target."+b+"(), t));"};function pf(a,b,c,d){T.call(this,a,b);this.j=c;this.k=d}A(pf,T);
pf.prototype.w=function(){return new pf(this.Xa,this.z,this.j,this.k)};pf.prototype.Va=function(a){a=U(a,this.k);var b=df(),b=U(b,b.H);return"target."+a+"(reader."+b+"());"};pf.prototype.Wa=function(a){a=U(a,this.j);var b=R();return"writer."+U(b,b.o)+"(target."+a+"());"};function qf(a,b,c,d){T.call(this,a,b);this.j=c;this.k=d}A(qf,T);qf.prototype.w=function(){return new qf(this.Xa,this.z,this.j,this.k)};
qf.prototype.Va=function(a){a=U(a,this.k);var b=df(),b=U(b,b.H);return"target."+a+"(reader."+b+"());"};qf.prototype.Wa=function(a){a=U(a,this.j);var b=R();return"writer."+U(b,b.o)+"(target."+a+"());"};function rf(a,b,c,d){T.call(this,a,b);this.j=c;this.k=d}A(rf,T);rf.prototype.w=function(){return new rf(this.Xa,this.z,this.j,this.k)};rf.prototype.Va=function(a){a=U(a,this.k);var b=df(),b=U(b,b.s);return"target."+a+"(reader."+b+"());"};
rf.prototype.Wa=function(a){a=U(a,this.j);var b=R();return"writer."+U(b,b.t)+"(target."+a+"());"};var lf=B(),nf=D();function sf(a,b){for(var c=0;c<a.length;c++)a[c].qd=c;a.sort(ff);this.Ui={};this.hj=Array(a.length);this.Wj=Array(a.length);var d="",e="",f="",h="",k="",i="",l="",n="";this.Tj=Array(a.length);for(c=0;c<a.length;c++){var q=a[c].w();this.Tj[c]=q;this.Ui[q.Xa]=q;q.qd=c;this.hj[c]=new Function("target","reader",q.Va(b));this.Wj[c]=new Function("target","writer",q.Wa(b));var d=d+q.Va(b),e=e+q.Wa(b),u=q.pi(b),f=f+u;q.z&6||(h+=u);q.z&2&&(i+=u);if(q.z&4){var w=q.hc(b),l=l+w,k=k+u;q.z&2||(n+=w)}}this.Ul=new Function("target",
"reader",d);this.Cm=new Function("target","writer",e);this.Um=new Function("source","target",f);this.Vh=new Function("source","target",h);this.Nf=new Function("source","target",k);this.Wh=new Function("source","target",i);this.sl=new Function("source","target","t","result",l);this.rl=new Function("source","target","t","result",n)}sf.prototype.fa=function(){return this.Tj.length};function W(a,b){return a.Ui[b].qd}function tf(a,b,c,d,e){for(a=a.hj;c;){if(c&1&&a[b])a[b](d,e);c>>=1;b++}}
function uf(a,b,c,d,e){for(a=a.Wj;c;){if(c&1)a[b](d,e);c>>=1;b++}};function X(a,b){this.O=a;this.time=0;this.Q=b;this.gb=this.Fb=0}t=X.prototype;t.reset=function(a){this.O=a;this.gb=this.Fb=this.time=0};function vf(a,b){if(!a.Q){var c=[];a(c);a.Q=new sf(c,b)}return a.Q}function Y(a,b){var c=a.Fb||a.gb;31>=b?a.Fb|=1<<b:a.gb|=1<<b-32;if(!c){var c=a.O,d=!!c.T;c.T|=2;d||(d=c.Y,d.xa[d.wa++]=c)}}t.wd=function(){this.Fb=this.gb=0};t.read=function(a){this.Q.Ul(this,a)};t.Sg=function(a){var b=a.s();tf(this.Q,0,b,this,a);31<this.Q.fa()&&(b=a.s(),tf(this.Q,32,b,this,a))};
t.write=function(a){this.Q.Cm(this,a)};t.zh=function(a){a.t(this.Fb);uf(this.Q,0,this.Fb,this,a);this.gb&&31<this.Q.fa()&&(a.t(this.gb),uf(this.Q,32,this.gb,this,a))};t.Vh=function(a){this.Q.Vh(this,a)};t.Wh=function(a){this.Q.Wh(this,a)};t.Nf=function(a){this.Q.Nf(this,a)};t.xi=function(a,b,c){var d=this.Q;this.O.Ja&4?d.rl(a,b,c,this):d.sl(a,b,c,this)};t.Kj=lf;t.kh=nf;t.Tl=Ve;t.rk=ef;X.prototype.Kj[0]=X.prototype.Kj[1];X.prototype.Tl(X.prototype.kh,X.prototype.kh,0,X.prototype.kh);
X.prototype.rk(0,0,0);function wf(a,b){var c=b||vf(xf,this);X.call(this,a,c);this.Lg=B();this.Rl=W(c,yf);this.Oa=D();this.bm=W(c,zf);this.Pe=B();this.dm=W(c,Af);this.Qd=0;this.mk=W(c,Bf);this.hf=B();this.ym=W(c,Cf)}A(wf,X);var yf=V++,zf=V++,Af=V++,Bf=V++,Cf=V++;t=wf.prototype;t.bd=s("Lg");t.setPosition=function(a){Ia(this.Lg,a)||(Ca(this.Lg,a),Y(this,this.Rl),this.O.wb=m)};t.Wk=s("Oa");
t.Aj=function(a){this.Oa.length==a.length&&this.Oa[0]==a[0]&&this.Oa[1]==a[1]&&this.Oa[2]==a[2]&&this.Oa[3]==a[3]||(Xa(this.Oa,a),Y(this,this.bm),this.O.wb=m)};t.Xk=s("Pe");t.Bj=function(a){Ia(this.Pe,a)||(Ca(this.Pe,a),Y(this,this.dm),this.O.wb=m)};t.Ok=s("Qd");t.hm=function(a){this.Qd!=a&&(this.Qd=a,Y(this,this.mk),this.O.wb=m)};t.al=s("hf");t.setVelocity=function(a){Ia(this.hf,a)||(Ca(this.hf,a),Y(this,this.ym))};
function xf(a){a.push(new kf(yf,gf|6,wf.prototype.bd,wf.prototype.setPosition));a.push(new mf(zf,gf|6,wf.prototype.Wk,wf.prototype.Aj,m));a.push(new kf(Af,gf|6,wf.prototype.Xk,wf.prototype.Bj));a.push(new jf(Bf,gf|4,wf.prototype.Ok,wf.prototype.hm));a.push(new kf(Cf,gf|2,wf.prototype.al,wf.prototype.setVelocity))};function Df(a,b){var c=b||vf(Ef,this);wf.call(this,a,c);this.xg="";this.El=W(c,Ff);this.wg=0;this.Dl=W(c,Gf);this.zf=0;this.ik=W(c,Hf)}A(Df,wf);var Ff=V++,Gf=V++,Hf=V++;t=Df.prototype;t.ad=s("xg");t.Ve=function(a){this.xg!=a&&(this.xg=a,Y(this,this.El))};t.Uk=s("wg");t.im=function(a){this.wg!=a&&(this.wg=a,Y(this,this.Dl))};t.Nk=s("zf");t.gm=function(a){this.zf!=a&&(this.zf=a,Y(this,this.ik))};
function Ef(a){xf(a);a.push(new pf(Ff,0,Df.prototype.ad,Df.prototype.Ve));a.push(new of(Gf,gf|4,Df.prototype.Uk,Df.prototype.im));a.push(new hf(Hf,0,Df.prototype.Nk,Df.prototype.gm))};function If(a,b){var c=b||vf(Jf,this);Df.call(this,a,c);this.ed=0;this.re=j;this.ol=W(c,Kf)}A(If,Df);var Kf=V++;If.prototype.Rk=s("ed");If.prototype.$g=function(a){this.ed!=a&&(this.ed=a,Y(this,this.ol),this.re=j)};function Jf(a){Ef(a);a.push(new rf(Kf,0,If.prototype.Rk,If.prototype.$g))};B();B();function Lf(){this.height=this.width=1;this.$a=j;this.Hl=0.1;this.eg=100;this.De=m;this.Ml=Za();this.Qg=Za();this.jf=Za();this.Ai=Za();this.Fd=Za();this.mc=Za();this.position=B();this.direction=B();this.li=[D(),D(),D(),D(),D(),D()]}var Ye=[B(),B(),B(),B(),B(),B(),B(),B()];function $(a,b){E.call(this);this.map=a;var c=$.bk;this.N=Math.min(Math.max(Math.floor(b),$.fk),c);this.Fa=2*this.N+1;this.ua=Array(this.Fa*$.Dh*this.Fa);this.Ha=B();this.K=new Int32Array(3);this.bb=Ka(this.Ha[0]-16*this.N,0,this.Ha[2]-16*this.N,this.Ha[0]+16*this.N,128,this.Ha[2]+16*this.N);this.n=[];this.nl=r}A($,E);$.Hm=8;$.ak=16;$.fk=1;$.bk=16;$.Dh=1;t=$.prototype;t.b=function(){hb(this.n);$.d.b.call(this)};t.vf=function(a){this.n.push(a)};t.ij=function(a){Bb(this.n,a)};
t.wi=function(a){Ca(this.Ha,a);this.Ug();this.nl=m};t.update=function(a){Ca(this.Ha,a);var b=a[0]>>4,c=a[2]>>4;a=b-this.K[0];var d=c-this.K[2];if(a||d){var b=b<<4,c=c<<4,e=this.bb,f=b+16*this.N,h=c+16*this.N;C(e.min,b-16*this.N,0,c-16*this.N);C(e.max,f,0,h);this.bb.max[0]+=16;this.bb.max[1]+=128;this.bb.max[2]+=16;this.K[0]+=a;this.K[1]+=0;this.K[2]+=d;this.Ug()}};t.Ug=function(){this.K[0]=this.Ha[0]>>4;this.K[1]=0;this.K[2]=this.Ha[2]>>4;this.fj(this.K[0]-this.N,0,this.K[2]-this.N,this.Fa,$.Dh,this.Fa)};
t.gc=function(a,b,c){a%=this.Fa;c%=this.Fa;0>a&&(a=this.Fa+a);0>c&&(c=this.Fa+c);return a+c*this.Fa};t.fj=function(a,b,c,d,e,f){for(b=a;b<a+d;b++)for(e=c;e<c+f;e++){var h=b,k=e,i=this.gc(h,0,k);if(!(0>i||i>this.ua.length))if(h=this.map.fc(h<<4,0,k<<4),h!=this.ua[i]){if(k=this.ua[i]){for(var l=0;l<this.n.length;l++)this.n[l].qk(k);k.Na--;k.Na||k.map.ze(k)}k=h;k.Na||k.map.Ae(k);k.Na++;this.ua[i]=h;for(l=0;l<this.n.length;l++)2==h.state&&this.n[l].ie(h)}}};
t.Be=function(a){for(var b=0;b<this.n.length;b++)this.n[b].ie(a),this.n[b].tl(a.x,a.y,a.l,a.x+16-1,a.y+128-1,a.l+16-1,3)};t.fc=function(a,b,c){if(0>b||128<=b)return p;a>>=4;b>>=7;c>>=4;var d=Math.abs(c-this.K[2]);if(Math.abs(a-this.K[0])>this.N||0!=b||d>this.N)return p;a=this.gc(a,b,c);return 0>a||a>this.ua.length?p:this.ua[a]};t.Ik=function(a,b){wb(this.ua,a,b)};t.ki=function(a,b,c){Mf(this,a,this.K[0]-this.N,this.K[2]-this.N,this.Fa,b,c)};
function Mf(a,b,c,d,e,f,h){var k=$.qm,i=16*(c+e),l=16*(d+e);C(k.min,16*c,0,16*d);C(k.max,i,128,l);a:{i=k.min;l=k.max;Ca(Ye[0],i);C(Ye[1],i[0],i[1],l[2]);C(Ye[2],i[0],l[1],i[2]);C(Ye[3],i[0],l[1],l[2]);C(Ye[4],l[0],i[1],i[2]);C(Ye[5],l[0],i[1],l[2]);C(Ye[6],l[0],l[1],i[2]);Ca(Ye[7],l);for(var i=0,l=b.li,n=0;n<l.length;n++){for(var q=l[n],u=8,w=1,F=0;8>F;F++){var H=Ye[F];0>q[0]*H[0]+q[1]*H[1]+q[2]*H[2]+q[3]&&(w=0,u--)}if(!u){i=-1;break a}i+=w}i=6==i?1:0}if(1==i){b=k.min[0]>>4;c=k.max[0]>>4;d=k.max[2]>>
4;for(k=k.min[2]>>4;k<d;k++)for(e=b;e<c;e++)(i=a.fc(e<<4,0,k<<4))&&f.call(h,i)}else if(0==i)if(1>=e)(a=a.fc(c<<4,0,d<<4))&&f.call(h,a);else{k=e/2|0;for(e=0;1>=e;e++)for(i=0;1>=i;i++)Mf(a,b,c+i*k,d+e*k,k,f,h)}}
t.rg=function(a,b){var c=p,d=Math.floor(a[0]),e=Math.floor(a[1]),f=Math.floor(a[2]),h=0==a[3]?0:0>a[3]?-1:1,k=0==a[4]?0:0>a[4]?-1:1,i=0==a[5]?0:0>a[5]?-1:1,l=(d+(0<h?1:0)-a[0])/a[3],n=(e+(0<k?1:0)-a[1])/a[4],q=(f+(0<i?1:0)-a[2])/a[5];isNaN(l)&&(l=Number.POSITIVE_INFINITY);isNaN(n)&&(n=Number.POSITIVE_INFINITY);isNaN(q)&&(q=Number.POSITIVE_INFINITY);var u=h/a[3],w=k/a[4],F=i/a[5];isNaN(u)&&(u=Number.POSITIVE_INFINITY);isNaN(w)&&(w=Number.POSITIVE_INFINITY);isNaN(F)&&(F=Number.POSITIVE_INFINITY);for(var H=
Math.min(b,16*this.Fa),G=0;G<H;G++){var I=this.fc(d,e,f);if(I&&(c=I.rg(a)))break;l<n&&l<q?(l+=u,d+=h):n<q?(n+=w,e+=k):(q+=F,f+=i)}return c&&c.Yf>b?p:c};t.ra=function(a,b,c,d){var e=this.fc(a,b,c);if(!e||!e.ra(a,b,c,d))return r;for(d=0;d<this.n.length;d++)this.n[d].zi(a,b,c,0);return m};$.un=[B(),B()];$.qm=new Ja;$=ye($,"blk.env.ChunkView",{wi:"initialize",update:"update",Ug:"rebuildCube_",fj:"pullChunks_",Ik:"forEachChunk",ki:"forEachInViewport"});function Nf(a){this.Th=fa(a)?a:1}Nf.Zj=1;Nf.prototype.yd=function(a){var b=R();if(this.qj(a,b))return b.finish();b.hb();return p};
Nf.prototype.qj=function(a,b){switch(Nf.Zj){case 1:Q(b,1);var c;a:{vd(b,a.x);vd(b,a.y);vd(b,a.l);Q(b,this.Th);switch(this.Th){default:case 0:c=new Uint8Array(a.$.buffer);td(b,4+c.length);b.M(c.length);for(var d=0;d<c.length;d++)b.buffer[b.offset++]=c[d];break;case 1:td(b,65668);d=b.offset+4;c=a.$;for(var d=b.buffer.subarray(d,d+65664),e=0,f=0,h=0,k=0;k<c.length;k++){var i=c[k];k&&i==f?h++:(f=i,h=1);if(k>=c.length-2||c[k+1]!=f)1<h||255==f>>8?(d[e++]=255,d[e++]=h>>8,d[e++]=h&255,d[e++]=f>>8,d[e++]=
f&255):(d[e++]=i>>8,d[e++]=i&255)}c=e;if(0>c){c=r;break a}b.M(c);b.offset+=c;break;case 2:c=r;break a}c=m}return c;default:return r}};
Nf.prototype.$h=function(a,b){switch(Oe(b)){case 1:var c;a:{c=bf(b);var d=bf(b),e=bf(b);a.x=c;a.y=d;a.l=e;var f=a.ab,h=c+16,k=d+128,i=e+16;C(f.min,c,d,e);C(f.max,h,k,i);d=Oe(b);c=a.$;switch(d){default:case 0:b.ia();d=0;for(e=b.offset;32768>d;d++,e+=2)c[d]=b.buffer[e+1]<<8|b.buffer[e];break;case 1:h=b.ia();d=b.buffer;f=b.offset;e=0;f=f?f:0;h=h?h:d.length;for(k=f;k<f+h;)if(i=d[k++],255==i)for(var i=d[k++]<<8|d[k++],l=d[k++]<<8|d[k++],n=0;n<i;n++)c[e++]=l;else c[e++]=i<<8|d[k++];break;case 2:c=r;break a}a.bc=
r;a.state=2;a.map.Be(a);c=m}return c;default:return r}};Nf.eh=p;Nf.Yk=function(){Nf.eh||(Nf.eh=new Nf(0));return Nf.eh};Nf=ye(Nf,"blk.io.ChunkSerializer",{qj:"serializeToWriter",$h:"deserializeFromReader"});function Of(a,b){E.call(this);this.X=a;this.Gc=b;this.Da=[];this.ug=-Of.Ch;this.ld=0}A(Of,E);Of.Ch=3;Of.ck=20;Of.Xj=100;t=Of.prototype;t.ie=function(a){0<=vb(this.Da,a)||(this.Da.push(a),this.ug=0)};
t.bj=function(a,b){var c=Math.min(Of.ck,this.Da.length);we("count",this.Da.length);if(a-this.ug>Of.Ch){this.ug=a;var d=Rb[0];Eb(this.Da,function(a,c){C(d,a.x+8,b[1],a.l+8);var e=Ga(b,d);C(d,c.x+8,b[1],c.l+8);return e-Ga(b,d)})}a-this.ld>1/Of.Xj?this.ld=a:c=0;if(c)for(var e=R(),f=Nf.Yk(),h=0;h<c;h++){var k=this.Da.shift();le.x=k.x;le.y=k.y;le.l=k.l;var i=e,l=le;Q(i,73);vd(i,l.x);vd(i,l.y);vd(i,l.l);k.ub||(k.ub=f.yd(k));i=e;k=k.ub;k instanceof Uint8Array||(k=new Uint8Array(k));td(i,k.length);for(l=
0;l<k.length;l++)i.buffer[i.offset++]=k[l];this.X.send(e.finish(),this.Gc);e.hb()}};t.qk=x;t.zi=x;t.tl=x;Of=ye(Of,"blk.env.server.ChunkSendQueue",{bj:"process"});function Pf(a,b,c,d){We.call(this,a,b,c,d);this.$a=j;this.Da=this.Qa=this.r=p}A(Pf,We);t=Pf.prototype;t.b=function(){this.r&&this.Qa&&(Bb(this.r.Ya,this.Qa),K(this.Qa));Pf.d.b.call(this)};t.dh=function(a){this.r=a;this.Qa=new $(a,$.ak);a.Ya.push(this.Qa);od(this,1,0)};t.update=function(a){var b=Qf,c=this.getParent();c instanceof We?Xe(c,b):Xe(this,b);this.Qa.update(b);this.Da.bj(a,b);od(this,1,0)};t.ma=function(a){Pf.d.ma.call(this,a);a instanceof Re&&(this.$a=a.yf)};
t.Tb=function(a){var b=this.ga(),c=Je(this).r;this.dh(c);this.Da=new Of(b.X,a);J(this,this.Da);this.Qa.vf(this.Da);a=Ba(0,80,0);this.Qa.wi(a)};t.Vd=function(a){if(this.$a){var b=this.$a;a.$a!==b&&(a.$a=b,a.De=m)}b=this.getParent();b instanceof We?b.Vd(a):Pf.d.Vd.call(this,a)};var Qf=D();function Rf(a,b){var c=b||vf(Sf,this);wf.call(this,a,c)}A(Rf,wf);function Sf(a){xf(a)};function Tf(a,b,c,d){fd.call(this,a,b,c,d)}A(Tf,fd);Tf.prototype.kg=function(){return this.getParent()};Tf.prototype.Zd=function(a){Tf.d.Zd.call(this,a)};Tf.prototype.$b=function(a){Tf.d.$b.call(this,a)};Tf.prototype.ma=function(a){Tf.d.ma.call(this,a);if(a instanceof Te){var b=this.kg();a:{for(var c=0;c<this.J.length;c++)if(this.J[c].D==a.lh){a=this.J[c];break a}a=p}a&&b.g.$g(a?a.D:0)}};function Uf(a,b){var c=b||vf(Vf,this);X.call(this,a,c)}A(Uf,X);function Vf(){};function Wf(){this.Jk=m}
Wf.prototype.ma=function(a,b){var c=a.jh,d=a.Ah*Ne,e=a.Jg*Ne,f=a.$l*Ne,h=Xf,k=Math.sin(d/2),d=Math.cos(d/2),i=Math.sin(e/2),e=Math.cos(e/2),l=Math.sin(f/2),f=Math.cos(f/2);h[0]=d*i*f+k*e*l;h[1]=k*e*f-d*i*l;h[2]=d*e*l-k*i*f;h[3]=d*e*f+k*i*l;b.Aj(Xf);if(this.Jk){h=b.bd();k=Yf[4];i=b.Oa;d=b.hf;f=Yf[5];e=Fa(d);1E-4<e?(l=Math.max(0,e-40*c),Ea(d,l/e,f)):C(f,0,0,0);d=a.nh;e=Yf[0];e[0]=0;e[0]+=18*!!(d&1);e[0]-=18*!!(d&2);e[1]=0;e[1]+=18*!!(d&4);e[1]-=18*!!(d&8);e[2]=0;e[2]+=18*!!(d&16);e[2]-=18*!!(d&32);
var d=Yf[1],l=i[0]*(i[0]+i[0]),n=i[3]*(i[0]+i[0]),q=i[0]*(i[1]+i[1]),u=i[1]*(i[1]+i[1]),w=i[3]*(i[1]+i[1]),F=i[0]*(i[2]+i[2]),H=i[1]*(i[2]+i[2]),G=i[2]*(i[2]+i[2]),i=i[3]*(i[2]+i[2]),I=e[0],N=e[1],e=e[2];d[0]=I*(1-u-G)+N*(q-i)+e*(F+w);d[1]=I*(q+i)+N*(1-l-G)+e*(H-n);d[2]=I*(F-w)+N*(H+n)+e*(1-l-u);i=Yf[2];(e=Fa(d))?Ea(d,1/e,i):C(i,0,0,0);e=Fa(d);18<e&&(Ea(d,18/e,d),e=18);d=e-(f[0]*i[0]+f[1]*i[1]+f[2]*i[2]);0<d&&(e=20*e*c,e>d&&(e=d),Ea(i,e,i),Da(i,f,f));d=Yf[3];Ea(f,c,d);Da(h,d,k);b.setPosition(k);b.setVelocity(f)}};
var Yf=[B(),B(),B(),B(),B(),B()];D();D();D();new Float32Array(16);new Float32Array(6);var Xf=D();var Zf=!Id||Id&&9<=$d,$f=Id&&!Yd("9");!Kd||Yd("528");Jd&&Yd("1.9b")||Id&&Yd("8")||Hd&&Yd("9.5")||Kd&&Yd("528");Jd&&!Yd("8")||Id&&Yd("9");function ag(a,b){this.type=a;this.currentTarget=this.target=b}t=ag.prototype;t.b=aa();t.Uc=aa();t.wc=r;t.defaultPrevented=r;t.Oe=m;t.preventDefault=function(){this.defaultPrevented=m;this.Oe=r};function bg(a,b){a&&this.lb(a,b)}A(bg,ag);t=bg.prototype;t.target=p;t.relatedTarget=p;t.offsetX=0;t.offsetY=0;t.clientX=0;t.clientY=0;t.screenX=0;t.screenY=0;t.button=0;t.keyCode=0;t.charCode=0;t.ctrlKey=r;t.altKey=r;t.shiftKey=r;t.metaKey=r;t.Pl=r;t.cg=p;
t.lb=function(a,b){var c=this.type=a.type;ag.call(this,c);this.target=a.target||a.srcElement;this.currentTarget=b;var d=a.relatedTarget;if(d){if(Jd){var e;a:{try{ue(d.nodeName);e=m;break a}catch(f){}e=r}e||(d=p)}}else"mouseover"==c?d=a.fromElement:"mouseout"==c&&(d=a.toElement);this.relatedTarget=d;this.offsetX=Kd||a.offsetX!==j?a.offsetX:a.layerX;this.offsetY=Kd||a.offsetY!==j?a.offsetY:a.layerY;this.clientX=a.clientX!==j?a.clientX:a.pageX;this.clientY=a.clientY!==j?a.clientY:a.pageY;this.screenX=
a.screenX||0;this.screenY=a.screenY||0;this.button=a.button;this.keyCode=a.keyCode||0;this.charCode=a.charCode||("keypress"==c?a.keyCode:0);this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.Pl=Dd?a.metaKey:a.ctrlKey;this.state=a.state;this.cg=a;a.defaultPrevented&&this.preventDefault();delete this.wc};
t.preventDefault=function(){bg.d.preventDefault.call(this);var a=this.cg;if(a.preventDefault)a.preventDefault();else if(a.returnValue=r,$f)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};t.b=aa();function cg(){}var dg=0;t=cg.prototype;t.key=0;t.xc=r;t.Wd=r;t.lb=function(a,b,c,d,e,f){na(a)?this.Bi=m:a&&a.handleEvent&&na(a.handleEvent)?this.Bi=r:g(Error("Invalid listener argument"));this.listener=a;this.ej=b;this.src=c;this.type=d;this.capture=!!e;this.ng=f;this.Wd=r;this.key=++dg;this.xc=r};t.handleEvent=function(a){return this.Bi?this.listener.call(this.ng||this.src,a):this.listener.handleEvent.call(this.listener,a)};var eg={},fg={},gg={},hg={};
function ig(a,b,c,d,e){if(ka(b)){for(var f=0;f<b.length;f++)ig(a,b[f],c,d,e);return p}a:{b||g(Error("Invalid event type"));d=!!d;var h=fg;b in h||(h[b]={f:0,qa:0});h=h[b];d in h||(h[d]={f:0,qa:0},h.f++);var h=h[d],f=qa(a),k;h.qa++;if(h[f]){k=h[f];for(var i=0;i<k.length;i++)if(h=k[i],h.listener==c&&h.ng==e){if(h.xc)break;k[i].Wd=r;a=k[i].key;break a}}else k=h[f]=[],h.f++;var l=jg,n=Zf?function(a){return l.call(n.src,n.key,a)}:function(a){a=l.call(n.src,n.key,a);if(!a)return a},i=n;i.src=a;h=new cg;
h.lb(c,i,a,b,d,e);h.Wd=r;c=h.key;i.key=c;k.push(h);eg[c]=h;gg[f]||(gg[f]=[]);gg[f].push(h);a.addEventListener?(a==v||!a.Yh)&&a.addEventListener(b,i,d):a.attachEvent(b in hg?hg[b]:hg[b]="on"+b,i);a=c}return a}function kg(a,b,c,d,e){if(ka(b))for(var f=0;f<b.length;f++)kg(a,b[f],c,d,e);else{d=!!d;a:{f=fg;if(b in f&&(f=f[b],d in f&&(f=f[d],a=qa(a),f[a]))){a=f[a];break a}a=p}if(a)for(f=0;f<a.length;f++)if(a[f].listener==c&&a[f].capture==d&&a[f].ng==e){lg(a[f].key);break}}}
function lg(a){if(!eg[a])return r;var b=eg[a];if(b.xc)return r;var c=b.src,d=b.type,e=b.ej,f=b.capture;c.removeEventListener?(c==v||!c.Yh)&&c.removeEventListener(d,e,f):c.detachEvent&&c.detachEvent(d in hg?hg[d]:hg[d]="on"+d,e);c=qa(c);gg[c]&&(e=gg[c],Bb(e,b),0==e.length&&delete gg[c]);b.xc=m;if(b=fg[d][f][c])b.Oi=m,mg(d,f,c,b);delete eg[a];return m}
function mg(a,b,c,d){if(!d.ye&&d.Oi){for(var e=0,f=0;e<d.length;e++)d[e].xc?d[e].ej.src=p:(e!=f&&(d[f]=d[e]),f++);d.length=f;d.Oi=r;0==f&&(delete fg[a][b][c],fg[a][b].f--,0==fg[a][b].f&&(delete fg[a][b],fg[a].f--),0==fg[a].f&&delete fg[a])}}function ng(a,b,c,d,e){var f=1;b=qa(b);if(a[b]){a.qa--;a=a[b];a.ye?a.ye++:a.ye=1;try{for(var h=a.length,k=0;k<h;k++){var i=a[k];i&&!i.xc&&(f&=og(i,e)!==r)}}finally{a.ye--,mg(c,d,b,a)}}return Boolean(f)}function og(a,b){a.Wd&&lg(a.key);return a.handleEvent(b)}
function jg(a,b){if(!eg[a])return m;var c=eg[a],d=c.type,e=fg;if(!(d in e))return m;var e=e[d],f,h;if(!Zf){f=b||ha("window.event");var k=m in e,i=r in e;if(k){if(0>f.keyCode||f.returnValue!=j)return m;a:{var l=r;if(0==f.keyCode)try{f.keyCode=-1;break a}catch(n){l=m}if(l||f.returnValue==j)f.returnValue=m}}l=new bg;l.lb(f,this);f=m;try{if(k){for(var q=[],u=l.currentTarget;u;u=u.parentNode)q.push(u);h=e[m];h.qa=h.f;for(var w=q.length-1;!l.wc&&0<=w&&h.qa;w--)l.currentTarget=q[w],f&=ng(h,q[w],d,m,l);if(i){h=
e[r];h.qa=h.f;for(w=0;!l.wc&&w<q.length&&h.qa;w++)l.currentTarget=q[w],f&=ng(h,q[w],d,r,l)}}else f=og(c,l)}finally{q&&(q.length=0)}return f}d=new bg(b,this);return f=og(c,d)};function pg(a){E.call(this);this.ml=a;this.C=[]}A(pg,E);var qg=[];pg.prototype.listen=function(a,b,c,d,e){ka(b)||(qg[0]=b,b=qg);for(var f=0;f<b.length;f++){var h=ig(a,b[f],c||this,d||r,e||this.ml||this);this.C.push(h)}return this};pg.prototype.b=function(){pg.d.b.call(this);wb(this.C,lg);this.C.length=0};pg.prototype.handleEvent=function(){g(Error("EventHandler.handleEvent not implemented"))};!Jd&&!Id||Id&&Id&&9<=$d||Jd&&Yd("1.9.1");Id&&Yd("9");function rg(a,b,c,d){fd.call(this,a,b,c,d)}A(rg,fd);rg.prototype.kg=function(){return this.getParent()};function sg(a,b,c,d){Ze.call(this,a,b,c,d)}A(sg,Ze);sg.prototype.Fg=function(a,b){sg.d.Fg.call(this,a,b)};sg.prototype.Ig=x;function tg(a,b,c,d){fd.call(this,a,b,c,d);this.zm=new Lf;this.Fl=new Wf}A(tg,rg);
tg.prototype.ma=function(a){tg.d.ma.call(this,a);var b=this.kg();if(b&&a instanceof Me){this.Fl.ma(a,b.g);var c,d=this.g;d.Fe===j&&(d.Fe=d.sd?d.O.ga().v[d.sd]||p:p);c=d.Fe;var d=ug(c.g),e=d.Qa,f=this.zm,h=16*d.Qa.N+16;f.eg!=h&&(f.eg=h,f.De=m);d.Vd(f);if(a.xb&&(d=b.g,d.re===j&&(d.re=d.ed?d.O.ga().v[d.ed]||p:p),d=d.re)){h=vg;h.time=a.getTime();h.viewport=f;h.Rh=e;h.Kg=c;h.gk=b;h.screenX=0.5;h.screenY=0.5;a.xb&1&&(h.screenX=a.Xg/65535,h.screenY=a.Yg/65535);var b=h.Rg,k=2*(h.screenX/f.width)-1,i=1-2*
(h.screenY/f.height);c=Ye[0];e=Ye[1];C(c,k,i,-1);C(e,k,i,1);cb(f.mc,c,c);cb(f.mc,e,e);Ha(c,e,e);var f=c[1],k=c[2],i=e[0],l=e[1],e=e[2];b[0]=c[0];b[1]=f;b[2]=k;b[3]=i;b[4]=l;b[5]=e;a.qe||(a=a.xb,a&4&&d.Ig(h,0),a&32&&d.Ig(h,1))}}};var vg=new function(){this.time=0;this.gk=this.Kg=this.Rh=this.viewport=p;this.screenY=this.screenX=0;this.Rg=new Float32Array(6)};function wg(a,b,c,d){Ze.call(this,a,b,c,d)}A(wg,sg);wg.prototype.pe=function(){var a=this.g.pe();return Je(this).r.A.q[a]};wg.prototype.Ue=function(a){this.g.Ue(a.id)};
wg.prototype.Ig=function(a,b){var c=a.Rh.rg(a.Rg,100);if(c&&100>=c.Yf)if(0==b){var d=c.Eh,e=c.Fh,f=c.Gh,h=0,k=0,i=0,c=c.Xi;c[0]==d?h--:c[0]==d+1&&h++;c[1]==e?k--:c[1]==e+1&&k++;c[2]==f?i--:c[2]==f+1&&i++;c=d+h;e+=k;f+=i;k=this.pe();i=a.Kg;k=k?k.id<<8:0;Je(this).ra(c,e,f,k,i)}else 1==b&&(f=c.Eh,i=c.Fh,c=c.Gh,e=a.Kg,Je(this).ra(f,i,c,0,e))};function xg(a,b,c,d){fd.call(this,a,b,c,d)}A(xg,fd);xg.prototype.kb=function(){var a=this.g;a.ef===j&&(a.ef=a.Cd?a.O.ga().kb(a.Cd):p);return a.ef};xg.prototype.jg=function(){var a=yg(this.g),b=this.g;b.ce===j&&(b.ce=b.Qc?b.O.ga().v[b.Qc]||p:p);var b=b.ce,c=ug(this.g),d=this.g;d.we===j&&(d.we=d.gd?d.O.ga().v[d.gd]||p:p);return[a,b,c,d.we]};
xg.prototype.Tb=function(a){var b=this.ga(),c=this.g;this.ha=a;c.Dj(a.c);var d=this.Y.Ac,e=Ke(d.g).r;id(this,d);d=b.va(69,md|22);d.ha=a;d.Ve("pumpkin");c.uj(d.D);var f=b.va(68,66);f.ha=a;id(f,d);f.g.zj(this.D);c.wj(f.D);f=b.va(66,66);f.ha=a;id(f,d);f.Tb(a);c.vj(f.D);f=b.va(70,0);f.ha=a;id(f,d);c.xj(f.D);c=[e.A.q[1],e.A.q[2],e.A.q[3],e.A.q[4],e.A.q[5],e.A.q[6],e.A.q[7],e.A.q[8],e.A.q[9]];for(e=0;e<c.length;e++){var h=b.va(72,0);h.ha=a;id(h,f);h.Ue(c[e]);0==e&&d.g.$g(h?h.D:0)}};function zg(a,b){var c=b||vf(Ag,this);X.call(this,a,c);this.Cd="";this.ef=j;this.xm=W(c,Bg);this.Hc=0;this.Id=j;this.hk=W(c,Cg);this.Qc=0;this.ce=j;this.wk=W(c,Dg);this.Lc=0;this.Xd=j;this.nk=W(c,Eg);this.gd=0;this.we=j;this.ul=W(c,Fg)}A(zg,X);var Bg=V++,Cg=V++,Dg=V++,Eg=V++,Fg=V++;t=zg.prototype;t.$k=s("Cd");t.Dj=function(a){this.Cd!=a&&(this.Cd=a,Y(this,this.xm),this.ef=j)};t.Mk=s("Hc");function yg(a){a.Id===j&&(a.Id=a.Hc?a.O.ga().v[a.Hc]||p:p);return a.Id}
t.uj=function(a){this.Hc!=a&&(this.Hc=a,Y(this,this.hk),this.Id=j)};t.Qk=s("Qc");t.wj=function(a){this.Qc!=a&&(this.Qc=a,Y(this,this.wk),this.ce=j)};t.Pk=s("Lc");function ug(a){a.Xd===j&&(a.Xd=a.Lc?a.O.ga().v[a.Lc]||p:p);return a.Xd}t.vj=function(a){this.Lc!=a&&(this.Lc=a,Y(this,this.nk),this.Xd=j)};t.Sk=s("gd");t.xj=function(a){this.gd!=a&&(this.gd=a,Y(this,this.ul),this.we=j)};
function Ag(a){a.push(new qf(Bg,0,zg.prototype.$k,zg.prototype.Dj));a.push(new rf(Cg,0,zg.prototype.Mk,zg.prototype.uj));a.push(new rf(Dg,0,zg.prototype.Qk,zg.prototype.wj));a.push(new rf(Eg,0,zg.prototype.Pk,zg.prototype.vj));a.push(new rf(Fg,0,zg.prototype.Sk,zg.prototype.xj))};function Gg(a,b){var c=b||vf(Hg,this);X.call(this,a,c);this.Gd=0;this.lf=j;this.Bm=W(c,Ig)}A(Gg,X);var Ig=V++;Gg.prototype.bl=s("Gd");function Ke(a){a.lf===j&&(a.lf=a.Gd?a.O.ga().v[a.Gd]||p:p);return a.lf}Gg.prototype.Ej=function(a){this.Gd!=a&&(this.Gd=a,Y(this,this.Bm),this.lf=j)};function Hg(a){a.push(new rf(Ig,0,Gg.prototype.bl,Gg.prototype.Ej))};function Jg(a,b,c,d,e){fd.call(this,a,b,c,d);this.Hj=e}A(Jg,fd);Jg.prototype.Zd=function(a){a instanceof We&&this.Hj.Zb(a)};Jg.prototype.$b=function(a){a instanceof We&&this.Hj.qb(a)};function Kg(a){this.vn=a||Lg;this.xn=[]}function Lg(){this.Rg=new Float32Array(6);this.end=this.start=this.kn=0;this.O=this.wn=p;this.Xi=B();this.Yf=0};function Mg(){Kg.call(this);this.v=[]}A(Mg,Kg);Mg.prototype.Zb=function(a){this.v.push(a)};Mg.prototype.qb=function(a){Bb(this.v,a)};Mg.prototype.forEach=function(a,b){for(var c=0;c<this.v.length&&a.call(b||v,this.v[c])!==r;c++);};Mg.prototype.ki=function(a,b,c){for(a=0;a<this.v.length&&b.call(c||v,this.v[a],0)!==r;a++);};D();function Ng(a,b,c,d){Jg.call(this,a,b,c,d,new Mg);this.r=p}A(Ng,Jg);Ng.prototype.dh=ba("r");Ng.prototype.update=function(a){this.g.Cj(a|0);od(this,2,a+1)};Ng.prototype.ra=function(a,b,c,d,e){var f=this.r;d&&!f.A.q[d>>8]?M("unknown block type",d):f.ra(a,b,c,d)!=d&&(f=this.Of(66),f.x=a,f.y=b,f.l=c,f.data=d,a=e?e.kb():p,kd(this.Y,f,a))};B();function Og(a,b){var c=b||vf(Pg,this);X.call(this,a,c)}A(Og,X);function Pg(){};function Qg(a,b){var c=b||vf(Rg,this);Og.call(this,a,c);this.gh=0;this.mm=W(c,Sg)}A(Qg,Og);var Sg=V++;Qg.prototype.Zk=s("gh");Qg.prototype.Cj=function(a){this.gh!=a&&(this.gh=a,Y(this,this.mm))};function Rg(a){a.push(new jf(Sg,0,Qg.prototype.Zk,Qg.prototype.Cj))};function Tg(a,b){var c=b||vf(Ug,this);X.call(this,a,c)}A(Tg,X);function Ug(){};function Vg(a,b){var c=b||vf(Wg,this);Tg.call(this,a,c);this.sd=0;this.Fe=j;this.Ql=W(c,Xg)}A(Vg,Tg);var Xg=V++;Vg.prototype.Vk=s("sd");Vg.prototype.zj=function(a){this.sd!=a&&(this.sd=a,Y(this,this.Ql),this.Fe=j)};function Wg(a){a.push(new rf(Xg,0,Vg.prototype.Vk,Vg.prototype.zj))};function Yg(a,b){var c=b||vf(Zg,this);Df.call(this,a,c)}A(Yg,Df);function Zg(a){Ef(a)};function $g(a,b){var c=b||vf(ah,this);Yg.call(this,a,c);this.Bf=0;this.jk=W(c,bh)}A($g,Yg);var bh=V++;$g.prototype.pe=s("Bf");$g.prototype.Ue=function(a){this.Bf!=a&&(this.Bf=a,Y(this,this.jk))};function ah(a){Ef(a);a.push(new hf(bh,0,$g.prototype.pe,$g.prototype.Ue))};function ch(a,b,c,d){Ze.call(this,a,b,c,d)}A(ch,sg);function dh(a,b){var c=b||vf(eh,this);Yg.call(this,a,c)}A(dh,Yg);function eh(a){Ef(a)};function fh(a,b,c){this.Ga=a;this.Bk=b;this.km=c;this.Xe=[]}fh.prototype.va=function(a,b,c){return new this.Bk(a,this,b,c)};function gd(a,b){if(a.Xe.length){var c=a.Xe.pop();c.reset(b);return c}return new a.km(b)};function gh(a,b,c,d,e,f){this.Tm=a;this.type=b;this.zn=c;this.userName=d;this.timestamp=e;this.value=f||p};function hh(a){E.call(this);this.F=a;this.h=[];this.dg=[]}A(hh,E);hh.prototype.wf=function(a){if(0<=vb(this.h,a))return p;this.h.push(a);a=new gh(this,0,a.c,a.info.ya,z());this.dg.push(a);return a};hh.prototype.Ke=function(a){return Bb(this.h,a)?(a=new gh(this,1,a.c,a.info.ya,z()),this.dg.push(a),a):p};hh.prototype.postMessage=function(a,b){if(!(0<=vb(this.h,a)))return p;var c=new gh(this,2,a.c,a.info.ya,z(),b);this.dg.push(c);return c};function ih(a){E.call(this);this.Ea=a;this.Mc={};this.zg=[];this.Gj(a.Mb)}A(ih,E);t=ih.prototype;t.b=function(){Cc(this.Mc,K);this.Mc={};ih.d.b.call(this)};t.Gj=x;function jh(a,b,c){var d=a.Mc[b];!d&&c&&(d=new hh(b),a.Mc[b]=d);return d}t.Yi=function(){if(this.zg.length){var a=this.zg;this.zg=[];return a}return p};t.fb=x;t.Uf=x;t.th=x;t.uh=function(a){Cc(this.Mc,function(b){b.Ke(a)})};t.vh=x;function kh(){this.Ta="";this.name="Server";this.location="us";this.Zc="unknown";this.$c="0";this.oc=32;this.Nb={}}kh.prototype.w=function(){var a=new kh;a.Ta=this.Ta;a.name=this.name;a.location=this.location;a.Zc=this.Zc;a.$c=this.$c;a.oc=this.oc;a.Nb=Fc(this.Nb);return a};kh.prototype.toString=ca("[server]");function lh(){this.nc=this.R=0}function mh(a,b){var c=b||new ee;c.Md=a.H();c.Ld=a.H();c.ya=a.H();return c}function nh(a,b){a.o(b.Md);a.o(b.Ld);a.o(b.ya);return m}function oh(a,b){a.o(b.c);Q(a,b.R);a.M(b.z);var c;if(!(c=!nh(a,b.info)))c=b.Jd,a.o(c.type),a.o(c.platform),a.o(c.rd),a.o(c.Tc),c=r;return c?r:m}var ph=new function(){this.nc=this.Oc=this.Te=0},qh=new function(){this.Oc=this.Te=0;this.gf=[]};
function rh(a,b){var c=ph.Oc,d=R();qh.Te=a;qh.Oc=c;qh.gf=b;Q(d,2);d.M(qh.Te);d.M(qh.Oc);d.M(qh.gf.length);for(c=0;c<qh.gf.length;c++){var e=d,f=qh.gf[c];Q(e,f.R);wd(e,f.nc)}return d.finish()}var sh=new function(){this.info=new kh;this.h=[]};
function th(a,b){var c=R();sh.info=a;sh.h=b;var d;a:{Q(c,3);d=sh.info;c.o(d.Ta);c.o(d.name);c.o(d.location);c.o(d.Zc);c.o(d.$c);c.M(d.oc);var e=0,f;for(f in d.Nb)e++;c.M(e);for(var h in d.Nb)e=d.Nb[h],c.o(h),c.o(e);c.M(sh.h.length);for(d=0;d<sh.h.length;d++)if(!oh(c,sh.h[d])){d=r;break a}d=m}return!d?(c.hb(),p):c.finish()}function uh(){this.Kd=this.Ye=0;this.I=new fe}var vh=new uh,wh=new uh;
function xh(a,b){var c=R();wh.Ye=3;wh.Kd=a;wh.I=b;Q(c,4);wd(c,wh.Ye);wd(c,wh.Kd);return!oh(c,wh.I)?(c.hb(),p):c.finish()}function yh(){this.reason=0}var zh=new yh,Ah=new yh,Bh=new function(){this.I=new fe};function Ch(a){var b=R();Bh.I=a;Q(b,6);return!oh(b,Bh.I)?(b.hb(),p):b.finish()}var Dh=new function(){this.c="";this.reason=0};function Eh(a,b){var c=R();Dh.c=a;Dh.reason=b;Q(c,7);c.o(Dh.c);c.M(Dh.reason);return c.finish()}function Fh(){this.c="";this.info=new ee}var Gh=new Fh,Hh=new Fh;
function Ih(a,b){var c=R();Hh.c=a;Hh.info=b;Q(c,8);c.o(Hh.c);return!nh(c,Hh.info)?(c.hb(),p):c.finish()}function Jh(){this.F=this.c="";this.timestamp=0;this.Fc=[]}var Kh=new Jh,Lh=new Jh;function Mh(a,b,c,d){var e=R();Lh.c=a;Lh.F=b;Lh.timestamp=c;Lh.Fc=d;Q(e,20);e.o(Lh.c);e.o(Lh.F);e.M(Lh.timestamp);e.M(Lh.Fc.length);for(a=0;a<Lh.Fc.length;a++)e.o(Lh.Fc[a]);return e.finish()}function Nh(){this.F=this.c="";this.timestamp=0}var Oh=new Nh,Ph=new Nh;
function Qh(){this.F=this.c="";this.timestamp=0;this.message=""}var Rh=new Qh,Sh=new Qh;function Th(a){ih.call(this,a);this.Se=a}A(Th,ih);t=Th.prototype;t.join=function(a,b,c){if(b=jh(this,b,m)){var d=z();fa(c)&&1E3>d-c&&(d=c);b.wf(a);var e=Array(b.h.length);for(c=0;c<b.h.length;c++){var f=b.h[c];e[c]=f.c}this.Se.send(Mh(f.c,b.F,d,e),a);d=Mh(a.c,b.F,d,[]);for(c=0;c<b.h.length;c++)f=b.h[c],f!=a&&this.Se.send(d,f)}};t.Gj=function(a){Ge(a,20,this.cl,this);Ge(a,21,this.dl,this);Ge(a,22,this.el,this)};
t.cl=function(a,b,c){a=a.I;if(!a)return r;Kh.c=c.H();Kh.F=c.H();Kh.timestamp=c.ia();b=c.ia();Kh.Fc.length=b;for(var d=0;d<b;d++)Kh.Fc[d]=c.H();if(!Kh)return r;if(Kh.c!=a.c)return M("user info mismatch"),r;this.join(a,Kh.F,Kh.timestamp);return m};
t.dl=function(a,b,c){a=a.I;if(!a)return r;Oh.c=c.H();Oh.F=c.H();Oh.timestamp=c.ia();if(!Oh)return r;if(Oh.c!=a.c)return M("user info mismatch"),r;b=Oh.timestamp;if(c=jh(this,Oh.F,r)){var d=z();fa(b)&&1E3>d-b&&(d=b);b=a.c;var e=c.F,f=R();Ph.c=b;Ph.F=e;Ph.timestamp=d;Q(f,21);f.o(Ph.c);f.o(Ph.F);f.M(Ph.timestamp);b=f.finish();for(e=0;e<c.h.length;e++)this.Se.send(b,c.h[e]);c.Ke(a)}return m};
t.el=function(a,b,c){a=a.I;if(!a)return r;Rh.c=c.H();Rh.F=c.H();Rh.timestamp=c.ia();Rh.message=c.H();if(!Rh)return r;if(Rh.c!=a.c)return M("user info mismatch"),r;c=jh(this,Rh.F,r);if(!c)return m;c.postMessage(a,Rh.message);a=a.c;b=c.F;var d=z(),e=Rh.message,f=R();Sh.c=a;Sh.F=b;Sh.timestamp=d;Sh.message=e;Q(f,22);f.o(Sh.c);f.o(Sh.F);f.M(Sh.timestamp);f.o(Sh.message);a=f.finish();for(b=0;b<c.h.length;b++)this.Se.send(a,c.h[b]);return m};function Uh(a,b,c){E.call(this);a.G=b.G;this.Kk=a;this.Ea=b;this.Ea.W.push(this);this.Ph=new Th(b);this.Ea.W.push(this.Ph);b=a.Fi;var d=new Lb;d.ni=b.yl;d.Qe=b.Al;this.r=new ad(d,c);J(this,this.r);this.Pa=new Ie(a,this.Ea,ke);J(this,this.Pa);a=this.Pa;c=new te(64,Re,0);a.Sa[c.Ga]=c;c=new te(65,Me,2);a.Sa[c.Ga]=c;c=new te(66,Se,0);a.Sa[c.Ga]=c;c=new te(67,Te,2);a.Sa[c.Ga]=c;a=this.Pa;Ae(a,new fh(64,Le,Gg));Ae(a,new fh(65,Ng,Qg));Ae(a,new fh(66,Pf,Rf));Ae(a,new fh(67,xg,zg));Ae(a,new fh(68,tg,Vg));
Ae(a,new fh(69,$e,If));Ae(a,new fh(70,Tf,Uf));Ae(a,new fh(71,ch,dh));Ae(a,new fh(72,wg,$g));this.rb=p;this.Wi=[];this.Li=new Kb(this.Kk.Jc);J(this,this.Li)}A(Uh,E);t=Uh.prototype;t.ga=s("Pa");t.ic=s("rb");t.kl=x;t.load=function(){var a=new O;this.rb=this.Pa.va(64,128);this.rb.mi=this;this.Fj();var b=this.Ea;b.Tg=m;b.state=1;b.ja.ka(y(b.lg,b));for(var c=0;c<b.W.length;c++)b.W[c].fb();M("Server ready, listening on",b.ja.Ta.toString());a.e(p);return a};
t.th=function(a){M("client connected",a.c,a.info,a.Jd);this.Ph.join(a,"main");var b=this.Xh(a);a.data=b;this.Wi.push(b);this.Ea.send(me(),a);this.kl()};t.uh=function(a){M("client disconnected",a.c);if(a=a.data)this.ga().qb(a),hd(a.Y.Ac,0),Bb(this.Wi,a),K(a)};t.vh=x;Uh.dk=5;Uh.prototype.update=function(a){2!=this.Ea.state&&(this.Ea.Yi(Uh.dk),2==this.Ea.state?M("Server disconnected!?"):(this.r.update(a),this.Pa.update(a)))};Uh.prototype.yc=aa();Uh.prototype.fb=x;Uh.prototype.Uf=x;
Uh=ye(Uh,"blk.game.server.ServerController",{load:"load",update:"update",yc:"render"});function Vh(a,b,c){Uh.call(this,a,b,c);this.mf=p}A(Vh,Uh);Vh.prototype.Fj=function(){var a=this.ic();this.mf=this.Pa.va(65,0);id(this.mf,a);this.mf.dh(this.r);a.g.Ej(this.mf.D)};Vh.prototype.Xh=function(a){var b=this.ga().va(67,0);b.Tb(a);a=yg(b.g);id(a,Je(b));var c=Ba(0,80,0);a.g.setPosition(c);hd(b.Y.Ac,0);return b};Vh=ye(Vh,"blk.game.fps.FpsServerController",{Fj:"setupSimulation",Xh:"createPlayer"});function Wh(){this.nm=this.ih=this.time=this.ig=0}Wh.prototype.lb=function(a,b,c,d){this.ig=a;this.time=b;this.ih=c;this.nm=d};function Xh(a){this.Me=a}Xh.prototype.yd=function(a){var b=[];Yh(this,a,b);return b.join("")};
function Yh(a,b,c){switch(typeof b){case "string":Zh(b,c);break;case "number":c.push(isFinite(b)&&!isNaN(b)?b:"null");break;case "boolean":c.push(b);break;case "undefined":c.push("null");break;case "object":if(b==p){c.push("null");break}if(ka(b)){var d=b.length;c.push("[");for(var e="",f=0;f<d;f++)c.push(e),e=b[f],Yh(a,a.Me?a.Me.call(b,String(f),e):e,c),e=",";c.push("]");break}c.push("{");d="";for(f in b)Object.prototype.hasOwnProperty.call(b,f)&&(e=b[f],"function"!=typeof e&&(c.push(d),Zh(f,c),c.push(":"),
Yh(a,a.Me?a.Me.call(b,f,e):e,c),d=","));c.push("}");break;case "function":break;default:g(Error("Unknown type: "+typeof b))}}var $h={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\x0B":"\\u000b"},ai=/\uffff/.test("\uffff")?/[\\\"\x00-\x1f\x7f-\uffff]/g:/[\\\"\x00-\x1f\x7f-\xff]/g;
function Zh(a,b){b.push('"',a.replace(ai,function(a){if(a in $h)return $h[a];var b=a.charCodeAt(0),e="\\u";16>b?e+="000":256>b?e+="00":4096>b&&(e+="0");return $h[a]=e+b.toString(16)}),'"')};function bi(){this.om=Bc();this.$d=this.nc=this.Ib=0;this.en=r}function He(a){return(Bc()-a.om)/1E3};function ci(a,b){E.call(this);this.Fi=a;this.G=b||new bi;this.Lf=[];this.Rm=p}A(ci,E);ci.prototype.b=function(){hb(this.Lf);this.Lf.length=0;ci.d.b.call(this)};ci.prototype.getTime=function(){return He(this.G)+this.G.$d};function di(){this.ih=this.time=this.ig=0;this.hasFocus=r}di.prototype.lb=function(a,b,c,d){this.ig=a;this.time=b;this.ih=c;this.hasFocus=d};function ei(a,b,c,d){E.call(this);this.ib=new pg(this);J(this,this.ib);this.sh=a;this.Gf=this.zc=this.Vf=p;if(!b){if(a=v.requestAnimationFrame||v.webkitRequestAnimationFrame||v.mozRequestAnimationFrame||v.oRequestAnimationFrame||v.msRequestAnimationFrame)this.zc=a;if(a=v.cancelAnimationFrame||v.webkitCancelAnimationFrame||v.mozCancelAnimationFrame||v.oCancelAnimationFrame||v.msCancelAnimationFrame)this.Gf=a}this.Pb=0;this.lc=p;this.vg=0;this.Dc=m;this.hg=d||0;this.We=p;c&&(this.ib.listen(v,"blur",
function(){this.Dc=r}),this.ib.listen(v,"focus",function(){this.Dc||(this.Dc=m,this.Pb&&this.start(m))}))}A(ei,E);ei.prototype.b=function(){this.stop(m);this.Vf=p;ei.d.b.call(this)};ei.prototype.hasFocus=s("Dc");
ei.prototype.start=function(a){if(!a&&(this.Pb++,1<this.Pb))return;if(this.Dc){var b=this;this.lc=this.zc?this.zc.call(v,function(){fi(b)},this.Vf):v.setTimeout(function(){fi(b)},62.5)}this.sh(Bc());this.hg&&(b=this,this.We=v.setInterval(xe(function(){var a=b;if(Bc()-a.vg>=a.hg&&a.Pb){var d=Bc();a.vg=d;a.sh(d)}},"gf.timing.RenderTimer#simulateTick"),this.hg))};
ei.prototype.stop=function(a){if(a||this.Pb)a||this.Pb--,this.Pb||(a=this.lc,this.Gf?this.Gf.call(v,a):this.zc||v.clearTimeout(a),this.lc=p,this.We!==p&&(v.clearInterval(this.We),this.We=p))};function fi(a){if(a.lc!==p){a.lc=p;a.Dc&&(a.lc=a.zc?a.zc.call(v,function(){fi(a)},a.Vf):v.setTimeout(function(){fi(a)},16));var b=Bc();a.vg=b;a.sh(b)}};function gi(a,b){ci.call(this,a,b);this.zk=new pg(this);J(this,this.zk);this.md=He(this.G);this.Ek=m;this.Fk=gi.$j;this.Ec=0;this.vm=new di;this.um=0;this.Zl=new Wh;this.Yl=0;var c=this;this.Le=new ei(function(a){c.jj(a)},j,j,500);J(this,this.Le);this.hh=r}A(gi,ci);gi.$j=0.016777;gi.Bh=0.25;t=gi.prototype;
t.jj=function(){var a=He(this.G),b=a-this.md;this.md=a;b>gi.Bh&&(b=gi.Bh);this.Ec+=b;a=1;if(this.Ek){for(a=this.Fk;this.Ec>=a;){this.rh(this.G.Ib,a);var c=this.G;c.Ib+=a;this.Ec-=a;if(!this.hh)break}a=this.Ec/a}else this.rh(this.G.Ib,b),c=this.G,c.Ib+=b;this.Le.hasFocus()&&this.kj(He(this.G)+this.G.$d,b,a)};t.rh=function(a,b){if(!(0>=b)){var c=this.vm;c.lb(this.um++,a,b,this.Le.hasFocus());this.update(c)}};t.kj=function(a,b,c){var d=this.Zl;d.lb(this.Yl++,a,b,c);this.yc(d)};t.update=x;t.yc=x;
gi=ye(gi,"gf.Game",{jj:"renderTick_",rh:"update_",kj:"render_"});function hi(a,b){ne.call(this,a);this.Wm=b||p}A(hi,ne);hi.prototype.load=function(a){var b=new O(function(){a.cancel()},this);a.load(b);return b};function ii(a,b,c,d){E.call(this);this.method=a;this.url=b;this.content=c||p;this.headers=d?Fc(d):{}}A(ii,E);function ji(a,b){this.statusCode=a;this.content=b||p};function ki(){E.call(this)}A(ki,E);t=ki.prototype;t.Yh=m;t.Gg=p;t.addEventListener=function(a,b,c,d){ig(this,a,b,c,d)};t.removeEventListener=function(a,b,c,d){kg(this,a,b,c,d)};
t.dispatchEvent=function(a){var b=a.type||a,c=fg;if(b in c){if(ma(a))a=new ag(a,this);else if(a instanceof ag)a.target=a.target||this;else{var d=a;a=new ag(b,this);Hc(a,d)}var d=1,e,c=c[b],b=m in c,f;if(b){e=[];for(f=this;f;f=f.Gg)e.push(f);f=c[m];f.qa=f.f;for(var h=e.length-1;!a.wc&&0<=h&&f.qa;h--)a.currentTarget=e[h],d&=ng(f,e[h],a.type,m,a)&&a.Oe!=r}if(r in c)if(f=c[r],f.qa=f.f,b)for(h=0;!a.wc&&h<e.length&&f.qa;h++)a.currentTarget=e[h],d&=ng(f,e[h],a.type,r,a)&&a.Oe!=r;else for(e=this;!a.wc&&e&&
f.qa;e=e.Gg)a.currentTarget=e,d&=ng(f,e,a.type,r,a)&&a.Oe!=r;a=Boolean(d)}else a=m;return a};t.b=function(){ki.d.b.call(this);var a=0;if(this!=p){var b=qa(this);if(gg[b])for(var b=gg[b],c=b.length-1;0<=c;c--)lg(b[c].key),a++}else Cc(eg,function(b,c){lg(c);a++});this.Gg=p};var li=v.window;var mi="StopIteration"in v?v.StopIteration:Error("StopIteration");function ni(){}ni.prototype.next=function(){g(mi)};ni.prototype.sf=function(){return this};function oi(a){if(a instanceof ni)return a;if("function"==typeof a.sf)return a.sf(r);if(la(a)){var b=0,c=new ni;c.next=function(){for(;;){b>=a.length&&g(mi);if(b in a)return a[b++];b++}};return c}g(Error("Not implemented"))};function pi(a,b){this.r={};this.C=[];var c=arguments.length;if(1<c){c%2&&g(Error("Uneven number of arguments"));for(var d=0;d<c;d+=2)this.set(arguments[d],arguments[d+1])}else if(a){a instanceof pi?(c=a.Ka(),d=a.za()):(c=Ec(a),d=Dc(a));for(var e=0;e<c.length;e++)this.set(c[e],d[e])}}t=pi.prototype;t.f=0;t.Ed=0;t.fa=s("f");t.za=function(){qi(this);for(var a=[],b=0;b<this.C.length;b++)a.push(this.r[this.C[b]]);return a};t.Ka=function(){qi(this);return this.C.concat()};
t.Cb=function(a){return ri(this.r,a)};t.clear=function(){this.r={};this.Ed=this.f=this.C.length=0};t.remove=function(a){return ri(this.r,a)?(delete this.r[a],this.f--,this.Ed++,this.C.length>2*this.f&&qi(this),m):r};function qi(a){if(a.f!=a.C.length){for(var b=0,c=0;b<a.C.length;){var d=a.C[b];ri(a.r,d)&&(a.C[c++]=d);b++}a.C.length=c}if(a.f!=a.C.length){for(var e={},c=b=0;b<a.C.length;)d=a.C[b],ri(e,d)||(a.C[c++]=d,e[d]=1),b++;a.C.length=c}}t.get=function(a,b){return ri(this.r,a)?this.r[a]:b};
t.set=function(a,b){ri(this.r,a)||(this.f++,this.C.push(a),this.Ed++);this.r[a]=b};t.w=function(){return new pi(this)};t.sf=function(a){qi(this);var b=0,c=this.C,d=this.r,e=this.Ed,f=this,h=new ni;h.next=function(){for(;;){e!=f.Ed&&g(Error("The map has changed since the iterator was created"));b>=c.length&&g(mi);var h=c[b++];return a?h:d[h]}};return h};function ri(a,b){return Object.prototype.hasOwnProperty.call(a,b)};function si(a){return ti(a||arguments.callee.caller,[])}
function ti(a,b){var c=[];if(0<=vb(b,a))c.push("[...circular reference...]");else if(a&&50>b.length){c.push(ui(a)+"(");for(var d=a.arguments,e=0;e<d.length;e++){0<e&&c.push(", ");var f;f=d[e];switch(typeof f){case "object":f=f?"object":"null";break;case "string":break;case "number":f=String(f);break;case "boolean":f=f?"true":"false";break;case "function":f=(f=ui(f))?f:"[fn]";break;default:f=typeof f}40<f.length&&(f=f.substr(0,40)+"...");c.push(f)}b.push(a);c.push(")\n");try{c.push(ti(a.caller,b))}catch(h){c.push("[exception trying to get caller]\n")}}else a?
c.push("[...long stack...]"):c.push("[end]");return c.join("")}function ui(a){if(vi[a])return vi[a];a=String(a);if(!vi[a]){var b=/function ([^\(]+)/.exec(a);vi[a]=b?b[1]:"[Anonymous]"}return vi[a]}var vi={};function wi(a,b,c,d,e){this.reset(a,b,c,d,e)}wi.prototype.em=0;wi.prototype.fi=p;wi.prototype.ei=p;var xi=0;wi.prototype.reset=function(a,b,c,d,e){this.em="number"==typeof e?e:xi++;this.$e=d||z();this.nd=a;this.Gl=b;this.hn=c;delete this.fi;delete this.ei};wi.prototype.yj=ba("nd");function yi(a){this.Ni=a}yi.prototype.P=p;yi.prototype.nd=p;yi.prototype.J=p;yi.prototype.dd=p;function zi(a,b){this.name=a;this.value=b}zi.prototype.toString=s("name");var Ai=new zi("SEVERE",1E3),Bi=new zi("WARNING",900),Ci=new zi("INFO",800),Di=new zi("CONFIG",700),Ei=new zi("FINE",500);t=yi.prototype;t.getName=s("Ni");t.getParent=s("P");t.yj=ba("nd");function Fi(a){return a.nd?a.nd:a.P?Fi(a.P):p}
t.log=function(a,b,c){if(a.value>=Fi(this).value){a=this.Tk(a,b,c);b="log:"+a.Gl;v.console&&(v.console.timeStamp?v.console.timeStamp(b):v.console.markTimeline&&v.console.markTimeline(b));v.msWriteProfilerMark&&v.msWriteProfilerMark(b);for(b=this;b;){c=b;var d=a;if(c.dd)for(var e=0,f=j;f=c.dd[e];e++)f(d);b=b.getParent()}}};
t.Tk=function(a,b,c){var d=new wi(a,String(b),this.Ni);if(c){d.fi=c;var e;var f=arguments.callee.caller;try{var h;var k=ha("window.location.href");if(ma(c))h={message:c,name:"Unknown error",lineNumber:"Not available",fileName:k,stack:"Not available"};else{var i,l,n=r;try{i=c.lineNumber||c.fn||"Not available"}catch(q){i="Not available",n=m}try{l=c.fileName||c.filename||c.sourceURL||k}catch(u){l="Not available",n=m}h=n||!c.lineNumber||!c.fileName||!c.stack?{message:c.message,name:c.name,lineNumber:i,
fileName:l,stack:c.stack||"Not available"}:c}e="Message: "+lb(h.message)+'\nUrl: <a href="view-source:'+h.fileName+'" target="_new">'+h.fileName+"</a>\nLine: "+h.lineNumber+"\n\nBrowser stack:\n"+lb(h.stack+"-> ")+"[end]\n\nJS stack traversal:\n"+lb(si(f)+"-> ")}catch(w){e="Exception trying to expose exception! You win, we lose. "+w}d.ei=e}return d};t.info=function(a,b){this.log(Ci,a,b)};function Gi(a,b){a.log(Ei,b,j)}t.tf=function(a,b){this.J||(this.J={});this.J[a]=b};var Hi={},Ii=p;
function Ji(a){Ii||(Ii=new yi(""),Hi[""]=Ii,Ii.yj(Di));var b;if(!(b=Hi[a])){b=new yi(a);var c=a.lastIndexOf("."),d=a.substr(c+1),c=Ji(a.substr(0,c));c.tf(d,b);b.P=c;Hi[a]=b}return b};function Ki(){}Ki.prototype.Oh=p;function Li(a){var b;if(!(b=a.Oh))b={},Mi(a)&&(b[0]=m,b[1]=m),b=a.Oh=b;return b};var Ni;function Oi(){}A(Oi,Ki);Oi.prototype.ee=function(){var a=Mi(this);return a?new ActiveXObject(a):new XMLHttpRequest};
function Mi(a){if(!a.ui&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var b=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],c=0;c<b.length;c++){var d=b[c];try{return new ActiveXObject(d),a.ui=d}catch(e){}}g(Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed"))}return a.ui}Ni=new Oi;var Pi=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#(.*))?$");function Qi(a){E.call(this);this.headers=new pi;this.qf=a||p}A(Qi,ki);Qi.prototype.V=Ji("goog.net.XhrIo");var Ri=/^https?$/i;t=Qi.prototype;t.Za=r;t.u=p;t.pf=p;t.xe="";t.Di="";t.jd=0;t.kd="";t.$f=r;t.te=r;t.qg=r;t.Lb=r;t.Bd=0;t.Ub=p;t.mj="";t.Am=r;
t.send=function(a,b,c,d){this.u&&g(Error("[goog.net.XhrIo] Object is active with another request="+this.xe+"; newUri="+a));b=b?b.toUpperCase():"GET";this.xe=a;this.kd="";this.jd=0;this.Di=b;this.$f=r;this.Za=m;this.u=this.qf?this.qf.ee():Ni.ee();this.pf=this.qf?Li(this.qf):Li(Ni);this.u.onreadystatechange=y(this.Ti,this);try{Gi(this.V,Si(this,"Opening Xhr")),this.qg=m,this.u.open(b,a,m),this.qg=r}catch(e){Gi(this.V,Si(this,"Error opening Xhr: "+e.message));Ti(this,e);return}a=c||"";var f=this.headers.w();
d&&Jc(d,function(a,b){f.set(b,a)});d=v.FormData&&a instanceof v.FormData;"POST"==b&&(!f.Cb("Content-Type")&&!d)&&f.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");Jc(f,function(a,b){this.u.setRequestHeader(b,a)},this);this.mj&&(this.u.responseType=this.mj);"withCredentials"in this.u&&(this.u.withCredentials=this.Am);try{this.Ub&&(li.clearTimeout(this.Ub),this.Ub=p),0<this.Bd&&(Gi(this.V,Si(this,"Will abort after "+this.Bd+"ms if incomplete")),this.Ub=li.setTimeout(y(this.pm,
this),this.Bd)),Gi(this.V,Si(this,"Sending request")),this.te=m,this.u.send(a),this.te=r}catch(h){Gi(this.V,Si(this,"Send error: "+h.message)),Ti(this,h)}};t.pm=function(){"undefined"!=typeof da&&this.u&&(this.kd="Timed out after "+this.Bd+"ms, aborting",this.jd=8,Gi(this.V,Si(this,this.kd)),this.dispatchEvent("timeout"),this.abort(8))};function Ti(a,b){a.Za=r;a.u&&(a.Lb=m,a.u.abort(),a.Lb=r);a.kd=b;a.jd=5;Ui(a);Vi(a)}
function Ui(a){a.$f||(a.$f=m,a.dispatchEvent("complete"),a.dispatchEvent("error"))}t.abort=function(a){this.u&&this.Za&&(Gi(this.V,Si(this,"Aborting")),this.Za=r,this.Lb=m,this.u.abort(),this.Lb=r,this.jd=a||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Vi(this))};t.b=function(){this.u&&(this.Za&&(this.Za=r,this.Lb=m,this.u.abort(),this.Lb=r),Vi(this,m));Qi.d.b.call(this)};t.Ti=function(){!this.qg&&!this.te&&!this.Lb?this.Ll():Wi(this)};t.Ll=function(){Wi(this)};
function Wi(a){if(a.Za&&"undefined"!=typeof da)if(a.pf[1]&&4==a.Kb()&&2==Xi(a))Gi(a.V,Si(a,"Local request error detected and ignored"));else if(a.te&&4==a.Kb())li.setTimeout(y(a.Ti,a),0);else if(a.dispatchEvent("readystatechange"),4==a.Kb()){Gi(a.V,Si(a,"Request complete"));a.Za=r;try{if(Yi(a))a.dispatchEvent("complete"),a.dispatchEvent("success");else{a.jd=6;var b;try{b=2<a.Kb()?a.u.statusText:""}catch(c){Gi(a.V,"Can not get status: "+c.message),b=""}a.kd=b+" ["+Xi(a)+"]";Ui(a)}}finally{Vi(a)}}}
function Vi(a,b){if(a.u){var c=a.u,d=a.pf[0]?x:p;a.u=p;a.pf=p;a.Ub&&(li.clearTimeout(a.Ub),a.Ub=p);b||a.dispatchEvent("ready");try{c.onreadystatechange=d}catch(e){a.V.log(Ai,"Problem encountered resetting onreadystatechange: "+e.message,j)}}}
function Yi(a){var b=Xi(a),c;a:switch(b){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:c=m;break a;default:c=r}if(!c){if(b=0===b)a=String(a.xe).match(Pi)[1]||p,!a&&self.location&&(a=self.location.protocol,a=a.substr(0,a.length-1)),b=!Ri.test(a?a.toLowerCase():"");c=b}return c}t.Kb=function(){return this.u?this.u.readyState:0};function Xi(a){try{return 2<a.Kb()?a.u.status:-1}catch(b){return a.V.log(Bi,"Can not get status: "+b.message,j),-1}}
function Si(a,b){return b+" ["+a.Di+" "+a.xe+" "+Xi(a)+"]"};function Zi(a,b,c,d){ii.call(this,a,b,c,d)}A(Zi,ii);function $i(a,b,c,d){a=new Zi(a,b,c,d);var e=new O,f=new Qi;f.Bd=Math.max(0,2E4);var h=ig(f,"complete",function(){var a=Xi(f),b;try{b=f.u?f.u.responseText:""}catch(c){Gi(f.V,"Can not get responseText: "+c.message),b=""}a=new ji(a,b);lg(h);K(f);Yi(f)?e.e(a):e.a(a)});f.send(a.url,a.method,a.content,a.headers);return e};function aj(a,b,c){E.call(this);this.Pm=a;this.Zg=a+"api/server/"+b;this.og={"X-GF-Version":"1","X-GF-Server-ID":b,"X-GF-Server-Key":c}}A(aj,E);function bj(a,b,c){gi.call(this,a,b.G);this.Jc=new hi(this);J(this,this.Jc);this.Lf.push(this.Jc);this.ac=new Vh(this,b,c);J(this,this.ac);this.cb=p;1==b.type&&(a.Ef&&a.rj&&a.tj)&&(this.cb=new aj(a.Ef,a.rj,a.tj),J(this,this.cb));this.Sd=p}A(bj,gi);t=bj.prototype;t.b=function(){this.Sd&&(v.clearTimeout(this.Sd),this.Sd=p);if(this.cb){var a=this.cb;$i("DELETE",a.Zg,j,a.og)}bj.d.b.call(this)};
t.Rj=function(){if(this.cb){for(var a=this.ac.Ea,b=[],c=0;c<a.h.length;c++)b.push(a.h[c].info);for(var a=this.cb,c=[],d=0;d<b.length;d++)c.push({display_name:b[d].ya});b=(new Xh(j)).yd({user_count:c.length,users:c});b=$i("POST",a.Zg,b,a.og);a=function(){this.Sd=v.setTimeout(y(this.Rj,this),5E3)};P(b,a,a,this)}};
t.load=function(){if(this.cb){var a=this.Fi,b;b=this.cb;var c=this.ac.Ea.sj,d=[],e;for(e in c.Nb)d.push(e+"="+c.Nb[e]);c=(new Xh(j)).yd({endpoint:c.Ta,server_name:c.name,server_location:c.location,game_type:c.Zc,game_version:c.$c,game_properties:d,user_max:c.oc});b=$i("PUT",b.Zg,c,b.og);P(b,function(){M("Registered with server browser at "+a.Ef);this.Rj()},function(a){M("Unable to register with server browser: ",a)},this)}return this.ac.load()};t.update=function(a){this.ac.update(a)};t.yc=function(a){this.ac.yc(a)};
bj=ye(bj,"blk.game.server.ServerGame",{update:"update",yc:"render"});function cj(){this.version=0};function dj(){E.call(this);this.pa=[];this.Ng=[];this.yg=r;this.se=0;this.rc=m;this.Qh=new Nf}A(dj,E);dj.ek=8;dj.prototype.update=function(){this.ob();for(var a=Bc();this.Ng.length&&!(Bc()-a>dj.ek);){var b=this.Ng.shift(),c=b.Ck,d=b.error,b=b.data,e;if(e=!d)if(e=b)if(e=c.Nc){e=this.Qh;var f=c.Nc,h=b,k=df();k.ka(h,0);e=e.$h(f,k)}e?(c.Nc.ub=b,c.la.e(p)):c.la.a(d)}};function ej(a,b,c,d){fj(a,b);a=new cj;!c&&d?b.la.e(a):b.la.a(c)}function gj(a,b,c){fj(a,b);c?b.la.a(c):b.la.e(p)}
function hj(a,b,c,d){fj(a,b);a.Ng.push({Ck:b,error:c,data:d})}function bd(a,b){var c=new O,d=new Pc(c,ij,b.x,b.y,b.l);d.version=b.version;b.ub?d.data=b.ub:(d.data=a.Qh.yd(b),b.ub=d.data);d.data?(a.pa.push(d),a.rc||a.ob()):c.a(p);return c}function jj(a,b,c){fj(a,b);c?b.la.a(c):b.la.e(p)}function kj(a,b,c){fj(a,b);c?b.la.a(c):b.la.e(p)}dj.prototype.ob=function(){if(!this.rc){!this.se&&this.yg&&(this.yg=r,this.lj());for(;1>this.se&&this.pa.length;){var a=this.pa[0];this.se++;this.Pg(a)}}};
dj.prototype.lj=function(){for(var a=this.pa.length-1,b=0;b<this.pa.length;b++)if(this.pa[b].uc==Number.MAX_VALUE){a=b-1;break}if(a)if(a==this.pa.length-1)Eb(this.pa,lj);else{a=this.pa.slice(0,a);Eb(a,lj);for(b=0;b<a.length;b++)this.pa[b]=a[b]}};function fj(a,b){a.se--;Bb(a.pa,b);a.ob()}var Qc=2,ij=3;function Pc(a,b,c,d,e){this.la=a;this.action=b;this.x=c;this.y=d;this.l=e;this.Nc=p;this.uc=Number.MAX_VALUE;this.version=0;this.data=p}function lj(a,b){return a.uc-b.uc}
dj=ye(dj,"blk.io.MapStore",{update:"update",ob:"pump_",lj:"resortQueue_"});function mj(a,b,c,d,e,f){E.call(this);this.x=a;this.y=b;this.l=c;this.key=d;this.fg=e;this.bn=f;this.sg=z();this.aj=r;this.aa=new Uint32Array(1024);this.L=[m];this.S=this.m=p}A(mj,E);function nj(a,b){return b.sg-a.sg}mj.prototype.b=function(){K(this.m);K(this.S);mj.d.b.call(this)};mj.prototype.gc=function(a,b,c){return 32*(c>>4&31)+(a>>4&31)};mj.prototype.Hd=function(a,b){var c=Array.prototype.slice.call(arguments,1);c.unshift(4096*a);return this.S.write.apply(this.S,c)};function oj(a,b){E.call(this);this.Cl=a;this.Ud={};this.q=[];this.am=b}A(oj,E);oj.prototype.b=function(){this.clear();oj.d.b.call(this)};
oj.prototype.get=function(a,b,c){var d=a>>9,e=c>>9,f=[d,0,e,"blkregion"].join("."),h=new O;(a=this.Ud[f])?(a.sg=z(),h.e(a)):P(this.am.getFile(f,2),function(a){if(this.q.length>=this.Cl&&this.q.length){Eb(this.q,nj);var b=this.q[this.q.length-1];delete this.Ud[b.key];K(b);this.q.length--}var c=new mj(d<<9,0,e<<9,f,a,0);this.Ud[f]=c;this.q.push(c);var n=new O;a=[c.fg.createReader(),c.fg.createWriter()];a=new $c(a,r,m);P(a,function(a){return yb(a,function(a){return a[1]})},p,j);P(a,function(a){this.m=
a[0];this.S=a[1];this.m.jb()?P(this.m.read(0,4096,this.aa.buffer),function(a){a!=this.aa.buffer&&(this.aa=new Uint32Array(a));a=this.S.jb()/4096;this.L.length=a;this.L[0]=m;for(a=1;a<this.L.length;a++)this.L[a]=r;for(a=0;a<this.aa.length;a++){var b=this.aa[a],c=b>>8,b=b&255;if(c)for(var d=0;d<b;d++)this.L[c+d]=m}this.aj=m;n.e(p)},function(a){n.a(a)},this):P(this.Hd(0,this.aa.buffer),function(){this.aj=m;n.e(p)},function(a){n.a(a)},this)},function(a){n.a(a)},c);P(n,function(){h.e(c)},function(a){h.a(a)},
this)},function(a){h.a(a)},this);return h};oj.prototype.clear=function(){wb(this.q,K);this.q.length=0;this.Ud={}};function pj(a,b){E.call(this);this.type=a;this.size=b}A(pj,E);function qj(a,b){ib.call(this,b+": "+rj(a));this.code=a;this.action=b}A(qj,ib);
function rj(a){switch(a){case 1:return"File or directory not found";case 2:return"Insecure or disallowed operation";case 3:return"Operation aborted";case 4:return"File or directory not readable";case 5:return"Invalid encoding";case 6:return"Cannot modify file or directory";case 7:return"Invalid state";case 8:return"Invalid line-ending specifier";case 9:return"Invalid modification";case 10:return"Quota exceeded";case 11:return"Invalid filetype";case 12:return"File or directory already exists at specified path";
default:return"Unknown error"}};function sj(a,b){return new qj(a?a.code:0,b)};function tj(a,b){ib.call(this,jb("Error %s: %s",b,uj(a)));this.code=a}A(tj,ib);
function uj(a){switch(a){case 1:return"File or directory not found";case 2:return"Insecure or disallowed operation";case 3:return"Operation aborted";case 4:return"File or directory not readable";case 5:return"Invalid encoding";case 6:return"Cannot modify file or directory";case 7:return"Invalid state";case 8:return"Invalid line-ending specifier";case 9:return"Invalid modification";case 10:return"Quota exceeded";case 11:return"Invalid filetype";case 12:return"File or directory already exists at specified path";
default:return"Unrecognized error"}};function vj(a,b){ag.call(this,a.type,b);this.cg=a}A(vj,ag);function wj(){E.call(this);this.m=new FileReader;this.m.onloadstart=y(this.ba,this);this.m.onprogress=y(this.ba,this);this.m.onload=y(this.ba,this);this.m.onabort=y(this.ba,this);this.m.onerror=y(this.ba,this);this.m.onloadend=y(this.ba,this)}A(wj,ki);t=wj.prototype;t.abort=function(){try{this.m.abort()}catch(a){g(new tj(a.code,"aborting read"))}};t.Kb=function(){return this.m.readyState};t.getError=function(){return this.m.error&&new tj(this.m.error.code,"reading file")};
t.ba=function(a){this.dispatchEvent(new vj(a,this))};t.b=function(){wj.d.b.call(this);delete this.m};t.readAsArrayBuffer=function(a){this.m.readAsArrayBuffer(a)};function xj(a,b){E.call(this);this.Hi=b;this.Hb=[];a>this.Hi&&g(Error("[goog.structs.SimplePool] Initial cannot be greater than max"));for(var c=0;c<a;c++)this.Hb.push(this.Rc())}A(xj,E);t=xj.prototype;t.Pf=p;t.bi=p;function yj(a,b){a.Hb.length<a.Hi?a.Hb.push(b):a.Wf(b)}t.Rc=function(){return this.Pf?this.Pf():{}};t.Wf=function(a){if(this.bi)this.bi(a);else if(oa(a))if(na(a.Uc))a.Uc();else for(var b in a)delete a[b]};t.b=function(){xj.d.b.call(this);for(var a=this.Hb;a.length;)this.Wf(a.pop());delete this.Hb};function zj(a){E.call(this);this.zb=a;this.nb=new xj(0,5);J(this,this.nb);a=y(function(){return new Aj(this.nb)},this);this.nb.Pf=a}A(zj,E);zj.prototype.jb=function(){return this.zb.size};zj.prototype.read=function(a,b){var c=this.zb.size,d=a||0;if(d>=c)return c=new O,c.a(new qj(7,"read file")),c;var e=d+(fa(b)?b:c);e>c&&(e=c);var e=e||0,f=p;0==d&&e==c?f=this.zb:this.zb.slice?f=this.zb.slice(d,e):this.zb.webkitSlice&&(f=this.zb.webkitSlice(d,e));return(this.nb.Hb.length?this.nb.Hb.pop():this.nb.Rc()).ka(f)};
function Aj(a){pg.call(this,this);this.nb=a;this.Rf=p;this.m=new wj;J(this,this.m);this.listen(this.m,"loadend",this.uk)}A(Aj,pg);Aj.prototype.ka=function(a){var b=new O(this.pk,this);this.Rf=b;this.m.readAsArrayBuffer(a);return b};Aj.prototype.pk=function(){this.m.abort()};Aj.prototype.uk=function(){var a=this.Rf;if(a){this.Rf=p;var b=this.m.m.result,c=this.m.getError();yj(this.nb,this);b?a.e(b):a.a(sj(c,"read"))}};function Bj(a){E.call(this);this.Ca=a;this.Ca.onwritestart=y(this.ba,this);this.Ca.onprogress=y(this.ba,this);this.Ca.onwrite=y(this.ba,this);this.Ca.onabort=y(this.ba,this);this.Ca.onerror=y(this.ba,this);this.Ca.onwriteend=y(this.ba,this)}A(Bj,ki);t=Bj.prototype;t.abort=function(){try{this.Ca.abort()}catch(a){g(new tj(a.code,"aborting save"))}};t.Kb=function(){return this.Ca.readyState};t.getError=function(){return this.Ca.error&&new tj(this.Ca.error.code,"saving file")};
t.ba=function(a){this.dispatchEvent(new vj(a,this))};t.b=function(){delete this.Ca;Bj.d.b.call(this)};function Cj(a){E.call(this);this.oa=a;J(this,this.oa);this.Ra=this.Z=p;this.ib=new pg(this);J(this,this.ib);this.ib.listen(this.oa,"writeend",function(){if(this.Z){var a=this.Z;this.Ra=this.Z=p;a.e(p)}});this.ib.listen(this.oa,"error",function(){if(this.Z&&this.Ra){var a=this.Z,c=new qj(2,this.Ra);this.Ra=this.Z=p;a.a(c)}});this.ib.listen(this.oa,"abort",function(){if(this.Z&&this.Ra){var a=this.Z,c=new qj(3,this.Ra);this.Ra=this.Z=p;a.a(c)}})}A(Cj,E);Cj.prototype.jb=function(){return this.oa.jb()};
Cj.prototype.bh=function(a){var b=new O;this.Z?b.a(new qj(7,"overlapped set length")):a==this.jb()?b.e(p):(this.Z=b,this.Ra="set length",this.oa.truncate(a));return b};
Cj.prototype.write=function(a,b){var c=new O;if(this.Z)return c.a(new qj(7,"overlapped write")),c;for(var d=Array.prototype.slice.call(arguments,1),e=0;e<d.length;e++)d[e]instanceof ArrayBuffer&&(d[e]=new Uint8Array(d[e]));var f=new Blob(d);a>this.jb()?P(this.bh(a+f.size),function(){this.Z=c;this.Ra="write";this.oa.seek(a);this.oa.write(f)},function(a){c.a(a)},this):(this.Z=c,this.Ra="write",this.oa.seek(a),this.oa.write(f));return c};function Dj(a,b){this.gg=a;this.fullPath=b.da.fullPath;this.name=b.getName();this.type=b.isFile()?0:1;this.oa=b}Dj.prototype.isFile=function(){return 0==this.type};Dj.prototype.remove=function(){var a=new O;P(this.oa.remove(),function(){a.e(p)},function(b){a.a(sj(b,"remove "+this.fullPath))},this);return a};function Ej(a,b){return b.isFile()?new Fj(a.gg,b):new Gj(a.gg,b)}function Fj(a,b){Dj.call(this,a,b);this.gi=b}A(Fj,Dj);
Fj.prototype.createReader=function(){var a=new O;P(this.gi.file(),function(b){a.e(new zj(b))},function(b){a.a(sj(b,"create reader "+this.fullPath))},this);return a};Fj.prototype.createWriter=function(){var a=new O;P(this.gi.createWriter(),function(b){a.e(new Cj(b))},function(b){a.a(sj(b,"create writer "+this.fullPath))},this);return a};Fj.prototype.read=function(){var a=new O;P(this.createReader(),function(b){P(b.read(),function(c){K(b);a.e(c)},function(c){K(b);a.a(c)})},function(b){a.a(b)});return a};
Fj.prototype.write=function(a){var b=new O;P(this.createWriter(),function(c){P(c.bh(0),function(){P(c.write(a),function(){K(c);b.e(p)},function(a){K(c);b.a(a)})},function(a){K(c);b.a(a)})},function(a){b.a(a)});return b};function Gj(a,b){Dj.call(this,a,b);this.Sf=b}A(Gj,Dj);Gj.prototype.getFile=function(a,b){var c=new O;P(this.Sf.getFile(a,b),function(a){c.e(Ej(this,a))},function(b){c.a(sj(b,"get file "+a+" in "+this.fullPath))},this);return c};
Gj.prototype.getDirectory=function(a,b){var c=new O;P(this.Sf.getDirectory(a,b),function(a){c.e(Ej(this,a))},function(b){c.a(sj(b,"get directory "+a+" in "+this.fullPath))},this);return c};Gj.prototype.Sc=function(a){var b=new O;P(this.Sf.Sc(a),function(a){b.e(Ej(this,a))},function(c){b.a(sj(c,"create path "+a+" in "+this.fullPath))},this);return b};function Hj(a){Bj.call(this,a);this.S=a}A(Hj,Bj);t=Hj.prototype;t.bd=function(){return this.S.position};t.jb=function(){return this.S.length};t.write=function(a){try{this.S.write(a)}catch(b){g(new tj(b.code,"writing file"))}};t.seek=function(a){try{this.S.seek(a)}catch(b){g(new tj(b.code,"seeking in file"))}};t.truncate=function(a){try{this.S.truncate(a)}catch(b){g(new tj(b.code,"truncating file"))}};function Ij(a){return a};function Jj(a,b){this.Ua=a;this.da=b}Jj.prototype.isFile=function(){return this.da.isFile};Jj.prototype.getName=function(){return this.da.name};Jj.prototype.remove=function(){var a=new O;this.da.remove(y(a.e,a,m),y(function(b){a.a(new tj(b.code,"removing "+this.da.fullPath))},this));return a};Jj.prototype.getParent=function(){var a=new O;this.da.getParent(y(function(b){a.e(new Kj(this.Ua,b))},this),y(function(b){a.a(new tj(b.code,"getting parent of "+this.da.fullPath))},this));return a};
function Kj(a,b){Jj.call(this,a,b);this.ai=b}A(Kj,Jj);var Lj=2;Kj.prototype.getFile=function(a,b){var c=new O;this.ai.getFile(a,Mj(b),y(function(a){c.e(new Nj(this.Ua,a))},this),y(function(b){c.a(new tj(b.code,"loading file "+a+" from "+this.da.fullPath))},this));return c};Kj.prototype.getDirectory=function(a,b){var c=new O;this.ai.getDirectory(a,Mj(b),y(function(a){c.e(new Kj(this.Ua,a))},this),y(function(b){c.a(new tj(b.code,"loading directory "+a+" from "+this.da.fullPath))},this));return c};
Kj.prototype.Sc=function(a){function b(a){if(!d.length)return Yc(a);var c=d.shift();a=".."==c?a.getParent():"."==c?Yc(a):a.getDirectory(c,Lj);return P(a,b,p,j)}if(0==a.lastIndexOf("/",0)){var c=this.Ua.ic();if(this.da.fullPath!=c.da.fullPath)return c.Sc(a)}var d=xb(a.split("/"),Ij);return b(this)};function Mj(a){return a==Lj?{create:m}:3==a?{create:m,exclusive:m}:{}}function Nj(a,b){Jj.call(this,a,b);this.hi=b}A(Nj,Jj);
Nj.prototype.createWriter=function(){var a=new O;this.hi.createWriter(function(b){a.e(new Hj(b))},y(function(b){a.a(new tj(b.code,"creating writer for "+this.da.fullPath))},this));return a};Nj.prototype.file=function(){var a=new O;this.hi.file(function(b){a.e(b)},y(function(b){a.a(new tj(b.code,"getting file for "+this.da.fullPath))},this));return a};function Oj(a){this.Ua=a}Oj.prototype.getName=function(){return this.Ua.name};Oj.prototype.ic=function(){return new Kj(this,this.Ua.root)};function Pj(a,b,c){pj.call(this,a,b);this.pl=c}A(Pj,pj);Pj.prototype.ic=function(){return new Gj(this,this.pl.ic())};function Qj(a){dj.call(this);this.Af=a;this.vd=this.rb=this.Ua=p}A(Qj,dj);
Qj.prototype.Tb=function(){var a=new O,b=new O,c=p;if(c=v.requestFileSystem||v.webkitRequestFileSystem,na(c)){var d=new O;c(1,1073741824,function(a){d.e(new Oj(a))},function(a){d.a(new tj(a.code,"requesting filesystem"))});c=d}else c=Zc(Error("File API unsupported"));c?P(c,function(a){b.e(new Pj(1,1073741824,a))},function(a){b.a(sj(a,"requesting filesystem"))}):b.a(p);P(b,function(b){this.Ua=b;P(b.ic().Sc(this.Af),function(b){this.rb=b;P(this.rb.Sc("regions"),function(b){this.vd=new oj(256,b);J(this,
this.vd);this.rc=r;this.ob();a.e(p)},function(b){a.a(b)},this)},function(b){a.a(b)},this)},function(b){a.a(b)},this);return a};
Qj.prototype.Pg=function(a){switch(a.action){case 0:P(this.rb.getFile("info.bin"),function(b){P(b.read(),function(b){ej(this,a,p,b)},function(b){ej(this,a,b,p)},this)},function(b){ej(this,a,b,p)},this);break;case 1:P(this.rb.getFile("info.bin"),function(b){P(b.write(a.data),function(){gj(this,a,p)},function(b){gj(this,a,b)},this)},function(b){gj(this,a,b)},this);break;case Qc:P(this.vd.get(a.x,a.y,a.l),function(b){var c=new O,d=b.aa[b.gc(a.x,a.y,a.l)],e=4096*(d&255);e?P(b.m.read(4096*(d>>8),e),function(a){c.e(a)},
function(a){c.a(a)},b):c.e(p);P(c,function(b){hj(this,a,p,b)},function(b){hj(this,a,b,p)},this)},function(b){hj(this,a,b,p)},this);break;case ij:P(this.vd.get(a.x,a.y,a.l),function(b){var c=a.data,d=new O,e=b.gc(a.x,a.y,a.l),f=b.aa[e],h=f>>8,k=f&255,i=Math.ceil(c.byteLength/4096);if(255<i)d.a(p);else if(h&&k==i)P(b.Hd(h,c),function(){d.e()},function(a){d.a(a)});else{if(h)for(var l=0;l<k;l++)b.L[h+l]=r;var n=new O,k=b.L.indexOf(r),l=0;if(1<i&&-1!=k)for(h=k;h<b.L.length&&!(l?b.L[h]?l=0:l++:b.L[h]||
(k=h,l=1),l>=i);h++);if(l>=i){for(h=0;h<i;h++)b.L[k+h]=m;n.e(k)}else{var q=Math.max(i,32),h=b.S.jb()+4096*q;P(b.S.bh(h),function(){var a=this.L.length;this.L.length+=q;for(var b=0;b<q;b++)this.L[a+b]=r;for(b=0;b<i;b++)this.L[a+b]=m;K(this.m);this.m=p;P(this.fg.createReader(),function(b){this.m=b;n.e(a)},function(a){n.a(a)},this)},function(a){n.a(a)},b)}P(n,function(a){f=a<<8|i;this.aa[e]=f;P(this.Hd(a,c),function(){P(this.Hd(0,this.aa.buffer),function(){d.e()},function(a){d.a(a)})},function(a){d.a(a)},
this)},function(a){d.a(a)},b)}P(d,function(){jj(this,a,p)},function(b){jj(this,a,b)},this)},function(b){jj(this,a,b)},this);break;case 4:P(this.vd.get(a.x,a.y,a.l),function(b){var c=b.gc(a.x,a.y,a.l),d=b.aa[c],e=d>>8,d=d&255;if(e){for(var f=0;f<d;f++)b.L[e+f]=r;b.aa[c]=0;b=b.Hd(0,b.aa.buffer)}else b=Yc(p);P(b,function(){kj(this,a,p)},function(b){kj(this,a,b)},this)},function(b){kj(this,a,b)},this)}};function Rj(a){dj.call(this);this.Af=a;this.Ia=p}A(Rj,dj);var Sj=v.indexedDB||v.mozIndexedDB||v.webkitIndexedDB||v.msIndexedDB;Rj.prototype.Tb=function(){if(!Sj)return Zc(p);var a=new O,b=Sj.open(this.Af,2);b.onerror=function(){a.a(p)};b.onsuccess=y(function(){this.Ia=b.result;this.Ia.onerror=function(a){M("idb error: "+a)};this.rc=r;this.ob();a.e(p)},this);b.onupgradeneeded=function(a){a=a.target.result;a.createObjectStore("info");a.createObjectStore("chunks")};return a};
Rj.prototype.b=function(){this.Ia&&(this.Ia.close(),this.Ia=p);Rj.d.b.call(this)};Rj.prototype.Jb=function(a){return[a.x,a.y,a.l].join(".")};
Rj.prototype.Pg=function(a){switch(a.action){case 0:var b=this.Ia.transaction(["info"],"readonly").objectStore("info").get("info");b.onsuccess=y(function(){ej(this,a,p,b.result)},this);b.onerror=y(function(b){b.preventDefault();ej(this,a,b,p)},this);break;case 1:var c=this.Ia.transaction(["info"],"readwrite").objectStore("info").put(a.data,"info");c.onsuccess=y(function(){gj(this,a,p)},this);c.onerror=y(function(b){b.preventDefault();gj(this,a,b)},this);break;case Qc:var d=this.Ia.transaction(["chunks"],
"readonly").objectStore("chunks").get(this.Jb(a));d.onsuccess=y(function(){hj(this,a,p,d.result)},this);d.onerror=y(function(b){b.preventDefault();hj(this,a,b,p)},this);break;case ij:c=this.Ia.transaction(["chunks"],"readwrite").objectStore("chunks").put(a.data,this.Jb(a));c.onsuccess=y(function(){jj(this,a,p)},this);c.onerror=y(function(b){b.preventDefault();jj(this,a,b)},this);break;case 4:c=this.Ia.transaction(["chunks"],"readwrite").objectStore("chunks")["delete"](this.Jb(a)),c.onsuccess=y(function(){kj(this,
a,p)},this),c.onerror=y(function(b){b.preventDefault();kj(this,a,b)},this)}};function Tj(){dj.call(this);this.vi=p;this.If={}}A(Tj,dj);Tj.prototype.Tb=function(){this.rc=r;this.ob();return Yc(p)};Tj.prototype.Jb=function(a){return[a.x,a.y,a.l].join(".")};Tj.prototype.Pg=function(a){switch(a.action){case 0:ej(this,a,p,this.vi);break;case 1:this.vi=a.data;gj(this,a,p);break;case Qc:var b=this.If[this.Jb(a)];hj(this,a,p,b);break;case ij:this.If[this.Jb(a)]=a.data;jj(this,a,p);break;case 4:delete this.If[this.Jb(a)],kj(this,a,p)}};function Uj(a,b){var c;if(a instanceof Uj)this.na=fa(b)?b:a.na,Vj(this,a.Bc),c=a.ff,Wj(this),this.ff=c,c=a.Vc,Wj(this),this.Vc=c,Xj(this,a.Ge),c=a.Ee,Wj(this),this.Ee=c,Yj(this,a.pb.w()),c=a.ne,Wj(this),this.ne=c;else if(a&&(c=String(a).match(Pi))){this.na=!!b;Vj(this,c[1]||"",m);var d=c[2]||"";Wj(this);this.ff=d?decodeURIComponent(d):"";d=c[3]||"";Wj(this);this.Vc=d?decodeURIComponent(d):"";Xj(this,c[4]);d=c[5]||"";Wj(this);this.Ee=d?decodeURIComponent(d):"";Yj(this,c[6]||"",m);c=c[7]||"";Wj(this);
this.ne=c?decodeURIComponent(c):""}else this.na=!!b,this.pb=new Zj(p,0,this.na)}t=Uj.prototype;t.Bc="";t.ff="";t.Vc="";t.Ge=p;t.Ee="";t.ne="";t.wl=r;t.na=r;
t.toString=function(){var a=[],b=this.Bc;b&&a.push($j(b,ak),":");if(b=this.Vc){a.push("//");var c=this.ff;c&&a.push($j(c,ak),"@");a.push(encodeURIComponent(String(b)));b=this.Ge;b!=p&&a.push(":",String(b))}if(b=this.Ee)this.Vc&&"/"!=b.charAt(0)&&a.push("/"),a.push($j(b,"/"==b.charAt(0)?bk:ck));(b=this.pb.toString())&&a.push("?",b);(b=this.ne)&&a.push("#",$j(b,dk));return a.join("")};t.w=function(){return new Uj(this)};
function Vj(a,b,c){Wj(a);a.Bc=c?b?decodeURIComponent(b):"":b;a.Bc&&(a.Bc=a.Bc.replace(/:$/,""))}function Xj(a,b){Wj(a);b?(b=Number(b),(isNaN(b)||0>b)&&g(Error("Bad port number "+b)),a.Ge=b):a.Ge=p}function Yj(a,b,c){Wj(a);b instanceof Zj?(a.pb=b,a.pb.ah(a.na)):(c||(b=$j(b,ek)),a.pb=new Zj(b,0,a.na))}function Wj(a){a.wl&&g(Error("Tried to modify a read-only Uri"))}t.ah=function(a){this.na=a;this.pb&&this.pb.ah(a);return this};function $j(a,b){return ma(a)?encodeURI(a).replace(b,fk):p}
function fk(a){a=a.charCodeAt(0);return"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var ak=/[#\/\?@]/g,ck=/[\#\?:]/g,bk=/[\#\?]/g,ek=/[\#\?@]/g,dk=/#/g;function Zj(a,b,c){this.ca=a||p;this.na=!!c}function gk(a){if(!a.B&&(a.B=new pi,a.f=0,a.ca))for(var b=a.ca.split("&"),c=0;c<b.length;c++){var d=b[c].indexOf("="),e=p,f=p;0<=d?(e=b[c].substring(0,d),f=b[c].substring(d+1)):e=b[c];e=decodeURIComponent(e.replace(/\+/g," "));e=hk(a,e);a.add(e,f?decodeURIComponent(f.replace(/\+/g," ")):"")}}t=Zj.prototype;
t.B=p;t.f=p;t.fa=function(){gk(this);return this.f};t.add=function(a,b){gk(this);this.ca=p;a=hk(this,a);var c=this.B.get(a);c||this.B.set(a,c=[]);c.push(b);this.f++;return this};t.remove=function(a){gk(this);a=hk(this,a);return this.B.Cb(a)?(this.ca=p,this.f-=this.B.get(a).length,this.B.remove(a)):r};t.clear=function(){this.B=this.ca=p;this.f=0};t.Cb=function(a){gk(this);a=hk(this,a);return this.B.Cb(a)};
t.Ka=function(){gk(this);for(var a=this.B.za(),b=this.B.Ka(),c=[],d=0;d<b.length;d++)for(var e=a[d],f=0;f<e.length;f++)c.push(b[d]);return c};t.za=function(a){gk(this);var b=[];if(a)this.Cb(a)&&(b=Cb(b,this.B.get(hk(this,a))));else{a=this.B.za();for(var c=0;c<a.length;c++)b=Cb(b,a[c])}return b};t.set=function(a,b){gk(this);this.ca=p;a=hk(this,a);this.Cb(a)&&(this.f-=this.B.get(a).length);this.B.set(a,[b]);this.f++;return this};
t.get=function(a,b){var c=a?this.za(a):[];return 0<c.length?String(c[0]):b};t.toString=function(){if(this.ca)return this.ca;if(!this.B)return"";for(var a=[],b=this.B.Ka(),c=0;c<b.length;c++)for(var d=b[c],e=encodeURIComponent(String(d)),d=this.za(d),f=0;f<d.length;f++){var h=e;""!==d[f]&&(h+="="+encodeURIComponent(String(d[f])));a.push(h)}return this.ca=a.join("&")};t.w=function(){var a=new Zj;a.ca=this.ca;this.B&&(a.B=this.B.w(),a.f=this.f);return a};
function hk(a,b){var c=String(b);a.na&&(c=c.toLowerCase());return c}t.ah=function(a){a&&!this.na&&(gk(this),this.ca=p,Jc(this.B,function(a,c){var d=c.toLowerCase();c!=d&&(this.remove(c),this.remove(d),0<a.length&&(this.ca=p,this.B.set(hk(this,d),Db(a)),this.f+=a.length))},this));this.na=a};t.extend=function(a){for(var b=0;b<arguments.length;b++)Jc(arguments[b],function(a,b){this.add(b,a)},this)};function ik(a,b,c){this.xf=a;Hc(this.xf,jk());this.uri=new Uj(b);this.He=new Zj(j,0,m);(a=this.uri.pb)&&this.He.extend(a);this.He.extend(c);this.Sm=kk(this,"buildServer")}function jk(){return{buildServer:{help:"Build server daemon address.",type:String,defaultValue:p}}}function lk(a,b){var c=parseFloat(a.xf[b].defaultValue),d=a.He.get(b,c);return!fa(d)?c:Number(d)}function kk(a,b){var c=a.xf[b].defaultValue,d=a.He.get(b,c);return!fa(d)||!d||!d.length||/^[\s\xa0]*$/.test(String(d))?c:String(d)};function mk(a,b){ik.call(this,nk(),a,b);this.gn=lk(this,"listenPort");this.gg=kk(this,"fileSystem");this.zl=kk(this,"mapPath");this.yl=kk(this,"mapGenerator");this.Al=lk(this,"mapSeed");this.Ef=kk(this,"browserUrl");this.rj=kk(this,"serverId");this.tj=kk(this,"serverKey");this.fm=kk(this,"serverName");this.wm=lk(this,"userCount")}A(mk,ik);
function nk(){return{listenPort:{help:"Port to use for game connections.",type:Number,defaultValue:1337},fileSystem:{help:"File system root path.",type:String,defaultValue:"/tmp/blk/"},mapPath:{help:"Map path.",type:String,defaultValue:"/maps/map01/"},mapGenerator:{help:"Map generator name.",type:String,defaultValue:"improved"},mapSeed:{help:"Map generator random seed.",type:Number,defaultValue:0},browserUrl:{help:"Server browser base API URL.",type:String,defaultValue:"http://localhost:8081/"},serverId:{help:"Server registration UUID.",
type:String,defaultValue:p},serverKey:{help:"Server private key.",type:String,defaultValue:p},serverName:{help:"Human-readable server name.",type:String,defaultValue:p},userCount:{help:"Maximum simultaneous user count.",type:Number,defaultValue:8}}};function ok(){E.call(this);this.type="none"}A(ok,E);function pk(){this.dd=Array(256)}function Ge(a,b,c,d){c=d?y(c,d):c;a.dd[b]=c};function qk(a,b,c){E.call(this);this.Mb=new pk;this.G=new bi;this.id=a;this.type=b;this.dj=c;this.info=new kh;this.Om=new ok;this.state=0;this.h=[];this.Yb={};this.wh=Array(256);this.W=[]}A(qk,E);qk.prototype.b=function(){this.W.length=0;qk.d.b.call(this)};qk.prototype.wf=function(a){this.h.push(a);this.Yb[a.c]=a;this.wh[a.R]=a;for(var b=0;b<this.W.length;b++)this.W[b].th(a)};qk.prototype.Ke=function(a){var b=this.Yb,c=a.c,d;(d=c in b)&&delete b[c];if(d){this.wh[a.R]=p;Bb(this.h,a);for(b=0;b<this.W.length;b++)this.W[b].uh(a)}};function rk(a){this.timestamp=z();this.I=p;this.data=a};function sk(a){E.call(this);this.Ta=a;this.vl=r;this.state=tk;this.Yd=r;this.Cc=0;this.vb=p;this.ud=[];this.nf=[]}A(sk,E);sk.prototype.b=function(){this.close();sk.d.b.call(this)};var tk=0;sk.prototype.read=function(){if(!this.ud.length)return p;var a=this.ud[0];a.timestamp<=z()?this.ud.shift():a=p;this.ud.length||(this.Yd=r);return a};
sk.prototype.write=function(a){a=new rk(a);if(this.Cc){var b=this.Cc+(Math.random()-0.5)*this.Cc/2;a.timestamp+=b;this.vb===p&&(this.vb=v.setInterval(y(function(){1==this.state&&this.flush()},this),5))}else this.vb!==p&&(v.clearInterval(this.vb),this.vb=p);this.nf.push(a);1==this.state&&this.flush()};function uk(a,b){if(a.Cc){var c=a.Cc+(Math.random()-0.5)*a.Cc/2;b.timestamp+=c}a.ud.push(b);a.Yd=m}
sk.prototype.flush=function(a){for(var b=z();this.nf.length;){var c=this.nf[0];if(c.timestamp>b&&!a)break;this.nf.shift();this.Vj(c.data)}};sk.prototype.close=function(){2!=this.state&&(this.vb!==p&&(v.clearInterval(this.vb),this.vb=p),this.state=2)};function vk(a,b,c,d){qk.call(this,"0",0,b);Ge(this.Mb,1,this.jl,this);Ge(this.Mb,8,this.ll,this);Ge(this.Mb,5,this.hl,this);this.ja=a;this.sj=d;this.Tg=r;this.hd=[];this.Nd=Array(255);for(a=1;a<this.Nd.length;a++)this.Nd[a-1]=a}A(vk,qk);t=vk.prototype;t.b=function(){if(this.Tg){this.Tg=r;this.state=0;this.ja.ka(p);for(var a=0;a<this.W.length;a++)this.W[a].Uf()}vk.d.b.call(this)};t.lg=function(a){var b=a.Ta;0<=vb(Gb,b)||Gb.push(b);this.hd.push(a)};
function wk(a,b){if(b.ja&&(a.Yb[b.c]||p)==b)b.ja.close(),a.Ke(b),a.send(Eh(b.c,b.Tf)),0!=b.R&&(a.Nd.push(b.R),b.R=0)}
t.Yi=function(a){if(this.hd.length)for(var b=df(),c=0;c<this.hd.length;c++){var d=this.hd[c],e=r,f=r,h=1;if(2!=d.state)for(;d.Yd;){var k=d.read();if(!k)break;b.ka(k.data,0);if(4==Oe(b)){var i=b,e=vh;e.Ye=Pe(i);e.Kd=Pe(i);k=e.I||new fe;k.c=i.H();k.R=Oe(i);k.z=i.ia();var l;if(!(l=!mh(i,k.info)))l=k.Jd||new ae,l.type=i.H(),l.platform=i.H(),l.rd=i.H(),l.Tc=i.H(),l=!l;e=!(l?0:k)?p:e;this.h.length+1>this.sj.oc&&(f=m,h=7);if(!f&&(3!=e.Ye||e.Kd!=this.dj))f=m,h=2;if(!f){e=ge(e.I);for(e.ja=d;!(e.c=Math.floor(2147483648*
Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^z()).toString(36),!this.Yb[e.c]););e.R=this.Nd.shift();this.send(Ch(ge(e)));this.send(xh(this.dj,e),e);k=yb(this.h,ge);k.push(ge(e));this.send(th(this.info.w(),k),e);this.wf(e)}e=m}else f=e=m,h=3}else f=e=m,h=1;e&&(f&&(f=h,h=R(),Ah.reason=f,Q(h,5),h.M(Ah.reason),(f=h.finish())&&d.write(f),K(d)),this.hd.splice(c,1),c--)}b=Bc();for(c=0;c<this.h.length;c++){for(d=this.h[c];d.ja.Yd;){h=d.ja.read();if(!h)break;h.I=d;d.Mh+=h.data.byteLength;
f=this.Mb;e=df();e.ka(h.data,0);e.offset+1<=e.buffer.length&&(k=Oe(e),(f=f.dd[k])&&f(h,k,e))}if(!d.ja||2==d.ja.state)d.Tf=1,wk(this,d);else if(a&&Bc()-b>=a)break}};t.jl=function(a,b,c){a=a.I;ph.Te=c.ia();ph.Oc=c.ia();ph.nc=c.ia();if(!ph)return r;c=a.i;b=Math.abs(ph.nc);c.Od=c.Od?(c.Od+b)/2:b;c.Ji=Math.min(c.Ji,b);c.Ii=Math.max(c.Ii,b);c=He(this.G)+this.G.$d;b=Array(this.h.length);for(var d=0;d<this.h.length;d++)b[d]=new lh,b[d].R=this.h[d].R,b[d].nc=this.h[d].i.Od;this.send(rh(1E3*c|0,b),a);return m};
t.ll=function(a,b,c){Gh.c=c.H();c=!mh(c,Gh.info)?p:Gh;if(!c)return r;b=this.Yb[c.c]||p;if(!b)return m;if(b!=a.I)return r;a=c.info.ya;a=kb(a).replace(/\xa0|\s/g," ").replace(/\xa0|[ \t]+/g," ");a=!a.length?"User":a;b.info.ya=a;for(a=0;a<this.W.length;a++)this.W[a].vh(b);this.send(Ih(b.c,b.info));return m};t.hl=function(a,b,c){a=a.I;zh.reason=c.ia();if(!zh)return r;M("["+a.c+"] disconnect req",zh.reason);return m};
t.send=function(a,b){if(a)if(b){var c=b.ja;2!=c.state?(c.write(a),b.i.Td+=a.byteLength):wk(this,b)}else for(var d=0;d<this.h.length;d++){var e=this.h[d],c=e.ja;2!=c.state?(e.i.Td+=a.byteLength,c.write(a)):(e.Tf=1,wk(this,e))}};function xk(a){a=new Uint8Array(a);for(var b=Array(a.length),c=0;c<b.length;c++)b[c]=a[c];return String.fromCharCode.apply(p,b)};function yk(a,b){sk.call(this,a);this.vl=m;this.state=1;this.p=b;this.lm=!!b.webkitPostMessage&&!(v.Im&&b instanceof MessagePort);this.ok=!Hd;var c=this;this.p.onmessage=function(a){c.mg(a)};this.p.onerror=function(a){M("port error",a)}}A(yk,sk);
yk.prototype.mg=function(a){a=a.data;var b=p;if(a instanceof ArrayBuffer)b=new rk(a);else if(ma(a)){for(var b=new Uint8Array(2*a.length),c=0,d=0;d<a.length;d++){for(var e=a.charCodeAt(d);255<e;)b[c++]=e,e>>=8;b[c++]=e}b=new rk(b.subarray(0,c).buffer)}else a&&a.close&&this.close();b&&uk(this,b)};yk.prototype.Vj=function(a){this.lm?this.p.webkitPostMessage(a,[a]):this.ok?this.p.postMessage(a):this.p.postMessage(xk(a))};
yk.prototype.close=function(){this.p.onmessage=p;try{this.p.postMessage({close:m}),this.p.close&&this.p.close()}catch(a){}yk.d.close.call(this)};function zk(a){E.call(this);this.Ta=a;this.fb=m;this.Mf=[];this.be=p}A(zk,E);zk.prototype.b=function(){this.close();this.be=p;zk.d.b.call(this)};zk.prototype.ka=function(a){if(this.be=a)for(;this.Mf.length;){var b=this.Mf.shift();a.call(p,b)}};function Ak(a,b){a.be?a.be.call(p,b):a.Mf.push(b)};function Bk(a,b){zk.call(this,a);this.p=b;this.Ih=y(this.lg,this);this.p.addEventListener("connect",this.Ih,r);if(v.WorkerLocation){var c=new yk(b,b);Ak(this,c)}}A(Bk,zk);Bk.prototype.lg=function(a){a=a.ports[0];a=new yk(a,a);Ak(this,a)};Bk.prototype.close=function(){this.fb&&(this.fb=r,this.p.removeEventListener("connect",this.Ih,r))};function Ck(a,b){sk.call(this,a);this.state=1;this.p=b;this.Kh=y(this.il,this);this.Hh=y(this.fl,this);this.Lh=y(this.mg,this);this.Dm={binary:m,mask:r};this.p.addListener("error",this.Kh);this.p.addListener("close",this.Hh);this.p.addListener("message",this.Lh)}A(Ck,sk);t=Ck.prototype;t.il=function(a){M("socket error",a)};t.fl=function(a){M("socket closed",a.code);this.close()};t.mg=function(a){for(var b=new Uint8Array(a.length),c=0;c<a.length;c++)b[c]=a[c];a=new rk(b.buffer);uk(this,a)};
t.Vj=function(a){var b=new Buffer(a.byteLength);a=new Uint8Array(a);for(var c=0;c<a.length;c++)b[c]=a[c];try{this.p.send(b,this.Dm)}catch(d){M("socket error: "+d),this.close()}};t.close=function(){this.p.removeListener("error",this.Kh);this.p.removeListener("close",this.Hh);this.p.removeListener("message",this.Lh);try{this.p.close(1E3,"")}catch(a){}Ck.d.close.call(this)};function Dk(a){zk.call(this,a);this.p=new (require("ws").Server)({host:j,port:Number(a)});this.Jh=y(this.gl,this);this.p.addListener("connection",this.Jh)}A(Dk,zk);Dk.prototype.gl=function(a){a=new Ck(a,a);Ak(this,a)};Dk.prototype.close=function(){this.fb&&(this.fb=r,this.p.removeListener("connection",this.Jh),this.p.close())};function Ek(){this.Wc=[];this.Eg=new pi;this.Nj=this.Oj=this.Pj=this.Ij=0;this.Ad=new pi;this.Sh=this.Mj=0;this.Il=1;this.ag=new xj(0,4E3);this.ag.Rc=function(){return new Fk};this.Jj=new xj(0,50);this.Jj.Rc=function(){return new Gk};var a=this;this.pg=new xj(0,2E3);this.pg.Rc=function(){return String(a.Il++)};this.pg.Wf=aa();this.yk=3}Ek.prototype.V=Ji("goog.debug.Trace");function Gk(){this.yh=this.time=this.count=0}
Gk.prototype.toString=function(){var a=[];a.push(this.type," ",this.count," (",Math.round(10*this.time)/10," ms)");this.yh&&a.push(" [VarAlloc = ",this.yh,"]");return a.join("")};function Fk(){}function Hk(a,b,c,d){var e=[];-1==c?e.push("    "):e.push(Ik(a.di-c));e.push(" ",Jk(a.di-b));0==a.bg?e.push(" Start        "):1==a.bg?(e.push(" Done "),e.push(Ik(a.nn-a.startTime)," ms ")):e.push(" Comment      ");e.push(d,a);0<a.rm&&e.push("[VarAlloc ",a.rm,"] ");return e.join("")}
Fk.prototype.toString=function(){return this.type==p?this.tk:"["+this.type+"] "+this.tk};Ek.prototype.reset=function(a){this.yk=a;for(a=0;a<this.Wc.length;a++){var b=this.ag.id;b&&yj(this.pg,b);yj(this.ag,this.Wc[a])}this.Wc.length=0;this.Eg.clear();this.Ij=z();this.Sh=this.Mj=this.Nj=this.Oj=this.Pj=0;b=this.Ad.Ka();for(a=0;a<b.length;a++){var c=this.Ad.get(b[a]);c.count=0;c.time=0;c.yh=0;yj(this.Jj,c)}this.Ad.clear()};
Ek.prototype.toString=function(){for(var a=[],b=-1,c=[],d=0;d<this.Wc.length;d++){var e=this.Wc[d];1==e.bg&&c.pop();a.push(" ",Hk(e,this.Ij,b,c.join("")));b=e.di;a.push("\n");0==e.bg&&c.push("|  ")}if(0!=this.Eg.fa()){var f=z();a.push(" Unstopped timers:\n");d=this.Eg;b=function(b){a.push("  ",b," (",f-b.startTime," ms, started at ",Jk(b.startTime),")\n")};if(la(d))try{wb(d,b,j)}catch(h){h!==mi&&g(h)}else{d=oi(d);try{for(;;)b.call(j,d.next())}catch(k){k!==mi&&g(k)}}}b=this.Ad.Ka();for(d=0;d<b.length;d++)c=
this.Ad.get(b[d]),1<c.count&&a.push(" TOTAL ",c,"\n");a.push("Total tracers created ",this.Mj,"\n","Total comments created ",this.Sh,"\n","Overhead start: ",this.Pj," ms\n","Overhead end: ",this.Oj," ms\n","Overhead comment: ",this.Nj," ms\n");return a.join("")};function Ik(a){a=Math.round(a);var b="";1E3>a&&(b=" ");100>a&&(b="  ");10>a&&(b="   ");return b+a}function Jk(a){a=Math.round(a);return String(100+a/1E3%60).substring(1,3)+"."+String(1E3+a%1E3).substring(1,4)}new Ek;ea("blk.server.start",function(a,b){function c(a,b,d){var e=new (b.shift())(a);P(e.Tb(),function(){d(e)},function(){c(a,b,d)})}for(var d=new O,e={},f=0;f<b.length;f++){var h=b[f];if(0==h.indexOf("--")){var h=h.split("="),k=h[1];e[h[0].substring(2)]=1<h.length?k:m}}if(e.help)return M("BLK game server","(release)"),M("gf:"),M(jk()),M("blk:"),M(nk()),d.a("help query"),d;var i=new mk(a,e),e=new kh;e.Ta="blk://local-0";e.name=i.fm||"Server";e.Zc="blk";e.$c="0.0.1";e.oc=i.wm;f=p;ma(v)?f=new Dk(v):oa(v)&&
(f=new Bk(v,v));e=new vk(f,7,0,e);e=Yc(e);P(e,function(a){c(i.zl,[Rj,Qj,Tj],function(b){var c=new bj(i,a,b);P(c.load(),function(){c.hh||(c.hh=m,c.Le.start());d.e(c)},function(a){d.a(a)})})},function(a){d.a(a)});return d});
